{
  "version": 3,
  "sources": [
    "node_modules/browserify/node_modules/browser-pack/_prelude.js",
    "awayjs-renderergl.js",
    "awayjs-renderergl/lib/DefaultRenderer.ts",
    "awayjs-renderergl/lib/DepthRenderer.ts",
    "awayjs-renderergl/lib/DistanceRenderer.ts",
    "awayjs-renderergl/lib/Filter3DRenderer.ts",
    "awayjs-renderergl/lib/RendererBase.ts",
    "awayjs-renderergl/lib/animators/AnimationSetBase.ts",
    "awayjs-renderergl/lib/animators/AnimatorBase.ts",
    "awayjs-renderergl/lib/animators/ParticleAnimationSet.ts",
    "awayjs-renderergl/lib/animators/ParticleAnimator.ts",
    "awayjs-renderergl/lib/animators/SkeletonAnimationSet.ts",
    "awayjs-renderergl/lib/animators/SkeletonAnimator.ts",
    "awayjs-renderergl/lib/animators/VertexAnimationSet.ts",
    "awayjs-renderergl/lib/animators/VertexAnimator.ts",
    "awayjs-renderergl/lib/animators/data/AnimationRegisterCache.ts",
    "awayjs-renderergl/lib/animators/data/AnimationSubGeometry.ts",
    "awayjs-renderergl/lib/animators/data/ColorSegmentPoint.ts",
    "awayjs-renderergl/lib/animators/data/JointPose.ts",
    "awayjs-renderergl/lib/animators/data/ParticleAnimationData.ts",
    "awayjs-renderergl/lib/animators/data/ParticleData.ts",
    "awayjs-renderergl/lib/animators/data/ParticlePropertiesMode.ts",
    "awayjs-renderergl/lib/animators/data/ParticleProperties.ts",
    "awayjs-renderergl/lib/animators/data/SkeletonJoint.ts",
    "awayjs-renderergl/lib/animators/data/SkeletonPose.ts",
    "awayjs-renderergl/lib/animators/data/Skeleton.ts",
    "awayjs-renderergl/lib/animators/data/VertexAnimationMode.ts",
    "awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleColorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleFollowNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleNodeBase.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticlePositionNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleScaleNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleTimeNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleUVNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonClipNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode.ts",
    "awayjs-renderergl/lib/animators/nodes/VertexClipNode.ts",
    "awayjs-renderergl/lib/animators/states/AnimationClipState.ts",
    "awayjs-renderergl/lib/animators/states/AnimationStateBase.ts",
    "awayjs-renderergl/lib/animators/states/ParticleAccelerationState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleBezierCurveState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleBillboardState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleColorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleFollowState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleInitialColorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleOrbitState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleOscillatorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticlePositionState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleScaleState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleStateBase.ts",
    "awayjs-renderergl/lib/animators/states/ParticleTimeState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleUVState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleVelocityState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonClipState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonDifferenceState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonDirectionalState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState.ts",
    "awayjs-renderergl/lib/animators/states/VertexClipState.ts",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode.ts",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState.ts",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransition.ts",
    "awayjs-renderergl/lib/base/ParticleGeometry.ts",
    "awayjs-renderergl/lib/compilation/DepthRenderObject.ts",
    "awayjs-renderergl/lib/compilation/DistanceRenderObject.ts",
    "awayjs-renderergl/lib/compilation/RegisterPool.ts",
    "awayjs-renderergl/lib/compilation/RenderBasicMaterialObject.ts",
    "awayjs-renderergl/lib/compilation/RenderObjectBase.ts",
    "awayjs-renderergl/lib/compilation/RenderObjectPool.ts",
    "awayjs-renderergl/lib/compilation/ShaderCompilerBase.ts",
    "awayjs-renderergl/lib/compilation/ShaderLightingCompiler.ts",
    "awayjs-renderergl/lib/compilation/ShaderLightingObject.ts",
    "awayjs-renderergl/lib/compilation/ShaderObjectBase.ts",
    "awayjs-renderergl/lib/compilation/ShaderRegisterCache.ts",
    "awayjs-renderergl/lib/compilation/ShaderRegisterData.ts",
    "awayjs-renderergl/lib/compilation/ShaderRegisterElement.ts",
    "awayjs-renderergl/lib/compilation/SkyboxRenderObject.ts",
    "awayjs-renderergl/lib/errors/AnimationSetError.ts",
    "awayjs-renderergl/lib/events/AnimationStateEvent.ts",
    "awayjs-renderergl/lib/events/AnimatorEvent.ts",
    "awayjs-renderergl/lib/events/ShadingMethodEvent.ts",
    "awayjs-renderergl/lib/filters/Filter3DBase.ts",
    "awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase.ts",
    "awayjs-renderergl/lib/managers/RTTBufferManager.ts",
    "awayjs-renderergl/lib/passes/BasicMaterialPass.ts",
    "awayjs-renderergl/lib/passes/DepthPass.ts",
    "awayjs-renderergl/lib/passes/DistancePass.ts",
    "awayjs-renderergl/lib/passes/RenderPassBase.ts",
    "awayjs-renderergl/lib/passes/SkyboxPass.ts",
    "awayjs-renderergl/lib/pick/JSPickingCollider.ts",
    "awayjs-renderergl/lib/pick/PickingColliderBase.ts",
    "awayjs-renderergl/lib/pick/ShaderPicker.ts",
    "awayjs-renderergl/lib/pool/BillboardRenderable.ts",
    "awayjs-renderergl/lib/pool/CurveSubMeshRenderable.ts",
    "awayjs-renderergl/lib/pool/LineSegmentRenderable.ts",
    "awayjs-renderergl/lib/pool/LineSubMeshRenderable.ts",
    "awayjs-renderergl/lib/pool/RenderableBase.ts",
    "awayjs-renderergl/lib/pool/RenderablePoolBase.ts",
    "awayjs-renderergl/lib/pool/RendererPoolBase.ts",
    "awayjs-renderergl/lib/pool/Sampler2DObject.ts",
    "awayjs-renderergl/lib/pool/SamplerCubeObject.ts",
    "awayjs-renderergl/lib/pool/SamplerObjectBase.ts",
    "awayjs-renderergl/lib/pool/Single2DTextureObject.ts",
    "awayjs-renderergl/lib/pool/SingleCubeTextureObject.ts",
    "awayjs-renderergl/lib/pool/SkyboxRenderable.ts",
    "awayjs-renderergl/lib/pool/TextureObjectBase.ts",
    "awayjs-renderergl/lib/pool/TextureObjectPool.ts",
    "awayjs-renderergl/lib/pool/TriangleSubMeshRenderable.ts",
    "awayjs-renderergl/lib/tools/commands/Merge.ts",
    "awayjs-renderergl/lib/tools/data/ParticleGeometryTransform.ts",
    "awayjs-renderergl/lib/utils/ParticleGeometryHelper.ts",
    "awayjs-renderergl/lib/utils/PerspectiveMatrix3D.ts"
  ],
  "names": [
    "require",
    "e",
    "t",
    "n",
    "r",
    "s",
    "o",
    "u",
    "a",
    "i",
    "f",
    "Error",
    "code",
    "l",
    "exports",
    "call",
    "length",
    "awayjs-renderergl/lib/DefaultRenderer",
    "module",
    "__extends",
    "this",
    "d",
    "b",
    "p",
    "hasOwnProperty",
    "__",
    "constructor",
    "prototype",
    "BitmapImage2D",
    "Matrix3D",
    "Vector3D",
    "ContextGLCompareMode",
    "ContextGLClearMask",
    "RendererBase",
    "DepthRenderer",
    "DistanceRenderer",
    "Filter3DRenderer",
    "RenderablePoolBase",
    "SkyboxRenderable",
    "RTTBufferManager",
    "DefaultRenderer",
    "_super",
    "rendererPoolClass",
    "stage",
    "_skyboxProjection",
    "_width",
    "width",
    "window",
    "innerWidth",
    "_pRttBufferManager",
    "viewWidth",
    "_height",
    "height",
    "innerHeight",
    "viewHeight",
    "Object",
    "defineProperty",
    "get",
    "_antiAlias",
    "set",
    "value",
    "_pBackBufferInvalid",
    "enumerable",
    "configurable",
    "_depthPrepass",
    "_pFilter3DRenderer",
    "filters",
    "dispose",
    "_pStage",
    "_pRequireDepthRender",
    "requireDepthRender",
    "_pDepthRender",
    "render",
    "entityCollector",
    "recoverFromDisposal",
    "pUpdateBackBuffer",
    "_shareContext",
    "_pContext",
    "clear",
    "DEPTH",
    "textureRatioX",
    "textureRatioY",
    "pRenderSceneDepthToTexture",
    "pRenderDepthPrepass",
    "_iRender",
    "_pScissorRect",
    "present",
    "bufferClear",
    "pExecuteRender",
    "target",
    "scissorRect",
    "surfaceSelector",
    "updateLights",
    "dirLights",
    "directionalLights",
    "pointLights",
    "len",
    "light",
    "shadowMapper",
    "castsShadows",
    "autoUpdateShadows",
    "_iShadowsInvalid",
    "iRenderDepthMap",
    "_pDepthRenderer",
    "_pDistanceRenderer",
    "pDraw",
    "skyBox",
    "setDepthTest",
    "ALWAYS",
    "drawSkybox",
    "_pGetRenderObject",
    "renderable",
    "renderObjectOwner",
    "getRenderObject",
    "_pool",
    "_skyboxRenderablePool",
    "getItem",
    "camera",
    "updateSkyboxProjection",
    "renderObject",
    "pass",
    "passes",
    "activatePass",
    "deactivatePass",
    "near",
    "copyFrom",
    "_pRttViewProjectionMatrix",
    "copyRowTo",
    "camPos",
    "scenePosition",
    "cx",
    "x",
    "cy",
    "y",
    "cz",
    "z",
    "cw",
    "Math",
    "sqrt",
    "signX",
    "signY",
    "inverse",
    "clone",
    "invert",
    "q",
    "transformVector",
    "w",
    "copyRowFrom",
    "disableColor",
    "_pDepthTextureInvalid",
    "initDepthTexture",
    "context",
    "configureBackBuffer",
    "iSetStage",
    "getInstance",
    "_pRendererPoolClass",
    "getPool",
    "textureWidth",
    "textureHeight",
    "awayjs-core/lib/data/BitmapImage2D",
    "undefined",
    "awayjs-core/lib/geom/Matrix3D",
    "awayjs-core/lib/geom/Vector3D",
    "awayjs-renderergl/lib/DepthRenderer",
    "awayjs-renderergl/lib/DistanceRenderer",
    "awayjs-renderergl/lib/Filter3DRenderer",
    "awayjs-renderergl/lib/RendererBase",
    "awayjs-renderergl/lib/managers/RTTBufferManager",
    "awayjs-renderergl/lib/pool/RenderablePoolBase",
    "awayjs-renderergl/lib/pool/SkyboxRenderable",
    "awayjs-stagegl/lib/base/ContextGLClearMask",
    "awayjs-stagegl/lib/base/ContextGLCompareMode",
    "_iBackgroundR",
    "_iBackgroundG",
    "_iBackgroundB",
    "getDepthRenderObject",
    "getDistanceRenderObject",
    "Event",
    "ContextGLBlendFactor",
    "ContextGLVertexBufferFormat",
    "_this",
    "_filterSizesInvalid",
    "_onRTTResizeDelegate",
    "event",
    "onRTTResize",
    "_stage",
    "_rttManager",
    "addEventListener",
    "RESIZE",
    "_requireDepthRender",
    "getMainInputTexture",
    "_filterTasksInvalid",
    "updateFilterTasks",
    "_mainInputTexture",
    "_filters",
    "updateFilterSizes",
    "_tasks",
    "Array",
    "filter",
    "setRenderTargets",
    "concat",
    "tasks",
    "depthTexture",
    "task",
    "indexBuffer",
    "vertexBuffer",
    "renderToTextureVertexBuffer",
    "update",
    "setVertexBufferAt",
    "FLOAT_2",
    "renderToScreenVertexBuffer",
    "setTextureAt",
    "setProgram",
    "getProgram",
    "activate",
    "setBlendFactors",
    "ONE",
    "ZERO",
    "drawTriangles",
    "deactivate",
    "removeEventListener",
    "awayjs-core/lib/events/Event",
    "awayjs-stagegl/lib/base/ContextGLBlendFactor",
    "awayjs-stagegl/lib/base/ContextGLVertexBufferFormat",
    "Point",
    "Rectangle",
    "AbstractMethodError",
    "EventDispatcher",
    "RenderableMergeSort",
    "RendererEvent",
    "EntityCollector",
    "DefaultMaterialManager",
    "AGALMiniAssembler",
    "StageEvent",
    "StageManager",
    "RendererPoolBase",
    "_numUsedStreams",
    "_numUsedTextures",
    "_viewPort",
    "_backgroundR",
    "_backgroundG",
    "_backgroundB",
    "_backgroundAlpha",
    "_localPos",
    "_globalPos",
    "_pNumTriangles",
    "_disableColor",
    "_renderBlended",
    "_onViewportUpdatedDelegate",
    "onViewportUpdated",
    "_onContextUpdateDelegate",
    "onContextUpdate",
    "renderableSorter",
    "_rendererPool",
    "getFreeStage",
    "updateGlobalPos",
    "notifyScissorUpdate",
    "shader",
    "numUsedStreams",
    "numUsedTextures",
    "programData",
    "program",
    "createProgram",
    "vertexByteCode",
    "assemble",
    "vertexString",
    "data",
    "fragmentByteCode",
    "fragmentString",
    "upload",
    "_iActivate",
    "_iDeactivate",
    "_iCreateEntityCollector",
    "CONTEXT_CREATED",
    "CONTEXT_RECREATED",
    "VIEWPORT_UPDATED",
    "_viewportDirty",
    "_scissorDirty",
    "viewProjection",
    "appendScale",
    "_iRenderCascades",
    "numCascades",
    "scissorRects",
    "cameras",
    "pCollectRenderables",
    "setRenderTarget",
    "LESS",
    "head",
    "_pOpaqueRenderableHead",
    "first",
    "LESS_EQUAL",
    "_pBlendedRenderableHead",
    "item",
    "entityHead",
    "_pCamera",
    "_iEntryPoint",
    "_pCameraForward",
    "transform",
    "forwardVector",
    "entity",
    "_iCollectRenderables",
    "next",
    "sortOpaqueRenderables",
    "sortBlendedRenderables",
    "_snapshotRequired",
    "_snapshotBitmapImage2D",
    "drawToBitmapImage2D",
    "queueSnapshot",
    "bmd",
    "setColorMask",
    "drawRenderables",
    "renderable2",
    "_renderObjectOwner",
    "alphaThreshold",
    "_scissorUpdated",
    "SCISSOR_UPDATED",
    "dispatchEvent",
    "notifyViewportUpdate",
    "_viewPortUpdated",
    "viewPort",
    "applyRenderable",
    "getDefaultMaterial",
    "renderableOwner",
    "renderObjectId",
    "renderOrderId",
    "cascaded",
    "sourceEntity",
    "position",
    "subtract",
    "zIndex",
    "zOffset",
    "dotProduct",
    "renderSceneTransform",
    "getRenderSceneTransform",
    "requiresBlending",
    "numTriangles",
    "overflow",
    "awayjs-core/lib/errors/AbstractMethodError",
    "awayjs-core/lib/events/EventDispatcher",
    "awayjs-core/lib/geom/Point",
    "awayjs-core/lib/geom/Rectangle",
    "awayjs-display/lib/events/RendererEvent",
    "awayjs-display/lib/managers/DefaultMaterialManager",
    "awayjs-display/lib/sort/RenderableMergeSort",
    "awayjs-display/lib/traverse/EntityCollector",
    "awayjs-renderergl/lib/pool/RendererPoolBase",
    "awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler",
    "awayjs-stagegl/lib/events/StageEvent",
    "awayjs-stagegl/lib/managers/StageManager",
    "awayjs-renderergl/lib/animators/AnimationSetBase",
    "AssetBase",
    "AnimationSetError",
    "AnimationSetBase",
    "_animations",
    "_animationNames",
    "_animationDictionary",
    "_pFindTempReg",
    "exclude",
    "excludeAnother",
    "reg",
    "indexOf",
    "_usesCPU",
    "resetGPUCompatibility",
    "cancelGPUCompatibility",
    "getAGALVertexCode",
    "shaderObject",
    "getAGALFragmentCode",
    "shadedTarget",
    "getAGALUVCode",
    "doneAGALCode",
    "assetType",
    "hasAnimation",
    "name",
    "getAnimation",
    "addAnimation",
    "node",
    "push",
    "awayjs-core/lib/library/AssetBase",
    "awayjs-renderergl/lib/errors/AnimationSetError",
    "awayjs-renderergl/lib/animators/AnimatorBase",
    "RequestAnimationFrame",
    "getTimer",
    "AnimatorEvent",
    "AnimatorBase",
    "animationSet",
    "_autoUpdate",
    "_time",
    "_playbackSpeed",
    "_pOwners",
    "_pAbsoluteTime",
    "_animationStates",
    "updatePosition",
    "_pAnimationSet",
    "_broadcaster",
    "onEnterFrame",
    "getAnimationState",
    "className",
    "stateClass",
    "uID",
    "id",
    "getAnimationStateByName",
    "_pActiveState",
    "_pActiveAnimationName",
    "start",
    "stop",
    "phase",
    "setRenderState",
    "vertexConstantOffset",
    "vertexStreamOffset",
    "_isPlaying",
    "hasEventListener",
    "START",
    "_startEvent",
    "STOP",
    "_stopEvent",
    "time",
    "dt",
    "playbackSpeed",
    "_pUpdateDeltaTime",
    "reset",
    "offset",
    "addOwner",
    "mesh",
    "removeOwner",
    "splice",
    "applyPositionDelta",
    "delta",
    "positionDelta",
    "dist",
    "translateLocal",
    "dispatchCycleEvent",
    "CYCLE_COMPLETE",
    "_cycleEvent",
    "testGPUCompatibility",
    "getRenderableSubGeometry",
    "sourceSubGeometry",
    "awayjs-core/lib/utils/RequestAnimationFrame",
    "awayjs-core/lib/utils/getTimer",
    "awayjs-renderergl/lib/events/AnimatorEvent",
    "awayjs-renderergl/lib/animators/ParticleAnimationSet",
    "AnimationRegisterCache",
    "AnimationSubGeometry",
    "ParticleAnimationData",
    "ParticleProperties",
    "ParticlePropertiesMode",
    "ParticleTimeNode",
    "ParticleAnimationSet",
    "usesDuration",
    "usesLooping",
    "usesDelay",
    "_animationSubGeometries",
    "_particleNodes",
    "_localDynamicNodes",
    "_localStaticNodes",
    "_totalLenOfOneVertex",
    "_timeNode",
    "_iProcessAnimationSetting",
    "mode",
    "LOCAL_STATIC",
    "_iDataOffset",
    "dataLength",
    "LOCAL_DYNAMIC",
    "priority",
    "_iAnimationRegisterCache",
    "animationRegisterCache",
    "profile",
    "numUsedVertexConstants",
    "vertexAttributesOffset",
    "varyingsOffset",
    "numUsedVaryings",
    "fragmentConstantOffset",
    "numUsedFragmentConstants",
    "hasUVNode",
    "needVelocity",
    "hasBillboard",
    "sourceRegisters",
    "animatableAttributes",
    "targetRegisters",
    "animationTargetRegisters",
    "needFragmentAnimation",
    "usesFragmentAnimation",
    "needUVAnimation",
    "usesUVTransform",
    "hasColorAddNode",
    "hasColorMulNode",
    "getInitCode",
    "POST_PRIORITY",
    "getCombinationCode",
    "COLOR_PRIORITY",
    "initColorRegisters",
    "getColorPassCode",
    "setUVSourceAndTarget",
    "uvSource",
    "uvTarget",
    "uvAttribute",
    "toString",
    "uvVar",
    "getColorCombinationCode",
    "setDataLength",
    "setVertexConst",
    "vertexZeroConst",
    "index",
    "key",
    "getAnimationSubGeometry",
    "subMesh",
    "parentMesh",
    "animationSubGeometry",
    "subGeometry",
    "_iGenerateAnimationSubGeometries",
    "initParticleFunc",
    "geometry",
    "j",
    "k",
    "newAnimationSubGeometry",
    "localNode",
    "subMeshes",
    "shareAnimationGeometry",
    "createVertexData",
    "numVertices",
    "particles",
    "particlesLength",
    "numParticles",
    "particleProperties",
    "particle",
    "oneDataLen",
    "oneDataOffset",
    "counterForVertex",
    "counterForOneData",
    "oneData",
    "vertexData",
    "vertexLength",
    "startingOffset",
    "vertexOffset",
    "total",
    "startTime",
    "duration",
    "delay",
    "initParticleScope",
    "_iGeneratePropertyOfOneParticle",
    "particleIndex",
    "numProcessedVertices",
    "animationParticles",
    "awayjs-renderergl/lib/animators/data/AnimationRegisterCache",
    "awayjs-renderergl/lib/animators/data/AnimationSubGeometry",
    "awayjs-renderergl/lib/animators/data/ParticleAnimationData",
    "awayjs-renderergl/lib/animators/data/ParticleProperties",
    "awayjs-renderergl/lib/animators/data/ParticlePropertiesMode",
    "awayjs-renderergl/lib/animators/nodes/ParticleTimeNode",
    "awayjs-renderergl/lib/animators/ParticleAnimator",
    "ContextGLProgramType",
    "ParticleAnimator",
    "particleAnimationSet",
    "_animationParticleStates",
    "_animatorParticleStates",
    "_timeParticleStates",
    "_animatorSubGeometries",
    "_particleAnimationSet",
    "state",
    "particleNodes",
    "needUpdateTime",
    "animatorSubGeometry",
    "getAnimatorSubGeometry",
    "setProgramConstantsFromArray",
    "VERTEX",
    "vertexConstantData",
    "numVertexConstant",
    "numFragmentConstant",
    "FRAGMENT",
    "fragmentConstantData",
    "resetTime",
    "awayjs-stagegl/lib/base/ContextGLProgramType",
    "awayjs-renderergl/lib/animators/SkeletonAnimationSet",
    "SkeletonAnimationSet",
    "jointsPerVertex",
    "_jointsPerVertex",
    "indexOffset0",
    "indexOffset1",
    "indexOffset2",
    "indexStream",
    "weightStream",
    "indices",
    "weights",
    "temp1",
    "temp2",
    "dot",
    "src",
    "awayjs-renderergl/lib/animators/SkeletonAnimator",
    "TriangleSubGeometry",
    "SubGeometryEvent",
    "JointPose",
    "SkeletonPose",
    "AnimationStateEvent",
    "SkeletonAnimator",
    "skeleton",
    "forceCPU",
    "_globalPose",
    "_morphedSubGeometry",
    "_morphedSubGeometryDirty",
    "_skeleton",
    "_forceCPU",
    "_numJoints",
    "numJoints",
    "_globalMatrices",
    "_onTransitionCompleteDelegate",
    "onTransitionComplete",
    "_onIndicesUpdateDelegate",
    "onIndicesUpdate",
    "_onVerticesUpdateDelegate",
    "onVerticesUpdate",
    "_globalPropertiesDirty",
    "updateGlobalProperties",
    "_useCondensedIndices",
    "play",
    "transition",
    "NaN",
    "_pActiveNode",
    "getAnimationNode",
    "TRANSITION_COMPLETE",
    "_activeSkeletonState",
    "isNaN",
    "useCondensedIndices",
    "updateCondensedMatrices",
    "condensedIndexLookUp",
    "numCondensedJoints",
    "_condensedMatrices",
    "usesCPU",
    "morphSubGeometry",
    "activateBuffer",
    "getVertexData",
    "JOINT_INDEX_DATA",
    "getVertexOffset",
    "JOINT_INDEX_FORMAT",
    "JOINT_WEIGHT_DATA",
    "JOINT_WEIGHT_FORMAT",
    "srcIndex",
    "localToGlobalPose",
    "getSkeletonPose",
    "mtxOffset",
    "globalPoses",
    "jointPoses",
    "raw",
    "ox",
    "oy",
    "oz",
    "ow",
    "xy2",
    "xz2",
    "xw2",
    "yz2",
    "yw2",
    "zw2",
    "n11",
    "n12",
    "n13",
    "n21",
    "n22",
    "n23",
    "n31",
    "n32",
    "n33",
    "m11",
    "m12",
    "m13",
    "m14",
    "m21",
    "m22",
    "m23",
    "m24",
    "m31",
    "m32",
    "m33",
    "m34",
    "joints",
    "pose",
    "quat",
    "vec",
    "orientation",
    "translation",
    "inverseBindPose",
    "targetSubGeometry",
    "autoDeriveNormals",
    "autoDeriveTangents",
    "autoDeriveUVs",
    "INDICES_UPDATED",
    "VERTICES_UPDATED",
    "sourcePositions",
    "positions",
    "sourceNormals",
    "vertexNormals",
    "sourceTangents",
    "vertexTangents",
    "jointIndices",
    "jointWeights",
    "targetPositions",
    "targetNormals",
    "targetTangents",
    "vx",
    "vy",
    "vz",
    "nx",
    "ny",
    "nz",
    "tx",
    "ty",
    "tz",
    "weight",
    "vertX",
    "vertY",
    "vertZ",
    "normX",
    "normY",
    "normZ",
    "tangX",
    "tangY",
    "tangZ",
    "updatePositions",
    "updateVertexNormals",
    "updateVertexTangents",
    "sourcePose",
    "targetPose",
    "globalJointPose",
    "numJointPoses",
    "parentIndex",
    "joint",
    "parentPose",
    "or",
    "tr",
    "x1",
    "y1",
    "z1",
    "w1",
    "x2",
    "y2",
    "z2",
    "w2",
    "x3",
    "y3",
    "z3",
    "type",
    "animationNode",
    "animationState",
    "updateIndices",
    "morphGeometry",
    "dataType",
    "UV_DATA",
    "updateUVs",
    "uvs",
    "SECONDARY_UV_DATA",
    "secondaryUVs",
    "awayjs-core/lib/data/TriangleSubGeometry",
    "awayjs-core/lib/events/SubGeometryEvent",
    "awayjs-renderergl/lib/animators/data/JointPose",
    "awayjs-renderergl/lib/animators/data/SkeletonPose",
    "awayjs-renderergl/lib/events/AnimationStateEvent",
    "awayjs-renderergl/lib/animators/VertexAnimationSet",
    "VertexAnimationMode",
    "VertexAnimationSet",
    "numPoses",
    "blendMode",
    "_numPoses",
    "_blendMode",
    "ABSOLUTE",
    "getAbsoluteAGALCode",
    "getAdditiveAGALCode",
    "regs",
    "constantReg",
    "streamIndex",
    "tangentDependencies",
    "outputsNormals",
    "normalDependencies",
    "awayjs-renderergl/lib/animators/data/VertexAnimationMode",
    "awayjs-renderergl/lib/animators/VertexAnimator",
    "VertexDataPool",
    "VertexAnimator",
    "vertexAnimationSet",
    "_poses",
    "_weights",
    "_vertexAnimationSet",
    "_activeVertexState",
    "geometryFlag",
    "currentGeometry",
    "nextGeometry",
    "blendWeight",
    "_iInvalidateRenderableGeometries",
    "setNullPose",
    "subGeom",
    "subGeometries",
    "_iIndex",
    "getIndexData",
    "POSITION_DATA",
    "getOffset",
    "POSITION_FORMAT",
    "NORMAL_DATA",
    "NORMAL_FORMAT",
    "awayjs-stagegl/lib/pool/VertexDataPool",
    "ShaderRegisterCache",
    "ShaderRegisterElement",
    "indexDictionary",
    "rotationRegisters",
    "positionAttribute",
    "getRegisterFromString",
    "scaleAndRotateTarget",
    "addVertexTempUsages",
    "regName",
    "getFreeVertexConstant",
    "vertexOneConst",
    "vertexTwoConst",
    "positionTarget",
    "getFreeVertexVectorTemp",
    "velocityTarget",
    "vertexTime",
    "vertexLife",
    "tempTime",
    "UVAttribute",
    "UVVaring",
    "setRegisterIndex",
    "parameterIndex",
    "registerIndex",
    "getRegisterIndex",
    "colorMulTarget",
    "colorMulVary",
    "getFreeVarying",
    "colorAddTarget",
    "colorAddVary",
    "colorTarget",
    "addFragmentTempUsages",
    "temp",
    "split",
    "parseInt",
    "_numVertexConstant",
    "_numFragmentConstant",
    "_index",
    "setVertexConstFromArray",
    "setVertexConstFromMatrix",
    "matrix",
    "rawData",
    "setFragmentConst",
    "awayjs-renderergl/lib/compilation/ShaderRegisterCache",
    "awayjs-renderergl/lib/compilation/ShaderRegisterElement",
    "_pVertexBuffer",
    "_pBufferContext",
    "_pBufferDirty",
    "previousTime",
    "Number",
    "NEGATIVE_INFINITY",
    "_iUniqueId",
    "SUBGEOM_ID_COUNT",
    "totalLenOfOneVertex",
    "_numVertices",
    "_pVertexData",
    "activateVertexBuffer",
    "bufferOffset",
    "format",
    "contextIndex",
    "stageIndex",
    "buffer",
    "createVertexBuffer",
    "uploadFromArray",
    "pop",
    "invalidateBuffer",
    "awayjs-renderergl/lib/animators/data/ColorSegmentPoint",
    "ColorSegmentPoint",
    "life",
    "color",
    "_life",
    "_color",
    "Quaternion",
    "toMatrix3D",
    "appendTranslation",
    "awayjs-core/lib/geom/Quaternion",
    "totalTime",
    "startVertexIndex",
    "awayjs-renderergl/lib/animators/data/ParticleData",
    "ParticleData",
    "GLOBAL",
    "awayjs-renderergl/lib/animators/data/SkeletonJoint",
    "SkeletonJoint",
    "jointPoseFromName",
    "jointName",
    "jointPoseIndex",
    "jointPoseIndexFromName",
    "jointPose",
    "cloneJointPose",
    "thisJointPose",
    "awayjs-renderergl/lib/animators/data/Skeleton",
    "Skeleton",
    "jointFromName",
    "jointIndex",
    "jointIndexFromName",
    "ADDITIVE",
    "awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase",
    "AnimationNodeBase",
    "AnimationClipNodeBase",
    "_pLooping",
    "_pTotalDuration",
    "_pStitchDirty",
    "_pStitchFinalFrame",
    "_pNumFrames",
    "_pDurations",
    "_pTotalDelta",
    "fixedFrameRate",
    "_pUpdateStitch",
    "_pLastFrame",
    "awayjs-display/lib/animators/nodes/AnimationNodeBase",
    "awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode",
    "ParticleNodeBase",
    "ParticleAccelerationState",
    "ParticleAccelerationNode",
    "acceleration",
    "_pStateClass",
    "_acceleration",
    "pGetAGALVertexCode",
    "accelerationValue",
    "_pMode",
    "getFreeVertexAttribute",
    "ACCELERATION_INDEX",
    "removeVertexTempUsage",
    "animator",
    "param",
    "tempAcceleration",
    "ACCELERATION_VECTOR3D",
    "_pOneData",
    "awayjs-renderergl/lib/animators/nodes/ParticleNodeBase",
    "awayjs-renderergl/lib/animators/states/ParticleAccelerationState",
    "awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode",
    "ParticleBezierCurveState",
    "ParticleBezierCurveNode",
    "controlPoint",
    "endPoint",
    "_iControlPoint",
    "_iEndPoint",
    "controlValue",
    "BEZIER_CONTROL_INDEX",
    "endValue",
    "BEZIER_END_INDEX",
    "rev_time",
    "time_2",
    "time_temp",
    "distance",
    "bezierControl",
    "BEZIER_CONTROL_VECTOR3D",
    "bezierEnd",
    "BEZIER_END_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleBezierCurveState",
    "awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode",
    "ParticleBillboardState",
    "ParticleBillboardNode",
    "billboardAxis",
    "_iBillboardAxis",
    "rotationMatrixRegister",
    "MATRIX_INDEX",
    "shaderRegisterElement",
    "awayjs-renderergl/lib/animators/states/ParticleBillboardState",
    "awayjs-renderergl/lib/animators/nodes/ParticleColorNode",
    "ColorTransform",
    "ParticleColorState",
    "ParticleColorNode",
    "usesMultiplier",
    "usesOffset",
    "usesCycle",
    "usesPhase",
    "startColor",
    "endColor",
    "cycleDuration",
    "cyclePhase",
    "_iUsesMultiplier",
    "_iUsesOffset",
    "_iUsesCycle",
    "_iUsesPhase",
    "_iStartColor",
    "_iEndColor",
    "_iCycleDuration",
    "_iCyclePhase",
    "cycleConst",
    "CYCLE_INDEX",
    "sin",
    "getFreeVertexSingleTemp",
    "startMultiplierValue",
    "deltaMultiplierValue",
    "START_MULTIPLIER_INDEX",
    "DELTA_MULTIPLIER_INDEX",
    "startOffsetValue",
    "deltaOffsetValue",
    "START_OFFSET_INDEX",
    "DELTA_OFFSET_INDEX",
    "COLOR_START_COLORTRANSFORM",
    "COLOR_END_COLORTRANSFORM",
    "redMultiplier",
    "greenMultiplier",
    "blueMultiplier",
    "alphaMultiplier",
    "redOffset",
    "greenOffset",
    "blueOffset",
    "alphaOffset",
    "awayjs-core/lib/geom/ColorTransform",
    "awayjs-renderergl/lib/animators/states/ParticleColorState",
    "awayjs-renderergl/lib/animators/nodes/ParticleFollowNode",
    "ParticleFollowState",
    "ParticleFollowNode",
    "usesPosition",
    "usesRotation",
    "smooth",
    "_iUsesPosition",
    "_iUsesRotation",
    "_iSmooth",
    "rotationAttribute",
    "FOLLOW_ROTATION_INDEX",
    "temp3",
    "temp4",
    "FOLLOW_POSITION_INDEX",
    "awayjs-renderergl/lib/animators/states/ParticleFollowState",
    "awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode",
    "ParticleInitialColorState",
    "ParticleInitialColorNode",
    "initialColor",
    "_iInitialColor",
    "multiplierValue",
    "MULTIPLIER_INDEX",
    "offsetValue",
    "OFFSET_INDEX",
    "COLOR_INITIAL_COLORTRANSFORM",
    "awayjs-renderergl/lib/animators/states/ParticleInitialColorState",
    "_pDataLength",
    "MODES",
    "_priority",
    1,
    2,
    "awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode",
    "ParticleOrbitState",
    "ParticleOrbitNode",
    "usesEulers",
    "radius",
    "eulers",
    "_iUsesEulers",
    "_iRadius",
    "_iEulers",
    "orbitRegister",
    "ORBIT_INDEX",
    "eulersMatrixRegister",
    "EULERS_INDEX",
    "cos",
    "degree",
    "orbit",
    "ORBIT_VECTOR3D",
    "PI",
    "awayjs-renderergl/lib/animators/states/ParticleOrbitState",
    "awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode",
    "ParticleOscillatorState",
    "ParticleOscillatorNode",
    "oscillator",
    "_iOscillator",
    "oscillatorRegister",
    "OSCILLATOR_INDEX",
    "dgree",
    "drift",
    "OSCILLATOR_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleOscillatorState",
    "awayjs-renderergl/lib/animators/nodes/ParticlePositionNode",
    "ParticlePositionState",
    "ParticlePositionNode",
    "_iPosition",
    "POSITION_INDEX",
    "POSITION_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticlePositionState",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode",
    "ParticleRotateToHeadingState",
    "ParticleRotateToHeadingNode",
    "nrmVel",
    "xAxis",
    "R",
    "R_rev",
    "cos2",
    "tempSingle",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode",
    "ParticleRotateToPositionState",
    "ParticleRotateToPositionNode",
    "nrmDirection",
    "o_temp",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode",
    "ParticleRotationalVelocityState",
    "ParticleRotationalVelocityNode",
    "rotationalVelocity",
    "_iRotationalVelocity",
    "rotationRegister",
    "ROTATIONALVELOCITY_INDEX",
    "Rtemp",
    "rotate",
    "ROTATIONALVELOCITY_VECTOR3D",
    "normalize",
    "awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState",
    "awayjs-renderergl/lib/animators/nodes/ParticleScaleNode",
    "ParticleScaleState",
    "ParticleScaleNode",
    "minScale",
    "maxScale",
    "_iMinScale",
    "_iMaxScale",
    "scaleRegister",
    "SCALE_INDEX",
    "scale",
    "SCALE_VECTOR3D",
    "abs",
    "awayjs-renderergl/lib/animators/states/ParticleScaleState",
    "awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode",
    "ParticleSegmentedColorState",
    "ParticleSegmentedColorNode",
    "numSegmentPoint",
    "segmentPoints",
    "_iNumSegmentPoint",
    "_iSegmentPoints",
    "accMultiplierColor",
    "tempColor",
    "accTime",
    "lifeTimeRegister",
    "TIME_DATA_INDEX",
    "startMulValue",
    "deltaMulValues",
    "deltaOffsetValues",
    "awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState",
    "awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode",
    "ParticleSpriteSheetState",
    "ParticleSpriteSheetNode",
    "numColumns",
    "numRows",
    "totalFrames",
    "MAX_VALUE",
    "_iNumColumns",
    "_iNumRows",
    "_iTotalFrames",
    "min",
    "uvParamConst1",
    "uvParamConst2",
    "UV_INDEX_0",
    "UV_INDEX_1",
    "uTotal",
    "uStep",
    "vStep",
    "uSpeed",
    "cycle",
    "phaseTime",
    "vOffset",
    "v",
    "uvCycle",
    "UV_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState",
    "ParticleTimeState",
    "_iUsesDuration",
    "_iUsesLooping",
    "_iUsesDelay",
    "timeStreamRegister",
    "TIME_STREAM_INDEX",
    "timeConst",
    "TIME_CONSTANT_INDEX",
    "div",
    "sge",
    "awayjs-renderergl/lib/animators/states/ParticleTimeState",
    "awayjs-renderergl/lib/animators/nodes/ParticleUVNode",
    "ParticleUVState",
    "ParticleUVNode",
    "axis",
    "_cycle",
    "_scale",
    "_axis",
    "updateUVData",
    "uvConst",
    "UV_INDEX",
    "axisIndex",
    "_iUvData",
    "U_AXIS",
    "V_AXIS",
    "awayjs-renderergl/lib/animators/states/ParticleUVState",
    "awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode",
    "ParticleVelocityState",
    "ParticleVelocityNode",
    "velocity",
    "_iVelocity",
    "velocityValue",
    "VELOCITY_INDEX",
    "_tempVelocity",
    "VELOCITY_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleVelocityState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode",
    "SkeletonBinaryLERPState",
    "SkeletonBinaryLERPNode",
    "awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonClipNode",
    "SkeletonClipState",
    "SkeletonClipNode",
    "_frames",
    "highQuality",
    "addFrame",
    "skeletonPose",
    "p1",
    "p2",
    "awayjs-renderergl/lib/animators/states/SkeletonClipState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode",
    "SkeletonDifferenceState",
    "SkeletonDifferenceNode",
    "awayjs-renderergl/lib/animators/states/SkeletonDifferenceState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode",
    "SkeletonDirectionalState",
    "SkeletonDirectionalNode",
    "awayjs-renderergl/lib/animators/states/SkeletonDirectionalState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode",
    "SkeletonNaryLERPState",
    "SkeletonNaryLERPNode",
    "_iInputs",
    "_numInputs",
    "getInputIndex",
    "input",
    "getInputAt",
    "addInput",
    "awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState",
    "awayjs-renderergl/lib/animators/nodes/VertexClipNode",
    "VertexClipState",
    "VertexClipNode",
    "_translations",
    "awayjs-renderergl/lib/animators/states/VertexClipState",
    "awayjs-renderergl/lib/animators/states/AnimationClipState",
    "AnimationStateBase",
    "AnimationClipState",
    "animationClipNode",
    "_pFramesDirty",
    "_animationClipNode",
    "_pUpdateFrames",
    "_pBlendWeight",
    "_pCurrentFrame",
    "_pNextFrame",
    "looping",
    "_pStartTime",
    "totalDuration",
    "_pTime",
    "_pUpdateTime",
    "_pTimeDir",
    "lastFrame",
    "notifyPlaybackComplete",
    "floor",
    "dur",
    "frameTime",
    "durations",
    "_animationStatePlaybackComplete",
    "PLAYBACK_COMPLETE",
    "_pAnimator",
    "awayjs-renderergl/lib/animators/states/AnimationStateBase",
    "_pRootDelta",
    "_pPositionDeltaDirty",
    "_pAnimationNode",
    "_pUpdatePositionDelta",
    "awayjs-renderergl/lib/animators/states/IAnimationState",
    "awayjs-renderergl/lib/animators/states/ISkeletonAnimationState",
    "awayjs-renderergl/lib/animators/states/IVertexAnimationState",
    "ParticleStateBase",
    "particleAccelerationNode",
    "_particleAccelerationNode",
    "updateAccelerationData",
    "FLOAT_3",
    "_halfAcceleration",
    "awayjs-renderergl/lib/animators/states/ParticleStateBase",
    "particleBezierCurveNode",
    "_particleBezierCurveNode",
    "_controlPoint",
    "_endPoint",
    "controlIndex",
    "endIndex",
    "MathConsts",
    "Orientation3D",
    "particleNode",
    "_matrix",
    "_billboardAxis",
    "comps",
    "pos",
    "sceneTransform",
    "look",
    "right",
    "crossProduct",
    "decompose",
    "AXIS_ANGLE",
    "copyColumnFrom",
    "appendRotation",
    "RADIANS_TO_DEGREES",
    "append",
    "inverseSceneTransform",
    "identity",
    "awayjs-core/lib/geom/MathConsts",
    "awayjs-core/lib/geom/Orientation3D",
    "particleColorNode",
    "_particleColorNode",
    "_usesMultiplier",
    "_usesOffset",
    "_usesCycle",
    "_usesPhase",
    "_startColor",
    "_endColor",
    "_cycleDuration",
    "_cyclePhase",
    "updateColorData",
    "dataOffset",
    "_cycleData",
    "FLOAT_4",
    "_startMultiplierData",
    "_deltaMultiplierData",
    "_startOffsetData",
    "_deltaOffsetData",
    "particleFollowNode",
    "_targetPos",
    "_targetEuler",
    "_temp",
    "_particleFollowNode",
    "_smooth",
    "_followTarget",
    "scaleX",
    "scaleY",
    "scaleZ",
    "rotationX",
    "rotationY",
    "rotationZ",
    "scaleBy",
    "DEGREES_TO_RADIANS",
    "_prePos",
    "_preEuler",
    "currentTime",
    "deltaTime",
    "needProcess",
    "processPositionAndRotation",
    "processPosition",
    "precessRotation",
    "changed",
    "interpolatedPos",
    "posVelocity",
    "inc",
    "add",
    "interpolatedRotation",
    "rotationVelocity",
    "particleInitialColorNode",
    "_particleInitialColorNode",
    "_initialColor",
    "_multiplierData",
    "_offsetData",
    "particleOrbitNode",
    "_particleOrbitNode",
    "_usesEulers",
    "_eulers",
    "_radius",
    "updateOrbitData",
    "_orbitData",
    "_eulersMatrix",
    "X_AXIS",
    "Y_AXIS",
    "Z_AXIS",
    "particleOscillatorNode",
    "_particleOscillatorNode",
    "_oscillator",
    "updateOscillatorData",
    "_oscillatorData",
    "particlePositionNode",
    "_particlePositionNode",
    "_position",
    "getPositions",
    "_pDynamicProperties",
    "setPositions",
    "_pDynamicPropertiesDirty",
    "_pUpdateDynamicProperties",
    "particleRotateToPositionNode",
    "_particleRotateToPositionNode",
    "_offset",
    "particleRotationNode",
    "_particleRotationalVelocityNode",
    "_rotationalVelocity",
    "updateRotationalVelocityData",
    "getRotationalVelocities",
    "setRotationalVelocities",
    "_rotationalVelocityData",
    "rotation",
    "particleScaleNode",
    "_particleScaleNode",
    "_minScale",
    "_maxScale",
    "updateScaleData",
    "_scaleData",
    "particleSegmentedColorNode",
    "_segmentPoints",
    "_numSegmentPoint",
    "_timeLifeData",
    "particleSpriteSheetNode",
    "_particleSpriteSheetNode",
    "_totalFrames",
    "_numColumns",
    "_numRows",
    "updateSpriteSheetData",
    "_spriteSheetData",
    "_particleNode",
    "_pNeedUpdateTime",
    "animationParticle",
    "particleTimeNode",
    "_particleTimeNode",
    "particleTime",
    "particleUVNode",
    "_particleUVNode",
    "particleVelocityNode",
    "_particleVelocityNode",
    "_velocity",
    "getVelocities",
    "setVelocities",
    "skeletonAnimationNode",
    "_blendWeight",
    "_skeletonPose",
    "_skeletonPoseDirty",
    "_skeletonAnimationNode",
    "_inputA",
    "inputA",
    "_inputB",
    "inputB",
    "updateSkeletonPose",
    "deltA",
    "deltB",
    "endPose",
    "endPoses",
    "poses1",
    "poses2",
    "pose1",
    "pose2",
    "lerp",
    "skeletonClipNode",
    "_rootPos",
    "_skeletonClipNode",
    "frames",
    "_currentPose",
    "_nextPose",
    "currentPose",
    "nextPose",
    "slerp",
    "p3",
    "totalDelta",
    "_pOldFrame",
    "dx",
    "dy",
    "dz",
    "stitchFinalFrame",
    "_baseInput",
    "baseInput",
    "_differenceInput",
    "differenceInput",
    "basePoses",
    "diffPoses",
    "base",
    "diff",
    "basePos",
    "diffPos",
    "_tempQuat",
    "multiply",
    "_direction",
    "_blendDirty",
    "_forward",
    "forward",
    "_backward",
    "backward",
    "_left",
    "left",
    "_right",
    "updateBlend",
    "_pUdateTime",
    "_blendWeights",
    "_inputs",
    "numInputs",
    "getBlendWeightAt",
    "setBlendWeightAt",
    "poses",
    "endTr",
    "endQuat",
    "firstPose",
    "w0",
    "x0",
    "y0",
    "z0",
    "vertexClipNode",
    "_vertexClipNode",
    "_currentGeometry",
    "_nextGeometry",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode",
    "CrossfadeTransitionState",
    "CrossfadeTransitionNode",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState",
    "_crossfadeTransitionNode",
    "startBlend",
    "blendSpeed",
    "_animationStateTransitionComplete",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransition",
    "CrossfadeTransition",
    "startNode",
    "endNode",
    "crossFadeTransitionNode",
    "awayjs-renderergl/lib/animators/transitions/IAnimationTransition",
    "awayjs-renderergl/lib/base/ParticleGeometry",
    "Geometry",
    "ParticleGeometry",
    "apply",
    "arguments",
    "awayjs-core/lib/data/Geometry",
    "awayjs-renderergl/lib/compilation/DepthRenderObject",
    "RenderObjectBase",
    "DepthPass",
    "DepthRenderObject",
    "pool",
    "renderableClass",
    "_pAddScreenPass",
    "awayjs-renderergl/lib/compilation/RenderObjectBase",
    "awayjs-renderergl/lib/passes/DepthPass",
    "awayjs-renderergl/lib/compilation/DistanceRenderObject",
    "DistancePass",
    "DistanceRenderObject",
    "awayjs-renderergl/lib/passes/DistancePass",
    "awayjs-renderergl/lib/compilation/IRenderObjectClass",
    "awayjs-renderergl/lib/compilation/RegisterPool",
    "RegisterPool",
    "regCount",
    "persistent",
    "_regName",
    "_regCount",
    "_persistent",
    "initRegisters",
    "requestFreeVectorReg",
    "isRegisterUsed",
    "_usedVectorCount",
    "_vectorRegisters",
    "requestFreeRegComponent",
    "_usedSingleCount",
    "_registerComponents",
    "addUsage",
    "register",
    "usageCount",
    "_component",
    "removeUsage",
    "hasRegisteredRegs",
    "hash",
    "_initPool",
    "_regPool",
    "_regCompsPool",
    "_initArray",
    "vectorRegisters",
    "registerComponents",
    "val",
    "c",
    "awayjs-renderergl/lib/compilation/RenderBasicMaterialObject",
    "BlendMode",
    "BasicMaterialPass",
    "RenderBasicMaterialObject",
    "material",
    "_material",
    "_screenPass",
    "_pUpdateRenderObject",
    "_pRequiresBlending",
    "NORMAL",
    "alphaBlending",
    "colorTransform",
    "preserveAlpha",
    "setBlendMode",
    "LAYER",
    "awayjs-core/lib/data/BlendMode",
    "awayjs-renderergl/lib/passes/BasicMaterialPass",
    "MaterialBase",
    "_forceSeparateMVP",
    "_invalidAnimation",
    "_invalidRenderObject",
    "_passes",
    "_renderableClass",
    "_onPassChangeDelegate",
    "onPassChange",
    "_updateAnimation",
    "_renderOrderId",
    "_iIncludeDependencies",
    "useMipmapping",
    "mipmap",
    "useSmoothTextures",
    "isAsset",
    "useAlphaPremultiplied",
    "alphaPremultiplied",
    "useBothSides",
    "bothSides",
    "repeatTextures",
    "repeat",
    "animateUVs",
    "texture",
    "getTextureObject",
    "_pClearScreenPasses",
    "disposeItem",
    "invalidateRenderObject",
    "invalidatePasses",
    "invalidatePass",
    "invalidateAnimation",
    "enabledGPUAnimation",
    "_getEnabledGPUAnimation",
    "mult",
    "usesAnimation",
    "invalidateProgram",
    "_pRemoveScreenPass",
    "CHANGE",
    "owners",
    "iOwners",
    "numOwners",
    "awayjs-display/lib/materials/MaterialBase",
    "awayjs-renderergl/lib/compilation/RenderObjectPool",
    "RenderObjectPool",
    "renderObjectClass",
    "_renderObjectPool",
    "_renderObjectClass",
    "_iAddRenderObject",
    "_iRemoveRenderObject",
    "awayjs-renderergl/lib/compilation/ShaderCompilerBase",
    "ShaderRegisterData",
    "ShaderCompilerBase",
    "renderPass",
    "_pVertexCode",
    "_pFragmentCode",
    "_pPostAnimationFragmentCode",
    "_pRenderableClass",
    "_pRenderPass",
    "_pShaderObject",
    "_pSharedRegisters",
    "_pRegisterCache",
    "compile",
    "pIncludeDependencies",
    "pInitRegisterIndices",
    "pCompileDependencies",
    "_iGetVertexCode",
    "_iGetFragmentCode",
    "fragmentOutputRegister",
    "removeFragmentTempUsage",
    "initConstantData",
    "_pAnimatableAttributes",
    "_pAnimationTargetRegisters",
    "_uvSource",
    "_uvTarget",
    "_iInitConstantData",
    "_pOutputsNormals",
    "outputsTangentNormals",
    "_pOutputsTangentNormals",
    "usesTangentSpace",
    "_pUsesTangentSpace",
    "viewDirDependencies",
    "globalPosDependencies",
    "getFreeFragmentVectorTemp",
    "compileGlobalPositionCode",
    "usesLocalPosFragment",
    "compileLocalPositionCode",
    "uvDependencies",
    "compileUVCode",
    "secondaryUVDependencies",
    "compileSecondaryUVCode",
    "compileNormalCode",
    "compileViewDirCode",
    "_iGetPreLightingVertexCode",
    "_iGetPreLightingFragmentCode",
    "globalPositionVertex",
    "sceneMatrixReg",
    "sceneMatrixIndex",
    "localPosition",
    "usesGlobalPosFragment",
    "globalPositionVarying",
    "localPositionVarying",
    "uvAttributeReg",
    "uvBufferIndex",
    "varying",
    "uvVarying",
    "uvTransform1",
    "uvTransform2",
    "uvTransformIndex",
    "secondaryUVBufferIndex",
    "secondaryUVVarying",
    "cameraPositionReg",
    "viewDirVarying",
    "viewDirFragment",
    "cameraPositionIndex",
    "animatedTangent",
    "normalFragment",
    "_iGetNormalVertexCode",
    "_iGetNormalFragmentCode",
    "normalMatrix",
    "sceneNormalMatrixIndex",
    "normalVarying",
    "animatedNormal",
    "bitangent",
    "tangentVarying",
    "bitangentVarying",
    "normalInput",
    "commons",
    "getFreeFragmentConstant",
    "commonsDataIndex",
    "tangentInput",
    "tangentBufferIndex",
    "normalBufferIndex",
    "colorDependencies",
    "colorInput",
    "colorBufferIndex",
    "colorVarying",
    "awayjs-renderergl/lib/compilation/ShaderRegisterData",
    "awayjs-renderergl/lib/compilation/ShaderLightingCompiler",
    "ShaderLightingCompiler",
    "renderLightingPass",
    "shaderLightingObject",
    "_shaderLightingObject",
    "_renderLightingPass",
    "usesShadows",
    "pCompileShadowCode",
    "usesLights",
    "initLightRegisters",
    "compileLightCode",
    "usesProbes",
    "compileLightProbeCode",
    "_iGetPostLightingVertexCode",
    "_iGetPostLightingFragmentCode",
    "shadowTarget",
    "_dirLightVertexConstants",
    "lightVertexConstantIndex",
    "_pointLightVertexConstants",
    "_dirLightFragmentConstants",
    "lightFragmentConstantIndex",
    "_pointLightFragmentConstants",
    "diffuseColorReg",
    "specularColorReg",
    "lightPosReg",
    "lightDirReg",
    "vertexRegIndex",
    "fragmentRegIndex",
    "addSpec",
    "usesLightsForSpecular",
    "addDiff",
    "usesLightsForDiffuse",
    "numDirectionalLights",
    "lightVarying",
    "_iGetPerLightDiffuseFragmentCode",
    "_iGetPerLightSpecularFragmentCode",
    "numPointLights",
    "usesLightFallOff",
    "weightReg",
    "weightComponents",
    "weightRegisters",
    "texReg",
    "usesProbesForSpecular",
    "usesProbesForDiffuse",
    "lightProbeDiffuseIndices",
    "lightProbeSpecularIndices",
    "_pNumProbeRegisters",
    "probeWeightsIndex",
    "numLightProbes",
    "getFreeTextureReg",
    "_iGetPerProbeDiffuseFragmentCode",
    "_iGetPerProbeSpecularFragmentCode",
    "ceil",
    "awayjs-renderergl/lib/compilation/ShaderLightingObject",
    "LightSources",
    "ContextGLProfile",
    "ShaderObjectBase",
    "ShaderLightingObject",
    "_includeCasters",
    "numAllLights",
    "diffuseLightSources",
    "_iUsesDiffuse",
    "specularLightSources",
    "_iUsesSpecular",
    "combinedLightSources",
    "enableLightFallOff",
    "BASELINE_CONSTRAINED",
    "numLights",
    "LIGHTS",
    "PROBES",
    "_iUsesShadows",
    "createCompiler",
    "lightPicker",
    "collectLights",
    "updateProbes",
    "dirLight",
    "pointLight",
    "dirPos",
    "numLightTypes",
    "ambientR",
    "ambientG",
    "ambientB",
    "cast",
    "directionalLightsOffset",
    "castingDirectionalLights",
    "sceneDirection",
    "_iAmbientR",
    "_iAmbientG",
    "_iAmbientB",
    "_pInverseSceneMatrix",
    "_iDiffuseR",
    "_iDiffuseG",
    "_iDiffuseB",
    "_iSpecularR",
    "_iSpecularG",
    "_iSpecularB",
    "pointLightsOffset",
    "castingPointLights",
    "_pRadius",
    "_pFallOffFactor",
    "probe",
    "lightProbes",
    "lightProbeWeights",
    "lightProbesOffset",
    "getImageObject",
    "diffuseMap",
    "specularMap",
    "awayjs-display/lib/materials/LightSources",
    "awayjs-renderergl/lib/compilation/ShaderObjectBase",
    "awayjs-stagegl/lib/base/ContextGLProfile",
    "LineSubGeometry",
    "ContextGLTriangleFace",
    "TextureObjectPool",
    "_invalidShader",
    "_invalidProgram",
    "_animationVertexCode",
    "_animationFragmentCode",
    "_defaultCulling",
    "BACK",
    "_renderPass",
    "_textureObjectPool",
    "_updateProgram",
    "_programData",
    "projectionDependencies",
    "registerCache",
    "setCulling",
    "NONE",
    "projection",
    "coordinateSystem",
    "UV_FORMAT",
    "SECONDARY_UV_FORMAT",
    "TANGENT_DATA",
    "TANGENT_FORMAT",
    "COLOR_DATA",
    "COLOR_FORMAT",
    "uvTransform",
    "copyRawDataTo",
    "invalidateShader",
    "compiler",
    "_calcAnimationCode",
    "getProgramData",
    "vertexCode",
    "fragmentCode",
    "postAnimationFragmentCode",
    "usages",
    "awayjs-core/lib/data/LineSubGeometry",
    "awayjs-renderergl/lib/pool/TextureObjectPool",
    "awayjs-stagegl/lib/base/ContextGLTriangleFace",
    "_numUsedVertexConstants",
    "_numUsedFragmentConstants",
    "_numUsedVaryings",
    "_profile",
    "_fragmentTempCache",
    "_vertexTempCache",
    "_varyingCache",
    "_textureCache",
    "_vertexAttributesCache",
    "_fragmentConstantsCache",
    "_vertexConstantsCache",
    "_fragmentOutputRegister",
    "_vertexOutputRegister",
    "_vertexAttributesOffset",
    "_vertexConstantOffset",
    "_varyingsOffset",
    "_fragmentConstantOffset",
    "getFreeFragmentSingleTemp",
    "component",
    "_toStr",
    "COMPONENTS",
    "awayjs-renderergl/lib/compilation/SkyboxRenderObject",
    "SkyboxPass",
    "SkyboxRenderObject",
    "awayjs-renderergl/lib/passes/SkyboxPass",
    "message",
    "awayjs-core/lib/errors/Error",
    "_animator",
    "_animationState",
    "_animationNode",
    "awayjs-renderergl/lib/events/ShadingMethodEvent",
    "ShadingMethodEvent",
    "SHADER_INVALIDATED",
    "awayjs-renderergl/lib/filters/Filter3DBase",
    "Filter3DBase",
    "pAddTask",
    "_textureWidth",
    "_textureHeight",
    "mainTarget",
    "awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase",
    "ContextGLTextureFormat",
    "Filter3DTaskBase",
    "_scaledTextureWidth",
    "_scaledTextureHeight",
    "_textureDimensionsInvalid",
    "_program3DInvalid",
    "_textureScale",
    "_target",
    "pUpdateTextures",
    "_program3D",
    "pInvalidateProgram",
    "pUpdateProgram",
    "pGetVertexCode",
    "pGetFragmentCode",
    "createTexture",
    "BGRA",
    "awayjs-stagegl/lib/base/ContextGLTextureFormat",
    "ImageUtils",
    "_viewWidth",
    "_viewHeight",
    "_buffersInvalid",
    "_renderToTextureRect",
    "_instances",
    "rttBufferManager",
    "getRTTBufferManagerFromStage",
    "vo",
    "RTTBufferManagerVO",
    "stage3d",
    "rttbfm",
    "deleteRTTBufferManager",
    "updateRTTBuffers",
    "_textureRatioX",
    "_textureRatioY",
    "getBestPowerOf2",
    "_renderToTextureVertexBuffer",
    "_renderToScreenVertexBuffer",
    "_indexBuffer",
    "textureVerts",
    "screenVerts",
    "createIndexBuffer",
    "u1",
    "u2",
    "v1",
    "v2",
    "awayjs-core/lib/utils/ImageUtils",
    "RenderPassBase",
    "_diffuseR",
    "_diffuseG",
    "_diffuseB",
    "_diffuseA",
    "_shader",
    "regCache",
    "sharedReg",
    "alphaReg",
    "targetReg",
    "_iInitRegisters",
    "cutOffReg",
    "_fragmentConstantsIndex",
    "diffuseInputReg",
    "awayjs-renderergl/lib/passes/RenderPassBase",
    "sharedRegisters",
    "dataReg1",
    "dataReg2",
    "projectionFragment",
    "albedo",
    "far",
    "awayjs-renderergl/lib/passes/IRenderLightingPass",
    "awayjs-renderergl/lib/passes/IRenderPassBase",
    "ArgumentError",
    "_preserveAlpha",
    "_depthCompareMode",
    "_blendFactorSource",
    "_blendFactorDest",
    "_pEnableBlending",
    "_writeDepth",
    "_renderObject",
    "SOURCE_ALPHA",
    "ONE_MINUS_SOURCE_ALPHA",
    "MULTIPLY",
    "SOURCE_COLOR",
    "ADD",
    "ALPHA",
    "awayjs-core/lib/errors/ArgumentError",
    "_skybox",
    "_cubeTexture",
    "cubeMap",
    "awayjs-renderergl/lib/pick/JSPickingCollider",
    "PickingColliderBase",
    "JSPickingCollider",
    "findClosestCollision",
    "_findClosestCollision",
    "_pTestRenderableCollision",
    "pickingCollisionVO",
    "shortestCollisionDistance",
    "i0",
    "i1",
    "i2",
    "rx",
    "ry",
    "rz",
    "coeff",
    "p0x",
    "p0y",
    "p0z",
    "p1x",
    "p1y",
    "p1z",
    "p2x",
    "p2y",
    "p2z",
    "s0x",
    "s0y",
    "s0z",
    "s1x",
    "s1y",
    "s1z",
    "nl",
    "nDotV",
    "D",
    "disToPlane",
    "Q1Q2",
    "Q1Q1",
    "Q2Q2",
    "RQ1",
    "RQ2",
    "indexData",
    "collisionTriangleIndex",
    "positionData",
    "positionStride",
    "dataPerVertex",
    "positionOffset",
    "uvData",
    "uvStride",
    "uvOffset",
    "numIndices",
    "rayDirection",
    "rayPosition",
    "rayEntryDistance",
    "localNormal",
    "uv",
    "_pGetCollisionUV",
    "awayjs-renderergl/lib/pick/PickingColliderBase",
    "BillboardRenderable",
    "TriangleSubMeshRenderable",
    "_billboardRenderablePool",
    "_subMeshRenderablePool",
    "_pPetCollisionNormal",
    "triangleIndex",
    "normal",
    "p0",
    "side0",
    "side1",
    "uIndex",
    "uv0",
    "uv1",
    "uv2",
    "setLocalRay",
    "localDirection",
    "testBillboardCollision",
    "billboard",
    "localRayPosition",
    "localRayDirection",
    "testMeshCollision",
    "findClosest",
    "awayjs-renderergl/lib/pool/BillboardRenderable",
    "awayjs-renderergl/lib/pool/TriangleSubMeshRenderable",
    "awayjs-renderergl/lib/pick/ShaderPicker",
    "Debug",
    "Matrix3DUtils",
    "ShaderPicker",
    "shaderPickingDetails",
    "_onlyMouseEnabled",
    "_interactives",
    "_localHitPosition",
    "_hitUV",
    "_localHitNormal",
    "_rayPos",
    "_rayDir",
    "_shaderPickingDetails",
    "_id",
    "_viewportData",
    "_boundOffsetScale",
    "getViewCollision",
    "view",
    "collector",
    "iEntityCollector",
    "renderer",
    "_context",
    "_projX",
    "_projY",
    "_potentialFound",
    "_blendedRenderableHead",
    "_opaqueRenderableHead",
    "_bitmapImage2D",
    "_hitColor",
    "getPixel",
    "_hitRenderable",
    "_hitEntity",
    "_iIsMouseEnabled",
    "_collisionVO",
    "_iPickingCollisionVO",
    "getHitDetails",
    "_faceIndex",
    "getSceneCollision",
    "direction",
    "scene",
    "MOUSE_SCISSOR_RECT",
    "_interactiveId",
    "_objectProgram",
    "initObjectProgram",
    "CALCULATION_MATRIX",
    "setProgramConstantsFromMatrix",
    "getIndexBuffer",
    "updateRay",
    "getRay",
    "throwPIR",
    "initTriangleProgram",
    "_triangleProgram",
    "getApproximatePosition",
    "getPreciseDetails",
    "bounds",
    "getBox",
    "col",
    "scX",
    "scY",
    "scZ",
    "offsX",
    "offsY",
    "offsZ",
    "localViewProjection",
    "depth",
    "setScissorRectangle",
    "t1",
    "t2",
    "t3",
    "v0x",
    "v0y",
    "v0z",
    "v1x",
    "v1y",
    "v1z",
    "v2x",
    "v2y",
    "v2z",
    "ni1",
    "ni2",
    "ni3",
    "n1",
    "n2",
    "n3",
    "nLength",
    "dot00",
    "dot01",
    "dot02",
    "dot11",
    "dot12",
    "invDenom",
    "ui1",
    "ui2",
    "ui3",
    "normals",
    "normalStride",
    "normalOffset",
    "getPrecisePosition",
    "invSceneTransform",
    "px",
    "py",
    "pz",
    "RAW_DATA_CONTAINER",
    "awayjs-core/lib/geom/Matrix3DUtils",
    "awayjs-core/lib/utils/Debug",
    "RenderableBase",
    "_billboard",
    "_pGetSubGeometry",
    "billboardRect",
    "_materialGeometry",
    "_pVertexDataDirty",
    "viewMatrixReg",
    "viewMatrixIndex",
    "matrix3D",
    "awayjs-renderergl/lib/pool/RenderableBase",
    "awayjs-renderergl/lib/pool/CurveSubMeshRenderable",
    "CurveSubGeometry",
    "CurveSubMeshRenderable",
    "level",
    "indexOffset",
    "_constants",
    "curves",
    "CURVE_DATA",
    "sd",
    "standardDerivatives",
    "out",
    "curve",
    "curvex",
    "curvey",
    "curvez",
    "free",
    "free1",
    "free2",
    "d2",
    "fixa",
    "fixb",
    "_aa",
    "_1",
    "join",
    "CURVE_FORMAT",
    "_pGetOverflowRenderable",
    "_level",
    "awayjs-core/lib/data/CurveSubGeometry",
    "awayjs-renderergl/lib/pool/IRenderableClass",
    "awayjs-renderergl/lib/pool/IRendererPoolClass",
    "awayjs-renderergl/lib/pool/ITextureObjectClass",
    "awayjs-renderergl/lib/pool/LineSegmentRenderable",
    "LineSegmentRenderable",
    "lineSegment",
    "_thickness",
    "_lineSegment",
    "_calcMatrix",
    "_lineGeometry",
    "START_POSITION_DATA",
    "END_POSITION_DATA",
    "THICKNESS_DATA",
    "startPostion",
    "end",
    "endPosition",
    "startPositions",
    "endPositions",
    "thickness",
    "updateThickness",
    "pONE_VECTOR",
    "pFRONT_VECTOR",
    "THICKNESS_FORMAT",
    "awayjs-renderergl/lib/pool/LineSubMeshRenderable",
    "LineSubMeshRenderable",
    "startColors",
    "SubGeometryBase",
    "RenderableOwnerEvent",
    "IndexDataPool",
    "_geometryDirty",
    "_indexDataDirty",
    "_vertexData",
    "_vertexOffset",
    "_onIndicesUpdatedDelegate",
    "_onIndicesUpdated",
    "_onVerticesUpdatedDelegate",
    "_onVerticesUpdated",
    "_onRenderObjectOwnerUpdatedDelegate",
    "_onRenderObjectOwnerUpdated",
    "_indexOffset",
    "RENDER_OBJECT_OWNER_UPDATED",
    "_updateIndexData",
    "_overflow",
    "_numTriangles",
    "_indexData",
    "_updateVertexData",
    "_concatenateArrays",
    "VERTEX_DATA",
    "invalidateGeometry",
    "invalidateIndexData",
    "invalidateVertexData",
    "_iFillIndexData",
    "_updateGeometry",
    "_subGeometry",
    "concatenateArrays",
    "awayjs-core/lib/data/SubGeometryBase",
    "awayjs-display/lib/events/RenderableOwnerEvent",
    "awayjs-stagegl/lib/pool/IndexDataPool",
    "_renderablePool",
    "_materialRenderObjectPool",
    "_skyboxRenderObjectPool",
    "_depthRenderObjectPool",
    "_distanceRenderObjectPool",
    "_iAddRenderable",
    "getMaterialRenderObject",
    "getSkyboxRenderObject",
    "_iRemoveRenderable",
    "disposePool",
    "pools",
    "_pools",
    "_renderer",
    "_pUpdatePool",
    "_lineSegmentRenderablePool",
    "_triangleSubMeshRenderablePool",
    "_lineSubMeshRenderablePool",
    "_curveSubMeshRenderablePool",
    "applyBillboard",
    "applyLineSegment",
    "applyTriangleSubMesh",
    "triangleSubMesh",
    "applyCurveSubMesh",
    "curveSubMesh",
    "applyLineSubMesh",
    "lineSubMesh",
    "awayjs-renderergl/lib/pool/Sampler2DObject",
    "SamplerObjectBase",
    "Sampler2DObject",
    "initProperties",
    "sampler2D",
    "samplerReg",
    "samplerIndex",
    "imageRect",
    "fragmentReg",
    "fragmentIndex",
    "getFragmentCode",
    "inputReg",
    "wrap",
    "getFormatString",
    "image2D",
    "offsetX",
    "offsetY",
    "awayjs-renderergl/lib/pool/SamplerObjectBase",
    "awayjs-renderergl/lib/pool/SamplerCubeObject",
    "SamplerCubeObject",
    "samplerCube",
    "imageCube",
    "bitmap",
    "COMPRESSED",
    "COMPRESSED_ALPHA",
    "awayjs-renderergl/lib/pool/Single2DTextureObject",
    "Single2DTexture",
    "TextureObjectBase",
    "Single2DTextureObject",
    "single2DTexture",
    "_single2DTexture",
    "_sampler2DObject",
    "assetClass",
    "awayjs-display/lib/textures/Single2DTexture",
    "awayjs-renderergl/lib/pool/TextureObjectBase",
    "awayjs-renderergl/lib/pool/SingleCubeTextureObject",
    "SingleCubeTexture",
    "SingleCubeTextureObject",
    "singleCubeTexture",
    "_singleCubeTexture",
    "_samplerCubeObject",
    "includeInput",
    "awayjs-display/lib/textures/SingleCubeTexture",
    "skybox",
    "_vertexArray",
    "_geometry",
    "_texture",
    "invalidate",
    "invalid",
    "_iAddTextureObject",
    "getClass",
    "_iRemoveTextureObject",
    "registerClass",
    "textureObjectClass",
    "classPool",
    "addDefaults",
    "main",
    "FLOAT_1",
    "awayjs-renderergl/lib/tools/commands/Merge",
    "Mesh",
    "Merge",
    "keepMaterial",
    "disposeSources",
    "objectSpace",
    "_keepMaterial",
    "_disposeSources",
    "_objectSpace",
    "applyToContainer",
    "receiver",
    "objectContainer",
    "parseContainer",
    "collect",
    "merge",
    "applyToMeshes",
    "meshes",
    "_toDispose",
    "_geomVOs",
    "destMesh",
    "subIdx",
    "oldGeom",
    "destGeom",
    "useSubMaterials",
    "sub",
    "vertices",
    "tangents",
    "addSubGeometry",
    "m",
    "calc",
    "iIdx",
    "vIdx",
    "nIdx",
    "tIdx",
    "uIdx",
    "pd",
    "nd",
    "td",
    "ud",
    "getSubGeomData",
    "transformVectors",
    "deltaTransformVectors",
    "GeometryVO",
    "object",
    "child",
    "numChildren",
    "getChildAt",
    "awayjs-display/lib/entities/Mesh",
    "awayjs-renderergl/lib/tools/data/ParticleGeometryTransform",
    "ParticleGeometryTransform",
    "_defaultVertexTransform",
    "_defaultInvVertexTransform",
    "transpose",
    "_defaultUVTransform",
    "awayjs-renderergl/lib/utils/ParticleGeometryHelper",
    "ParticleGeometryHelper",
    "generateGeometry",
    "geometries",
    "transforms",
    "indicesVector",
    "positionsVector",
    "normalsVector",
    "tangentsVector",
    "uvsVector",
    "vertexCounters",
    "sourceSubGeometries",
    "numSubGeometries",
    "vertexCounter",
    "sub2SubMap",
    "tempVertex",
    "tempNormal",
    "tempTangents",
    "tempUV",
    "MAX_VERTEX",
    "particleData",
    "tempLen",
    "compact",
    "product",
    "sourceUVs",
    "particleGeometryTransform",
    "vertexTransform",
    "invVertexTransform",
    "UVTransform",
    "deltaTransformVector",
    "transformPoint",
    "sourceIndices",
    "particleGeometry",
    "awayjs-renderergl/lib/utils/PerspectiveMatrix3D",
    "PerspectiveMatrix3D",
    "perspectiveFieldOfViewLH",
    "fieldOfViewY",
    "aspectRatio",
    "zNear",
    "zFar",
    "yScale",
    "tan",
    "xScale",
    "copyRawDataFrom"
  ],
  "mappings": "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",
  "file": "awayjs-renderergl.min.js",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    null,
    "import ImageBase\t\t\t\t\t= require(\"awayjs-core/lib/data/ImageBase\");\nimport BitmapImage2D\t\t\t\t= require(\"awayjs-core/lib/data/BitmapImage2D\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport CollectorBase\t\t\t\t= require(\"awayjs-display/lib/traverse/CollectorBase\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport ShadowMapperBase\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLClearMask\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport DepthRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/DepthRenderer\");\nimport DistanceRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/DistanceRenderer\");\nimport Filter3DRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/Filter3DRenderer\");\nimport Filter3DBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/filters/Filter3DBase\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\nimport IRendererPoolClass\t\t\t= require(\"awayjs-renderergl/lib/pool/IRendererPoolClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderablePoolBase\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\nimport SkyboxRenderable\t\t\t\t= require(\"awayjs-renderergl/lib/pool/SkyboxRenderable\");\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * The DefaultRenderer class provides the default rendering method. It renders the scene graph objects using the\n * materials assigned to them.\n *\n * @class away.render.DefaultRenderer\n */\nclass DefaultRenderer extends RendererBase\n{\n\tpublic _pRequireDepthRender:boolean;\n\tprivate _skyboxRenderablePool:RenderablePoolBase;\n\n\tprivate _pDistanceRenderer:DepthRenderer;\n\tprivate _pDepthRenderer:DepthRenderer;\n\tprivate _skyboxProjection:Matrix3D = new Matrix3D();\n\tpublic _pFilter3DRenderer:Filter3DRenderer;\n\n\tpublic _pDepthRender:BitmapImage2D;\n\n\tprivate _antiAlias:number;\n\n\tpublic get antiAlias():number\n\t{\n\t\treturn this._antiAlias;\n\t}\n\n\tpublic set antiAlias(value:number)\n\t{\n\t\tif (this._antiAlias == value)\n\t\t\treturn;\n\n\t\tthis._antiAlias = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get depthPrepass():boolean\n\t{\n\t\treturn this._depthPrepass;\n\t}\n\n\tpublic set depthPrepass(value:boolean)\n\t{\n\t\tthis._depthPrepass = value;\n\t}\n\n\t/**\n\t *\n\t * @returns {*}\n\t */\n\tpublic get filters3d():Array<Filter3DBase>\n\t{\n\t\treturn this._pFilter3DRenderer? this._pFilter3DRenderer.filters : null;\n\t}\n\tpublic set filters3d(value:Array<Filter3DBase>)\n\t{\n\t\tif (value && value.length == 0)\n\t\t\tvalue = null;\n\n\t\tif (this._pFilter3DRenderer && !value) {\n\t\t\tthis._pFilter3DRenderer.dispose();\n\t\t\tthis._pFilter3DRenderer = null;\n\t\t} else if (!this._pFilter3DRenderer && value) {\n\t\t\tthis._pFilter3DRenderer = new Filter3DRenderer(this._pStage);\n\t\t\tthis._pFilter3DRenderer.filters = value;\n\t\t}\n\n\t\tif (this._pFilter3DRenderer) {\n\t\t\tthis._pFilter3DRenderer.filters = value;\n\t\t\tthis._pRequireDepthRender = this._pFilter3DRenderer.requireDepthRender;\n\t\t} else {\n\t\t\tthis._pRequireDepthRender = false;\n\n\t\t\tif (this._pDepthRender) {\n\t\t\t\tthis._pDepthRender.dispose();\n\t\t\t\tthis._pDepthRender = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Creates a new DefaultRenderer object.\n\t *\n\t * @param antiAlias The amount of anti-aliasing to use.\n\t * @param renderMode The render mode to use.\n\t */\n\tconstructor(rendererPoolClass:IRendererPoolClass = null, stage:Stage = null)\n\t{\n\t\tsuper(rendererPoolClass, stage);\n\n\t\tif (this._width == 0)\n\t\t\tthis.width = window.innerWidth;\n\t\telse\n\t\t\tthis._pRttBufferManager.viewWidth = this._width;\n\n\t\tif (this._height == 0)\n\t\t\tthis.height = window.innerHeight;\n\t\telse\n\t\t\tthis._pRttBufferManager.viewHeight = this._height;\n\t}\n\n\tpublic render(entityCollector:CollectorBase)\n\t{\n\t\tsuper.render(entityCollector);\n\n\t\tif (!this._pStage.recoverFromDisposal()) {//if context has Disposed by the OS,don't render at this frame\n\t\t\tthis._pBackBufferInvalid = true;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._pBackBufferInvalid)// reset or update render settings\n\t\t\tthis.pUpdateBackBuffer();\n\n\t\tif (this._shareContext && this._pContext)\n\t\t\tthis._pContext.clear(0, 0, 0, 1, 1, 0, ContextGLClearMask.DEPTH);\n\n\t\tif (this._pFilter3DRenderer) {\n\t\t\tthis.textureRatioX = this._pRttBufferManager.textureRatioX;\n\t\t\tthis.textureRatioY = this._pRttBufferManager.textureRatioY;\n\t\t} else {\n\t\t\tthis.textureRatioX = 1;\n\t\t\tthis.textureRatioY = 1;\n\t\t}\n\n\t\tif (this._pRequireDepthRender)\n\t\t\tthis.pRenderSceneDepthToTexture(<EntityCollector> entityCollector);\n\n\t\tif (this._depthPrepass)\n\t\t\tthis.pRenderDepthPrepass(<EntityCollector> entityCollector);\n\n\t\tif (this._pFilter3DRenderer && this._pContext) { //TODO\n\t\t\t//this._iRender(entityCollector, this._pFilter3DRenderer.getMainInputTexture(this._pStage), this._pRttBufferManager.renderToTextureRect);\n\t\t\t//this._pFilter3DRenderer.render(this._pStage, entityCollector.camera, this._pDepthRender);\n\n\t\t} else {\n\n\t\t\tif (this._shareContext)\n\t\t\t\tthis._iRender(entityCollector, null, this._pScissorRect);\n\t\t\telse\n\t\t\t\tthis._iRender(entityCollector);\n\t\t}\n\n\t\tsuper.render(entityCollector);\n\n\t\tif (!this._shareContext && this._pContext)\n\t\t\tthis._pContext.present();\n\n\t\t// register that a view has been rendered\n\t\tthis._pStage.bufferClear = false;\n\t}\n\n\tpublic pExecuteRender(entityCollector:EntityCollector, target:ImageBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\tthis.updateLights(entityCollector);\n\n\t\tsuper.pExecuteRender(entityCollector, target, scissorRect, surfaceSelector);\n\t}\n\n\tprivate updateLights(entityCollector:EntityCollector)\n\t{\n\t\tvar dirLights:Array<DirectionalLight> = entityCollector.directionalLights;\n\t\tvar pointLights:Array<PointLight> = entityCollector.pointLights;\n\t\tvar len:number, i:number;\n\t\tvar light:LightBase;\n\t\tvar shadowMapper:ShadowMapperBase;\n\n\t\tlen = dirLights.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tlight = dirLights[i];\n\n\t\t\tshadowMapper = light.shadowMapper;\n\n\t\t\tif (light.castsShadows && (shadowMapper.autoUpdateShadows || shadowMapper._iShadowsInvalid ))\n\t\t\t\tshadowMapper.iRenderDepthMap(entityCollector, this._pDepthRenderer);\n\t\t}\n\n\t\tlen = pointLights.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tlight = pointLights[i];\n\n\t\t\tshadowMapper = light.shadowMapper;\n\n\t\t\tif (light.castsShadows && (shadowMapper.autoUpdateShadows || shadowMapper._iShadowsInvalid))\n\t\t\t\tshadowMapper.iRenderDepthMap(entityCollector, this._pDistanceRenderer);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pDraw(entityCollector:EntityCollector)\n\t{\n\t\tif (entityCollector.skyBox) {\n\t\t\tthis._pContext.setDepthTest(false, ContextGLCompareMode.ALWAYS);\n\n\t\t\tthis.drawSkybox(entityCollector);\n\t\t}\n\n\t\tsuper.pDraw(entityCollector);\n\t}\n\n\tpublic _pGetRenderObject(renderable:RenderableBase, renderObjectOwner:IRenderObjectOwner):RenderObjectBase\n\t{\n\t\treturn <RenderObjectBase> renderObjectOwner.getRenderObject(renderable._pool);\n\t}\n\n\t/**\n\t * Draw the skybox if present.\n\t *\n\t * @param entityCollector The EntityCollector containing all potentially visible information.\n\t */\n\tprivate drawSkybox(entityCollector:EntityCollector)\n\t{\n\t\tvar skyBox:SkyboxRenderable = <SkyboxRenderable> this._skyboxRenderablePool.getItem(entityCollector.skyBox);\n\n\t\tvar camera:Camera = entityCollector.camera;\n\n\t\tthis.updateSkyboxProjection(camera);\n\n\t\tvar renderObject:RenderObjectBase = skyBox.renderObject = this._pGetRenderObject(skyBox, skyBox.renderObjectOwner);\n\t\tvar pass:RenderPassBase = renderObject.passes[0];\n\n\t\tthis.activatePass(skyBox, pass, camera);\n\t\tskyBox._iRender(pass, camera, this._skyboxProjection);\n\t\tthis.deactivatePass(skyBox, pass);\n\t}\n\n\tprivate updateSkyboxProjection(camera:Camera)\n\t{\n\t\tvar near:Vector3D = new Vector3D();\n\n\t\tthis._skyboxProjection.copyFrom(this._pRttViewProjectionMatrix);\n\t\tthis._skyboxProjection.copyRowTo(2, near);\n\n\t\tvar camPos:Vector3D = camera.scenePosition;\n\n\t\tvar cx:number = near.x;\n\t\tvar cy:number = near.y;\n\t\tvar cz:number = near.z;\n\t\tvar cw:number = -(near.x*camPos.x + near.y*camPos.y + near.z*camPos.z + Math.sqrt(cx*cx + cy*cy + cz*cz));\n\n\t\tvar signX:number = cx >= 0? 1 : -1;\n\t\tvar signY:number = cy >= 0? 1 : -1;\n\n\t\tvar p:Vector3D = new Vector3D(signX, signY, 1, 1);\n\n\t\tvar inverse:Matrix3D = this._skyboxProjection.clone();\n\t\tinverse.invert();\n\n\t\tvar q:Vector3D = inverse.transformVector(p);\n\n\t\tthis._skyboxProjection.copyRowTo(3, p);\n\n\t\tvar a:number = (q.x*p.x + q.y*p.y + q.z*p.z + q.w*p.w)/(cx*q.x + cy*q.y + cz*q.z + cw*q.w);\n\n\t\tthis._skyboxProjection.copyRowFrom(2, new Vector3D(cx*a, cy*a, cz*a, cw*a));\n\t}\n\n\tpublic dispose()\n\t{\n\t\tif (!this._shareContext)\n\t\t\tthis._pStage.dispose();\n\n\t\tthis._skyboxRenderablePool.dispose();\n\t\tthis._skyboxRenderablePool = null;\n\n\t\tthis._pRttBufferManager.dispose();\n\t\tthis._pRttBufferManager = null;\n\n\t\tthis._pDepthRenderer.dispose();\n\t\tthis._pDistanceRenderer.dispose();\n\t\tthis._pDepthRenderer = null;\n\t\tthis._pDistanceRenderer = null;\n\n\t\tthis._pDepthRender = null;\n\n\t\tsuper.dispose();\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic pRenderDepthPrepass(entityCollector:EntityCollector)\n\t{\n\t\tthis._pDepthRenderer.disableColor = true;\n\n\t\tif (this._pFilter3DRenderer) { //TODO\n//\t\t\t\tthis._pDepthRenderer.textureRatioX = this._pRttBufferManager.textureRatioX;\n//\t\t\t\tthis._pDepthRenderer.textureRatioY = this._pRttBufferManager.textureRatioY;\n//\t\t\t\tthis._pDepthRenderer._iRender(entityCollector, this._pFilter3DRenderer.getMainInputTexture(this._pStage), this._pRttBufferManager.renderToTextureRect);\n\t\t} else {\n\t\t\tthis._pDepthRenderer.textureRatioX = 1;\n\t\t\tthis._pDepthRenderer.textureRatioY = 1;\n\t\t\tthis._pDepthRenderer._iRender(entityCollector);\n\t\t}\n\n\t\tthis._pDepthRenderer.disableColor = false;\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic pRenderSceneDepthToTexture(entityCollector:EntityCollector)\n\t{\n\t\tif (this._pDepthTextureInvalid || !this._pDepthRender)\n\t\t\tthis.initDepthTexture(<IContextGL> this._pStage.context);\n\n\t\tthis._pDepthRenderer.textureRatioX = this._pRttBufferManager.textureRatioX;\n\t\tthis._pDepthRenderer.textureRatioY = this._pRttBufferManager.textureRatioY;\n\t\tthis._pDepthRenderer._iRender(entityCollector, this._pDepthRender);\n\t}\n\n\n\t/**\n\t * Updates the backbuffer dimensions.\n\t */\n\tpublic pUpdateBackBuffer()\n\t{\n\t\t// No reason trying to configure back buffer if there is no context available.\n\t\t// Doing this anyway (and relying on _stage to cache width/height for\n\t\t// context does get available) means usesSoftwareRendering won't be reliable.\n\t\tif (this._pStage.context && !this._shareContext) {\n\t\t\tif (this._width && this._height) {\n\t\t\t\tthis._pStage.configureBackBuffer(this._width, this._height, this._antiAlias, true);\n\t\t\t\tthis._pBackBufferInvalid = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic iSetStage(value:Stage)\n\t{\n\t\tsuper.iSetStage(value);\n\n\t\tif (this._pStage) {\n\t\t\tthis._pRttBufferManager = RTTBufferManager.getInstance(this._pStage);\n\n\t\t\tthis._pDepthRenderer = new DepthRenderer(this._pRendererPoolClass, this._pStage);\n\t\t\tthis._pDistanceRenderer = new DistanceRenderer(this._pRendererPoolClass, this._pStage);\n\n\t\t\tthis._skyboxRenderablePool = RenderablePoolBase.getPool(SkyboxRenderable, this._pStage);\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initDepthTexture(context:IContextGL):void\n\t{\n\t\tthis._pDepthTextureInvalid = false;\n\n\t\tif (this._pDepthRender)\n\t\t\tthis._pDepthRender.dispose();\n\n\t\tthis._pDepthRender = new BitmapImage2D(this._pRttBufferManager.textureWidth, this._pRttBufferManager.textureHeight);\n\t}\n}\n\nexport = DefaultRenderer;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport IRendererPoolClass\t\t\t= require(\"awayjs-renderergl/lib/pool/IRendererPoolClass\");\n\n\n/**\n * The DepthRenderer class renders 32-bit depth information encoded as RGBA\n *\n * @class away.render.DepthRenderer\n */\nclass DepthRenderer extends RendererBase\n{\n\t/**\n\t * Creates a new DepthRenderer object.\n\t * @param renderBlended Indicates whether semi-transparent objects should be rendered.\n\t * @param distanceBased Indicates whether the written depth value is distance-based or projected depth-based\n\t */\n\tconstructor(rendererPoolClass:IRendererPoolClass = null, stage:Stage = null)\n\t{\n\t\tsuper(rendererPoolClass, stage);\n\n\t\tthis._iBackgroundR = 1;\n\t\tthis._iBackgroundG = 1;\n\t\tthis._iBackgroundB = 1;\n\n\t}\n\n\tpublic _pGetRenderObject(renderable:RenderableBase, renderObjectOwner:IRenderObjectOwner):RenderObjectBase\n\t{\n\t\treturn renderable._pool.getDepthRenderObject(renderObjectOwner);\n\t}\n}\n\nexport = DepthRenderer;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport IRendererPoolClass\t\t\t= require(\"awayjs-renderergl/lib/pool/IRendererPoolClass\");\n\n\n/**\n * The DistanceRenderer class renders 32-bit depth information encoded as RGBA\n *\n * @class away.render.DistanceRenderer\n */\nclass DistanceRenderer extends RendererBase\n{\n\t/**\n\t * Creates a new DistanceRenderer object.\n\t * @param renderBlended Indicates whether semi-transparent objects should be rendered.\n\t * @param distanceBased Indicates whether the written depth value is distance-based or projected depth-based\n\t */\n\tconstructor(rendererPoolClass:IRendererPoolClass = null, stage:Stage = null)\n\t{\n\t\tsuper(rendererPoolClass, stage);\n\n\t\tthis._iBackgroundR = 1;\n\t\tthis._iBackgroundG = 1;\n\t\tthis._iBackgroundB = 1;\n\n\t}\n\n\tpublic _pGetRenderObject(renderable:RenderableBase, renderObjectOwner:IRenderObjectOwner):RenderObjectBase\n\t{\n\t\treturn renderable._pool.getDistanceRenderObject(renderObjectOwner);\n\t}\n}\n\nexport = DistanceRenderer;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport Filter3DBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/filters/Filter3DBase\");\nimport Filter3DTaskBase\t\t\t\t= require(\"awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase\");\n\n/**\n * @class away.render.Filter3DRenderer\n */\nclass Filter3DRenderer\n{\n\tprivate _filters:Array<Filter3DBase>;\n\tprivate _tasks:Array<Filter3DTaskBase>;\n\tprivate _filterTasksInvalid:boolean;\n\tprivate _mainInputTexture:ITexture;\n\tprivate _requireDepthRender:boolean;\n\tprivate _rttManager:RTTBufferManager;\n\tprivate _stage:Stage;\n\tprivate _filterSizesInvalid:boolean = true;\n\tprivate _onRTTResizeDelegate:(event:Event) => void;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._onRTTResizeDelegate = (event:Event) => this.onRTTResize(event);\n\n\t\tthis._stage = stage;\n\t\tthis._rttManager = RTTBufferManager.getInstance(stage);\n\t\tthis._rttManager.addEventListener(Event.RESIZE, this._onRTTResizeDelegate);\n\n\t}\n\n\tprivate onRTTResize(event:Event)\n\t{\n\t\tthis._filterSizesInvalid = true;\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\tif (this._filterTasksInvalid) {\n\n\t\t\tthis.updateFilterTasks(stage);\n\n\t\t}\n\n\t\treturn this._mainInputTexture;\n\t}\n\n\tpublic get filters():Filter3DBase[]\n\t{\n\t\treturn this._filters;\n\t}\n\n\tpublic set filters(value:Filter3DBase[])\n\t{\n\t\tthis._filters = value;\n\n\t\tthis._filterTasksInvalid = true;\n\n\t\tthis._requireDepthRender = false;\n\n\t\tif (!this._filters) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tfor (var i:number = 0; i < this._filters.length; ++i) {\n\n\t\t\t// TODO: check logic:\n\t\t\t// this._requireDepthRender ||=  Boolean ( this._filters[i].requireDepthRender )\n\n\t\t\tvar s:any = this._filters[i];\n\t\t\tvar b:boolean = <boolean> ( s.requireDepthRender == null )? false : s.requireDepthRender;\n\n\t\t\tthis._requireDepthRender = this._requireDepthRender || b;\n\n\t\t}\n\n\t\tthis._filterSizesInvalid = true;\n\n\t}\n\n\tprivate updateFilterTasks(stage:Stage)\n\t{\n\t\tvar len:number;\n\n\t\tif (this._filterSizesInvalid) {\n\n\t\t\tthis.updateFilterSizes();\n\n\t\t}\n\n\t\tif (!this._filters) {\n\t\t\tthis._tasks = null;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tasks = new Array<Filter3DTaskBase>();\n\n\t\tlen = this._filters.length - 1;\n\n\t\tvar filter:Filter3DBase;\n\n\t\tfor (var i:number = 0; i <= len; ++i) {\n\n\t\t\t// make sure all internal tasks are linked together\n\t\t\tfilter = this._filters[i];\n\n\t\t\t// TODO: check logic\n\t\t\t// filter.setRenderTargets(i == len? null : Filter3DBase(_filters[i + 1]).getMainInputTexture(stage), stage);\n\n\t\t\tfilter.setRenderTargets(i == len? null : this._filters[i + 1].getMainInputTexture(stage), stage);\n\n\t\t\tthis._tasks = this._tasks.concat(filter.tasks);\n\n\t\t}\n\n\t\tthis._mainInputTexture = this._filters[0].getMainInputTexture(stage);\n\n\t}\n\n\tpublic render(stage:Stage, camera:Camera, depthTexture:ITexture)\n\t{\n\t\tvar len:number;\n\t\tvar i:number;\n\t\tvar task:Filter3DTaskBase;\n\t\tvar context:IContextGL = <IContextGL> stage.context;\n\n\t\tvar indexBuffer:IIndexBuffer = this._rttManager.indexBuffer;\n\n\t\tvar vertexBuffer:IVertexBuffer = this._rttManager.renderToTextureVertexBuffer;\n\n\t\tif (!this._filters) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterSizesInvalid) {\n\t\t\tthis.updateFilterSizes();\n\t\t}\n\n\t\tif (this._filterTasksInvalid) {\n\t\t\tthis.updateFilterTasks(stage);\n\t\t}\n\n\t\tlen = this._filters.length;\n\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._filters[i].update(stage, camera);\n\t\t}\n\n\t\tlen = this._tasks.length;\n\n\t\tif (len > 1) {\n\t\t\tcontext.setVertexBufferAt(0, vertexBuffer, 0, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\tcontext.setVertexBufferAt(1, vertexBuffer, 2, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t}\n\n\t\tfor (i = 0; i < len; ++i) {\n\n\t\t\ttask = this._tasks[i];\n\n\t\t\t//stage.setRenderTarget(task.target); //TODO\n\n\t\t\tif (!task.target) {\n\n\t\t\t\tstage.scissorRect = null;\n\t\t\t\tvertexBuffer = this._rttManager.renderToScreenVertexBuffer;\n\t\t\t\tcontext.setVertexBufferAt(0, vertexBuffer, 0, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\t\tcontext.setVertexBufferAt(1, vertexBuffer, 2, ContextGLVertexBufferFormat.FLOAT_2);\n\n\t\t\t}\n\n\t\t\tcontext.setTextureAt(0, task.getMainInputTexture(stage));\n\t\t\tcontext.setProgram(task.getProgram(stage));\n\t\t\tcontext.clear(0.0, 0.0, 0.0, 0.0);\n\n\t\t\ttask.activate(stage, camera, depthTexture);\n\n\t\t\tcontext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\t\tcontext.drawTriangles(indexBuffer, 0, 2);\n\n\t\t\ttask.deactivate(stage);\n\t\t}\n\n\t\tcontext.setTextureAt(0, null);\n\t\tcontext.setVertexBufferAt(0, null);\n\t\tcontext.setVertexBufferAt(1, null);\n\t}\n\n\tprivate updateFilterSizes()\n\t{\n\t\tfor (var i:number = 0; i < this._filters.length; ++i) {\n\t\t\tthis._filters[i].textureWidth = this._rttManager.textureWidth;\n\t\t\tthis._filters[i].textureHeight = this._rttManager.textureHeight;\n\t\t}\n\n\t\tthis._filterSizesInvalid = true;\n\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._rttManager.removeEventListener(Event.RESIZE, this._onRTTResizeDelegate);\n\t\tthis._rttManager = null;\n\t\tthis._stage = null;\n\t}\n}\n\nexport = Filter3DRenderer;",
    "import ImageBase\t\t\t\t\t= require(\"awayjs-core/lib/data/ImageBase\");\nimport BitmapImage2D\t\t\t\t= require(\"awayjs-core/lib/data/BitmapImage2D\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Point\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport EntityListItem\t\t\t\t= require(\"awayjs-display/lib/pool/EntityListItem\");\nimport IEntitySorter\t\t\t\t= require(\"awayjs-display/lib/sort/IEntitySorter\");\nimport RenderableMergeSort\t\t\t= require(\"awayjs-display/lib/sort/RenderableMergeSort\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport RendererEvent\t\t\t\t= require(\"awayjs-display/lib/events/RendererEvent\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport CollectorBase\t\t\t\t= require(\"awayjs-display/lib/traverse/CollectorBase\");\nimport ShadowCasterCollector\t\t= require(\"awayjs-display/lib/traverse/ShadowCasterCollector\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\nimport AGALMiniAssembler\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport StageEvent\t\t\t\t\t= require(\"awayjs-stagegl/lib/events/StageEvent\");\nimport StageManager\t\t\t\t\t= require(\"awayjs-stagegl/lib/managers/StageManager\");\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\n\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport IRendererPoolClass\t\t\t= require(\"awayjs-renderergl/lib/pool/IRendererPoolClass\");\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\nimport RendererPoolBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RendererPoolBase\");\n\n\n/**\n * RendererBase forms an abstract base class for classes that are used in the rendering pipeline to render the\n * contents of a partition\n *\n * @class away.render.RendererBase\n */\nclass RendererBase extends EventDispatcher implements IRenderer\n{\n\tprivate _numUsedStreams:number = 0;\n\tprivate _numUsedTextures:number = 0;\n\n\tprivate _rendererPool:RendererPoolBase;\n\n\tpublic _pRendererPoolClass:IRendererPoolClass;\n\tpublic _pContext:IContextGL;\n\tpublic _pStage:Stage;\n\n\tpublic _pCamera:Camera;\n\tpublic _iEntryPoint:Vector3D;\n\tpublic _pCameraForward:Vector3D;\n\n\tpublic _pRttBufferManager:RTTBufferManager;\n\tprivate _viewPort:Rectangle = new Rectangle();\n\tprivate _viewportDirty:boolean;\n\tprivate _scissorDirty:boolean;\n\n\tpublic _pBackBufferInvalid:boolean = true;\n\tpublic _pDepthTextureInvalid:boolean = true;\n\tpublic _depthPrepass:boolean = false;\n\tprivate _backgroundR:number = 0;\n\tprivate _backgroundG:number = 0;\n\tprivate _backgroundB:number = 0;\n\tprivate _backgroundAlpha:number = 1;\n\tpublic _shareContext:boolean = false;\n\n\t// only used by renderers that need to render geometry to textures\n\tpublic _width:number;\n\tpublic _height:number;\n\n\tpublic textureRatioX:number = 1;\n\tpublic textureRatioY:number = 1;\n\n\tprivate _snapshotBitmapImage2D:BitmapImage2D;\n\tprivate _snapshotRequired:boolean;\n\n\tpublic _pRttViewProjectionMatrix:Matrix3D = new Matrix3D();\n\n\tprivate _localPos:Point = new Point();\n\tprivate _globalPos:Point = new Point();\n\tpublic _pScissorRect:Rectangle = new Rectangle();\n\n\tprivate _scissorUpdated:RendererEvent;\n\tprivate _viewPortUpdated:RendererEvent;\n\n\tprivate _onContextUpdateDelegate:Function;\n\tprivate _onViewportUpdatedDelegate;\n\n\tpublic _pNumTriangles:number = 0;\n\n\tpublic _pOpaqueRenderableHead:RenderableBase;\n\tpublic _pBlendedRenderableHead:RenderableBase;\n\tpublic _disableColor:boolean = false;\n\tpublic _renderBlended:boolean = true;\n\n\n\tpublic get renderBlended():boolean\n\t{\n\t\treturn this._renderBlended;\n\t}\n\n\tpublic set renderBlended(value:boolean)\n\t{\n\t\tthis._renderBlended = value;\n\t}\n\n\n\tpublic get disableColor():boolean\n\t{\n\t\treturn this._disableColor;\n\t}\n\n\tpublic set disableColor(value:boolean)\n\t{\n\t\tthis._disableColor = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get numTriangles():number\n\t{\n\t\treturn this._pNumTriangles;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic renderableSorter:IEntitySorter;\n\n\n\t/**\n\t * A viewPort rectangle equivalent of the Stage size and position.\n\t */\n\tpublic get viewPort():Rectangle\n\t{\n\t\treturn this._viewPort;\n\t}\n\n\t/**\n\t * A scissor rectangle equivalent of the view size and position.\n\t */\n\tpublic get scissorRect():Rectangle\n\t{\n\t\treturn this._pScissorRect;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get x():number\n\t{\n\t\treturn this._localPos.x;\n\t}\n\n\tpublic set x(value:number)\n\t{\n\t\tif (this.x == value)\n\t\t\treturn;\n\n\t\tthis._globalPos.x = this._localPos.x = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get y():number\n\t{\n\t\treturn this._localPos.y;\n\t}\n\n\tpublic set y(value:number)\n\t{\n\t\tif (this.y == value)\n\t\t\treturn;\n\n\t\tthis._globalPos.y = this._localPos.y = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic set width(value:number)\n\t{\n\t\tif (this._width == value)\n\t\t\treturn;\n\n\t\tthis._width = value;\n\t\tthis._pScissorRect.width = value;\n\n\t\tif (this._pRttBufferManager)\n\t\t\tthis._pRttBufferManager.viewWidth = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t\tthis._pDepthTextureInvalid = true;\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic set height(value:number)\n\t{\n\t\tif (this._height == value)\n\t\t\treturn;\n\n\t\tthis._height = value;\n\t\tthis._pScissorRect.height = value;\n\n\t\tif (this._pRttBufferManager)\n\t\t\tthis._pRttBufferManager.viewHeight = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t\tthis._pDepthTextureInvalid = true;\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\t/**\n\t * Creates a new RendererBase object.\n\t */\n\tconstructor(rendererPoolClass:IRendererPoolClass = null, stage:Stage = null)\n\t{\n\t\tsuper();\n\n\t\tthis._pRendererPoolClass = rendererPoolClass;\n\n\t\tthis._onViewportUpdatedDelegate = (event:StageEvent) => this.onViewportUpdated(event)\n\t\tthis._onContextUpdateDelegate = (event:Event) => this.onContextUpdate(event);\n\n\t\t//default sorting algorithm\n\t\tthis.renderableSorter = new RenderableMergeSort();\n\n\t\tthis._rendererPool = (rendererPoolClass)? new this._pRendererPoolClass(this) : new RendererPoolBase(this);\n\n\t\tthis.stage = stage || StageManager.getInstance().getFreeStage();\n\t}\n\n\tpublic activatePass(renderable:RenderableBase, pass:RenderPassBase, camera:Camera)\n\t{\n\t\t//clear unused vertex streams\n\t\tfor (var i = pass.shader.numUsedStreams; i < this._numUsedStreams; i++)\n\t\t\tthis._pContext.setVertexBufferAt(i, null);\n\n\t\t//clear unused texture streams\n\t\tfor (var i = pass.shader.numUsedTextures; i < this._numUsedTextures; i++)\n\t\t\tthis._pContext.setTextureAt(i, null);\n\n\t\t//check program data is uploaded\n\t\tvar programData:ProgramData = pass.shader.programData;\n\n\t\tif (!programData.program) {\n\t\t\tprogramData.program = this._pContext.createProgram();\n\t\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + programData.vertexString + \"endpart\"))['vertex'].data;\n\t\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + programData.fragmentString + \"endpart\"))['fragment'].data;\n\t\t\tprogramData.program.upload(vertexByteCode, fragmentByteCode);\n\t\t}\n\n\t\t//set program data\n\t\tthis._pContext.setProgram(programData.program);\n\n\t\t//activate shader object through renderable\n\t\trenderable._iActivate(pass, camera);\n\t}\n\n\tpublic deactivatePass(renderable:RenderableBase, pass:RenderPassBase)\n\t{\n\t\t//deactivate shader object\n\t\trenderable._iDeactivate(pass);\n\n\t\tthis._numUsedStreams = pass.shader.numUsedStreams;\n\t\tthis._numUsedTextures = pass.shader.numUsedTextures;\n\t}\n\n\tpublic _iCreateEntityCollector():CollectorBase\n\t{\n\t\treturn new EntityCollector();\n\t}\n\n\t/**\n\t * The background color's red component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundR():number\n\t{\n\t\treturn this._backgroundR;\n\t}\n\n\tpublic set _iBackgroundR(value:number)\n\t{\n\t\tif (this._backgroundR == value)\n\t\t\treturn;\n\n\t\tthis._backgroundR = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t * The background color's green component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundG():number\n\t{\n\t\treturn this._backgroundG;\n\t}\n\n\tpublic set _iBackgroundG(value:number)\n\t{\n\t\tif (this._backgroundG == value)\n\t\t\treturn;\n\n\t\tthis._backgroundG = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t * The background color's blue component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundB():number\n\t{\n\t\treturn this._backgroundB;\n\t}\n\n\tpublic set _iBackgroundB(value:number)\n\t{\n\t\tif (this._backgroundB == value)\n\t\t\treturn;\n\n\t\tthis._backgroundB = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\tpublic get context():IContextGL\n\t{\n\t\treturn this._pContext;\n\t}\n\n\t/**\n\t * The Stage that will provide the ContextGL used for rendering.\n\t */\n\tpublic get stage():Stage\n\t{\n\t\treturn this._pStage;\n\t}\n\n\tpublic set stage(value:Stage)\n\t{\n\t\tif (this._pStage == value)\n\t\t\treturn;\n\n\t\tthis.iSetStage(value);\n\t}\n\n\tpublic iSetStage(value:Stage)\n\t{\n\t\tif (this._pStage)\n\t\t\tthis.dispose();\n\n\t\tif (value) {\n\t\t\tthis._pStage = value;\n\n\t\t\tthis._rendererPool.stage = this._pStage;\n\n\t\t\tthis._pStage.addEventListener(StageEvent.CONTEXT_CREATED, this._onContextUpdateDelegate);\n\t\t\tthis._pStage.addEventListener(StageEvent.CONTEXT_RECREATED, this._onContextUpdateDelegate);\n\t\t\tthis._pStage.addEventListener(StageEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\n\t\t\t/*\n\t\t\t if (_backgroundImageRenderer)\n\t\t\t _backgroundImageRenderer.stage = value;\n\t\t\t */\n\t\t\tif (this._pStage.context)\n\t\t\t\tthis._pContext = <IContextGL> this._pStage.context;\n\t\t}\n\n\t\tthis._pBackBufferInvalid = true;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t * Defers control of ContextGL clear() and present() calls to Stage, enabling multiple Stage frameworks\n\t * to share the same ContextGL object.\n\t */\n\tpublic get shareContext():boolean\n\t{\n\t\treturn this._shareContext;\n\t}\n\n\tpublic set shareContext(value:boolean)\n\t{\n\t\tif (this._shareContext == value)\n\t\t\treturn;\n\n\t\tthis._shareContext = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t * Disposes the resources used by the RendererBase.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._rendererPool.dispose();\n\n\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_CREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_RECREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.removeEventListener(StageEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\n\t\tthis._pStage = null;\n\t\tthis._pContext = null;\n\t\t/*\n\t\t if (_backgroundImageRenderer) {\n\t\t _backgroundImageRenderer.dispose();\n\t\t _backgroundImageRenderer = null;\n\t\t }\n\t\t */\n\t}\n\n\tpublic render(entityCollector:CollectorBase)\n\t{\n\t\tthis._viewportDirty = false;\n\t\tthis._scissorDirty = false;\n\t}\n\n\t/**\n\t * Renders the potentially visible geometry to the back buffer or texture.\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t * @param target An option target texture to render to.\n\t * @param surfaceSelector The index of a CubeTexture's face to render to.\n\t * @param additionalClearMask Additional clear mask information, in case extra clear channels are to be omitted.\n\t */\n\tpublic _iRender(entityCollector:CollectorBase, target:ImageBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\t//TODO refactor setTarget so that rendertextures are created before this check\n\t\tif (!this._pStage || !this._pContext)\n\t\t\treturn;\n\n\t\tthis._pRttViewProjectionMatrix.copyFrom(entityCollector.camera.viewProjection);\n\t\tthis._pRttViewProjectionMatrix.appendScale(this.textureRatioX, this.textureRatioY, 1);\n\n\t\tthis.pExecuteRender(entityCollector, target, scissorRect, surfaceSelector);\n\n\t\t// generate mip maps on target (if target exists) //TODO\n\t\t//if (target)\n\t\t//\t(<Texture>target).generateMipmaps();\n\n\t\t// clear buffers\n\t\tfor (var i:number = 0; i < 8; ++i) {\n\t\t\tthis._pContext.setVertexBufferAt(i, null);\n\t\t\tthis._pContext.setTextureAt(i, null);\n\t\t}\n\t}\n\n\tpublic _iRenderCascades(entityCollector:ShadowCasterCollector, target:ImageBase, numCascades:number, scissorRects:Array<Rectangle>, cameras:Array<Camera>)\n\t{\n\t\tthis.pCollectRenderables(entityCollector);\n\n\t\tthis._pStage.setRenderTarget(target, true, 0);\n\t\tthis._pContext.clear(1, 1, 1, 1, 1, 0);\n\n\t\tthis._pContext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\tthis._pContext.setDepthTest(true, ContextGLCompareMode.LESS);\n\n\t\tvar head:RenderableBase = this._pOpaqueRenderableHead;\n\n\t\tvar first:boolean = true;\n\n\t\t//TODO cascades must have separate collectors, rather than separate draw commands\n\t\tfor (var i:number = numCascades - 1; i >= 0; --i) {\n\t\t\tthis._pStage.scissorRect = scissorRects[i];\n\t\t\t//this.drawCascadeRenderables(head, cameras[i], first? null : cameras[i].frustumPlanes);\n\t\t\tfirst = false;\n\t\t}\n\n\t\t//line required for correct rendering when using away3d with starling. DO NOT REMOVE UNLESS STARLING INTEGRATION IS RETESTED!\n\t\tthis._pContext.setDepthTest(false, ContextGLCompareMode.LESS_EQUAL);\n\n\t\tthis._pStage.scissorRect = null;\n\t}\n\n\tpublic pCollectRenderables(entityCollector:CollectorBase)\n\t{\n\t\t//reset head values\n\t\tthis._pBlendedRenderableHead = null;\n\t\tthis._pOpaqueRenderableHead = null;\n\t\tthis._pNumTriangles = 0;\n\n\t\t//grab entity head\n\t\tvar item:EntityListItem = entityCollector.entityHead;\n\n\t\t//set temp values for entry point and camera forward vector\n\t\tthis._pCamera = entityCollector.camera;\n\t\tthis._iEntryPoint = this._pCamera.scenePosition;\n\t\tthis._pCameraForward = this._pCamera.transform.forwardVector;\n\n\t\t//iterate through all entities\n\t\twhile (item) {\n\t\t\titem.entity._iCollectRenderables(this._rendererPool);\n\t\t\titem = item.next;\n\t\t}\n\n\t\t//sort the resulting renderables\n\t\tthis._pOpaqueRenderableHead = <RenderableBase> this.renderableSorter.sortOpaqueRenderables(this._pOpaqueRenderableHead);\n\t\tthis._pBlendedRenderableHead = <RenderableBase> this.renderableSorter.sortBlendedRenderables(this._pBlendedRenderableHead);\n\t}\n\n\t/**\n\t * Renders the potentially visible geometry to the back buffer or texture. Only executed if everything is set up.\n\t *\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t * @param target An option target texture to render to.\n\t * @param surfaceSelector The index of a CubeTexture's face to render to.\n\t * @param additionalClearMask Additional clear mask information, in case extra clear channels are to be omitted.\n\t */\n\tpublic pExecuteRender(entityCollector:CollectorBase, target:ImageBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\tthis._pStage.setRenderTarget(target, true, surfaceSelector);\n\n\t\tif ((target || !this._shareContext) && !this._depthPrepass)\n\t\t\tthis._pContext.clear(this._backgroundR, this._backgroundG, this._backgroundB, this._backgroundAlpha, 1, 0);\n\n\t\tthis._pStage.scissorRect = scissorRect;\n\n\t\t/*\n\t\t if (_backgroundImageRenderer)\n\t\t _backgroundImageRenderer.render();\n\t\t */\n\t\tthis.pCollectRenderables(entityCollector);\n\n\t\tthis._pContext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\n\t\tthis.pDraw(entityCollector);\n\n\t\t//line required for correct rendering when using away3d with starling. DO NOT REMOVE UNLESS STARLING INTEGRATION IS RETESTED!\n\t\t//this._pContext.setDepthTest(false, ContextGLCompareMode.LESS_EQUAL); //oopsie\n\n\t\tif (!this._shareContext) {\n\t\t\tif (this._snapshotRequired && this._snapshotBitmapImage2D) {\n\t\t\t\tthis._pContext.drawToBitmapImage2D(this._snapshotBitmapImage2D);\n\t\t\t\tthis._snapshotRequired = false;\n\t\t\t}\n\t\t}\n\n\t\tthis._pStage.scissorRect = null;\n\t}\n\n\t/*\n\t * Will draw the renderer's output on next render to the provided bitmap data.\n\t * */\n\tpublic queueSnapshot(bmd:BitmapImage2D)\n\t{\n\t\tthis._snapshotRequired = true;\n\t\tthis._snapshotBitmapImage2D = bmd;\n\t}\n\n\t/**\n\t * Performs the actual drawing of geometry to the target.\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t */\n\tpublic pDraw(entityCollector:CollectorBase)\n\t{\n\t\tthis._pContext.setDepthTest(true, ContextGLCompareMode.LESS_EQUAL);\n\n\t\tif (this._disableColor)\n\t\t\tthis._pContext.setColorMask(false, false, false, false);\n\n\t\tthis.drawRenderables(this._pOpaqueRenderableHead, entityCollector);\n\n\t\tif (this._renderBlended)\n\t\t\tthis.drawRenderables(this._pBlendedRenderableHead, entityCollector);\n\n\t\tif (this._disableColor)\n\t\t\tthis._pContext.setColorMask(true, true, true, true);\n\t}\n\n\t//private drawCascadeRenderables(renderable:RenderableBase, camera:Camera, cullPlanes:Array<Plane3D>)\n\t//{\n\t//\tvar renderable2:RenderableBase;\n\t//\tvar renderObject:RenderObjectBase;\n\t//\tvar pass:RenderPassBase;\n\t//\n\t//\twhile (renderable) {\n\t//\t\trenderable2 = renderable;\n\t//\t\trenderObject = renderable.renderObject;\n\t//\t\tpass = renderObject.passes[0] //assuming only one pass per material\n\t//\n\t//\t\tthis.activatePass(renderable, pass, camera);\n\t//\n\t//\t\tdo {\n\t//\t\t\t// if completely in front, it will fall in a different cascade\n\t//\t\t\t// do not use near and far planes\n\t//\t\t\tif (!cullPlanes || renderable2.sourceEntity.worldBounds.isInFrustum(cullPlanes, 4)) {\n\t//\t\t\t\trenderable2._iRender(pass, camera, this._pRttViewProjectionMatrix);\n\t//\t\t\t} else {\n\t//\t\t\t\trenderable2.cascaded = true;\n\t//\t\t\t}\n\t//\n\t//\t\t\trenderable2 = renderable2.next;\n\t//\n\t//\t\t} while (renderable2 && renderable2.renderObject == renderObject && !renderable2.cascaded);\n\t//\n\t//\t\tthis.deactivatePass(renderable, pass);\n\t//\n\t//\t\trenderable = renderable2;\n\t//\t}\n\t//}\n\n\t/**\n\t * Draw a list of renderables.\n\t *\n\t * @param renderables The renderables to draw.\n\t * @param entityCollector The EntityCollector containing all potentially visible information.\n\t */\n\tpublic drawRenderables(renderable:RenderableBase, entityCollector:CollectorBase)\n\t{\n\t\tvar i:number;\n\t\tvar len:number;\n\t\tvar renderable2:RenderableBase;\n\t\tvar renderObject:RenderObjectBase;\n\t\tvar passes:Array<RenderPassBase>;\n\t\tvar pass:RenderPassBase;\n\t\tvar camera:Camera = entityCollector.camera;\n\n\n\t\twhile (renderable) {\n\t\t\trenderObject = renderable.renderObject;\n\t\t\tpasses = renderObject.passes;\n\n\t\t\t// otherwise this would result in depth rendered anyway because fragment shader kil is ignored\n\t\t\tif (this._disableColor && renderObject._renderObjectOwner.alphaThreshold != 0) {\n\t\t\t\trenderable2 = renderable;\n\t\t\t\t// fast forward\n\t\t\t\tdo {\n\t\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t\t} while (renderable2 && renderable2.renderObject == renderObject);\n\t\t\t} else {\n\t\t\t\t//iterate through each shader object\n\t\t\t\tlen = passes.length;\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\trenderable2 = renderable;\n\t\t\t\t\tpass = passes[i];\n\n\t\t\t\t\tthis.activatePass(renderable, pass, camera);\n\n\t\t\t\t\tdo {\n\t\t\t\t\t\trenderable2._iRender(pass, camera, this._pRttViewProjectionMatrix);\n\n\t\t\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t\t\t} while (renderable2 && renderable2.renderObject == renderObject);\n\n\t\t\t\t\tthis.deactivatePass(renderable, pass);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trenderable = renderable2;\n\t\t}\n\t}\n\n\t/**\n\t * Assign the context once retrieved\n\t */\n\tprivate onContextUpdate(event:Event)\n\t{\n\t\tthis._pContext = <IContextGL> this._pStage.context;\n\t}\n\n\tpublic get _iBackgroundAlpha():number\n\t{\n\t\treturn this._backgroundAlpha;\n\t}\n\n\tpublic set _iBackgroundAlpha(value:number)\n\t{\n\t\tif (this._backgroundAlpha == value)\n\t\t\treturn;\n\n\t\tthis._backgroundAlpha = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/*\n\t public get iBackground():Texture2DBase\n\t {\n\t return this._background;\n\t }\n\t */\n\n\t/*\n\t public set iBackground(value:Texture2DBase)\n\t {\n\t if (this._backgroundImageRenderer && !value) {\n\t this._backgroundImageRenderer.dispose();\n\t this._backgroundImageRenderer = null;\n\t }\n\n\t if (!this._backgroundImageRenderer && value)\n\t {\n\n\t this._backgroundImageRenderer = new BackgroundImageRenderer(this._pStage);\n\n\t }\n\n\n\t this._background = value;\n\n\t if (this._backgroundImageRenderer)\n\t this._backgroundImageRenderer.texture = value;\n\t }\n\t */\n\t/*\n\t public get backgroundImageRenderer():BackgroundImageRenderer\n\t {\n\t return _backgroundImageRenderer;\n\t }\n\t */\n\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyScissorUpdate()\n\t{\n\t\tif (this._scissorDirty)\n\t\t\treturn;\n\n\t\tthis._scissorDirty = true;\n\n\t\tif (!this._scissorUpdated)\n\t\t\tthis._scissorUpdated = new RendererEvent(RendererEvent.SCISSOR_UPDATED);\n\n\t\tthis.dispatchEvent(this._scissorUpdated);\n\t}\n\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyViewportUpdate()\n\t{\n\t\tif (this._viewportDirty)\n\t\t\treturn;\n\n\t\tthis._viewportDirty = true;\n\n\t\tif (!this._viewPortUpdated)\n\t\t\tthis._viewPortUpdated = new RendererEvent(RendererEvent.VIEWPORT_UPDATED);\n\n\t\tthis.dispatchEvent(this._viewPortUpdated);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onViewportUpdated(event:StageEvent)\n\t{\n\t\tthis._viewPort = this._pStage.viewPort;\n\t\t//TODO stop firing viewport updated for every stagegl viewport change\n\n\t\tif (this._shareContext) {\n\t\t\tthis._pScissorRect.x = this._globalPos.x - this._pStage.x;\n\t\t\tthis._pScissorRect.y = this._globalPos.y - this._pStage.y;\n\t\t\tthis.notifyScissorUpdate();\n\t\t}\n\n\t\tthis.notifyViewportUpdate();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic updateGlobalPos()\n\t{\n\t\tif (this._shareContext) {\n\t\t\tthis._pScissorRect.x = this._globalPos.x - this._viewPort.x;\n\t\t\tthis._pScissorRect.y = this._globalPos.y - this._viewPort.y;\n\t\t} else {\n\t\t\tthis._pScissorRect.x = 0;\n\t\t\tthis._pScissorRect.y = 0;\n\t\t\tthis._viewPort.x = this._globalPos.x;\n\t\t\tthis._viewPort.y = this._globalPos.y;\n\t\t}\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\t/**\n\t *\n\t * @param renderable\n\t * @protected\n\t */\n\tpublic applyRenderable(renderable:RenderableBase)\n\t{\n\t\t//set local vars for faster referencing\n\t\tvar renderObject:RenderObjectBase = this._pGetRenderObject(renderable, renderable.renderObjectOwner || DefaultMaterialManager.getDefaultMaterial(renderable.renderableOwner));\n\n\t\trenderable.renderObject = renderObject;\n\t\trenderable.renderObjectId = renderObject.renderObjectId;\n\t\trenderable.renderOrderId = renderObject.renderOrderId;\n\n\t\trenderable.cascaded = false;\n\n\t\tvar entity:IEntity = renderable.sourceEntity;\n\t\tvar position:Vector3D = entity.scenePosition;\n\n\t\t// project onto camera's z-axis\n\t\tposition = this._iEntryPoint.subtract(position);\n\t\trenderable.zIndex = entity.zOffset + position.dotProduct(this._pCameraForward);\n\n\t\t//store reference to scene transform\n\t\trenderable.renderSceneTransform = renderable.sourceEntity.getRenderSceneTransform(this._pCamera);\n\n\t\tif (renderObject.requiresBlending) {\n\t\t\trenderable.next = this._pBlendedRenderableHead;\n\t\t\tthis._pBlendedRenderableHead = renderable;\n\t\t} else {\n\t\t\trenderable.next = this._pOpaqueRenderableHead;\n\t\t\tthis._pOpaqueRenderableHead = renderable;\n\t\t}\n\n\t\tthis._pNumTriangles += renderable.numTriangles;\n\n\t\t//handle any overflow for renderables with data that exceeds GPU limitations\n\t\tif (renderable.overflow)\n\t\t\tthis.applyRenderable(renderable.overflow);\n\t}\n\n\tpublic _pGetRenderObject(renderable:RenderableBase, renderObjectOwner:IRenderObjectOwner):RenderObjectBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = RendererBase;",
    "import IAsset\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport AnimationNodeBase\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetError\t\t\t= require(\"awayjs-renderergl/lib/errors/AnimationSetError\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\n/**\n * Provides an abstract base class for data set classes that hold animation data for use in animator classes.\n *\n * @see away.animators.AnimatorBase\n */\nclass AnimationSetBase extends AssetBase implements IAsset\n{\n\tpublic static assetType:string = \"[asset AnimationSet]\";\n\n\tprivate _usesCPU:boolean;\n\tprivate _animations:Array<AnimationNodeBase> = new Array<AnimationNodeBase>();\n\tprivate _animationNames:Array<string> = new Array<string>();\n\tprivate _animationDictionary:Object = new Object();\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Retrieves a temporary GPU register that's still free.\n\t *\n\t * @param exclude An array of non-free temporary registers.\n\t * @param excludeAnother An additional register that's not free.\n\t * @return A temporary register that can be used.\n\t */\n\tpublic _pFindTempReg(exclude:Array<string>, excludeAnother:string = null):string\n\t{\n\t\tvar i:number /*uint*/ = 0;\n\t\tvar reg:string;\n\n\t\twhile (true) {\n\t\t\treg = \"vt\" + i;\n\t\t\tif (exclude.indexOf(reg) == -1 && excludeAnother != reg)\n\t\t\t\treturn reg;\n\t\t\t++i;\n\t\t}\n\n\t\t// can't be reached\n\t\treturn null;\n\t}\n\n\t/**\n\t * Indicates whether the properties of the animation data contained within the set combined with\n\t * the vertex registers already in use on shading materials allows the animation data to utilise\n\t * GPU calls.\n\t */\n\tpublic get usesCPU():boolean\n\t{\n\t\treturn this._usesCPU;\n\t}\n\n\t/**\n\t * Called by the material to reset the GPU indicator before testing whether register space in the shader\n\t * is available for running GPU-based animation code.\n\t *\n\t * @private\n\t */\n\tpublic resetGPUCompatibility()\n\t{\n\t\tthis._usesCPU = false;\n\t}\n\n\tpublic cancelGPUCompatibility()\n\t{\n\t\tthis._usesCPU = true;\n\t}\n\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shaderObject:ShaderObjectBase, stage:Stage)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shaderObject:ShaderObjectBase, stage:Stage)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shaderObject:ShaderObjectBase, shadedTarget:string):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shaderObject:ShaderObjectBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AnimationSetBase.assetType;\n\t}\n\n\t/**\n\t * Returns a vector of animation state objects that make up the contents of the animation data set.\n\t */\n\tpublic get animations():Array<AnimationNodeBase>\n\t{\n\t\treturn this._animations;\n\t}\n\n\t/**\n\t * Returns a vector of animation state objects that make up the contents of the animation data set.\n\t */\n\tpublic get animationNames():Array<string>\n\t{\n\t\treturn this._animationNames;\n\t}\n\n\t/**\n\t * Check to determine whether a state is registered in the animation set under the given name.\n\t *\n\t * @param stateName The name of the animation state object to be checked.\n\t */\n\tpublic hasAnimation(name:string):boolean\n\t{\n\t\treturn this._animationDictionary[name] != null;\n\t}\n\n\t/**\n\t * Retrieves the animation state object registered in the animation data set under the given name.\n\t *\n\t * @param stateName The name of the animation state object to be retrieved.\n\t */\n\tpublic getAnimation(name:string):AnimationNodeBase\n\t{\n\t\treturn this._animationDictionary[name];\n\t}\n\n\t/**\n\t * Adds an animation state object to the aniamtion data set under the given name.\n\t *\n\t * @param stateName The name under which the animation state object will be stored.\n\t * @param animationState The animation state object to be staored in the set.\n\t */\n\tpublic addAnimation(node:AnimationNodeBase)\n\t{\n\t\tif (this._animationDictionary[node.name])\n\t\t\tthrow new AnimationSetError(\"root node name '\" + node.name + \"' already exists in the set\");\n\n\t\tthis._animationDictionary[node.name] = node;\n\n\t\tthis._animations.push(node);\n\n\t\tthis._animationNames.push(node.name);\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t */\n\tpublic dispose()\n\t{\n\t}\n}\n\nexport = AnimationSetBase;",
    "import Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport RequestAnimationFrame\t\t= require(\"awayjs-core/lib/utils/RequestAnimationFrame\");\nimport getTimer\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/getTimer\");\n\nimport IAnimationSet\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\nimport IAnimator\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimator\");\nimport AnimationNodeBase\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Mesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IAnimationState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IAnimationState\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport TriangleSubMeshRenderable\t= require(\"awayjs-renderergl/lib/pool/TriangleSubMeshRenderable\");\nimport AnimatorEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimatorEvent\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\n\n/**\n * Dispatched when playback of an animation inside the animator object starts.\n *\n * @eventType away3d.events.AnimatorEvent\n */\n//[Event(name=\"start\", type=\"away3d.events.AnimatorEvent\")]\n\n/**\n * Dispatched when playback of an animation inside the animator object stops.\n *\n * @eventType away3d.events.AnimatorEvent\n */\n//[Event(name=\"stop\", type=\"away3d.events.AnimatorEvent\")]\n\n/**\n * Dispatched when playback of an animation reaches the end of an animation.\n *\n * @eventType away3d.events.AnimatorEvent\n */\n//[Event(name=\"cycle_complete\", type=\"away3d.events.AnimatorEvent\")]\n\n/**\n * Provides an abstract base class for animator classes that control animation output from a data set subtype of <code>AnimationSetBase</code>.\n *\n * @see away.animators.AnimationSetBase\n */\nclass AnimatorBase extends AssetBase implements IAnimator\n{\n\tpublic static assetType:string = \"[asset Animator]\";\n\n\tprivate _broadcaster:RequestAnimationFrame;\n\tprivate _isPlaying:boolean;\n\tprivate _autoUpdate:boolean = true;\n\tprivate _startEvent:AnimatorEvent;\n\tprivate _stopEvent:AnimatorEvent;\n\tprivate _cycleEvent:AnimatorEvent;\n\tprivate _time:number /*int*/ = 0;\n\tprivate _playbackSpeed:number = 1;\n\n\tpublic _pAnimationSet:IAnimationSet;\n\tpublic _pOwners:Array<Mesh> = new Array<Mesh>();\n\tpublic _pActiveNode:AnimationNodeBase;\n\tpublic _pActiveState:IAnimationState;\n\tpublic _pActiveAnimationName:string;\n\tpublic _pAbsoluteTime:number = 0;\n\n\tprivate _animationStates:Object = new Object();\n\n\t/**\n\t * Enables translation of the animated mesh from data returned per frame via the positionDelta property of the active animation node. Defaults to true.\n\t *\n\t * @see away.animators.IAnimationState#positionDelta\n\t */\n\tpublic updatePosition:boolean = true;\n\n\tpublic getAnimationState(node:AnimationNodeBase):IAnimationState\n\t{\n\t\tvar className:any = node.stateClass;\n\t\tvar uID:number = node.id;\n\n\t\tif (this._animationStates[uID] == null)\n\t\t\tthis._animationStates[uID] = new className(this, node);\n\n\t\treturn this._animationStates[uID];\n\t}\n\n\tpublic getAnimationStateByName(name:string):IAnimationState\n\t{\n\t\treturn this.getAnimationState(this._pAnimationSet.getAnimation(name));\n\t}\n\n\t/**\n\t * Returns the internal absolute time of the animator, calculated by the current time and the playback speed.\n\t *\n\t * @see #time\n\t * @see #playbackSpeed\n\t */\n\tpublic get absoluteTime():number\n\t{\n\t\treturn this._pAbsoluteTime;\n\t}\n\n\t/**\n\t * Returns the animation data set in use by the animator.\n\t */\n\tpublic get animationSet():IAnimationSet\n\t{\n\t\treturn this._pAnimationSet;\n\t}\n\n\t/**\n\t * Returns the current active animation state.\n\t */\n\tpublic get activeState():IAnimationState\n\t{\n\t\treturn this._pActiveState;\n\t}\n\n\t/**\n\t * Returns the current active animation node.\n\t */\n\tpublic get activeAnimation():AnimationNodeBase\n\t{\n\t\treturn this._pAnimationSet.getAnimation(this._pActiveAnimationName);\n\t}\n\n\t/**\n\t * Returns the current active animation node.\n\t */\n\tpublic get activeAnimationName():string\n\t{\n\t\treturn this._pActiveAnimationName;\n\t}\n\n\t/**\n\t * Determines whether the animators internal update mechanisms are active. Used in cases\n\t * where manual updates are required either via the <code>time</code> property or <code>update()</code> method.\n\t * Defaults to true.\n\t *\n\t * @see #time\n\t * @see #update()\n\t */\n\tpublic get autoUpdate():boolean\n\t{\n\t\treturn this._autoUpdate;\n\t}\n\n\tpublic set autoUpdate(value:boolean)\n\t{\n\t\tif (this._autoUpdate == value)\n\t\t\treturn;\n\n\t\tthis._autoUpdate = value;\n\n\t\tif (this._autoUpdate)\n\t\t\tthis.start(); else\n\t\t\tthis.stop();\n\t}\n\n\t/**\n\t * Gets and sets the internal time clock of the animator.\n\t */\n\tpublic get time():number /*int*/\n\t{\n\t\treturn this._time;\n\t}\n\n\tpublic set time(value:number /*int*/)\n\t{\n\t\tif (this._time == value)\n\t\t\treturn;\n\n\t\tthis.update(value);\n\t}\n\n\t/**\n\t * Sets the animation phase of the current active state's animation clip(s).\n\t *\n\t * @param value The phase value to use. 0 represents the beginning of an animation clip, 1 represents the end.\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._pActiveState.phase(value);\n\t}\n\n\t/**\n\t * Creates a new <code>AnimatorBase</code> object.\n\t *\n\t * @param animationSet The animation data set to be used by the animator object.\n\t */\n\tconstructor(animationSet:IAnimationSet)\n\t{\n\t\tsuper();\n\n\t\tthis._pAnimationSet = animationSet;\n\n\t\tthis._broadcaster = new RequestAnimationFrame(this.onEnterFrame, this);\n\t}\n\n\t/**\n\t * The amount by which passed time should be scaled. Used to slow down or speed up animations. Defaults to 1.\n\t */\n\tpublic get playbackSpeed():number\n\t{\n\t\treturn this._playbackSpeed;\n\t}\n\n\tpublic set playbackSpeed(value:number)\n\t{\n\t\tthis._playbackSpeed = value;\n\t}\n\n\tpublic setRenderState(shaderObject:ShaderObjectBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * Resumes the automatic playback clock controling the active state of the animator.\n\t */\n\tpublic start()\n\t{\n\t\tif (this._isPlaying || !this._autoUpdate)\n\t\t\treturn;\n\n\t\tthis._time = this._pAbsoluteTime = getTimer();\n\n\t\tthis._isPlaying = true;\n\n\t\tthis._broadcaster.start();\n\n\t\tif (!this.hasEventListener(AnimatorEvent.START))\n\t\t\treturn;\n\n\t\tif (this._startEvent == null)\n\t\t\tthis._startEvent = new AnimatorEvent(AnimatorEvent.START, this);\n\n\t\tthis.dispatchEvent(this._startEvent);\n\t}\n\n\t/**\n\t * Pauses the automatic playback clock of the animator, in case manual updates are required via the\n\t * <code>time</code> property or <code>update()</code> method.\n\t *\n\t * @see #time\n\t * @see #update()\n\t */\n\tpublic stop()\n\t{\n\t\tif (!this._isPlaying)\n\t\t\treturn;\n\n\t\tthis._isPlaying = false;\n\n\t\tthis._broadcaster.stop();\n\n\t\tif (!this.hasEventListener(AnimatorEvent.STOP))\n\t\t\treturn;\n\n\t\tif (this._stopEvent == null)\n\t\t\tthis._stopEvent = new AnimatorEvent(AnimatorEvent.STOP, this);\n\n\t\tthis.dispatchEvent(this._stopEvent);\n\t}\n\n\t/**\n\t * Provides a way to manually update the active state of the animator when automatic\n\t * updates are disabled.\n\t *\n\t * @see #stop()\n\t * @see #autoUpdate\n\t */\n\tpublic update(time:number /*int*/)\n\t{\n\t\tvar dt:number = (time - this._time)*this.playbackSpeed;\n\n\t\tthis._pUpdateDeltaTime(dt);\n\n\t\tthis._time = time;\n\t}\n\n\tpublic reset(name:string, offset:number = 0)\n\t{\n\t\tthis.getAnimationState(this._pAnimationSet.getAnimation(name)).offset(offset + this._pAbsoluteTime);\n\t}\n\n\t/**\n\t * Used by the mesh object to which the animator is applied, registers the owner for internal use.\n\t *\n\t * @private\n\t */\n\tpublic addOwner(mesh:Mesh)\n\t{\n\t\tthis._pOwners.push(mesh);\n\t}\n\n\t/**\n\t * Used by the mesh object from which the animator is removed, unregisters the owner for internal use.\n\t *\n\t * @private\n\t */\n\tpublic removeOwner(mesh:Mesh)\n\t{\n\t\tthis._pOwners.splice(this._pOwners.indexOf(mesh), 1);\n\t}\n\n\t/**\n\t * Internal abstract method called when the time delta property of the animator's contents requires updating.\n\t *\n\t * @private\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tthis._pAbsoluteTime += dt;\n\n\t\tthis._pActiveState.update(this._pAbsoluteTime);\n\n\t\tif (this.updatePosition)\n\t\t\tthis.applyPositionDelta();\n\t}\n\n\t/**\n\t * Enter frame event handler for automatically updating the active state of the animator.\n\t */\n\tprivate onEnterFrame(event:Event = null)\n\t{\n\t\tthis.update(getTimer());\n\t}\n\n\tprivate applyPositionDelta()\n\t{\n\t\tvar delta:Vector3D = this._pActiveState.positionDelta;\n\t\tvar dist:number = delta.length;\n\t\tvar len:number /*uint*/;\n\t\tif (dist > 0) {\n\t\t\tlen = this._pOwners.length;\n\t\t\tfor (var i:number /*uint*/ = 0; i < len; ++i)\n\t\t\t\tthis._pOwners[i].translateLocal(delta, dist);\n\t\t}\n\t}\n\n\t/**\n\t *  for internal use.\n\t *\n\t * @private\n\t */\n\tpublic dispatchCycleEvent()\n\t{\n\t\tif (this.hasEventListener(AnimatorEvent.CYCLE_COMPLETE)) {\n\t\t\tif (this._cycleEvent == null)\n\t\t\t\tthis._cycleEvent = new AnimatorEvent(AnimatorEvent.CYCLE_COMPLETE, this);\n\n\t\t\tthis.dispatchEvent(this._cycleEvent);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic testGPUCompatibility(shaderObject:ShaderObjectBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AnimatorBase.assetType;\n\t}\n\n\n\tpublic getRenderableSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry):TriangleSubGeometry\n\t{\n\t\t//nothing to do here\n\t\treturn sourceSubGeometry;\n\t}\n}\n\nexport = AnimatorBase;",
    "import SubGeometryBase\t\t\t\t\t= require(\"awayjs-core/lib/data/SubGeometryBase\");\n\nimport IAnimationSet\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\nimport ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleTimeNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode\");\nimport ParticleGeometry\t\t\t\t\t= require(\"awayjs-renderergl/lib/base/ParticleGeometry\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\n\n\n/**\n * The animation data set used by particle-based animators, containing particle animation data.\n *\n * @see away.animators.ParticleAnimator\n */\nclass ParticleAnimationSet extends AnimationSetBase implements IAnimationSet\n{\n\t/** @private */\n\tpublic _iAnimationRegisterCache:AnimationRegisterCache;\n\n\t//all other nodes dependent on it\n\tprivate _timeNode:ParticleTimeNode;\n\n\t/**\n\t * Property used by particle nodes that require compilation at the end of the shader\n\t */\n\tpublic static POST_PRIORITY:number /*int*/ = 9;\n\n\t/**\n\t * Property used by particle nodes that require color compilation\n\t */\n\tpublic static COLOR_PRIORITY:number /*int*/ = 18;\n\n\tprivate _animationSubGeometries:Object = new Object();\n\tprivate _particleNodes:Array<ParticleNodeBase> = new Array<ParticleNodeBase>();\n\tprivate _localDynamicNodes:Array<ParticleNodeBase> = new Array<ParticleNodeBase>();\n\tprivate _localStaticNodes:Array<ParticleNodeBase> = new Array<ParticleNodeBase>();\n\tprivate _totalLenOfOneVertex:number /*int*/ = 0;\n\n\t//set true if has an node which will change UV\n\tpublic hasUVNode:boolean;\n\t//set if the other nodes need to access the velocity\n\tpublic needVelocity:boolean;\n\t//set if has a billboard node.\n\tpublic hasBillboard:boolean;\n\t//set if has an node which will apply color multiple operation\n\tpublic hasColorMulNode:boolean;\n\t//set if has an node which will apply color add operation\n\tpublic hasColorAddNode:boolean;\n\n\t/**\n\t * Initialiser function for static particle properties. Needs to reference a with the following format\n\t *\n\t * <code>\n\t * initParticleFunc(prop:ParticleProperties)\n\t * {\n\t * \t\t//code for settings local properties\n\t * }\n\t * </code>\n\t *\n\t * Aside from setting any properties required in particle animation nodes using local static properties, the initParticleFunc function\n\t * is required to time node requirements as they may be needed. These properties on the ParticleProperties object can include\n\t * <code>startTime</code>, <code>duration</code> and <code>delay</code>. The use of these properties is determined by the setting\n\t * arguments passed in the constructor of the particle animation set. By default, only the <code>startTime</code> property is required.\n\t */\n\tpublic initParticleFunc:Function;\n\n\t/**\n\t * Initialiser function scope for static particle properties\n\t */\n\tpublic initParticleScope:Object;\n\n\t/**\n\t * Creates a new <code>ParticleAnimationSet</code>\n\t *\n\t * @param    [optional] usesDuration    Defines whether the animation set uses the <code>duration</code> data in its static properties to determine how long a particle is visible for. Defaults to false.\n\t * @param    [optional] usesLooping     Defines whether the animation set uses a looping timeframe for each particle determined by the <code>startTime</code>, <code>duration</code> and <code>delay</code> data in its static properties function. Defaults to false. Requires <code>usesDuration</code> to be true.\n\t * @param    [optional] usesDelay       Defines whether the animation set uses the <code>delay</code> data in its static properties to determine how long a particle is hidden for. Defaults to false. Requires <code>usesLooping</code> to be true.\n\t */\n\tconstructor(usesDuration:boolean = false, usesLooping:boolean = false, usesDelay:boolean = false)\n\t{\n\t\tsuper();\n\n\t\t//automatically add a particle time node to the set\n\t\tthis.addAnimation(this._timeNode = new ParticleTimeNode(usesDuration, usesLooping, usesDelay));\n\t}\n\n\t/**\n\t * Returns a vector of the particle animation nodes contained within the set.\n\t */\n\tpublic get particleNodes():Array<ParticleNodeBase>\n\t{\n\t\treturn this._particleNodes;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic addAnimation(node:AnimationNodeBase)\n\t{\n\t\tvar i:number /*int*/;\n\t\tvar n:ParticleNodeBase = <ParticleNodeBase> node;\n\t\tn._iProcessAnimationSetting(this);\n\t\tif (n.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tn._iDataOffset = this._totalLenOfOneVertex;\n\t\t\tthis._totalLenOfOneVertex += n.dataLength;\n\t\t\tthis._localStaticNodes.push(n);\n\t\t} else if (n.mode == ParticlePropertiesMode.LOCAL_DYNAMIC)\n\t\t\tthis._localDynamicNodes.push(n);\n\n\t\tfor (i = this._particleNodes.length - 1; i >= 0; i--) {\n\t\t\tif (this._particleNodes[i].priority <= n.priority)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._particleNodes.splice(i + 1, 0, n);\n\n\t\tsuper.addAnimation(node);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shaderObject:ShaderObjectBase, stage:Stage)\n\t{\n//\t\t\tthis._iAnimationRegisterCache = pass.animationRegisterCache;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shaderObject:ShaderObjectBase, stage:Stage)\n\t{\n//\t\t\tvar context:IContextGL = <IContextGL> stage.context;\n//\t\t\tvar offset:number /*int*/ = this._iAnimationRegisterCache.vertexAttributesOffset;\n//\t\t\tvar used:number /*int*/ = this._iAnimationRegisterCache.numUsedStreams;\n//\t\t\tfor (var i:number /*int*/ = offset; i < used; i++)\n//\t\t\t\tcontext.setVertexBufferAt(i, null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\t//grab animationRegisterCache from the materialpassbase or create a new one if the first time\n\t\tthis._iAnimationRegisterCache = shaderObject.animationRegisterCache;\n\n\t\tif (this._iAnimationRegisterCache == null)\n\t\t\tthis._iAnimationRegisterCache = shaderObject.animationRegisterCache = new AnimationRegisterCache(shaderObject.profile);\n\n\t\t//reset animationRegisterCache\n\t\tthis._iAnimationRegisterCache.vertexConstantOffset = shaderObject.numUsedVertexConstants;\n\t\tthis._iAnimationRegisterCache.vertexAttributesOffset = shaderObject.numUsedStreams;\n\t\tthis._iAnimationRegisterCache.varyingsOffset = shaderObject.numUsedVaryings;\n\t\tthis._iAnimationRegisterCache.fragmentConstantOffset = shaderObject.numUsedFragmentConstants;\n\t\tthis._iAnimationRegisterCache.hasUVNode = this.hasUVNode;\n\t\tthis._iAnimationRegisterCache.needVelocity = this.needVelocity;\n\t\tthis._iAnimationRegisterCache.hasBillboard = this.hasBillboard;\n\t\tthis._iAnimationRegisterCache.sourceRegisters = shaderObject.animatableAttributes;\n\t\tthis._iAnimationRegisterCache.targetRegisters = shaderObject.animationTargetRegisters;\n\t\tthis._iAnimationRegisterCache.needFragmentAnimation = shaderObject.usesFragmentAnimation;\n\t\tthis._iAnimationRegisterCache.needUVAnimation = !shaderObject.usesUVTransform;\n\t\tthis._iAnimationRegisterCache.hasColorAddNode = this.hasColorAddNode;\n\t\tthis._iAnimationRegisterCache.hasColorMulNode = this.hasColorMulNode;\n\t\tthis._iAnimationRegisterCache.reset();\n\n\t\tvar code:string = \"\";\n\n\t\tcode += this._iAnimationRegisterCache.getInitCode();\n\n\t\tvar node:ParticleNodeBase;\n\t\tvar i:number /*int*/;\n\n\t\tfor (i = 0; i < this._particleNodes.length; i++) {\n\t\t\tnode = this._particleNodes[i];\n\t\t\tif (node.priority < ParticleAnimationSet.POST_PRIORITY)\n\t\t\t\tcode += node.getAGALVertexCode(shaderObject, this._iAnimationRegisterCache);\n\t\t}\n\n\t\tcode += this._iAnimationRegisterCache.getCombinationCode();\n\n\t\tfor (i = 0; i < this._particleNodes.length; i++) {\n\t\t\tnode = this._particleNodes[i];\n\t\t\tif (node.priority >= ParticleAnimationSet.POST_PRIORITY && node.priority < ParticleAnimationSet.COLOR_PRIORITY)\n\t\t\t\tcode += node.getAGALVertexCode(shaderObject, this._iAnimationRegisterCache);\n\t\t}\n\n\t\tcode += this._iAnimationRegisterCache.initColorRegisters();\n\n\t\tfor (i = 0; i < this._particleNodes.length; i++) {\n\t\t\tnode = this._particleNodes[i];\n\t\t\tif (node.priority >= ParticleAnimationSet.COLOR_PRIORITY)\n\t\t\t\tcode += node.getAGALVertexCode(shaderObject, this._iAnimationRegisterCache);\n\t\t}\n\t\tcode += this._iAnimationRegisterCache.getColorPassCode();\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.hasUVNode) {\n\t\t\tthis._iAnimationRegisterCache.setUVSourceAndTarget(shaderObject.uvSource, shaderObject.uvTarget);\n\t\t\tcode += \"mov \" + this._iAnimationRegisterCache.uvTarget + \".xy,\" + this._iAnimationRegisterCache.uvAttribute.toString() + \"\\n\";\n\t\t\tvar node:ParticleNodeBase;\n\t\t\tfor (var i:number /*uint*/ = 0; i < this._particleNodes.length; i++)\n\t\t\t\tnode = this._particleNodes[i];\n\t\t\t\tcode += node.getAGALUVCode(shaderObject, this._iAnimationRegisterCache);\n\t\t\tcode += \"mov \" + this._iAnimationRegisterCache.uvVar.toString() + \",\" + this._iAnimationRegisterCache.uvTarget + \".xy\\n\";\n\t\t} else\n\t\t\tcode += \"mov \" + shaderObject.uvTarget + \",\" + shaderObject.uvSource + \"\\n\";\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shaderObject:ShaderObjectBase, shadedTarget:string):string\n\t{\n\t\treturn this._iAnimationRegisterCache.getColorCombinationCode(shadedTarget);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shaderObject:ShaderObjectBase)\n\t{\n\t\tthis._iAnimationRegisterCache.setDataLength();\n\n\t\t//set vertexZeroConst,vertexOneConst,vertexTwoConst\n\t\tthis._iAnimationRegisterCache.setVertexConst(this._iAnimationRegisterCache.vertexZeroConst.index, 0, 1, 2, 0);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get usesCPU():boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic cancelGPUCompatibility()\n\t{\n\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var key in this._animationSubGeometries)\n\t\t\t(<AnimationSubGeometry> this._animationSubGeometries[key]).dispose();\n\n\t\tsuper.dispose();\n\t}\n\n\tpublic getAnimationSubGeometry(subMesh:ISubMesh)\n\t{\n\t\tvar mesh:Mesh = subMesh.parentMesh;\n\t\tvar animationSubGeometry:AnimationSubGeometry = (mesh.shareAnimationGeometry)? this._animationSubGeometries[subMesh.subGeometry.id] : this._animationSubGeometries[subMesh.id];\n\n\t\tif (animationSubGeometry)\n\t\t\treturn animationSubGeometry;\n\n\t\tthis._iGenerateAnimationSubGeometries(mesh);\n\n\t\treturn (mesh.shareAnimationGeometry)? this._animationSubGeometries[subMesh.subGeometry.id] : this._animationSubGeometries[subMesh.id];\n\t}\n\n\n\t/** @private */\n\tpublic _iGenerateAnimationSubGeometries(mesh:Mesh)\n\t{\n\t\tif (this.initParticleFunc == null)\n\t\t\tthrow(new Error(\"no initParticleFunc set\"));\n\n\t\tvar geometry:ParticleGeometry = <ParticleGeometry> mesh.geometry;\n\n\t\tif (!geometry)\n\t\t\tthrow(new Error(\"Particle animation can only be performed on a ParticleGeometry object\"));\n\n\t\tvar i:number /*int*/, j:number /*int*/, k:number /*int*/;\n\t\tvar animationSubGeometry:AnimationSubGeometry;\n\t\tvar newAnimationSubGeometry:boolean = false;\n\t\tvar subGeometry:SubGeometryBase;\n\t\tvar subMesh:ISubMesh;\n\t\tvar localNode:ParticleNodeBase;\n\n\t\tfor (i = 0; i < mesh.subMeshes.length; i++) {\n\t\t\tsubMesh = mesh.subMeshes[i];\n\t\t\tsubGeometry = subMesh.subGeometry;\n\t\t\tif (mesh.shareAnimationGeometry) {\n\t\t\t\tanimationSubGeometry = this._animationSubGeometries[subGeometry.id];\n\n\t\t\t\tif (animationSubGeometry)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tanimationSubGeometry = new AnimationSubGeometry();\n\n\t\t\tif (mesh.shareAnimationGeometry)\n\t\t\t\tthis._animationSubGeometries[subGeometry.id] = animationSubGeometry;\n\t\t\telse\n\t\t\t\tthis._animationSubGeometries[subMesh.id] = animationSubGeometry;\n\n\t\t\tnewAnimationSubGeometry = true;\n\n\t\t\t//create the vertexData vector that will be used for local node data\n\t\t\tanimationSubGeometry.createVertexData(subGeometry.numVertices, this._totalLenOfOneVertex);\n\t\t}\n\n\t\tif (!newAnimationSubGeometry)\n\t\t\treturn;\n\n\t\tvar particles:Array<ParticleData> = geometry.particles;\n\t\tvar particlesLength:number /*uint*/ = particles.length;\n\t\tvar numParticles:number /*uint*/ = geometry.numParticles;\n\t\tvar particleProperties:ParticleProperties = new ParticleProperties();\n\t\tvar particle:ParticleData;\n\n\t\tvar oneDataLen:number /*int*/;\n\t\tvar oneDataOffset:number /*int*/;\n\t\tvar counterForVertex:number /*int*/;\n\t\tvar counterForOneData:number /*int*/;\n\t\tvar oneData:Array<number>;\n\t\tvar numVertices:number /*uint*/;\n\t\tvar vertexData:Array<number>;\n\t\tvar vertexLength:number /*uint*/;\n\t\tvar startingOffset:number /*uint*/;\n\t\tvar vertexOffset:number /*uint*/;\n\n\t\t//default values for particle param\n\t\tparticleProperties.total = numParticles;\n\t\tparticleProperties.startTime = 0;\n\t\tparticleProperties.duration = 1000;\n\t\tparticleProperties.delay = 0.1;\n\n\t\ti = 0;\n\t\tj = 0;\n\t\twhile (i < numParticles) {\n\t\t\tparticleProperties.index = i;\n\n\t\t\t//call the init on the particle parameters\n\t\t\tthis.initParticleFunc.call(this.initParticleScope, particleProperties);\n\n\t\t\t//create the next set of node properties for the particle\n\t\t\tfor (k = 0; k < this._localStaticNodes.length; k++)\n\t\t\t\tthis._localStaticNodes[k]._iGeneratePropertyOfOneParticle(particleProperties);\n\n\t\t\t//loop through all particle data for the curent particle\n\t\t\twhile (j < particlesLength && (particle = particles[j]).particleIndex == i) {\n\t\t\t\t//find the target animationSubGeometry\n\t\t\t\tfor (k = 0; k < mesh.subMeshes.length; k++) {\n\t\t\t\t\tsubMesh = mesh.subMeshes[k];\n\t\t\t\t\tif (subMesh.subGeometry == particle.subGeometry) {\n\t\t\t\t\t\tanimationSubGeometry = (mesh.shareAnimationGeometry)? this._animationSubGeometries[subMesh.subGeometry.id] : this._animationSubGeometries[subMesh.id];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnumVertices = particle.numVertices;\n\t\t\t\tvertexData = animationSubGeometry.vertexData;\n\t\t\t\tvertexLength = numVertices*this._totalLenOfOneVertex;\n\t\t\t\tstartingOffset = animationSubGeometry.numProcessedVertices*this._totalLenOfOneVertex;\n\n\t\t\t\t//loop through each static local node in the animation set\n\t\t\t\tfor (k = 0; k < this._localStaticNodes.length; k++) {\n\t\t\t\t\tlocalNode = this._localStaticNodes[k];\n\t\t\t\t\toneData = localNode.oneData;\n\t\t\t\t\toneDataLen = localNode.dataLength;\n\t\t\t\t\toneDataOffset = startingOffset + localNode._iDataOffset;\n\n\t\t\t\t\t//loop through each vertex set in the vertex data\n\t\t\t\t\tfor (counterForVertex = 0; counterForVertex < vertexLength; counterForVertex += this._totalLenOfOneVertex) {\n\t\t\t\t\t\tvertexOffset = oneDataOffset + counterForVertex;\n\n\t\t\t\t\t\t//add the data for the local node to the vertex data\n\t\t\t\t\t\tfor (counterForOneData = 0; counterForOneData < oneDataLen; counterForOneData++)\n\t\t\t\t\t\t\tvertexData[vertexOffset + counterForOneData] = oneData[counterForOneData];\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t//store particle properties if they need to be retreived for dynamic local nodes\n\t\t\t\tif (this._localDynamicNodes.length)\n\t\t\t\t\tanimationSubGeometry.animationParticles.push(new ParticleAnimationData(i, particleProperties.startTime, particleProperties.duration, particleProperties.delay, particle));\n\n\t\t\t\tanimationSubGeometry.numProcessedVertices += numVertices;\n\n\t\t\t\t//next index\n\t\t\t\tj++;\n\t\t\t}\n\n\t\t\t//next particle\n\t\t\ti++;\n\t\t}\n\t}\n}\n\nexport = ParticleAnimationSet;",
    "import ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport SubGeometryBase\t\t\t\t\t= require(\"awayjs-core/lib/data/SubGeometryBase\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/pool/TriangleSubMeshRenderable\");\n\n/**\n * Provides an interface for assigning paricle-based animation data sets to mesh-based entity objects\n * and controlling the various available states of animation through an interative playhead that can be\n * automatically updated or manually triggered.\n *\n * Requires that the containing geometry of the parent mesh is particle geometry\n *\n * @see away.base.ParticleGeometry\n */\nclass ParticleAnimator extends AnimatorBase\n{\n\n\tprivate _particleAnimationSet:ParticleAnimationSet;\n\tprivate _animationParticleStates:Array<ParticleStateBase> = new Array<ParticleStateBase>();\n\tprivate _animatorParticleStates:Array<ParticleStateBase> = new Array<ParticleStateBase>();\n\tprivate _timeParticleStates:Array<ParticleStateBase> = new Array<ParticleStateBase>();\n\tprivate _totalLenOfOneVertex:number /*uint*/ = 0;\n\tprivate _animatorSubGeometries:Object = new Object();\n\n\t/**\n\t * Creates a new <code>ParticleAnimator</code> object.\n\t *\n\t * @param particleAnimationSet The animation data set containing the particle animations used by the animator.\n\t */\n\tconstructor(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tsuper(particleAnimationSet);\n\t\tthis._particleAnimationSet = particleAnimationSet;\n\n\t\tvar state:ParticleStateBase;\n\t\tvar node:ParticleNodeBase;\n\n\t\tfor (var i:number = 0; i < this._particleAnimationSet.particleNodes.length; i++) {\n\t\t\tnode = this._particleAnimationSet.particleNodes[i];\n\t\t\tstate = <ParticleStateBase> this.getAnimationState(node);\n\t\t\tif (node.mode == ParticlePropertiesMode.LOCAL_DYNAMIC) {\n\t\t\t\tthis._animatorParticleStates.push(state);\n\t\t\t\tnode._iDataOffset = this._totalLenOfOneVertex;\n\t\t\t\tthis._totalLenOfOneVertex += node.dataLength;\n\t\t\t} else {\n\t\t\t\tthis._animationParticleStates.push(state);\n\t\t\t}\n\t\t\tif (state.needUpdateTime)\n\t\t\t\tthis._timeParticleStates.push(state);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\treturn new ParticleAnimator(this._particleAnimationSet);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(shaderObject:ShaderObjectBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\tvar animationRegisterCache:AnimationRegisterCache = this._particleAnimationSet._iAnimationRegisterCache;\n\n\t\tvar subMesh:ISubMesh = (<TriangleSubMeshRenderable> renderable).subMesh;\n\t\tvar state:ParticleStateBase;\n\t\tvar i:number;\n\n\t\tif (!subMesh)\n\t\t\tthrow(new Error(\"Must be subMesh\"));\n\n\t\t//process animation sub geometries\n\t\tvar animationSubGeometry:AnimationSubGeometry = this._particleAnimationSet.getAnimationSubGeometry(subMesh);\n\n\t\tfor (i = 0; i < this._animationParticleStates.length; i++)\n\t\t\tthis._animationParticleStates[i].setRenderState(stage, renderable, animationSubGeometry, animationRegisterCache, camera);\n\n\t\t//process animator subgeometries\n\t\tvar animatorSubGeometry:AnimationSubGeometry = this.getAnimatorSubGeometry(subMesh);\n\n\t\tfor (i = 0; i < this._animatorParticleStates.length; i++)\n\t\t\tthis._animatorParticleStates[i].setRenderState(stage, renderable, animatorSubGeometry, animationRegisterCache, camera);\n\n\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, animationRegisterCache.vertexConstantOffset, animationRegisterCache.vertexConstantData, animationRegisterCache.numVertexConstant);\n\n\t\tif (animationRegisterCache.numFragmentConstant > 0)\n\t\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, animationRegisterCache.fragmentConstantOffset, animationRegisterCache.fragmentConstantData, animationRegisterCache.numFragmentConstant);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic testGPUCompatibility(shaderObject:ShaderObjectBase)\n\t{\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic start()\n\t{\n\t\tsuper.start();\n\n\t\tfor (var i:number = 0; i < this._timeParticleStates.length; i++)\n\t\t\tthis._timeParticleStates[i].offset(this._pAbsoluteTime);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tthis._pAbsoluteTime += dt;\n\n\t\tfor (var i:number = 0; i < this._timeParticleStates.length; i++)\n\t\t\tthis._timeParticleStates[i].update(this._pAbsoluteTime);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic resetTime(offset:number /*int*/ = 0)\n\t{\n\t\tfor (var i:number = 0; i < this._timeParticleStates.length; i++)\n\t\t\tthis._timeParticleStates[i].offset(this._pAbsoluteTime + offset);\n\t\tthis.update(this.time);\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var key in this._animatorSubGeometries)\n\t\t\t(<AnimationSubGeometry> this._animatorSubGeometries[key]).dispose();\n\t}\n\n\tprivate getAnimatorSubGeometry(subMesh:ISubMesh):AnimationSubGeometry\n\t{\n\t\tif (!this._animatorParticleStates.length)\n\t\t\treturn;\n\n\t\tvar subGeometry:SubGeometryBase = subMesh.subGeometry;\n\t\tvar animatorSubGeometry:AnimationSubGeometry = this._animatorSubGeometries[subGeometry.id] = new AnimationSubGeometry();\n\n\t\t//create the vertexData vector that will be used for local state data\n\t\tanimatorSubGeometry.createVertexData(subGeometry.numVertices, this._totalLenOfOneVertex);\n\n\t\t//pass the particles data to the animator subGeometry\n\t\tanimatorSubGeometry.animationParticles = this._particleAnimationSet.getAnimationSubGeometry(subMesh).animationParticles;\n\t}\n}\n\nexport = ParticleAnimator;",
    "import IAnimationSet\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\n\n/**\n * The animation data set used by skeleton-based animators, containing skeleton animation data.\n *\n * @see away.animators.SkeletonAnimator\n */\nclass SkeletonAnimationSet extends AnimationSetBase implements IAnimationSet\n{\n\tprivate _jointsPerVertex:number /*uint*/;\n\n\t/**\n\t * Returns the amount of skeleton joints that can be linked to a single vertex via skinned weight values. For GPU-base animation, the\n\t * maximum allowed value is 4.\n\t */\n\tpublic get jointsPerVertex():number /*uint*/\n\t{\n\t\treturn this._jointsPerVertex;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonAnimationSet</code> object.\n\t *\n\t * @param jointsPerVertex Sets the amount of skeleton joints that can be linked to a single vertex via skinned weight values. For GPU-base animation, the maximum allowed value is 4. Defaults to 4.\n\t */\n\tconstructor(jointsPerVertex:number /*uint*/ = 4)\n\t{\n\t\tsuper();\n\n\t\tthis._jointsPerVertex = jointsPerVertex;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\tvar len:number /*uint*/ = shaderObject.animatableAttributes.length;\n\n\t\tvar indexOffset0:number /*uint*/ = shaderObject.numUsedVertexConstants;\n\t\tvar indexOffset1:number /*uint*/ = indexOffset0 + 1;\n\t\tvar indexOffset2:number /*uint*/ = indexOffset0 + 2;\n\t\tvar indexStream:string = \"va\" + shaderObject.numUsedStreams;\n\t\tvar weightStream:string = \"va\" + (shaderObject.numUsedStreams + 1);\n\t\tvar indices:Array<string> = [ indexStream + \".x\", indexStream + \".y\", indexStream + \".z\", indexStream + \".w\" ];\n\t\tvar weights:Array<string> = [ weightStream + \".x\", weightStream + \".y\", weightStream + \".z\", weightStream + \".w\" ];\n\t\tvar temp1:string = this._pFindTempReg(shaderObject.animationTargetRegisters);\n\t\tvar temp2:string = this._pFindTempReg(shaderObject.animationTargetRegisters, temp1);\n\t\tvar dot:string = \"dp4\";\n\t\tvar code:string = \"\";\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\n\t\t\tvar src:string = shaderObject.animatableAttributes[i];\n\n\t\t\tfor (var j:number /*uint*/ = 0; j < this._jointsPerVertex; ++j) {\n\t\t\t\tcode += dot + \" \" + temp1 + \".x, \" + src + \", vc[\" + indices[j] + \"+\" + indexOffset0 + \"]\\n\" +\n\t\t\t\t\tdot + \" \" + temp1 + \".y, \" + src + \", vc[\" + indices[j] + \"+\" + indexOffset1 + \"]\\n\" +\n\t\t\t\t\tdot + \" \" + temp1 + \".z, \" + src + \", vc[\" + indices[j] + \"+\" + indexOffset2 + \"]\\n\" +\n\t\t\t\t\t\"mov \" + temp1 + \".w, \" + src + \".w\\n\" +\n\t\t\t\t\t\"mul \" + temp1 + \", \" + temp1 + \", \" + weights[j] + \"\\n\"; // apply weight\n\n\t\t\t\t// add or mov to target. Need to write to a temp reg first, because an output can be a target\n\t\t\t\tif (j == 0)\n\t\t\t\t\tcode += \"mov \" + temp2 + \", \" + temp1 + \"\\n\"; else\n\t\t\t\t\tcode += \"add \" + temp2 + \", \" + temp2 + \", \" + temp1 + \"\\n\";\n\t\t\t}\n\t\t\t// switch to dp3 once positions have been transformed, from now on, it should only be vectors instead of points\n\t\t\tdot = \"dp3\";\n\t\t\tcode += \"mov \" + shaderObject.animationTargetRegisters[i] + \", \" + temp2 + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shaderObject:ShaderObjectBase, stage:Stage)\n\t{\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shaderObject:ShaderObjectBase, stage:Stage)\n\t{\n//\t\t\tvar streamOffset:number /*uint*/ = pass.numUsedStreams;\n//\t\t\tvar context:IContextGL = <IContextGL> stage.context;\n//\t\t\tcontext.setVertexBufferAt(streamOffset, null);\n//\t\t\tcontext.setVertexBufferAt(streamOffset + 1, null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shaderObject:ShaderObjectBase, shadedTarget:string):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\treturn \"mov \" + shaderObject.uvTarget + \",\" + shaderObject.uvSource + \"\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shaderObject:ShaderObjectBase)\n\t{\n\n\t}\n}\n\nexport = SkeletonAnimationSet;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport TriangleSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport SubGeometryEvent\t\t\t\t\t= require(\"awayjs-core/lib/events/SubGeometryEvent\");\n\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport SkeletonAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimationSet\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonJoint\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonJoint\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\nimport IAnimationTransition\t\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/IAnimationTransition\");\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/pool/TriangleSubMeshRenderable\");\n\n/**\n * Provides an interface for assigning skeleton-based animation data sets to mesh-based entity objects\n * and controlling the various available states of animation through an interative playhead that can be\n * automatically updated or manually triggered.\n */\nclass SkeletonAnimator extends AnimatorBase\n{\n\tprivate _globalMatrices:Array<number>;\n\tprivate _globalPose:SkeletonPose = new SkeletonPose();\n\tprivate _globalPropertiesDirty:boolean;\n\tprivate _numJoints:number /*uint*/;\n\tprivate _morphedSubGeometry:Object = new Object();\n\tprivate _morphedSubGeometryDirty:Object = new Object();\n\tprivate _condensedMatrices:Array<number>;\n\n\tprivate _skeleton:Skeleton;\n\tprivate _forceCPU:boolean;\n\tprivate _useCondensedIndices:boolean;\n\tprivate _jointsPerVertex:number /*uint*/;\n\tprivate _activeSkeletonState:ISkeletonAnimationState;\n\tprivate _onTransitionCompleteDelegate:(event:AnimationStateEvent) => void;\n\n\tprivate _onIndicesUpdateDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onVerticesUpdateDelegate:(event:SubGeometryEvent) => void;\n\n\t/**\n\t * returns the calculated global matrices of the current skeleton pose.\n\t *\n\t * @see #globalPose\n\t */\n\tpublic get globalMatrices():Array<number>\n\t{\n\t\tif (this._globalPropertiesDirty)\n\t\t\tthis.updateGlobalProperties();\n\n\t\treturn this._globalMatrices;\n\t}\n\n\t/**\n\t * returns the current skeleton pose output from the animator.\n\t *\n\t * @see away.animators.data.SkeletonPose\n\t */\n\tpublic get globalPose():SkeletonPose\n\t{\n\t\tif (this._globalPropertiesDirty)\n\t\t\tthis.updateGlobalProperties();\n\n\t\treturn this._globalPose;\n\t}\n\n\t/**\n\t * Returns the skeleton object in use by the animator - this defines the number and heirarchy of joints used by the\n\t * skinned geoemtry to which skeleon animator is applied.\n\t */\n\tpublic get skeleton():Skeleton\n\t{\n\t\treturn this._skeleton;\n\t}\n\n\t/**\n\t * Indicates whether the skeleton animator is disabled by default for GPU rendering, something that allows the animator to perform calculation on the GPU.\n\t * Defaults to false.\n\t */\n\tpublic get forceCPU():boolean\n\t{\n\t\treturn this._forceCPU;\n\t}\n\n\t/**\n\t * Offers the option of enabling GPU accelerated animation on skeletons larger than 32 joints\n\t * by condensing the number of joint index values required per mesh. Only applicable to\n\t * skeleton animations that utilise more than one mesh object. Defaults to false.\n\t */\n\tpublic get useCondensedIndices():boolean\n\t{\n\t\treturn this._useCondensedIndices;\n\t}\n\n\tpublic set useCondensedIndices(value:boolean)\n\t{\n\t\tthis._useCondensedIndices = value;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonAnimator</code> object.\n\t *\n\t * @param skeletonAnimationSet The animation data set containing the skeleton animations used by the animator.\n\t * @param skeleton The skeleton object used for calculating the resulting global matrices for transforming skinned mesh data.\n\t * @param forceCPU Optional value that only allows the animator to perform calculation on the CPU. Defaults to false.\n\t */\n\tconstructor(animationSet:SkeletonAnimationSet, skeleton:Skeleton, forceCPU:boolean = false)\n\t{\n\t\tsuper(animationSet);\n\n\t\tthis._skeleton = skeleton;\n\t\tthis._forceCPU = forceCPU;\n\t\tthis._jointsPerVertex = animationSet.jointsPerVertex;\n\n\t\tthis._numJoints = this._skeleton.numJoints;\n\t\tthis._globalMatrices = new Array<number>(this._numJoints*12);\n\n\t\tvar j:number /*int*/ = 0;\n\t\tfor (var i:number /*uint*/ = 0; i < this._numJoints; ++i) {\n\t\t\tthis._globalMatrices[j++] = 1;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 1;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 1;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t}\n\n\t\tthis._onTransitionCompleteDelegate = (event:AnimationStateEvent) => this.onTransitionComplete(event);\n\t\tthis._onIndicesUpdateDelegate = (event:SubGeometryEvent) => this.onIndicesUpdate(event);\n\t\tthis._onVerticesUpdateDelegate = (event:SubGeometryEvent) => this.onVerticesUpdate(event);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\t/* The cast to SkeletonAnimationSet should never fail, as _animationSet can only be set\n\t\t through the constructor, which will only accept a SkeletonAnimationSet. */\n\t\treturn new SkeletonAnimator(<SkeletonAnimationSet> this._pAnimationSet, this._skeleton, this._forceCPU);\n\t}\n\n\t/**\n\t * Plays an animation state registered with the given name in the animation data set.\n\t *\n\t * @param name The data set name of the animation state to be played.\n\t * @param transition An optional transition object that determines how the animator will transition from the currently active animation state.\n\t * @param offset An option offset time (in milliseconds) that resets the state's internal clock to the absolute time of the animator plus the offset value. Required for non-looping animation states.\n\t */\n\tpublic play(name:string, transition:IAnimationTransition = null, offset:number = NaN)\n\t{\n\t\tif (this._pActiveAnimationName == name)\n\t\t\treturn;\n\n\t\tthis._pActiveAnimationName = name;\n\n\t\tif (!this._pAnimationSet.hasAnimation(name))\n\t\t\tthrow new Error(\"Animation root node \" + name + \" not found!\");\n\n\t\tif (transition && this._pActiveNode) {\n\t\t\t//setup the transition\n\t\t\tthis._pActiveNode = transition.getAnimationNode(this, this._pActiveNode, this._pAnimationSet.getAnimation(name), this._pAbsoluteTime);\n\t\t\tthis._pActiveNode.addEventListener(AnimationStateEvent.TRANSITION_COMPLETE, this._onTransitionCompleteDelegate);\n\t\t} else\n\t\t\tthis._pActiveNode = this._pAnimationSet.getAnimation(name);\n\n\t\tthis._pActiveState = this.getAnimationState(this._pActiveNode);\n\n\t\tif (this.updatePosition) {\n\t\t\t//update straight away to reset position deltas\n\t\t\tthis._pActiveState.update(this._pAbsoluteTime);\n\t\t\tthis._pActiveState.positionDelta;\n\t\t}\n\n\t\tthis._activeSkeletonState = <ISkeletonAnimationState> this._pActiveState;\n\n\t\tthis.start();\n\n\t\t//apply a time offset if specified\n\t\tif (!isNaN(offset))\n\t\t\tthis.reset(name, offset);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(shaderObject:ShaderObjectBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\t// do on request of globalProperties\n\t\tif (this._globalPropertiesDirty)\n\t\t\tthis.updateGlobalProperties();\n\n\t\tvar subGeometry:TriangleSubGeometry = <TriangleSubGeometry> (<TriangleSubMesh> (<TriangleSubMeshRenderable> renderable).subMesh).subGeometry;\n\n\t\tsubGeometry.useCondensedIndices = this._useCondensedIndices;\n\n\t\tif (this._useCondensedIndices) {\n\t\t\t// using a condensed data set\n\t\t\tthis.updateCondensedMatrices(subGeometry.condensedIndexLookUp, subGeometry.numCondensedJoints);\n\t\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._condensedMatrices, subGeometry.numCondensedJoints*3);\n\t\t} else {\n\t\t\tif (this._pAnimationSet.usesCPU) {\n\t\t\t\tif (this._morphedSubGeometryDirty[subGeometry.id])\n\t\t\t\t\tthis.morphSubGeometry(<TriangleSubMeshRenderable> renderable, subGeometry);\n\n\t\t\t\treturn\n\t\t\t}\n\t\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._globalMatrices, this._numJoints*3);\n\t\t}\n\n\t\tstage.activateBuffer(vertexStreamOffset, renderable.getVertexData(TriangleSubGeometry.JOINT_INDEX_DATA), renderable.getVertexOffset(TriangleSubGeometry.JOINT_INDEX_DATA), renderable.JOINT_INDEX_FORMAT);\n\t\tstage.activateBuffer(vertexStreamOffset + 1, renderable.getVertexData(TriangleSubGeometry.JOINT_WEIGHT_DATA), renderable.getVertexOffset(TriangleSubGeometry.JOINT_WEIGHT_DATA), renderable.JOINT_WEIGHT_FORMAT);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic testGPUCompatibility(shaderObject:ShaderObjectBase)\n\t{\n\t\tif (!this._useCondensedIndices && (this._forceCPU || this._jointsPerVertex > 4 || shaderObject.numUsedVertexConstants + this._numJoints*3 > 128))\n\t\t\tthis._pAnimationSet.cancelGPUCompatibility();\n\t}\n\n\t/**\n\t * Applies the calculated time delta to the active animation state node or state transition object.\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tsuper._pUpdateDeltaTime(dt);\n\n\t\t//invalidate pose matrices\n\t\tthis._globalPropertiesDirty = true;\n\n\t\t//trigger geometry invalidation if using CPU animation\n\t\tif (this._pAnimationSet.usesCPU)\n\t\t\tfor (var key in this._morphedSubGeometryDirty)\n\t\t\t\tthis._morphedSubGeometryDirty[key] = true;\n\t}\n\n\tprivate updateCondensedMatrices(condensedIndexLookUp:Array<number> /*uint*/, numJoints:number /*uint*/)\n\t{\n\t\tvar i:number /*uint*/ = 0, j:number /*uint*/ = 0;\n\t\tvar len:number /*uint*/;\n\t\tvar srcIndex:number /*uint*/;\n\n\t\tthis._condensedMatrices = new Array<number>();\n\n\t\tdo {\n\t\t\tsrcIndex = condensedIndexLookUp[i]*4;\n\t\t\tlen = srcIndex + 12;\n\t\t\t// copy into condensed\n\t\t\twhile (srcIndex < len)\n\t\t\t\tthis._condensedMatrices[j++] = this._globalMatrices[srcIndex++];\n\t\t} while (++i < numJoints);\n\t}\n\n\tprivate updateGlobalProperties()\n\t{\n\t\tthis._globalPropertiesDirty = false;\n\n\t\t//get global pose\n\t\tthis.localToGlobalPose(this._activeSkeletonState.getSkeletonPose(this._skeleton), this._globalPose, this._skeleton);\n\n\t\t// convert pose to matrix\n\t\tvar mtxOffset:number /*uint*/ = 0;\n\t\tvar globalPoses:Array<JointPose> = this._globalPose.jointPoses;\n\t\tvar raw:Array<number>;\n\t\tvar ox:number, oy:number, oz:number, ow:number;\n\t\tvar xy2:number, xz2:number, xw2:number;\n\t\tvar yz2:number, yw2:number, zw2:number;\n\t\tvar n11:number, n12:number, n13:number;\n\t\tvar n21:number, n22:number, n23:number;\n\t\tvar n31:number, n32:number, n33:number;\n\t\tvar m11:number, m12:number, m13:number, m14:number;\n\t\tvar m21:number, m22:number, m23:number, m24:number;\n\t\tvar m31:number, m32:number, m33:number, m34:number;\n\t\tvar joints:Array<SkeletonJoint> = this._skeleton.joints;\n\t\tvar pose:JointPose;\n\t\tvar quat:Quaternion;\n\t\tvar vec:Vector3D;\n\t\tvar t:number;\n\n\t\tfor (var i:number /*uint*/ = 0; i < this._numJoints; ++i) {\n\t\t\tpose = globalPoses[i];\n\t\t\tquat = pose.orientation;\n\t\t\tvec = pose.translation;\n\t\t\tox = quat.x;\n\t\t\toy = quat.y;\n\t\t\toz = quat.z;\n\t\t\tow = quat.w;\n\n\t\t\txy2 = (t = 2.0*ox)*oy;\n\t\t\txz2 = t*oz;\n\t\t\txw2 = t*ow;\n\t\t\tyz2 = (t = 2.0*oy)*oz;\n\t\t\tyw2 = t*ow;\n\t\t\tzw2 = 2.0*oz*ow;\n\n\t\t\tyz2 = 2.0*oy*oz;\n\t\t\tyw2 = 2.0*oy*ow;\n\t\t\tzw2 = 2.0*oz*ow;\n\t\t\tox *= ox;\n\t\t\toy *= oy;\n\t\t\toz *= oz;\n\t\t\tow *= ow;\n\n\t\t\tn11 = (t = ox - oy) - oz + ow;\n\t\t\tn12 = xy2 - zw2;\n\t\t\tn13 = xz2 + yw2;\n\t\t\tn21 = xy2 + zw2;\n\t\t\tn22 = -t - oz + ow;\n\t\t\tn23 = yz2 - xw2;\n\t\t\tn31 = xz2 - yw2;\n\t\t\tn32 = yz2 + xw2;\n\t\t\tn33 = -ox - oy + oz + ow;\n\n\t\t\t// prepend inverse bind pose\n\t\t\traw = joints[i].inverseBindPose;\n\t\t\tm11 = raw[0];\n\t\t\tm12 = raw[4];\n\t\t\tm13 = raw[8];\n\t\t\tm14 = raw[12];\n\t\t\tm21 = raw[1];\n\t\t\tm22 = raw[5];\n\t\t\tm23 = raw[9];\n\t\t\tm24 = raw[13];\n\t\t\tm31 = raw[2];\n\t\t\tm32 = raw[6];\n\t\t\tm33 = raw[10];\n\t\t\tm34 = raw[14];\n\n\t\t\tthis._globalMatrices[mtxOffset] = n11*m11 + n12*m21 + n13*m31;\n\t\t\tthis._globalMatrices[mtxOffset + 1] = n11*m12 + n12*m22 + n13*m32;\n\t\t\tthis._globalMatrices[mtxOffset + 2] = n11*m13 + n12*m23 + n13*m33;\n\t\t\tthis._globalMatrices[mtxOffset + 3] = n11*m14 + n12*m24 + n13*m34 + vec.x;\n\t\t\tthis._globalMatrices[mtxOffset + 4] = n21*m11 + n22*m21 + n23*m31;\n\t\t\tthis._globalMatrices[mtxOffset + 5] = n21*m12 + n22*m22 + n23*m32;\n\t\t\tthis._globalMatrices[mtxOffset + 6] = n21*m13 + n22*m23 + n23*m33;\n\t\t\tthis._globalMatrices[mtxOffset + 7] = n21*m14 + n22*m24 + n23*m34 + vec.y;\n\t\t\tthis._globalMatrices[mtxOffset + 8] = n31*m11 + n32*m21 + n33*m31;\n\t\t\tthis._globalMatrices[mtxOffset + 9] = n31*m12 + n32*m22 + n33*m32;\n\t\t\tthis._globalMatrices[mtxOffset + 10] = n31*m13 + n32*m23 + n33*m33;\n\t\t\tthis._globalMatrices[mtxOffset + 11] = n31*m14 + n32*m24 + n33*m34 + vec.z;\n\n\t\t\tmtxOffset = mtxOffset + 12;\n\t\t}\n\t}\n\n\n\tpublic getRenderableSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry):TriangleSubGeometry\n\t{\n\t\tthis._morphedSubGeometryDirty[sourceSubGeometry.id] = true;\n\n\t\t//early out for GPU animations\n\t\tif (!this._pAnimationSet.usesCPU)\n\t\t\treturn sourceSubGeometry;\n\n\t\tvar targetSubGeometry:TriangleSubGeometry;\n\n\t\tif (!(targetSubGeometry = this._morphedSubGeometry[sourceSubGeometry.id])) {\n\t\t\t//not yet stored\n\t\t\ttargetSubGeometry = this._morphedSubGeometry[sourceSubGeometry.id] = sourceSubGeometry.clone();\n\t\t\t//turn off auto calculations on the morphed geometry\n\t\t\ttargetSubGeometry.autoDeriveNormals = false;\n\t\t\ttargetSubGeometry.autoDeriveTangents = false;\n\t\t\ttargetSubGeometry.autoDeriveUVs = false;\n\t\t\t//add event listeners for any changes in UV values on the source geometry\n\t\t\tsourceSubGeometry.addEventListener(SubGeometryEvent.INDICES_UPDATED, this._onIndicesUpdateDelegate);\n\t\t\tsourceSubGeometry.addEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdateDelegate);\n\t\t}\n\n\t\treturn targetSubGeometry;\n\t}\n\n\t/**\n\t * If the animation can't be performed on GPU, transform vertices manually\n\t * @param subGeom The subgeometry containing the weights and joint index data per vertex.\n\t * @param pass The material pass for which we need to transform the vertices\n\t */\n\tpublic morphSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry)\n\t{\n\t\tthis._morphedSubGeometryDirty[sourceSubGeometry.id] = false;\n\n\t\tvar sourcePositions:Array<number> = sourceSubGeometry.positions;\n\t\tvar sourceNormals:Array<number> = sourceSubGeometry.vertexNormals;\n\t\tvar sourceTangents:Array<number> = sourceSubGeometry.vertexTangents;\n\n\t\tvar jointIndices:Array<number> = sourceSubGeometry.jointIndices;\n\t\tvar jointWeights:Array<number> = sourceSubGeometry.jointWeights;\n\n\t\tvar targetSubGeometry = this._morphedSubGeometry[sourceSubGeometry.id];\n\n\t\tvar targetPositions:Array<number> = targetSubGeometry.positions;\n\t\tvar targetNormals:Array<number> = targetSubGeometry.vertexNormals;\n\t\tvar targetTangents:Array<number> = targetSubGeometry.vertexTangents;\n\n\t\tvar index:number /*uint*/ = 0;\n\t\tvar j:number /*uint*/ = 0;\n\t\tvar k:number /*uint*/;\n\t\tvar vx:number, vy:number, vz:number;\n\t\tvar nx:number, ny:number, nz:number;\n\t\tvar tx:number, ty:number, tz:number;\n\t\tvar len:number /*int*/ = sourcePositions.length;\n\t\tvar weight:number;\n\t\tvar vertX:number, vertY:number, vertZ:number;\n\t\tvar normX:number, normY:number, normZ:number;\n\t\tvar tangX:number, tangY:number, tangZ:number;\n\t\tvar m11:number, m12:number, m13:number, m14:number;\n\t\tvar m21:number, m22:number, m23:number, m24:number;\n\t\tvar m31:number, m32:number, m33:number, m34:number;\n\n\t\twhile (index < len) {\n\t\t\tvertX = sourcePositions[index];\n\t\t\tvertY = sourcePositions[index + 1];\n\t\t\tvertZ = sourcePositions[index + 2];\n\t\t\tnormX = sourceNormals[index];\n\t\t\tnormY = sourceNormals[index + 1];\n\t\t\tnormZ = sourceNormals[index + 2];\n\t\t\ttangX = sourceTangents[index];\n\t\t\ttangY = sourceTangents[index + 1];\n\t\t\ttangZ = sourceTangents[index + 2];\n\t\t\tvx = 0;\n\t\t\tvy = 0;\n\t\t\tvz = 0;\n\t\t\tnx = 0;\n\t\t\tny = 0;\n\t\t\tnz = 0;\n\t\t\ttx = 0;\n\t\t\tty = 0;\n\t\t\ttz = 0;\n\t\t\tk = 0;\n\t\t\twhile (k < this._jointsPerVertex) {\n\t\t\t\tweight = jointWeights[j];\n\t\t\t\tif (weight > 0) {\n\t\t\t\t\t// implicit /3*12 (/3 because indices are multiplied by 3 for gpu matrix access, *12 because it's the matrix size)\n\t\t\t\t\tvar mtxOffset:number /*uint*/ = jointIndices[j++] << 2;\n\t\t\t\t\tm11 = this._globalMatrices[mtxOffset];\n\t\t\t\t\tm12 = this._globalMatrices[mtxOffset + 1];\n\t\t\t\t\tm13 = this._globalMatrices[mtxOffset + 2];\n\t\t\t\t\tm14 = this._globalMatrices[mtxOffset + 3];\n\t\t\t\t\tm21 = this._globalMatrices[mtxOffset + 4];\n\t\t\t\t\tm22 = this._globalMatrices[mtxOffset + 5];\n\t\t\t\t\tm23 = this._globalMatrices[mtxOffset + 6];\n\t\t\t\t\tm24 = this._globalMatrices[mtxOffset + 7];\n\t\t\t\t\tm31 = this._globalMatrices[mtxOffset + 8];\n\t\t\t\t\tm32 = this._globalMatrices[mtxOffset + 9];\n\t\t\t\t\tm33 = this._globalMatrices[mtxOffset + 10];\n\t\t\t\t\tm34 = this._globalMatrices[mtxOffset + 11];\n\t\t\t\t\tvx += weight*(m11*vertX + m12*vertY + m13*vertZ + m14);\n\t\t\t\t\tvy += weight*(m21*vertX + m22*vertY + m23*vertZ + m24);\n\t\t\t\t\tvz += weight*(m31*vertX + m32*vertY + m33*vertZ + m34);\n\t\t\t\t\tnx += weight*(m11*normX + m12*normY + m13*normZ);\n\t\t\t\t\tny += weight*(m21*normX + m22*normY + m23*normZ);\n\t\t\t\t\tnz += weight*(m31*normX + m32*normY + m33*normZ);\n\t\t\t\t\ttx += weight*(m11*tangX + m12*tangY + m13*tangZ);\n\t\t\t\t\tty += weight*(m21*tangX + m22*tangY + m23*tangZ);\n\t\t\t\t\ttz += weight*(m31*tangX + m32*tangY + m33*tangZ);\n\t\t\t\t\t++k;\n\t\t\t\t} else {\n\t\t\t\t\tj += (this._jointsPerVertex - k);\n\t\t\t\t\tk = this._jointsPerVertex;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttargetPositions[index] = vx;\n\t\t\ttargetPositions[index + 1] = vy;\n\t\t\ttargetPositions[index + 2] = vz;\n\t\t\ttargetNormals[index] = nx;\n\t\t\ttargetNormals[index + 1] = ny;\n\t\t\ttargetNormals[index + 2] = nz;\n\t\t\ttargetTangents[index] = tx;\n\t\t\ttargetTangents[index + 1] = ty;\n\t\t\ttargetTangents[index + 2] = tz;\n\n\t\t\tindex += 3;\n\t\t}\n\n\t\ttargetSubGeometry.updatePositions(targetPositions);\n\t\ttargetSubGeometry.updateVertexNormals(targetNormals);\n\t\ttargetSubGeometry.updateVertexTangents(targetTangents);\n\t}\n\n\t/**\n\t * Converts a local hierarchical skeleton pose to a global pose\n\t * @param targetPose The SkeletonPose object that will contain the global pose.\n\t * @param skeleton The skeleton containing the joints, and as such, the hierarchical data to transform to global poses.\n\t */\n\tprivate localToGlobalPose(sourcePose:SkeletonPose, targetPose:SkeletonPose, skeleton:Skeleton)\n\t{\n\t\tvar globalPoses:Array<JointPose> = targetPose.jointPoses;\n\t\tvar globalJointPose:JointPose;\n\t\tvar joints:Array<SkeletonJoint> = skeleton.joints;\n\t\tvar len:number /*uint*/ = sourcePose.numJointPoses;\n\t\tvar jointPoses:Array<JointPose> = sourcePose.jointPoses;\n\t\tvar parentIndex:number /*int*/;\n\t\tvar joint:SkeletonJoint;\n\t\tvar parentPose:JointPose;\n\t\tvar pose:JointPose;\n\t\tvar or:Quaternion;\n\t\tvar tr:Vector3D;\n\t\tvar t:Vector3D;\n\t\tvar q:Quaternion;\n\n\t\tvar x1:number, y1:number, z1:number, w1:number;\n\t\tvar x2:number, y2:number, z2:number, w2:number;\n\t\tvar x3:number, y3:number, z3:number;\n\n\t\t// :s\n\t\tif (globalPoses.length != len)\n\t\t\tglobalPoses.length = len;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tglobalJointPose = globalPoses[i];\n\n\t\t\tif (globalJointPose == null)\n\t\t\t\tglobalJointPose = globalPoses[i] = new JointPose();\n\n\t\t\tjoint = joints[i];\n\t\t\tparentIndex = joint.parentIndex;\n\t\t\tpose = jointPoses[i];\n\n\t\t\tq = globalJointPose.orientation;\n\t\t\tt = globalJointPose.translation;\n\n\t\t\tif (parentIndex < 0) {\n\t\t\t\ttr = pose.translation;\n\t\t\t\tor = pose.orientation;\n\t\t\t\tq.x = or.x;\n\t\t\t\tq.y = or.y;\n\t\t\t\tq.z = or.z;\n\t\t\t\tq.w = or.w;\n\t\t\t\tt.x = tr.x;\n\t\t\t\tt.y = tr.y;\n\t\t\t\tt.z = tr.z;\n\t\t\t} else {\n\t\t\t\t// append parent pose\n\t\t\t\tparentPose = globalPoses[parentIndex];\n\n\t\t\t\t// rotate point\n\t\t\t\tor = parentPose.orientation;\n\t\t\t\ttr = pose.translation;\n\t\t\t\tx2 = or.x;\n\t\t\t\ty2 = or.y;\n\t\t\t\tz2 = or.z;\n\t\t\t\tw2 = or.w;\n\t\t\t\tx3 = tr.x;\n\t\t\t\ty3 = tr.y;\n\t\t\t\tz3 = tr.z;\n\n\t\t\t\tw1 = -x2*x3 - y2*y3 - z2*z3;\n\t\t\t\tx1 = w2*x3 + y2*z3 - z2*y3;\n\t\t\t\ty1 = w2*y3 - x2*z3 + z2*x3;\n\t\t\t\tz1 = w2*z3 + x2*y3 - y2*x3;\n\n\t\t\t\t// append parent translation\n\t\t\t\ttr = parentPose.translation;\n\t\t\t\tt.x = -w1*x2 + x1*w2 - y1*z2 + z1*y2 + tr.x;\n\t\t\t\tt.y = -w1*y2 + x1*z2 + y1*w2 - z1*x2 + tr.y;\n\t\t\t\tt.z = -w1*z2 - x1*y2 + y1*x2 + z1*w2 + tr.z;\n\n\t\t\t\t// append parent orientation\n\t\t\t\tx1 = or.x;\n\t\t\t\ty1 = or.y;\n\t\t\t\tz1 = or.z;\n\t\t\t\tw1 = or.w;\n\t\t\t\tor = pose.orientation;\n\t\t\t\tx2 = or.x;\n\t\t\t\ty2 = or.y;\n\t\t\t\tz2 = or.z;\n\t\t\t\tw2 = or.w;\n\n\t\t\t\tq.w = w1*w2 - x1*x2 - y1*y2 - z1*z2;\n\t\t\t\tq.x = w1*x2 + x1*w2 + y1*z2 - z1*y2;\n\t\t\t\tq.y = w1*y2 - x1*z2 + y1*w2 + z1*x2;\n\t\t\t\tq.z = w1*z2 + x1*y2 - y1*x2 + z1*w2;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onTransitionComplete(event:AnimationStateEvent)\n\t{\n\t\tif (event.type == AnimationStateEvent.TRANSITION_COMPLETE) {\n\t\t\tevent.animationNode.removeEventListener(AnimationStateEvent.TRANSITION_COMPLETE, this._onTransitionCompleteDelegate);\n\t\t\t//if this is the current active state transition, revert control to the active node\n\t\t\tif (this._pActiveState == event.animationState) {\n\t\t\t\tthis._pActiveNode = this._pAnimationSet.getAnimation(this._pActiveAnimationName);\n\t\t\t\tthis._pActiveState = this.getAnimationState(this._pActiveNode);\n\t\t\t\tthis._activeSkeletonState = <ISkeletonAnimationState> this._pActiveState;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onIndicesUpdate(event:SubGeometryEvent)\n\t{\n\t\tvar subGeometry:TriangleSubGeometry = <TriangleSubGeometry> event.target;\n\n\t\t(<TriangleSubGeometry> this._morphedSubGeometry[subGeometry.id]).updateIndices(subGeometry.indices);\n\t}\n\n\tprivate onVerticesUpdate(event:SubGeometryEvent)\n\t{\n\t\tvar subGeometry:TriangleSubGeometry = <TriangleSubGeometry> event.target;\n\t\tvar morphGeometry:TriangleSubGeometry = <TriangleSubGeometry> this._morphedSubGeometry[subGeometry.id];\n\n\t\tswitch(event.dataType) {\n\t\t\tcase TriangleSubGeometry.UV_DATA:\n\t\t\t\tmorphGeometry.updateUVs(subGeometry.uvs);\n\t\t\tcase TriangleSubGeometry.SECONDARY_UV_DATA:\n\t\t\t\tmorphGeometry.updateUVs(subGeometry.secondaryUVs);\n\t\t}\n\t}\n}\n\nexport = SkeletonAnimator;",
    "import IAnimationSet\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport VertexAnimationMode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/VertexAnimationMode\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\n\n/**\n * The animation data set used by vertex-based animators, containing vertex animation state data.\n *\n * @see VertexAnimator\n */\nclass VertexAnimationSet extends AnimationSetBase implements IAnimationSet\n{\n\tprivate _numPoses:number /*uint*/;\n\tprivate _blendMode:string;\n\n\t/**\n\t * Returns the number of poses made available at once to the GPU animation code.\n\t */\n\tpublic get numPoses():number /*uint*/\n\t{\n\t\treturn this._numPoses;\n\t}\n\n\t/**\n\t * Returns the active blend mode of the vertex animator object.\n\t */\n\tpublic get blendMode():string\n\t{\n\t\treturn this._blendMode;\n\t}\n\n\t/**\n\t * Returns whether or not normal data is used in last set GPU pass of the vertex shader.\n\t */\n//\t\tpublic get useNormals():boolean\n//\t\t{\n//\t\t\treturn this._uploadNormals;\n//\t\t}\n\n\t/**\n\t * Creates a new <code>VertexAnimationSet</code> object.\n\t *\n\t * @param numPoses The number of poses made available at once to the GPU animation code.\n\t * @param blendMode Optional value for setting the animation mode of the vertex animator object.\n\t *\n\t * @see away3d.animators.data.VertexAnimationMode\n\t */\n\tconstructor(numPoses:number /*uint*/ = 2, blendMode:string = \"absolute\")\n\t{\n\t\tsuper();\n\t\tthis._numPoses = numPoses;\n\t\tthis._blendMode = blendMode;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE)\n\t\t\treturn this.getAbsoluteAGALCode(shaderObject);\n\t\telse\n\t\t\treturn this.getAdditiveAGALCode(shaderObject);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shaderObject:ShaderObjectBase, stage:Stage)\n\t{\n//\t\t\tvar uID:number = pass._iUniqueId;\n//\t\t\tthis._uploadNormals = <boolean> this._useNormals[uID];\n//\t\t\tthis._uploadTangents = <boolean> this._useTangents[uID];\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shaderObject:ShaderObjectBase, stage:Stage)\n\t{\n//\t\t\tvar uID:number = pass._iUniqueId;\n//\t\t\tvar index:number /*uint*/ = this._streamIndices[uID];\n//\t\t\tvar context:IContextGL = <IContextGL> stage.context;\n//\t\t\tcontext.setVertexBufferAt(index, null);\n//\t\t\tif (this._uploadNormals)\n//\t\t\t\tcontext.setVertexBufferAt(index + 1, null);\n//\t\t\tif (this._uploadTangents)\n//\t\t\t\tcontext.setVertexBufferAt(index + 2, null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shaderObject:ShaderObjectBase, shadedTarget:string):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\treturn \"mov \" + shaderObject.uvTarget + \",\" + shaderObject.uvSource + \"\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shaderObject:ShaderObjectBase)\n\t{\n\n\t}\n\n\t/**\n\t * Generates the vertex AGAL code for absolute blending.\n\t */\n\tprivate getAbsoluteAGALCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar temp1:string = this._pFindTempReg(shaderObject.animationTargetRegisters);\n\t\tvar temp2:string = this._pFindTempReg(shaderObject.animationTargetRegisters, temp1);\n\t\tvar regs:Array<string> = new Array<string>(\"x\", \"y\", \"z\", \"w\");\n\t\tvar len:number /*uint*/ = shaderObject.animatableAttributes.length;\n\t\tvar constantReg:string = \"vc\" + shaderObject.numUsedVertexConstants;\n\n\t\tif (len > 2)\n\t\t\tlen = 2;\n\t\tvar streamIndex:number /*uint*/ = shaderObject.numUsedStreams;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tcode += \"mul \" + temp1 + \", \" + shaderObject.animatableAttributes[i] + \", \" + constantReg + \".\" + regs[0] + \"\\n\";\n\n\t\t\tfor (var j:number /*uint*/ = 1; j < this._numPoses; ++j) {\n\t\t\t\tcode += \"mul \" + temp2 + \", va\" + streamIndex + \", \" + constantReg + \".\" + regs[j] + \"\\n\";\n\n\t\t\t\tif (j < this._numPoses - 1)\n\t\t\t\t\tcode += \"add \" + temp1 + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\t\t\t++streamIndex;\n\t\t\t}\n\n\t\t\tcode += \"add \" + shaderObject.animationTargetRegisters[i] + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\t\t}\n\n\t\t// add code for bitangents if tangents are used\n\t\tif (shaderObject.tangentDependencies > 0 || shaderObject.outputsNormals) {\n\t\t\tcode += \"dp3 \" + temp1 + \".x, \" + shaderObject.animatableAttributes[2] + \", \" + shaderObject.animationTargetRegisters[1] + \"\\n\" +\n\t\t\t\t\"mul \" + temp1 + \", \" + shaderObject.animationTargetRegisters[1] + \", \" + temp1 + \".x\\n\" +\n\t\t\t\t\"sub \" + shaderObject.animationTargetRegisters[2] + \", \" + shaderObject.animationTargetRegisters[2] + \", \" + temp1 + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * Generates the vertex AGAL code for additive blending.\n\t */\n\tprivate getAdditiveAGALCode(shaderObject:ShaderObjectBase):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar len:number /*uint*/ = shaderObject.animatableAttributes.length;\n\t\tvar regs:Array<string> = [\"x\", \"y\", \"z\", \"w\"];\n\t\tvar temp1:string = this._pFindTempReg(shaderObject.animationTargetRegisters);\n\t\tvar k:number /*uint*/;\n\n\t\tvar streamIndex:number /*uint*/ = shaderObject.numUsedStreams;\n\n\t\tif (len > 2)\n\t\t\tlen = 2;\n\n\t\tcode += \"mov  \" + shaderObject.animationTargetRegisters[0] + \", \" + shaderObject.animatableAttributes[0] + \"\\n\";\n\t\tif (shaderObject.normalDependencies > 0)\n\t\t\tcode += \"mov \" + shaderObject.animationTargetRegisters[1] + \", \" + shaderObject.animatableAttributes[1] + \"\\n\";\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tfor (var j:number /*uint*/ = 0; j < this._numPoses; ++j) {\n\t\t\t\tcode += \"mul \" + temp1 + \", va\" + (streamIndex + k) + \", vc\" + shaderObject.numUsedVertexConstants + \".\" + regs[j] + \"\\n\" +\n\t\t\t\t\t\"add \" + shaderObject.animationTargetRegisters[i] + \", \" + shaderObject.animationTargetRegisters[i] + \", \" + temp1 + \"\\n\";\n\t\t\t\tk++;\n\t\t\t}\n\t\t}\n\n\t\tif (shaderObject.tangentDependencies > 0 || shaderObject.outputsNormals) {\n\t\t\tcode += \"dp3 \" + temp1 + \".x, \" + shaderObject.animatableAttributes[2] + \", \" + shaderObject.animationTargetRegisters[1] + \"\\n\" +\n\t\t\t\t\"mul \" + temp1 + \", \" + shaderObject.animationTargetRegisters[1] + \", \" + temp1 + \".x\\n\" +\n\t\t\t\t\"sub \" + shaderObject.animationTargetRegisters[2] + \", \" + shaderObject.animatableAttributes[2] + \", \" + temp1 + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n}\n\nexport = VertexAnimationSet;",
    "import Geometry\t\t\t\t\t\t\t= require(\"awayjs-core/lib/data/Geometry\");\nimport SubGeometryBase\t\t\t\t\t= require(\"awayjs-core/lib/data/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\n\nimport TriangleSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport VertexDataPool\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/VertexDataPool\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport VertexAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimationSet\");\nimport VertexAnimationMode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/VertexAnimationMode\");\nimport IVertexAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IVertexAnimationState\");\nimport IAnimationTransition\t\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/IAnimationTransition\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/pool/TriangleSubMeshRenderable\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\n\n/**\n * Provides an interface for assigning vertex-based animation data sets to mesh-based entity objects\n * and controlling the various available states of animation through an interative playhead that can be\n * automatically updated or manually triggered.\n */\nclass VertexAnimator extends AnimatorBase\n{\n\tprivate _vertexAnimationSet:VertexAnimationSet;\n\tprivate _poses:Array<Geometry> = new Array<Geometry>();\n\tprivate _weights:Array<number> = Array<number>(1, 0, 0, 0);\n\tprivate _numPoses:number /*uint*/;\n\tprivate _blendMode:string;\n\tprivate _activeVertexState:IVertexAnimationState;\n\n\t/**\n\t * Creates a new <code>VertexAnimator</code> object.\n\t *\n\t * @param vertexAnimationSet The animation data set containing the vertex animations used by the animator.\n\t */\n\tconstructor(vertexAnimationSet:VertexAnimationSet)\n\t{\n\t\tsuper(vertexAnimationSet);\n\n\t\tthis._vertexAnimationSet = vertexAnimationSet;\n\t\tthis._numPoses = vertexAnimationSet.numPoses;\n\t\tthis._blendMode = vertexAnimationSet.blendMode;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\treturn new VertexAnimator(this._vertexAnimationSet);\n\t}\n\n\t/**\n\t * Plays a sequence with a given name. If the sequence is not found, it may not be loaded yet, and it will retry every frame.\n\t * @param sequenceName The name of the clip to be played.\n\t */\n\tpublic play(name:string, transition:IAnimationTransition = null, offset:number = NaN)\n\t{\n\t\tif (this._pActiveAnimationName == name)\n\t\t\treturn;\n\n\t\tthis._pActiveAnimationName = name;\n\n\t\t//TODO: implement transitions in vertex animator\n\n\t\tif (!this._pAnimationSet.hasAnimation(name))\n\t\t\tthrow new Error(\"Animation root node \" + name + \" not found!\");\n\n\t\tthis._pActiveNode = this._pAnimationSet.getAnimation(name);\n\n\t\tthis._pActiveState = this.getAnimationState(this._pActiveNode);\n\n\t\tif (this.updatePosition) {\n\t\t\t//update straight away to reset position deltas\n\t\t\tthis._pActiveState.update(this._pAbsoluteTime);\n\t\t\tthis._pActiveState.positionDelta;\n\t\t}\n\n\t\tthis._activeVertexState = <IVertexAnimationState> this._pActiveState;\n\n\t\tthis.start();\n\n\t\t//apply a time offset if specified\n\t\tif (!isNaN(offset))\n\t\t\tthis.reset(name, offset);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tsuper._pUpdateDeltaTime(dt);\n\n\t\tvar geometryFlag:boolean = false;\n\n\t\tif (this._poses[0] != this._activeVertexState.currentGeometry) {\n\t\t\tthis._poses[0] = this._activeVertexState.currentGeometry;\n\t\t\tgeometryFlag = true;\n\t\t}\n\n\t\tif (this._poses[1] != this._activeVertexState.nextGeometry) {\n\t\t\tthis._poses[1] = this._activeVertexState.nextGeometry;\n\t\t\tgeometryFlag = true;\n\t\t}\n\n\t\tthis._weights[0] = 1 - (this._weights[1] = this._activeVertexState.blendWeight);\n\n\t\tif (geometryFlag) {\n\t\t\t//invalidate meshes\n\t\t\tvar mesh:Mesh;\n\t\t\tvar len:number = this._pOwners.length;\n\t\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\t\tmesh = this._pOwners[i];\n\t\t\t\tmesh._iInvalidateRenderableGeometries();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(shaderObject:ShaderObjectBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\t// todo: add code for when running on cpu\n\n\t\t// if no poses defined, set temp data\n\t\tif (!this._poses.length) {\n\t\t\tthis.setNullPose(shaderObject, renderable, stage, vertexConstantOffset, vertexStreamOffset);\n\t\t\treturn;\n\t\t}\n\n\t\t// this type of animation can only be SubMesh\n\t\tvar subMesh:TriangleSubMesh = <TriangleSubMesh> (<TriangleSubMeshRenderable> renderable).subMesh;\n\t\tvar subGeom:SubGeometryBase;\n\t\tvar i:number /*uint*/;\n\t\tvar len:number /*uint*/ = this._numPoses;\n\n\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._weights, 1);\n\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE)\n\t\t\ti = 1;\n\t\telse\n\t\t\ti = 0;\n\n\t\tfor (; i < len; ++i) {\n\t\t\tsubGeom = this._poses[i].subGeometries[subMesh._iIndex] || subMesh.subGeometry;\n\n\t\t\tstage.activateBuffer(vertexStreamOffset++, VertexDataPool.getItem(subGeom, renderable.getIndexData(), TriangleSubGeometry.POSITION_DATA), subGeom.getOffset(TriangleSubGeometry.POSITION_DATA), TriangleSubGeometry.POSITION_FORMAT);\n\n\t\t\tif (shaderObject.normalDependencies > 0)\n\t\t\t\tstage.activateBuffer(vertexStreamOffset++, VertexDataPool.getItem(subGeom, renderable.getIndexData(), TriangleSubGeometry.NORMAL_DATA), subGeom.getOffset(TriangleSubGeometry.NORMAL_DATA), TriangleSubGeometry.NORMAL_FORMAT);\n\t\t}\n\t}\n\n\tprivate setNullPose(shaderObject:ShaderObjectBase, renderable:RenderableBase, stage:Stage, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._weights, 1);\n\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE) {\n\t\t\tvar len:number /*uint*/ = this._numPoses;\n\t\t\tfor (var i:number /*uint*/ = 1; i < len; ++i) {\n\t\t\t\tstage.activateBuffer(vertexStreamOffset++, renderable.getVertexData(TriangleSubGeometry.POSITION_DATA), renderable.getVertexOffset(TriangleSubGeometry.POSITION_DATA), TriangleSubGeometry.POSITION_FORMAT);\n\n\t\t\t\tif (shaderObject.normalDependencies > 0)\n\t\t\t\t\tstage.activateBuffer(vertexStreamOffset++, renderable.getVertexData(TriangleSubGeometry.NORMAL_DATA), renderable.getVertexOffset(TriangleSubGeometry.NORMAL_DATA), TriangleSubGeometry.NORMAL_FORMAT);\n\t\t\t}\n\t\t}\n\t\t// todo: set temp data for additive?\n\t}\n\n\t/**\n\t * Verifies if the animation will be used on cpu. Needs to be true for all passes for a material to be able to use it on gpu.\n\t * Needs to be called if gpu code is potentially required.\n\t */\n\tpublic testGPUCompatibility(shaderObject:ShaderObjectBase)\n\t{\n\t}\n\n\tpublic getRenderableSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry):TriangleSubGeometry\n\t{\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE && this._poses.length)\n\t\t\treturn <TriangleSubGeometry> this._poses[0].subGeometries[renderable.subMesh._iIndex] || sourceSubGeometry;\n\n\t\t//nothing to do here\n\t\treturn sourceSubGeometry;\n\t}\n}\n\nexport = VertexAnimator;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nimport AnimationNodeBase\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\n\n/**\n * ...\n */\nclass AnimationRegisterCache extends ShaderRegisterCache\n{\n\t//vertex\n\tpublic positionAttribute:ShaderRegisterElement;\n\tpublic uvAttribute:ShaderRegisterElement;\n\tpublic positionTarget:ShaderRegisterElement;\n\tpublic scaleAndRotateTarget:ShaderRegisterElement;\n\tpublic velocityTarget:ShaderRegisterElement;\n\tpublic vertexTime:ShaderRegisterElement;\n\tpublic vertexLife:ShaderRegisterElement;\n\tpublic vertexZeroConst:ShaderRegisterElement;\n\tpublic vertexOneConst:ShaderRegisterElement;\n\tpublic vertexTwoConst:ShaderRegisterElement;\n\tpublic uvTarget:ShaderRegisterElement;\n\tpublic colorAddTarget:ShaderRegisterElement;\n\tpublic colorMulTarget:ShaderRegisterElement;\n\t//vary\n\tpublic colorAddVary:ShaderRegisterElement;\n\tpublic colorMulVary:ShaderRegisterElement;\n\n\t//fragment\n\n\tpublic uvVar:ShaderRegisterElement;\n\n\t//these are targets only need to rotate ( normal and tangent )\n\tpublic rotationRegisters:Array<ShaderRegisterElement>;\n\n\tpublic needFragmentAnimation:boolean;\n\tpublic needUVAnimation:boolean;\n\n\tpublic sourceRegisters:Array<string>;\n\tpublic targetRegisters:Array<string>;\n\n\tprivate indexDictionary:Object = new Object();\n\n\t//set true if has an node which will change UV\n\tpublic hasUVNode:boolean;\n\t//set if the other nodes need to access the velocity\n\tpublic needVelocity:boolean;\n\t//set if has a billboard node.\n\tpublic hasBillboard:boolean;\n\t//set if has an node which will apply color multiple operation\n\tpublic hasColorMulNode:boolean;\n\t//set if has an node which will apply color add operation\n\tpublic hasColorAddNode:boolean;\n\n\tconstructor(profile:string)\n\t{\n\t\tsuper(profile);\n\t}\n\n\tpublic reset()\n\t{\n\t\tsuper.reset();\n\n\t\tthis.rotationRegisters = new Array<ShaderRegisterElement>();\n\t\tthis.positionAttribute = this.getRegisterFromString(this.sourceRegisters[0]);\n\t\tthis.scaleAndRotateTarget = this.getRegisterFromString(this.targetRegisters[0]);\n\t\tthis.addVertexTempUsages(this.scaleAndRotateTarget, 1);\n\n\t\tfor (var i:number /*int*/ = 1; i < this.targetRegisters.length; i++) {\n\t\t\tthis.rotationRegisters.push(this.getRegisterFromString(this.targetRegisters[i]));\n\t\t\tthis.addVertexTempUsages(this.rotationRegisters[i - 1], 1);\n\t\t}\n\n\t\tthis.scaleAndRotateTarget = new ShaderRegisterElement(this.scaleAndRotateTarget.regName, this.scaleAndRotateTarget.index); //only use xyz, w is used as vertexLife\n\n\t\t//allot const register\n\n\t\tthis.vertexZeroConst = this.getFreeVertexConstant();\n\t\tthis.vertexZeroConst = new ShaderRegisterElement(this.vertexZeroConst.regName, this.vertexZeroConst.index, 0);\n\t\tthis.vertexOneConst = new ShaderRegisterElement(this.vertexZeroConst.regName, this.vertexZeroConst.index, 1);\n\t\tthis.vertexTwoConst = new ShaderRegisterElement(this.vertexZeroConst.regName, this.vertexZeroConst.index, 2);\n\n\t\t//allot temp register\n\t\tthis.positionTarget = this.getFreeVertexVectorTemp();\n\t\tthis.addVertexTempUsages(this.positionTarget, 1);\n\t\tthis.positionTarget = new ShaderRegisterElement(this.positionTarget.regName, this.positionTarget.index);\n\n\t\tif (this.needVelocity) {\n\t\t\tthis.velocityTarget = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(this.velocityTarget, 1);\n\t\t\tthis.velocityTarget = new ShaderRegisterElement(this.velocityTarget.regName, this.velocityTarget.index);\n\t\t\tthis.vertexTime = new ShaderRegisterElement(this.velocityTarget.regName, this.velocityTarget.index, 3);\n\t\t\tthis.vertexLife = new ShaderRegisterElement(this.positionTarget.regName, this.positionTarget.index, 3);\n\t\t} else {\n\t\t\tvar tempTime:ShaderRegisterElement = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(tempTime, 1);\n\t\t\tthis.vertexTime = new ShaderRegisterElement(tempTime.regName, tempTime.index, 0);\n\t\t\tthis.vertexLife = new ShaderRegisterElement(tempTime.regName, tempTime.index, 1);\n\t\t}\n\n\t}\n\n\tpublic setUVSourceAndTarget(UVAttribute:string, UVVaring:string)\n\t{\n\t\tthis.uvVar = this.getRegisterFromString(UVVaring);\n\t\tthis.uvAttribute = this.getRegisterFromString(UVAttribute);\n\t\t//uv action is processed after normal actions,so use offsetTarget as uvTarget\n\t\tthis.uvTarget = new ShaderRegisterElement(this.positionTarget.regName, this.positionTarget.index);\n\t}\n\n\tpublic setRegisterIndex(node:AnimationNodeBase, parameterIndex:number /*int*/, registerIndex:number /*int*/)\n\t{\n\t\t//8 should be enough for any node.\n\t\tvar t:Array<number> /*int*/ = this.indexDictionary[node.id];\n\n\t\tif (t == null)\n\t\t\tt = this.indexDictionary[node.id] = new Array<number>(8) /*int*/;\n\n\t\tt[parameterIndex] = registerIndex;\n\t}\n\n\tpublic getRegisterIndex(node:AnimationNodeBase, parameterIndex:number /*int*/):number /*int*/\n\t{\n\t\treturn (<Array<number>> this.indexDictionary[node.id])[parameterIndex];\n\t}\n\n\tpublic getInitCode():string\n\t{\n\t\tvar len:number /*int*/ = this.sourceRegisters.length;\n\t\tvar code:string = \"\";\n\t\tfor (var i:number /*int*/ = 0; i < len; i++)\n\t\t\tcode += \"mov \" + this.targetRegisters[i] + \",\" + this.sourceRegisters[i] + \"\\n\";\n\n\t\tcode += \"mov \" + this.positionTarget + \".xyz,\" + this.vertexZeroConst.toString() + \"\\n\";\n\n\t\tif (this.needVelocity)\n\t\t\tcode += \"mov \" + this.velocityTarget + \".xyz,\" + this.vertexZeroConst.toString() + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\tpublic getCombinationCode():string\n\t{\n\t\treturn \"add \" + this.scaleAndRotateTarget + \".xyz,\" + this.scaleAndRotateTarget + \".xyz,\" + this.positionTarget + \".xyz\\n\";\n\t}\n\n\tpublic initColorRegisters():string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.hasColorMulNode) {\n\t\t\tthis.colorMulTarget = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(this.colorMulTarget, 1);\n\t\t\tthis.colorMulVary = this.getFreeVarying();\n\t\t\tcode += \"mov \" + this.colorMulTarget + \",\" + this.vertexOneConst + \"\\n\";\n\t\t}\n\t\tif (this.hasColorAddNode) {\n\t\t\tthis.colorAddTarget = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(this.colorAddTarget, 1);\n\t\t\tthis.colorAddVary = this.getFreeVarying();\n\t\t\tcode += \"mov \" + this.colorAddTarget + \",\" + this.vertexZeroConst + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\tpublic getColorPassCode():string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.needFragmentAnimation && (this.hasColorAddNode || this.hasColorMulNode)) {\n\t\t\tif (this.hasColorMulNode)\n\t\t\t\tcode += \"mov \" + this.colorMulVary + \",\" + this.colorMulTarget + \"\\n\";\n\t\t\tif (this.hasColorAddNode)\n\t\t\t\tcode += \"mov \" + this.colorAddVary + \",\" + this.colorAddTarget + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\tpublic getColorCombinationCode(shadedTarget:string):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.needFragmentAnimation && (this.hasColorAddNode || this.hasColorMulNode)) {\n\t\t\tvar colorTarget:ShaderRegisterElement = this.getRegisterFromString(shadedTarget);\n\t\t\tthis.addFragmentTempUsages(colorTarget, 1);\n\t\t\tif (this.hasColorMulNode)\n\t\t\t\tcode += \"mul \" + colorTarget + \",\" + colorTarget + \",\" + this.colorMulVary + \"\\n\";\n\t\t\tif (this.hasColorAddNode)\n\t\t\t\tcode += \"add \" + colorTarget + \",\" + colorTarget + \",\" + this.colorAddVary + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\tprivate getRegisterFromString(code:string):ShaderRegisterElement\n\t{\n\t\tvar temp:Array<string> = code.split(/(\\d+)/);\n\t\treturn new ShaderRegisterElement(temp[0], parseInt(temp[1]));\n\t}\n\n\tpublic vertexConstantData:Array<number> = new Array<number>();\n\tpublic fragmentConstantData:Array<number> = new Array<number>();\n\n\tprivate _numVertexConstant:number /*int*/;\n\tprivate _numFragmentConstant:number /*int*/;\n\n\tpublic get numVertexConstant():number /*int*/\n\t{\n\t\treturn this._numVertexConstant;\n\t}\n\n\tpublic get numFragmentConstant():number /*int*/\n\t{\n\t\treturn this._numFragmentConstant;\n\t}\n\n\tpublic setDataLength()\n\t{\n\t\tthis._numVertexConstant = this.numUsedVertexConstants - this.vertexConstantOffset;\n\t\tthis._numFragmentConstant = this.numUsedFragmentConstants - this.fragmentConstantOffset;\n\t\tthis.vertexConstantData.length = this._numVertexConstant*4;\n\t\tthis.fragmentConstantData.length = this._numFragmentConstant*4;\n\t}\n\n\tpublic setVertexConst(index:number /*int*/, x:number = 0, y:number = 0, z:number = 0, w:number = 0)\n\t{\n\t\tvar _index:number /*int*/ = (index - this.vertexConstantOffset)*4;\n\t\tthis.vertexConstantData[_index++] = x;\n\t\tthis.vertexConstantData[_index++] = y;\n\t\tthis.vertexConstantData[_index++] = z;\n\t\tthis.vertexConstantData[_index] = w;\n\t}\n\n\tpublic setVertexConstFromArray(index:number /*int*/, data:Array<number>)\n\t{\n\t\tvar _index:number /*int*/ = (index - this.vertexConstantOffset)*4;\n\t\tfor (var i:number /*int*/ = 0; i < data.length; i++)\n\t\t\tthis.vertexConstantData[_index++] = data[i];\n\t}\n\n\tpublic setVertexConstFromMatrix(index:number /*int*/, matrix:Matrix3D)\n\t{\n\t\tvar rawData:Array<number> = matrix.rawData;\n\t\tvar _index:number /*int*/ = (index - this.vertexConstantOffset)*4;\n\t\tthis.vertexConstantData[_index++] = rawData[0];\n\t\tthis.vertexConstantData[_index++] = rawData[4];\n\t\tthis.vertexConstantData[_index++] = rawData[8];\n\t\tthis.vertexConstantData[_index++] = rawData[12];\n\t\tthis.vertexConstantData[_index++] = rawData[1];\n\t\tthis.vertexConstantData[_index++] = rawData[5];\n\t\tthis.vertexConstantData[_index++] = rawData[9];\n\t\tthis.vertexConstantData[_index++] = rawData[13];\n\t\tthis.vertexConstantData[_index++] = rawData[2];\n\t\tthis.vertexConstantData[_index++] = rawData[6];\n\t\tthis.vertexConstantData[_index++] = rawData[10];\n\t\tthis.vertexConstantData[_index++] = rawData[14];\n\t\tthis.vertexConstantData[_index++] = rawData[3];\n\t\tthis.vertexConstantData[_index++] = rawData[7];\n\t\tthis.vertexConstantData[_index++] = rawData[11];\n\t\tthis.vertexConstantData[_index] = rawData[15];\n\n\t}\n\n\tpublic setFragmentConst(index:number /*int*/, x:number = 0, y:number = 0, z:number = 0, w:number = 0)\n\t{\n\t\tvar _index:number /*int*/ = (index - this.fragmentConstantOffset)*4;\n\t\tthis.fragmentConstantData[_index++] = x;\n\t\tthis.fragmentConstantData[_index++] = y;\n\t\tthis.fragmentConstantData[_index++] = z;\n\t\tthis.fragmentConstantData[_index] = w;\n\t}\n}\n\nexport = AnimationRegisterCache;",
    "import Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IVertexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\n\n/**\n * ...\n */\nclass AnimationSubGeometry\n{\n\tpublic static SUBGEOM_ID_COUNT:number = 0;\n\n\tpublic _pVertexData:Array<number>;\n\n\tpublic _pVertexBuffer:Array<IVertexBuffer> = new Array<IVertexBuffer>(8);\n\tpublic _pBufferContext:Array<IContextGL> = new Array<IContextGL>(8);\n\tpublic _pBufferDirty:Array<boolean> = new Array<boolean>(8);\n\n\tprivate _numVertices:number /*uint*/;\n\n\tprivate _totalLenOfOneVertex:number /*uint*/;\n\n\tpublic numProcessedVertices:number /*int*/ = 0;\n\n\tpublic previousTime:number = Number.NEGATIVE_INFINITY;\n\n\tpublic animationParticles:Array<ParticleAnimationData> = new Array<ParticleAnimationData>();\n\n\t/**\n\t * An id for this animation subgeometry, used to identify animation subgeometries when using animation sets.\n\t *\n\t * @private\n\t */\n\tpublic _iUniqueId:number;//Arcane\n\n\tconstructor()\n\t{\n\t\tfor (var i:number /*int*/ = 0; i < 8; i++)\n\t\t\tthis._pBufferDirty[i] = true;\n\n\t\tthis._iUniqueId = AnimationSubGeometry.SUBGEOM_ID_COUNT++;\n\t}\n\n\tpublic createVertexData(numVertices:number /*uint*/, totalLenOfOneVertex:number /*uint*/)\n\t{\n\t\tthis._numVertices = numVertices;\n\t\tthis._totalLenOfOneVertex = totalLenOfOneVertex;\n\t\tthis._pVertexData = new Array<number>(numVertices*totalLenOfOneVertex);\n\t}\n\n\tpublic activateVertexBuffer(index:number /*int*/, bufferOffset:number /*int*/, stage:Stage, format:string)\n\t{\n\t\tvar contextIndex:number /*int*/ = stage.stageIndex;\n\t\tvar context:IContextGL = <IContextGL> stage.context;\n\n\t\tvar buffer:IVertexBuffer = this._pVertexBuffer[contextIndex];\n\t\tif (!buffer || this._pBufferContext[contextIndex] != context) {\n\t\t\tbuffer = this._pVertexBuffer[contextIndex] = context.createVertexBuffer(this._numVertices, this._totalLenOfOneVertex);\n\t\t\tthis._pBufferContext[contextIndex] = context;\n\t\t\tthis._pBufferDirty[contextIndex] = true;\n\t\t}\n\t\tif (this._pBufferDirty[contextIndex]) {\n\t\t\tbuffer.uploadFromArray(this._pVertexData, 0, this._numVertices);\n\t\t\tthis._pBufferDirty[contextIndex] = false;\n\t\t}\n\t\tcontext.setVertexBufferAt(index, buffer, bufferOffset, format);\n\t}\n\n\tpublic dispose()\n\t{\n\t\twhile (this._pVertexBuffer.length) {\n\t\t\tvar vertexBuffer:IVertexBuffer = this._pVertexBuffer.pop()\n\n\t\t\tif (vertexBuffer)\n\t\t\t\tvertexBuffer.dispose();\n\t\t}\n\t}\n\n\tpublic invalidateBuffer()\n\t{\n\t\tfor (var i:number /*int*/ = 0; i < 8; i++)\n\t\t\tthis._pBufferDirty[i] = true;\n\t}\n\n\tpublic get vertexData():Array<number>\n\t{\n\t\treturn this._pVertexData;\n\t}\n\n\tpublic get numVertices():number /*uint*/\n\t{\n\t\treturn this._numVertices;\n\t}\n\n\tpublic get totalLenOfOneVertex():number /*uint*/\n\t{\n\t\treturn this._totalLenOfOneVertex;\n\t}\n}\n\nexport = AnimationSubGeometry;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\n\nclass ColorSegmentPoint\n{\n\tprivate _color:ColorTransform;\n\tprivate _life:number;\n\n\tconstructor(life:number, color:ColorTransform)\n\t{\n\t\t//0<life<1\n\t\tif (life <= 0 || life >= 1)\n\t\t\tthrow(new Error(\"life exceeds range (0,1)\"));\n\t\tthis._life = life;\n\t\tthis._color = color;\n\t}\n\n\tpublic get color():ColorTransform\n\t{\n\t\treturn this._color;\n\t}\n\n\tpublic get life():number\n\t{\n\t\treturn this._life;\n\t}\n\n}\n\nexport = ColorSegmentPoint;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\n/**\n * Contains transformation data for a skeleton joint, used for skeleton animation.\n *\n * @see away.animation.Skeleton\n * @see away.animation.SkeletonJoint\n *\n * todo: support (uniform) scale\n */\nclass JointPose\n{\n\t/**\n\t * The name of the joint to which the pose is associated\n\t */\n\tpublic name:string; // intention is that this should be used only at load time, not in the main loop\n\n\t/**\n\t * The rotation of the pose stored as a quaternion\n\t */\n\tpublic orientation:Quaternion = new Quaternion();\n\n\t/**\n\t * The translation of the pose\n\t */\n\tpublic translation:Vector3D = new Vector3D();\n\n\tconstructor()\n\t{\n\n\t}\n\n\t/**\n\t * Converts the transformation to a Matrix3D representation.\n\t *\n\t * @param target An optional target matrix to store the transformation. If not provided, it will create a new instance.\n\t * @return The transformation matrix of the pose.\n\t */\n\tpublic toMatrix3D(target:Matrix3D = null):Matrix3D\n\t{\n\t\tif (target == null)\n\t\t\ttarget = new Matrix3D();\n\n\t\tthis.orientation.toMatrix3D(target);\n\t\ttarget.appendTranslation(this.translation.x, this.translation.y, this.translation.z);\n\t\treturn target;\n\t}\n\n\t/**\n\t * Copies the transformation data from a source pose object into the existing pose object.\n\t *\n\t * @param pose The source pose to copy from.\n\t */\n\tpublic copyFrom(pose:JointPose)\n\t{\n\t\tvar or:Quaternion = pose.orientation;\n\t\tvar tr:Vector3D = pose.translation;\n\t\tthis.orientation.x = or.x;\n\t\tthis.orientation.y = or.y;\n\t\tthis.orientation.z = or.z;\n\t\tthis.orientation.w = or.w;\n\t\tthis.translation.x = tr.x;\n\t\tthis.translation.y = tr.y;\n\t\tthis.translation.z = tr.z;\n\t}\n}\n\nexport = JointPose;",
    "import ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\n\n/**\n * ...\n */\nclass ParticleAnimationData\n{\n\tpublic index:number /*uint*/;\n\tpublic startTime:number;\n\tpublic totalTime:number;\n\tpublic duration:number;\n\tpublic delay:number;\n\tpublic startVertexIndex:number /*uint*/;\n\tpublic numVertices:number /*uint*/;\n\n\tconstructor(index:number /*uint*/, startTime:number, duration:number, delay:number, particle:ParticleData)\n\t{\n\t\tthis.index = index;\n\t\tthis.startTime = startTime;\n\t\tthis.totalTime = duration + delay;\n\t\tthis.duration = duration;\n\t\tthis.delay = delay;\n\t\tthis.startVertexIndex = particle.startVertexIndex;\n\t\tthis.numVertices = particle.numVertices;\n\t}\n}\n\nexport = ParticleAnimationData;",
    "import TriangleSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\n\nclass ParticleData\n{\n\tpublic particleIndex:number /*uint*/;\n\tpublic numVertices:number /*uint*/;\n\tpublic startVertexIndex:number /*uint*/;\n\tpublic subGeometry:TriangleSubGeometry;\n}\n\nexport = ParticleData",
    "/**\n * Options for setting the properties mode of a particle animation node.\n */\nclass ParticlePropertiesMode\n{\n\t/**\n\t * Mode that defines the particle node as acting on global properties (ie. the properties set in the node constructor or the corresponding animation state).\n\t */\n\tpublic static GLOBAL:number /*uint*/ = 0;\n\n\t/**\n\t * Mode that defines the particle node as acting on local static properties (ie. the properties of particles set in the initialising on the animation set).\n\t */\n\tpublic static LOCAL_STATIC:number /*uint*/ = 1;\n\n\t/**\n\t * Mode that defines the particle node as acting on local dynamic properties (ie. the properties of the particles set in the corresponding animation state).\n\t */\n\tpublic static LOCAL_DYNAMIC:number /*uint*/ = 2;\n}\n\nexport = ParticlePropertiesMode;",
    "/**\n * Dynamic class for holding the local properties of a particle, used for processing the static properties\n * of particles in the particle animation set before beginning upload to the GPU.\n */\nclass ParticleProperties\n{\n\t/**\n\t * The index of the current particle being set.\n\t */\n\tpublic index:number /*uint*/;\n\n\t/**\n\t * The total number of particles being processed by the particle animation set.\n\t */\n\tpublic total:number /*uint*/;\n\n\t/**\n\t * The start time of the particle.\n\t */\n\tpublic startTime:number;\n\n\t/**\n\t * The duration of the particle, an optional value used when the particle aniamtion set settings for <code>useDuration</code> are enabled in the constructor.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t */\n\tpublic duration:number;\n\n\t/**\n\t * The delay between cycles of the particle, an optional value used when the particle aniamtion set settings for <code>useLooping</code> and  <code>useDelay</code> are enabled in the constructor.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t */\n\tpublic delay:number;\n}\n\nexport = ParticleProperties;",
    "/**\n * A value obect representing a single joint in a skeleton object.\n *\n * @see away.animators.Skeleton\n */\nclass SkeletonJoint\n{\n\t/**\n\t * The index of the parent joint in the skeleton's joints vector.\n\t *\n\t * @see away.animators.Skeleton#joints\n\t */\n\tpublic parentIndex:number /*int*/ = -1;\n\n\t/**\n\t * The name of the joint\n\t */\n\tpublic name:string; // intention is that this should be used only at load time, not in the main loop\n\n\t/**\n\t * The inverse bind pose matrix, as raw data, used to transform vertices to bind joint space in preparation for transformation using the joint matrix.\n\t */\n\tpublic inverseBindPose:Array<number>;\n\n\t/**\n\t * Creates a new <code>SkeletonJoint</code> object\n\t */\n\tconstructor()\n\t{\n\t}\n}\n\nexport = SkeletonJoint;",
    "import IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AssetBase\t\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\n\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\n\n\n/**\n * A collection of pose objects, determining the pose for an entire skeleton.\n * The <code>jointPoses</code> vector object corresponds to a skeleton's <code>joints</code> vector object, however, there is no\n * reference to a skeleton's instance, since several skeletons can be influenced by the same pose (eg: animation\n * clips are added to any animator with a valid skeleton)\n *\n * @see away.animators.Skeleton\n * @see away.animators.JointPose\n */\nclass SkeletonPose extends AssetBase implements IAsset\n{\n\tpublic static assetType:string = \"[asset SkeletonPose]\";\n\n\t/**\n\t * A flat list of pose objects that comprise the skeleton pose. The pose indices correspond to the target skeleton's joint indices.\n\t *\n\t * @see away.animators.Skeleton#joints\n\t */\n\tpublic jointPoses:Array<JointPose>;\n\n\t/**\n\t * The total number of joint poses in the skeleton pose.\n\t */\n\tpublic get numJointPoses():number /*uint*/\n\t{\n\t\treturn this.jointPoses.length;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonPose</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.jointPoses = new Array<JointPose>();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn SkeletonPose.assetType;\n\t}\n\n\t/**\n\t * Returns the joint pose object with the given joint name, otherwise returns a null object.\n\t *\n\t * @param jointName The name of the joint object whose pose is to be found.\n\t * @return The pose object with the given joint name.\n\t */\n\tpublic jointPoseFromName(jointName:string):JointPose\n\t{\n\t\tvar jointPoseIndex:number /*int*/ = this.jointPoseIndexFromName(jointName);\n\t\tif (jointPoseIndex != -1)\n\t\t\treturn this.jointPoses[jointPoseIndex]; else\n\t\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the pose index, given the joint name. -1 is returned if the joint name is not found in the pose.\n\t *\n\t * @param The name of the joint object whose pose is to be found.\n\t * @return The index of the pose object in the jointPoses Array\n\t *\n\t * @see #jointPoses\n\t */\n\tpublic jointPoseIndexFromName(jointName:string):number /*int*/\n\t{\n\t\t// this is implemented as a linear search, rather than a possibly\n\t\t// more optimal method (Dictionary lookup, for example) because:\n\t\t// a) it is assumed that it will be called once for each joint\n\t\t// b) it is assumed that it will be called only during load, and not during main loop\n\t\t// c) maintaining a dictionary (for safety) would dictate an interface to access JointPoses,\n\t\t//    rather than direct array access.  this would be sub-optimal.\n\t\tvar jointPoseIndex:number /*int*/;\n\t\tvar jointPose:JointPose;\n\t\tfor (var i:number /*uint*/; i < this.jointPoses.length; i++) {\n\t\t\tjointPose = this.jointPoses[i];\n\t\t\tif (jointPose.name == jointName)\n\t\t\t\treturn jointPoseIndex;\n\t\t\tjointPoseIndex++;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\t/**\n\t * Creates a copy of the <code>SkeletonPose</code> object, with a dulpicate of its component joint poses.\n\t *\n\t * @return SkeletonPose\n\t */\n\tpublic clone():SkeletonPose\n\t{\n\t\tvar clone:SkeletonPose = new SkeletonPose();\n\t\tvar numJointPoses:number /*uint*/ = this.jointPoses.length;\n\t\tfor (var i:number /*uint*/ = 0; i < numJointPoses; i++) {\n\t\t\tvar cloneJointPose:JointPose = new JointPose();\n\t\t\tvar thisJointPose:JointPose = this.jointPoses[i];\n\t\t\tcloneJointPose.name = thisJointPose.name;\n\t\t\tcloneJointPose.copyFrom(thisJointPose);\n\t\t\tclone.jointPoses[i] = cloneJointPose;\n\t\t}\n\t\treturn clone;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tthis.jointPoses.length = 0;\n\t}\n}\n\nexport = SkeletonPose;",
    "import SkeletonJoint\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonJoint\");\n\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AssetBase\t\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\n\n/**\n * A Skeleton object is a hierarchical grouping of joint objects that can be used for skeletal animation.\n *\n * @see away.animators.SkeletonJoint\n */\nclass Skeleton extends AssetBase implements IAsset\n{\n\tpublic static assetType:string = \"[asset Skeleton]\";\n\n\t/**\n\t * A flat list of joint objects that comprise the skeleton. Every joint except for the root has a parentIndex\n\t * property that is an index into this list.\n\t * A child joint should always have a higher index than its parent.\n\t */\n\tpublic joints:Array<SkeletonJoint>;\n\n\t/**\n\t * The total number of joints in the skeleton.\n\t */\n\tpublic get numJoints():number /*uint*/\n\t{\n\t\treturn this.joints.length;\n\t}\n\n\t/**\n\t * Creates a new <code>Skeleton</code> object\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\t// in the long run, it might be a better idea to not store Joint objects, but keep all data in Vectors, that we can upload easily?\n\t\tthis.joints = new Array<SkeletonJoint>();\n\t}\n\n\t/**\n\t * Returns the joint object in the skeleton with the given name, otherwise returns a null object.\n\t *\n\t * @param jointName The name of the joint object to be found.\n\t * @return The joint object with the given name.\n\t *\n\t * @see #joints\n\t */\n\tpublic jointFromName(jointName:string):SkeletonJoint\n\t{\n\t\tvar jointIndex:number /*int*/ = this.jointIndexFromName(jointName);\n\t\tif (jointIndex != -1)\n\t\t\treturn this.joints[jointIndex]; else\n\t\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the joint index, given the joint name. -1 is returned if the joint name is not found.\n\t *\n\t * @param jointName The name of the joint object to be found.\n\t * @return The index of the joint object in the joints Array\n\t *\n\t * @see #joints\n\t */\n\tpublic jointIndexFromName(jointName:string):number /*int*/\n\t{\n\t\t// this is implemented as a linear search, rather than a possibly\n\t\t// more optimal method (Dictionary lookup, for example) because:\n\t\t// a) it is assumed that it will be called once for each joint\n\t\t// b) it is assumed that it will be called only during load, and not during main loop\n\t\t// c) maintaining a dictionary (for safety) would dictate an interface to access SkeletonJoints,\n\t\t//    rather than direct array access.  this would be sub-optimal.\n\t\tvar jointIndex:number /*int*/;\n\t\tvar joint:SkeletonJoint;\n\t\tfor (var i:number /*int*/; i < this.joints.length; i++) {\n\t\t\tjoint = this.joints[i];\n\t\t\tif (joint.name == jointName)\n\t\t\t\treturn jointIndex;\n\t\t\tjointIndex++;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tthis.joints.length = 0;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn Skeleton.assetType;\n\t}\n}\n\nexport = Skeleton;",
    "/**\n * Options for setting the animation mode of a vertex animator object.\n *\n * @see away.animators.VertexAnimator\n */\nclass VertexAnimationMode\n{\n\t/**\n\t * Animation mode that adds all outputs from active vertex animation state to form the current vertex animation pose.\n\t */\n\tpublic static ADDITIVE:string = \"additive\";\n\n\t/**\n\t * Animation mode that picks the output from a single vertex animation state to form the current vertex animation pose.\n\t */\n\tpublic static ABSOLUTE:string = \"absolute\";\n}\n\nexport = VertexAnimationMode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\n/**\n * Provides an abstract base class for nodes with time-based animation data in an animation blend tree.\n */\nclass AnimationClipNodeBase extends AnimationNodeBase\n{\n\tpublic _pLooping:boolean = true;\n\tpublic _pTotalDuration:number /*uint*/ = 0;\n\tpublic _pLastFrame:number /*uint*/;\n\n\tpublic _pStitchDirty:boolean = true;\n\tpublic _pStitchFinalFrame:boolean = false;\n\tpublic _pNumFrames:number /*uint*/ = 0;\n\n\tpublic _pDurations:Array<number> = new Array<number>();\n\t/*uint*/\n\tpublic _pTotalDelta:Vector3D = new Vector3D();\n\n\tpublic fixedFrameRate:boolean = true;\n\n\t/**\n\t * Determines whether the contents of the animation node have looping characteristics enabled.\n\t */\n\tpublic get looping():boolean\n\t{\n\t\treturn this._pLooping;\n\t}\n\n\tpublic set looping(value:boolean)\n\t{\n\t\tif (this._pLooping == value)\n\t\t\treturn;\n\n\t\tthis._pLooping = value;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\t/**\n\t * Defines if looping content blends the final frame of animation data with the first (true) or works on the\n\t * assumption that both first and last frames are identical (false). Defaults to false.\n\t */\n\tpublic get stitchFinalFrame():boolean\n\t{\n\t\treturn this._pStitchFinalFrame;\n\t}\n\n\tpublic set stitchFinalFrame(value:boolean)\n\t{\n\t\tif (this._pStitchFinalFrame == value)\n\t\t\treturn;\n\n\t\tthis._pStitchFinalFrame = value;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\tpublic get totalDuration():number /*uint*/\n\t{\n\t\tif (this._pStitchDirty)\n\t\t\tthis._pUpdateStitch();\n\n\t\treturn this._pTotalDuration;\n\t}\n\n\tpublic get totalDelta():Vector3D\n\t{\n\t\tif (this._pStitchDirty)\n\t\t\tthis._pUpdateStitch();\n\n\t\treturn this._pTotalDelta;\n\t}\n\n\tpublic get lastFrame():number /*uint*/\n\t{\n\t\tif (this._pStitchDirty)\n\t\t\tthis._pUpdateStitch();\n\n\t\treturn this._pLastFrame;\n\t}\n\n\t/**\n\t * Returns a vector of time values representing the duration (in milliseconds) of each animation frame in the clip.\n\t */\n\tpublic get durations():Array<number> /*uint*/\n\t{\n\t\treturn this._pDurations;\n\t}\n\n\t/**\n\t * Creates a new <code>AnimationClipNodeBase</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Updates the node's final frame stitch state.\n\t *\n\t * @see #stitchFinalFrame\n\t */\n\tpublic _pUpdateStitch()\n\t{\n\t\tthis._pStitchDirty = false;\n\n\t\tthis._pLastFrame = (this._pStitchFinalFrame)? this._pNumFrames : this._pNumFrames - 1;\n\n\t\tthis._pTotalDuration = 0;\n\t\tthis._pTotalDelta.x = 0;\n\t\tthis._pTotalDelta.y = 0;\n\t\tthis._pTotalDelta.z = 0;\n\t}\n}\n\nexport = AnimationClipNodeBase;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleAccelerationState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleAccelerationState\");\n\n/**\n * A particle animation node used to apply a constant acceleration vector to the motion of a particle.\n */\nclass ParticleAccelerationNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _acceleration:Vector3D;\n\n\t/**\n\t * Reference for acceleration node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the direction of acceleration on the particle.\n\t */\n\tpublic static ACCELERATION_VECTOR3D:string = \"AccelerationVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleAccelerationNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] acceleration    Defines the default acceleration vector of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, acceleration:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleAcceleration\", mode, 3);\n\n\t\tthis._pStateClass = ParticleAccelerationState;\n\n\t\tthis._acceleration = acceleration || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pGetAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar accelerationValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleAccelerationState.ACCELERATION_INDEX, accelerationValue.index);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\n\t\tvar code:string = \"mul \" + temp + \",\" + animationRegisterCache.vertexTime + \",\" + accelerationValue + \"\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"mul \" + temp2 + \",\" + temp + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + temp2 + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t}\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tcode += \"mul \" + temp + \",\" + temp + \",\" + animationRegisterCache.vertexTime + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + temp + \",\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleAccelerationState\n\t{\n\t\treturn <ParticleAccelerationState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar tempAcceleration:Vector3D = param[ParticleAccelerationNode.ACCELERATION_VECTOR3D];\n\t\tif (!tempAcceleration)\n\t\t\tthrow new Error(\"there is no \" + ParticleAccelerationNode.ACCELERATION_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = tempAcceleration.x/2;\n\t\tthis._pOneData[1] = tempAcceleration.y/2;\n\t\tthis._pOneData[2] = tempAcceleration.z/2;\n\t}\n}\n\nexport = ParticleAccelerationNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleBezierCurveState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleBezierCurveState\");\n\n/**\n * A particle animation node used to control the position of a particle over time along a bezier curve.\n */\nclass ParticleBezierCurveNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iControlPoint:Vector3D;\n\t/** @private */\n\tpublic _iEndPoint:Vector3D;\n\n\t/**\n\t * Reference for bezier curve node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the control point position (0, 1, 2) of the curve.\n\t */\n\tpublic static BEZIER_CONTROL_VECTOR3D:string = \"BezierControlVector3D\";\n\n\t/**\n\t * Reference for bezier curve node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the end point position (0, 1, 2) of the curve.\n\t */\n\tpublic static BEZIER_END_VECTOR3D:string = \"BezierEndVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleBezierCurveNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] controlPoint    Defines the default control point of the node, used when in global mode.\n\t * @param    [optional] endPoint        Defines the default end point of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, controlPoint:Vector3D = null, endPoint:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleBezierCurve\", mode, 6);\n\n\t\tthis._pStateClass = ParticleBezierCurveState;\n\n\t\tthis._iControlPoint = controlPoint || new Vector3D();\n\t\tthis._iEndPoint = endPoint || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar controlValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleBezierCurveState.BEZIER_CONTROL_INDEX, controlValue.index);\n\n\t\tvar endValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleBezierCurveState.BEZIER_END_INDEX, endValue.index);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar rev_time:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\tvar time_2:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\tvar time_temp:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar distance:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"sub \" + rev_time + \",\" + animationRegisterCache.vertexOneConst + \",\" + animationRegisterCache.vertexLife + \"\\n\";\n\t\tcode += \"mul \" + time_2 + \",\" + animationRegisterCache.vertexLife + \",\" + animationRegisterCache.vertexLife + \"\\n\";\n\n\t\tcode += \"mul \" + time_temp + \",\" + animationRegisterCache.vertexLife + \",\" + rev_time + \"\\n\";\n\t\tcode += \"mul \" + time_temp + \",\" + time_temp + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\tcode += \"mul \" + distance + \".xyz,\" + time_temp + \",\" + controlValue + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\tcode += \"mul \" + distance + \".xyz,\" + time_2 + \",\" + endValue + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tcode += \"mul \" + time_2 + \",\" + animationRegisterCache.vertexLife + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"sub \" + time_temp + \",\" + animationRegisterCache.vertexOneConst + \",\" + time_2 + \"\\n\";\n\t\t\tcode += \"mul \" + time_temp + \",\" + animationRegisterCache.vertexTwoConst + \",\" + time_temp + \"\\n\";\n\t\t\tcode += \"mul \" + distance + \".xyz,\" + controlValue + \",\" + time_temp + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t\tcode += \"mul \" + distance + \".xyz,\" + endValue + \",\" + time_2 + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleBezierCurveState\n\t{\n\t\treturn <ParticleBezierCurveState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar bezierControl:Vector3D = param[ParticleBezierCurveNode.BEZIER_CONTROL_VECTOR3D];\n\t\tif (!bezierControl)\n\t\t\tthrow new Error(\"there is no \" + ParticleBezierCurveNode.BEZIER_CONTROL_VECTOR3D + \" in param!\");\n\n\t\tvar bezierEnd:Vector3D = param[ParticleBezierCurveNode.BEZIER_END_VECTOR3D];\n\t\tif (!bezierEnd)\n\t\t\tthrow new Error(\"there is no \" + ParticleBezierCurveNode.BEZIER_END_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = bezierControl.x;\n\t\tthis._pOneData[1] = bezierControl.y;\n\t\tthis._pOneData[2] = bezierControl.z;\n\t\tthis._pOneData[3] = bezierEnd.x;\n\t\tthis._pOneData[4] = bezierEnd.y;\n\t\tthis._pOneData[5] = bezierEnd.z;\n\t}\n}\n\nexport = ParticleBezierCurveNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleBillboardState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleBillboardState\");\n\n/**\n * A particle animation node that controls the rotation of a particle to always face the camera.\n */\nclass ParticleBillboardNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iBillboardAxis:Vector3D;\n\n\t/**\n\t * Creates a new <code>ParticleBillboardNode</code>\n\t */\n\tconstructor(billboardAxis:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleBillboard\", ParticlePropertiesMode.GLOBAL, 0, 4);\n\n\t\tthis._pStateClass = ParticleBillboardState;\n\n\t\tthis._iBillboardAxis = billboardAxis;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar rotationMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleBillboardState.MATRIX_INDEX, rotationMatrixRegister.index);\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\tvar code:string = \"m33 \" + temp + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \",\" + rotationMatrixRegister + \"\\n\" +\n\t\t\t\t\t\t  \"mov \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp + \"\\n\";\n\n\t\tvar shaderRegisterElement:ShaderRegisterElement;\n\t\tfor (var i:number /*uint*/ = 0; i < animationRegisterCache.rotationRegisters.length; i++) {\n\t\t\tshaderRegisterElement = animationRegisterCache.rotationRegisters[i];\n\t\t\tcode += \"m33 \" + temp + \".xyz,\" + shaderRegisterElement + \",\" + rotationMatrixRegister + \"\\n\" +\n\t\t\t\t\t\"mov \" + shaderRegisterElement + \".xyz,\" + shaderRegisterElement + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleBillboardState\n\t{\n\t\treturn <ParticleBillboardState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.hasBillboard = true;\n\t}\n}\n\nexport = ParticleBillboardNode;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleColorState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleColorState\");\n\n/**\n * A particle animation node used to control the color variation of a particle over time.\n */\nclass ParticleColorNode extends ParticleNodeBase\n{\n\t//default values used when creating states\n\t/** @private */\n\tpublic _iUsesMultiplier:boolean;\n\t/** @private */\n\tpublic _iUsesOffset:boolean;\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\t/** @private */\n\tpublic _iStartColor:ColorTransform;\n\t/** @private */\n\tpublic _iEndColor:ColorTransform;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\n\t/**\n\t * Reference for color node properties on a single particle (when in local property mode).\n\t * Expects a <code>ColorTransform</code> object representing the start color transform applied to the particle.\n\t */\n\tpublic static COLOR_START_COLORTRANSFORM:string = \"ColorStartColorTransform\";\n\n\t/**\n\t * Reference for color node properties on a single particle (when in local property mode).\n\t * Expects a <code>ColorTransform</code> object representing the end color transform applied to the particle.\n\t */\n\tpublic static COLOR_END_COLORTRANSFORM:string = \"ColorEndColorTransform\";\n\n\t/**\n\t * Creates a new <code>ParticleColorNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] usesMultiplier  Defines whether the node uses multiplier data in the shader for its color transformations. Defaults to true.\n\t * @param    [optional] usesOffset      Defines whether the node uses offset data in the shader for its color transformations. Defaults to true.\n\t * @param    [optional] usesCycle       Defines whether the node uses the <code>cycleDuration</code> property in the shader to calculate the period of the animation independent of particle duration. Defaults to false.\n\t * @param    [optional] usesPhase       Defines whether the node uses the <code>cyclePhase</code> property in the shader to calculate a starting offset to the cycle rotation of the particle. Defaults to false.\n\t * @param    [optional] startColor      Defines the default start color transform of the node, when in global mode.\n\t * @param    [optional] endColor        Defines the default end color transform of the node, when in global mode.\n\t * @param    [optional] cycleDuration   Defines the duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tconstructor(mode:number /*uint*/, usesMultiplier:boolean = true, usesOffset:boolean = true, usesCycle:boolean = false, usesPhase:boolean = false, startColor:ColorTransform = null, endColor:ColorTransform = null, cycleDuration:number = 1, cyclePhase:number = 0)\n\t{\n\t\tsuper(\"ParticleColor\", mode, (usesMultiplier && usesOffset)? 16 : 8, ParticleAnimationSet.COLOR_PRIORITY);\n\n\t\tthis._pStateClass = ParticleColorState;\n\n\t\tthis._iUsesMultiplier = usesMultiplier;\n\t\tthis._iUsesOffset = usesOffset;\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iStartColor = startColor || new ColorTransform();\n\t\tthis._iEndColor = endColor || new ColorTransform();\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iCyclePhase = cyclePhase;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tif (this._iUsesCycle) {\n\t\t\t\tvar cycleConst:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.CYCLE_INDEX, cycleConst.index);\n\n\t\t\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\t\t\tvar sin:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\t\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\t\t\tcode += \"mul \" + sin + \",\" + animationRegisterCache.vertexTime + \",\" + cycleConst + \".x\\n\";\n\n\t\t\t\tif (this._iUsesPhase)\n\t\t\t\t\tcode += \"add \" + sin + \",\" + sin + \",\" + cycleConst + \".y\\n\";\n\n\t\t\t\tcode += \"sin \" + sin + \",\" + sin + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tvar startMultiplierValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\t\t\tvar deltaMultiplierValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.START_MULTIPLIER_INDEX, startMultiplierValue.index);\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.DELTA_MULTIPLIER_INDEX, deltaMultiplierValue.index);\n\n\t\t\t\tcode += \"mul \" + temp + \",\" + deltaMultiplierValue + \",\" + (this._iUsesCycle? sin : animationRegisterCache.vertexLife) + \"\\n\";\n\t\t\t\tcode += \"add \" + temp + \",\" + temp + \",\" + startMultiplierValue + \"\\n\";\n\t\t\t\tcode += \"mul \" + animationRegisterCache.colorMulTarget + \",\" + temp + \",\" + animationRegisterCache.colorMulTarget + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tvar startOffsetValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.LOCAL_STATIC)? animationRegisterCache.getFreeVertexAttribute() : animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tvar deltaOffsetValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.LOCAL_STATIC)? animationRegisterCache.getFreeVertexAttribute() : animationRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.START_OFFSET_INDEX, startOffsetValue.index);\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.DELTA_OFFSET_INDEX, deltaOffsetValue.index);\n\n\t\t\t\tcode += \"mul \" + temp + \",\" + deltaOffsetValue + \",\" + (this._iUsesCycle? sin : animationRegisterCache.vertexLife) + \"\\n\";\n\t\t\t\tcode += \"add \" + temp + \",\" + temp + \",\" + startOffsetValue + \"\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + temp + \",\" + animationRegisterCache.colorAddTarget + \"\\n\";\n\t\t\t}\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleColorState\n\t{\n\t\treturn <ParticleColorState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tif (this._iUsesMultiplier)\n\t\t\tparticleAnimationSet.hasColorMulNode = true;\n\t\tif (this._iUsesOffset)\n\t\t\tparticleAnimationSet.hasColorAddNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar startColor:ColorTransform = param[ParticleColorNode.COLOR_START_COLORTRANSFORM];\n\t\tif (!startColor)\n\t\t\tthrow(new Error(\"there is no \" + ParticleColorNode.COLOR_START_COLORTRANSFORM + \" in param!\"));\n\n\t\tvar endColor:ColorTransform = param[ParticleColorNode.COLOR_END_COLORTRANSFORM];\n\t\tif (!endColor)\n\t\t\tthrow(new Error(\"there is no \" + ParticleColorNode.COLOR_END_COLORTRANSFORM + \" in param!\"));\n\n\t\tvar i:number /*uint*/ = 0;\n\n\t\tif (!this._iUsesCycle) {\n\t\t\t//multiplier\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tthis._pOneData[i++] = startColor.redMultiplier;\n\t\t\t\tthis._pOneData[i++] = startColor.greenMultiplier;\n\t\t\t\tthis._pOneData[i++] = startColor.blueMultiplier;\n\t\t\t\tthis._pOneData[i++] = startColor.alphaMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.redMultiplier - startColor.redMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.greenMultiplier - startColor.greenMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.blueMultiplier - startColor.blueMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.alphaMultiplier - startColor.alphaMultiplier;\n\t\t\t}\n\n\t\t\t//offset\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tthis._pOneData[i++] = startColor.redOffset/255;\n\t\t\t\tthis._pOneData[i++] = startColor.greenOffset/255;\n\t\t\t\tthis._pOneData[i++] = startColor.blueOffset/255;\n\t\t\t\tthis._pOneData[i++] = startColor.alphaOffset/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.redOffset - startColor.redOffset)/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.greenOffset - startColor.greenOffset)/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.blueOffset - startColor.blueOffset)/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.alphaOffset - startColor.alphaOffset)/255;\n\t\t\t}\n\t\t} else {\n\t\t\t//multiplier\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tthis._pOneData[i++] = (startColor.redMultiplier + endColor.redMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.greenMultiplier + endColor.greenMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.blueMultiplier + endColor.blueMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaMultiplier + endColor.alphaMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.redMultiplier - endColor.redMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.greenMultiplier - endColor.greenMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.blueMultiplier - endColor.blueMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaMultiplier - endColor.alphaMultiplier)/2;\n\t\t\t}\n\n\t\t\t//offset\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tthis._pOneData[i++] = (startColor.redOffset + endColor.redOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.greenOffset + endColor.greenOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.blueOffset + endColor.blueOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaOffset + endColor.alphaOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.redOffset - endColor.redOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.greenOffset - endColor.greenOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.blueOffset - endColor.blueOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaOffset - endColor.alphaOffset)/(255*2);\n\t\t\t}\n\t\t}\n\n\t}\n}\n\nexport = ParticleColorNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleFollowState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleFollowState\");\n\n/**\n * A particle animation node used to create a follow behaviour on a particle system.\n */\nclass ParticleFollowNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesPosition:boolean;\n\n\t/** @private */\n\tpublic _iUsesRotation:boolean;\n\n\t/** @private */\n\tpublic _iSmooth:boolean;\n\n\t/**\n\t * Creates a new <code>ParticleFollowNode</code>\n\t *\n\t * @param    [optional] usesPosition     Defines wehether the individual particle reacts to the position of the target.\n\t * @param    [optional] usesRotation     Defines wehether the individual particle reacts to the rotation of the target.\n\t * @param    [optional] smooth     Defines wehether the state calculate the interpolated value.\n\t */\n\tconstructor(usesPosition:boolean = true, usesRotation:boolean = true, smooth:boolean = false)\n\t{\n\t\tsuper(\"ParticleFollow\", ParticlePropertiesMode.LOCAL_DYNAMIC, (usesPosition && usesRotation)? 6 : 3, ParticleAnimationSet.POST_PRIORITY);\n\n\t\tthis._pStateClass = ParticleFollowState;\n\n\t\tthis._iUsesPosition = usesPosition;\n\t\tthis._iUsesRotation = usesRotation;\n\t\tthis._iSmooth = smooth;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\t//TODO: use Quaternion to implement this function\n\t\tvar code:string = \"\";\n\t\tif (this._iUsesRotation) {\n\t\t\tvar rotationAttribute:ShaderRegisterElement = animationRegisterCache.getFreeVertexAttribute();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleFollowState.FOLLOW_ROTATION_INDEX, rotationAttribute.index);\n\n\t\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp2, 1);\n\t\t\tvar temp3:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tvar temp4:ShaderRegisterElement;\n\t\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\t\tanimationRegisterCache.addVertexTempUsages(temp3, 1);\n\t\t\t\ttemp4 = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\t}\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp2);\n\t\t\tif (animationRegisterCache.hasBillboard)\n\t\t\t\tanimationRegisterCache.removeVertexTempUsage(temp3);\n\n\t\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\t\tvar i:number /*int*/;\n\n\t\t\t//x axis\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"sin \" + temp3 + \".y,\" + rotationAttribute + \".x\\n\";\n\t\t\tcode += \"cos \" + temp3 + \".z,\" + rotationAttribute + \".x\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".x,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + temp3 + \".z\\n\";\n\t\t\tcode += \"neg \" + temp2 + \".z,\" + temp3 + \".y\\n\";\n\n\t\t\tif (animationRegisterCache.hasBillboard)\n\t\t\t\tcode += \"m33 \" + temp4 + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\telse {\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t\t}\n\n\t\t\t//y axis\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"cos \" + temp1 + \".x,\" + rotationAttribute + \".y\\n\";\n\t\t\tcode += \"sin \" + temp1 + \".z,\" + rotationAttribute + \".y\\n\";\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"neg \" + temp3 + \".x,\" + temp1 + \".z\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + temp1 + \".x\\n\";\n\n\t\t\tif (animationRegisterCache.hasBillboard)\n\t\t\t\tcode += \"m33 \" + temp4 + \".xyz,\" + temp4 + \".xyz,\" + temp1 + \"\\n\";\n\t\t\telse {\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t\t}\n\n\t\t\t//z axis\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"sin \" + temp2 + \".x,\" + rotationAttribute + \".z\\n\";\n\t\t\tcode += \"cos \" + temp2 + \".y,\" + rotationAttribute + \".z\\n\";\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + temp2 + \".y\\n\";\n\t\t\tcode += \"neg \" + temp1 + \".y,\" + temp2 + \".x\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\n\t\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\t\tcode += \"m33 \" + temp4 + \".xyz,\" + temp4 + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tcode += \"sub \" + temp4 + \".xyz,\" + temp4 + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp4 + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t\t} else {\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t\t}\n\n\t\t}\n\n\t\tif (this._iUsesPosition) {\n\t\t\tvar positionAttribute:ShaderRegisterElement = animationRegisterCache.getFreeVertexAttribute();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleFollowState.FOLLOW_POSITION_INDEX, positionAttribute.index);\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + positionAttribute + \",\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleFollowState\n\t{\n\t\treturn <ParticleFollowState> animator.getAnimationState(this);\n\t}\n}\n\nexport = ParticleFollowNode;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleInitialColorState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleInitialColorState\");\n\n/**\n *\n */\nclass ParticleInitialColorNode extends ParticleNodeBase\n{\n\t//default values used when creating states\n\t/** @private */\n\tpublic _iUsesMultiplier:boolean;\n\t/** @private */\n\tpublic _iUsesOffset:boolean;\n\t/** @private */\n\tpublic _iInitialColor:ColorTransform;\n\n\t/**\n\t * Reference for color node properties on a single particle (when in local property mode).\n\t * Expects a <code>ColorTransform</code> object representing the color transform applied to the particle.\n\t */\n\tpublic static COLOR_INITIAL_COLORTRANSFORM:string = \"ColorInitialColorTransform\";\n\n\tconstructor(mode:number /*uint*/, usesMultiplier:boolean = true, usesOffset:boolean = false, initialColor:ColorTransform = null)\n\t{\n\t\tsuper(\"ParticleInitialColor\", mode, (usesMultiplier && usesOffset)? 8 : 4, ParticleAnimationSet.COLOR_PRIORITY);\n\n\t\tthis._pStateClass = ParticleInitialColorState;\n\n\t\tthis._iUsesMultiplier = usesMultiplier;\n\t\tthis._iUsesOffset = usesOffset;\n\t\tthis._iInitialColor = initialColor || new ColorTransform();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tvar multiplierValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleInitialColorState.MULTIPLIER_INDEX, multiplierValue.index);\n\n\t\t\t\tcode += \"mul \" + animationRegisterCache.colorMulTarget + \",\" + multiplierValue + \",\" + animationRegisterCache.colorMulTarget + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tvar offsetValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.LOCAL_STATIC)? animationRegisterCache.getFreeVertexAttribute() : animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleInitialColorState.OFFSET_INDEX, offsetValue.index);\n\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + offsetValue + \",\" + animationRegisterCache.colorAddTarget + \"\\n\";\n\t\t\t}\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tif (this._iUsesMultiplier)\n\t\t\tparticleAnimationSet.hasColorMulNode = true;\n\t\tif (this._iUsesOffset)\n\t\t\tparticleAnimationSet.hasColorAddNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar initialColor:ColorTransform = param[ParticleInitialColorNode.COLOR_INITIAL_COLORTRANSFORM];\n\t\tif (!initialColor)\n\t\t\tthrow(new Error(\"there is no \" + ParticleInitialColorNode.COLOR_INITIAL_COLORTRANSFORM + \" in param!\"));\n\n\t\tvar i:number /*uint*/ = 0;\n\n\t\t//multiplier\n\t\tif (this._iUsesMultiplier) {\n\t\t\tthis._pOneData[i++] = initialColor.redMultiplier;\n\t\t\tthis._pOneData[i++] = initialColor.greenMultiplier;\n\t\t\tthis._pOneData[i++] = initialColor.blueMultiplier;\n\t\t\tthis._pOneData[i++] = initialColor.alphaMultiplier;\n\t\t}\n\t\t//offset\n\t\tif (this._iUsesOffset) {\n\t\t\tthis._pOneData[i++] = initialColor.redOffset/255;\n\t\t\tthis._pOneData[i++] = initialColor.greenOffset/255;\n\t\t\tthis._pOneData[i++] = initialColor.blueOffset/255;\n\t\t\tthis._pOneData[i++] = initialColor.alphaOffset/255;\n\t\t}\n\n\t}\n\n}\n\nexport = ParticleInitialColorNode;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\n\n/**\n * Provides an abstract base class for particle animation nodes.\n */\nclass ParticleNodeBase extends AnimationNodeBase\n{\n\tprivate _priority:number /*int*/;\n\n\tpublic _pMode:number /*uint*/;\n\tpublic _pDataLength:number /*uint*/ = 3;\n\tpublic _pOneData:Array<number>;\n\n\tpublic _iDataOffset:number /*uint*/;\n\n\t//modes alias\n\tprivate static GLOBAL:string = 'Global';\n\tprivate static LOCAL_STATIC:string = 'LocalStatic';\n\tprivate static LOCAL_DYNAMIC:string = 'LocalDynamic';\n\n\t//modes list\n\tprivate static MODES:Object =\n\t{\n\t\t0:ParticleNodeBase.GLOBAL,\n\t\t1:ParticleNodeBase.LOCAL_STATIC,\n\t\t2:ParticleNodeBase.LOCAL_DYNAMIC\n\t};\n\n\t/**\n\t * Returns the property mode of the particle animation node. Typically set in the node constructor\n\t *\n\t * @see away.animators.ParticlePropertiesMode\n\t */\n\tpublic get mode():number /*uint*/\n\t{\n\t\treturn this._pMode;\n\t}\n\n\t/**\n\t * Returns the priority of the particle animation node, used to order the agal generated in a particle animation set. Set automatically on instantiation.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t * @see #getAGALVertexCode\n\t */\n\tpublic get priority():number /*int*/\n\t{\n\t\treturn this._priority;\n\t}\n\n\t/**\n\t * Returns the length of the data used by the node when in <code>LOCAL_STATIC</code> mode. Used to generate the local static data of the particle animation set.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t * @see #getAGALVertexCode\n\t */\n\tpublic get dataLength():number /*int*/\n\t{\n\t\treturn this._pDataLength;\n\t}\n\n\t/**\n\t * Returns the generated data vector of the node after one particle pass during the generation of all local static data of the particle animation set.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t * @see #generatePropertyOfOneParticle\n\t */\n\tpublic get oneData():Array<number>\n\t{\n\t\treturn this._pOneData;\n\t}\n\n\t/**\n\t * Creates a new <code>ParticleNodeBase</code> object.\n\t *\n\t * @param               name            Defines the generic name of the particle animation node.\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param               dataLength      Defines the length of the data used by the node when in <code>LOCAL_STATIC</code> mode.\n\t * @param    [optional] priority        the priority of the particle animation node, used to order the agal generated in a particle animation set. Defaults to 1.\n\t */\n\tconstructor(name:string, mode:number /*uint*/, dataLength:number /*uint*/, priority:number /*int*/ = 1)\n\t{\n\t\tsuper();\n\n\t\tname = name + ParticleNodeBase.MODES[mode];\n\n\t\tthis.name = name;\n\t\tthis._pMode = mode;\n\t\tthis._priority = priority;\n\t\tthis._pDataLength = dataLength;\n\n\t\tthis._pOneData = new Array<number>(this._pDataLength);\n\t}\n\n\t/**\n\t * Returns the AGAL code of the particle animation node for use in the vertex shader.\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Returns the AGAL code of the particle animation node for use in the fragment shader.\n\t */\n\tpublic getAGALFragmentCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Returns the AGAL code of the particle animation node for use in the fragment shader when UV coordinates are required.\n\t */\n\tpublic getAGALUVCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Called internally by the particle animation set when assigning the set of static properties originally defined by the initParticleFunc of the set.\n\t *\n\t * @see away.animators.ParticleAnimationSet#initParticleFunc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\n\t}\n\n\t/**\n\t * Called internally by the particle animation set when determining the requirements of the particle animation node AGAL.\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\n\t}\n}\n\nexport = ParticleNodeBase;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleOrbitState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleOrbitState\");\n\n/**\n * A particle animation node used to control the position of a particle over time around a circular orbit.\n */\nclass ParticleOrbitNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesEulers:boolean;\n\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\n\t/** @private */\n\tpublic _iRadius:number;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\t/** @private */\n\tpublic _iEulers:Vector3D;\n\n\t/**\n\t * Reference for orbit node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the radius (x), cycle speed (y) and cycle phase (z) of the motion on the particle.\n\t */\n\tpublic static ORBIT_VECTOR3D:string = \"OrbitVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleOrbitNode</code> object.\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] usesEulers      Defines whether the node uses the <code>eulers</code> property in the shader to calculate a rotation on the orbit. Defaults to true.\n\t * @param    [optional] usesCycle       Defines whether the node uses the <code>cycleDuration</code> property in the shader to calculate the period of the orbit independent of particle duration. Defaults to false.\n\t * @param    [optional] usesPhase       Defines whether the node uses the <code>cyclePhase</code> property in the shader to calculate a starting offset to the cycle rotation of the particle. Defaults to false.\n\t * @param    [optional] radius          Defines the radius of the orbit when in global mode. Defaults to 100.\n\t * @param    [optional] cycleDuration   Defines the duration of the orbit in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the phase of the orbit in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t * @param    [optional] eulers          Defines the euler rotation in degrees, applied to the orientation of the orbit when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, usesEulers:boolean = true, usesCycle:boolean = false, usesPhase:boolean = false, radius:number = 100, cycleDuration:number = 1, cyclePhase:number = 0, eulers:Vector3D = null)\n\t{\n\t\tvar len:number /*int*/ = 3;\n\t\tif (usesPhase)\n\t\t\tlen++;\n\t\tsuper(\"ParticleOrbit\", mode, len);\n\n\t\tthis._pStateClass = ParticleOrbitState;\n\n\t\tthis._iUsesEulers = usesEulers;\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iRadius = radius;\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iCyclePhase = cyclePhase;\n\t\tthis._iEulers = eulers || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar orbitRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleOrbitState.ORBIT_INDEX, orbitRegister.index);\n\n\t\tvar eulersMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleOrbitState.EULERS_INDEX, eulersMatrixRegister.index);\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\tvar distance:ShaderRegisterElement = new ShaderRegisterElement(temp1.regName, temp1.index);\n\n\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index, 0);\n\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index, 1);\n\t\tvar degree:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index, 2);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\n\t\tvar code:string = \"\";\n\n\t\tif (this._iUsesCycle) {\n\t\t\tcode += \"mul \" + degree + \",\" + animationRegisterCache.vertexTime + \",\" + orbitRegister + \".y\\n\";\n\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tcode += \"add \" + degree + \",\" + degree + \",\" + orbitRegister + \".w\\n\";\n\t\t} else\n\t\t\tcode += \"mul \" + degree + \",\" + animationRegisterCache.vertexLife + \",\" + orbitRegister + \".y\\n\";\n\n\t\tcode += \"cos \" + cos + \",\" + degree + \"\\n\";\n\t\tcode += \"sin \" + sin + \",\" + degree + \"\\n\";\n\t\tcode += \"mul \" + distance + \".x,\" + cos + \",\" + orbitRegister + \".x\\n\";\n\t\tcode += \"mul \" + distance + \".y,\" + sin + \",\" + orbitRegister + \".x\\n\";\n\t\tcode += \"mov \" + distance + \".wz\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\tif (this._iUsesEulers)\n\t\t\tcode += \"m44 \" + distance + \",\" + distance + \",\" + eulersMatrixRegister + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tcode += \"neg \" + distance + \".x,\" + sin + \"\\n\";\n\t\t\tcode += \"mov \" + distance + \".y,\" + cos + \"\\n\";\n\t\t\tcode += \"mov \" + distance + \".zw,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tif (this._iUsesEulers)\n\t\t\t\tcode += \"m44 \" + distance + \",\" + distance + \",\" + eulersMatrixRegister + \"\\n\";\n\t\t\tcode += \"mul \" + distance + \",\" + distance + \",\" + orbitRegister + \".z\\n\";\n\t\t\tcode += \"div \" + distance + \",\" + distance + \",\" + orbitRegister + \".y\\n\";\n\t\t\tif (!this._iUsesCycle)\n\t\t\t\tcode += \"div \" + distance + \",\" + distance + \",\" + animationRegisterCache.vertexLife + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleOrbitState\n\t{\n\t\treturn <ParticleOrbitState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\t//Vector3D.x is radius, Vector3D.y is cycle duration, Vector3D.z is phase\n\t\tvar orbit:Vector3D = param[ParticleOrbitNode.ORBIT_VECTOR3D];\n\t\tif (!orbit)\n\t\t\tthrow new Error(\"there is no \" + ParticleOrbitNode.ORBIT_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = orbit.x;\n\t\tif (this._iUsesCycle && orbit.y <= 0)\n\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\tthis._pOneData[1] = Math.PI*2/(!this._iUsesCycle? 1 : orbit.y);\n\t\tthis._pOneData[2] = orbit.x*Math.PI*2;\n\t\tif (this._iUsesPhase)\n\t\t\tthis._pOneData[3] = orbit.z*Math.PI/180;\n\t}\n}\n\nexport = ParticleOrbitNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleOscillatorState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleOscillatorState\");\n\n/**\n * A particle animation node used to control the position of a particle over time using simple harmonic motion.\n */\nclass ParticleOscillatorNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iOscillator:Vector3D;\n\n\t/**\n\t * Reference for ocsillator node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the axis (x,y,z) and cycle speed (w) of the motion on the particle.\n\t */\n\tpublic static OSCILLATOR_VECTOR3D:string = \"OscillatorVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleOscillatorNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] oscillator      Defines the default oscillator axis (x, y, z) and cycleDuration (w) of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, oscillator:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleOscillator\", mode, 4);\n\n\t\tthis._pStateClass = ParticleOscillatorState;\n\n\t\tthis._iOscillator = oscillator || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar oscillatorRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleOscillatorState.OSCILLATOR_INDEX, oscillatorRegister.index);\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar dgree:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar distance:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"mul \" + dgree + \",\" + animationRegisterCache.vertexTime + \",\" + oscillatorRegister + \".w\\n\";\n\t\tcode += \"sin \" + sin + \",\" + dgree + \"\\n\";\n\t\tcode += \"mul \" + distance + \".xyz,\" + sin + \",\" + oscillatorRegister + \".xyz\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tcode += \"cos \" + cos + \",\" + dgree + \"\\n\";\n\t\t\tcode += \"mul \" + distance + \".xyz,\" + cos + \",\" + oscillatorRegister + \".xyz\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleOscillatorState\n\t{\n\t\treturn <ParticleOscillatorState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\t//(Vector3D.x,Vector3D.y,Vector3D.z) is oscillator axis, Vector3D.w is oscillator cycle duration\n\t\tvar drift:Vector3D = param[ParticleOscillatorNode.OSCILLATOR_VECTOR3D];\n\t\tif (!drift)\n\t\t\tthrow(new Error(\"there is no \" + ParticleOscillatorNode.OSCILLATOR_VECTOR3D + \" in param!\"));\n\n\t\tthis._pOneData[0] = drift.x;\n\t\tthis._pOneData[1] = drift.y;\n\t\tthis._pOneData[2] = drift.z;\n\t\tif (drift.w <= 0)\n\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\t\tthis._pOneData[3] = Math.PI*2/drift.w;\n\t}\n}\n\nexport = ParticleOscillatorNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticlePositionState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticlePositionState\");\n\n/**\n * A particle animation node used to set the starting position of a particle.\n */\nclass ParticlePositionNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iPosition:Vector3D;\n\n\t/**\n\t * Reference for position node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing position of the particle.\n\t */\n\tpublic static POSITION_VECTOR3D:string = \"PositionVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticlePositionNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] position        Defines the default position of the particle when in global mode. Defaults to 0,0,0.\n\t */\n\tconstructor(mode:number /*uint*/, position:Vector3D = null)\n\t{\n\t\tsuper(\"ParticlePosition\", mode, 3);\n\n\t\tthis._pStateClass = ParticlePositionState;\n\n\t\tthis._iPosition = position || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar positionAttribute:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticlePositionState.POSITION_INDEX, positionAttribute.index);\n\n\t\treturn \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticlePositionState\n\t{\n\t\treturn <ParticlePositionState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar offset:Vector3D = param[ParticlePositionNode.POSITION_VECTOR3D];\n\t\tif (!offset)\n\t\t\tthrow(new Error(\"there is no \" + ParticlePositionNode.POSITION_VECTOR3D + \" in param!\"));\n\n\t\tthis._pOneData[0] = offset.x;\n\t\tthis._pOneData[1] = offset.y;\n\t\tthis._pOneData[2] = offset.z;\n\t}\n}\n\nexport = ParticlePositionNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotateToHeadingState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState\");\n\n/**\n * A particle animation node used to control the rotation of a particle to match its heading vector.\n */\nclass ParticleRotateToHeadingNode extends ParticleNodeBase\n{\n\t/**\n\t * Creates a new <code>ParticleBillboardNode</code>\n\t */\n\tconstructor()\n\t{\n\t\tsuper(\"ParticleRotateToHeading\", ParticlePropertiesMode.GLOBAL, 0, 3);\n\n\t\tthis._pStateClass = ParticleRotateToHeadingState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\tvar i:number /*int*/;\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp2, 1);\n\t\t\tvar temp3:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tvar rotationMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotateToHeadingState.MATRIX_INDEX, rotationMatrixRegister.index);\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp2);\n\n\t\t\t//process the velocity\n\t\t\tcode += \"m33 \" + temp1 + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz,\" + rotationMatrixRegister + \"\\n\";\n\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".xy,\" + temp1 + \".xy\\n\";\n\t\t\tcode += \"nrm \" + temp3 + \".xyz,\" + temp3 + \".xyz\\n\";\n\n\t\t\t//temp3.x=cos,temp3.y=sin\n\t\t\t//only process z axis\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".x,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"neg \" + temp1 + \".y,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t} else {\n\t\t\tvar nrmVel:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(nrmVel, 1);\n\n\t\t\tvar xAxis:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(xAxis, 1);\n\n\t\t\tvar R:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(R, 1);\n\t\t\tvar R_rev:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(R.regName, R.index, 3);\n\t\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(R_rev.regName, R_rev.index, 3);\n\t\t\tvar cos2:ShaderRegisterElement = new ShaderRegisterElement(nrmVel.regName, nrmVel.index, 3);\n\t\t\tvar tempSingle:ShaderRegisterElement = sin;\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(nrmVel);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(xAxis);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(R);\n\n\t\t\tcode += \"mov \" + xAxis + \".x,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mov \" + xAxis + \".yz,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\n\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t\tcode += \"dp3 \" + cos2 + \",\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + xAxis + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t//use R as temp to judge if nrm is (0,0,0).\n\t\t\t//if nrm is (0,0,0) ,change it to (0,0,1).\n\t\t\tcode += \"dp3 \" + R + \".x,\" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"sge \" + R + \".x,\" + animationRegisterCache.vertexZeroConst + \",\" + R + \".x\\n\";\n\t\t\tcode += \"add \" + nrmVel + \".z,\" + R + \".x,\" + nrmVel + \".z\\n\";\n\n\t\t\tcode += \"add \" + tempSingle + \",\" + cos2 + \",\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"sqt \" + cos + \",\" + tempSingle + \"\\n\";\n\n\t\t\tcode += \"sub \" + tempSingle + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos2 + \"\\n\";\n\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"sqt \" + sin + \",\" + tempSingle + \"\\n\";\n\n\t\t\tcode += \"mul \" + R + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\n\t\t\t//use cos as R.w\n\n\t\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\n\t\t\t//use cos as R_rev.w\n\n\t\t\t//nrmVel and xAxis are used as temp register\n\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + R + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\n\t\t\t//use cos as R.w\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"dp3 \" + xAxis + \".w,\" + R + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\n\t\t\tcode += \"crs \" + R + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\t//code += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" +R_rev + \".w\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\t\tcode += \"add \" + R + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t//just repeat the calculate above\n\t\t\t\t//because of the limited registers, no need to optimise\n\t\t\t\tcode += \"mov \" + xAxis + \".x,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\t\tcode += \"mov \" + xAxis + \".yz,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t\t\tcode += \"dp3 \" + cos2 + \",\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + xAxis + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"dp3 \" + R + \".x,\" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"sge \" + R + \".x,\" + animationRegisterCache.vertexZeroConst + \",\" + R + \".x\\n\";\n\t\t\t\tcode += \"add \" + nrmVel + \".z,\" + R + \".x,\" + nrmVel + \".z\\n\";\n\t\t\t\tcode += \"add \" + tempSingle + \",\" + cos2 + \",\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\t\tcode += \"sqt \" + cos + \",\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"sub \" + tempSingle + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos2 + \"\\n\";\n\t\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\t\tcode += \"sqt \" + sin + \",\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + R + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t\tcode += \"dp3 \" + xAxis + \".w,\" + R + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\t\t\t\tcode += \"crs \" + R + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\t\t\tcode += \"add \" + R + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t}\n\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleRotateToHeadingState\n\t{\n\t\treturn <ParticleRotateToHeadingState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.needVelocity = true;\n\t}\n}\n\nexport = ParticleRotateToHeadingNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotateToPositionState\t= require(\"awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState\");\n\n/**\n * A particle animation node used to control the rotation of a particle to face to a position\n */\nclass ParticleRotateToPositionNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iPosition:Vector3D;\n\n\t/**\n\t * Reference for the position the particle will rotate to face for a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the position that the particle must face.\n\t */\n\tpublic static POSITION_VECTOR3D:string = \"RotateToPositionVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleRotateToPositionNode</code>\n\t */\n\tconstructor(mode:number /*uint*/, position:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleRotateToPosition\", mode, 3, 3);\n\n\t\tthis._pStateClass = ParticleRotateToPositionState;\n\n\t\tthis._iPosition = position || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar positionAttribute:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotateToPositionState.POSITION_INDEX, positionAttribute.index);\n\n\t\tvar code:string = \"\";\n\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\tvar i:number /*int*/;\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp2, 1);\n\t\t\tvar temp3:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tvar rotationMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotateToPositionState.MATRIX_INDEX, rotationMatrixRegister.index);\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp2);\n\n\t\t\t//process the position\n\t\t\tcode += \"sub \" + temp1 + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\tcode += \"m33 \" + temp1 + \".xyz,\" + temp1 + \".xyz,\" + rotationMatrixRegister + \"\\n\";\n\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".xy,\" + temp1 + \".xy\\n\";\n\t\t\tcode += \"nrm \" + temp3 + \".xyz,\" + temp3 + \".xyz\\n\";\n\n\t\t\t//temp3.x=cos,temp3.y=sin\n\t\t\t//only process z axis\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".x,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"neg \" + temp1 + \".y,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t} else {\n\t\t\tvar nrmDirection:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(nrmDirection, 1);\n\n\t\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\t\tvar o_temp:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\t\tvar tempSingle:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 3);\n\n\t\t\tvar R:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(R, 1);\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(nrmDirection);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(R);\n\n\t\t\tcode += \"sub \" + nrmDirection + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\n\t\t\tcode += \"mov \" + sin + \",\" + nrmDirection + \".y\\n\";\n\t\t\tcode += \"mul \" + cos + \",\" + sin + \",\" + sin + \"\\n\";\n\t\t\tcode += \"sub \" + cos + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\tcode += \"sqt \" + cos + \",\" + cos + \"\\n\";\n\n\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".y\\n\";\n\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".y\\n\";\n\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\n\t\t\tcode += \"sub \" + animationRegisterCache.scaleAndRotateTarget + \".y,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\n\t\t\tcode += \"abs \" + R + \".y,\" + nrmDirection + \".y\\n\";\n\t\t\tcode += \"sge \" + R + \".z,\" + R + \".y,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mul \" + R + \".x,\" + R + \".y,\" + nrmDirection + \".y\\n\";\n\n\t\t\t//judgu if nrmDirection=(0,1,0);\n\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"dp3 \" + sin + \",\" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\tcode += \"sge \" + tempSingle + \",\" + animationRegisterCache.vertexZeroConst + \",\" + sin + \"\\n\";\n\n\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\n\t\t\tcode += \"sub \" + sin + \",\" + animationRegisterCache.vertexOneConst + \",\" + tempSingle + \"\\n\";\n\t\t\tcode += \"mul \" + sin + \",\" + sin + \",\" + nrmDirection + \".x\\n\";\n\n\t\t\tcode += \"mov \" + cos + \",\" + nrmDirection + \".z\\n\";\n\t\t\tcode += \"neg \" + cos + \",\" + cos + \"\\n\";\n\t\t\tcode += \"sub \" + o_temp + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\tcode += \"mul \" + o_temp + \",\" + R + \".x,\" + tempSingle + \"\\n\";\n\t\t\tcode += \"add \" + cos + \",\" + cos + \",\" + o_temp + \"\\n\";\n\n\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".x\\n\";\n\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".x\\n\";\n\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\n\t\t\tcode += \"sub \" + animationRegisterCache.scaleAndRotateTarget + \".x,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t//just repeat the calculate above\n\t\t\t\t//because of the limited registers, no need to optimise\n\t\t\t\tcode += \"sub \" + nrmDirection + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\t\tcode += \"mov \" + sin + \",\" + nrmDirection + \".y\\n\";\n\t\t\t\tcode += \"mul \" + cos + \",\" + sin + \",\" + sin + \"\\n\";\n\t\t\t\tcode += \"sub \" + cos + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"sqt \" + cos + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".y\\n\";\n\t\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".y\\n\";\n\t\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"sub \" + animationRegisterCache.rotationRegisters[i] + \".y,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\t\t\t\tcode += \"abs \" + R + \".y,\" + nrmDirection + \".y\\n\";\n\t\t\t\tcode += \"sge \" + R + \".z,\" + R + \".y,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".x,\" + R + \".y,\" + nrmDirection + \".y\\n\";\n\t\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\tcode += \"dp3 \" + sin + \",\" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\t\tcode += \"sge \" + tempSingle + \",\" + animationRegisterCache.vertexZeroConst + \",\" + sin + \"\\n\";\n\t\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\t\tcode += \"sub \" + sin + \",\" + animationRegisterCache.vertexOneConst + \",\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"mul \" + sin + \",\" + sin + \",\" + nrmDirection + \".x\\n\";\n\t\t\t\tcode += \"mov \" + cos + \",\" + nrmDirection + \".z\\n\";\n\t\t\t\tcode += \"neg \" + cos + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"sub \" + o_temp + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"mul \" + o_temp + \",\" + R + \".x,\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"add \" + cos + \",\" + cos + \",\" + o_temp + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".x\\n\";\n\t\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".x\\n\";\n\t\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"sub \" + animationRegisterCache.rotationRegisters[i] + \".x,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\t\t\t}\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleRotateToPositionState\n\t{\n\t\treturn <ParticleRotateToPositionState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar offset:Vector3D = param[ParticleRotateToPositionNode.POSITION_VECTOR3D];\n\t\tif (!offset)\n\t\t\tthrow(new Error(\"there is no \" + ParticleRotateToPositionNode.POSITION_VECTOR3D + \" in param!\"));\n\n\t\tthis._pOneData[0] = offset.x;\n\t\tthis._pOneData[1] = offset.y;\n\t\tthis._pOneData[2] = offset.z;\n\t}\n}\n\nexport = ParticleRotateToPositionNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotationalVelocityState\t= require(\"awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState\");\n\n/**\n * A particle animation node used to set the starting rotational velocity of a particle.\n */\nclass ParticleRotationalVelocityNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iRotationalVelocity:Vector3D;\n\n\t/**\n\t * Reference for rotational velocity node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the rotational velocity around an axis of the particle.\n\t */\n\tpublic static ROTATIONALVELOCITY_VECTOR3D:string = \"RotationalVelocityVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleRotationalVelocityNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t */\n\tconstructor(mode:number /*uint*/, rotationalVelocity:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleRotationalVelocity\", mode, 4);\n\n\t\tthis._pStateClass = ParticleRotationalVelocityState;\n\n\t\tthis._iRotationalVelocity = rotationalVelocity || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar rotationRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX, rotationRegister.index);\n\n\t\tvar nrmVel:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(nrmVel, 1);\n\n\t\tvar xAxis:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(xAxis, 1);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\tvar Rtemp:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index);\n\t\tvar R_rev:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tR_rev = new ShaderRegisterElement(R_rev.regName, R_rev.index);\n\n\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(Rtemp.regName, Rtemp.index, 3);\n\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(R_rev.regName, R_rev.index, 3);\n\n\t\tanimationRegisterCache.removeVertexTempUsage(nrmVel);\n\t\tanimationRegisterCache.removeVertexTempUsage(xAxis);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"mov \" + nrmVel + \".xyz,\" + rotationRegister + \".xyz\\n\";\n\t\tcode += \"mov \" + nrmVel + \".w,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\n\t\tcode += \"mul \" + cos + \",\" + animationRegisterCache.vertexTime + \",\" + rotationRegister + \".w\\n\";\n\n\t\tcode += \"sin \" + sin + \",\" + cos + \"\\n\";\n\t\tcode += \"cos \" + cos + \",\" + cos + \"\\n\";\n\n\t\tcode += \"mul \" + Rtemp + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\n\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\n\t\t//nrmVel and xAxis are used as temp register\n\t\tcode += \"crs \" + nrmVel + \".xyz,\" + Rtemp + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\n\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\tcode += \"dp3 \" + xAxis + \".w,\" + Rtemp + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\n\t\tcode += \"crs \" + Rtemp + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\n\t\t//use cos as R_rev.w\n\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\tcode += \"add \" + Rtemp + \".xyz,\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\n\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\n\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\tfor (var i:number /*int*/ = 0; i < len; i++) {\n\t\t\tcode += \"mov \" + nrmVel + \".xyz,\" + rotationRegister + \".xyz\\n\";\n\t\t\tcode += \"mov \" + nrmVel + \".w,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mul \" + cos + \",\" + animationRegisterCache.vertexTime + \",\" + rotationRegister + \".w\\n\";\n\t\t\tcode += \"sin \" + sin + \",\" + cos + \"\\n\";\n\t\t\tcode += \"cos \" + cos + \",\" + cos + \"\\n\";\n\t\t\tcode += \"mul \" + Rtemp + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + Rtemp + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \"\\n\";\n\t\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"dp3 \" + xAxis + \".w,\" + Rtemp + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \"\\n\";\n\t\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\t\t\tcode += \"crs \" + Rtemp + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\t\tcode += \"add \" + Rtemp + \".xyz,\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \",\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleRotationalVelocityState\n\t{\n\t\treturn <ParticleRotationalVelocityState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\t//(Vector3d.x,Vector3d.y,Vector3d.z) is rotation axis,Vector3d.w is cycle duration\n\t\tvar rotate:Vector3D = param[ParticleRotationalVelocityNode.ROTATIONALVELOCITY_VECTOR3D];\n\t\tif (!rotate)\n\t\t\tthrow(new Error(\"there is no \" + ParticleRotationalVelocityNode.ROTATIONALVELOCITY_VECTOR3D + \" in param!\"));\n\n\t\tif (rotate.length <= 0)\n\t\t\trotate.z = 1; //set the default direction\n\t\telse\n\t\t\trotate.normalize();\n\n\t\tthis._pOneData[0] = rotate.x;\n\t\tthis._pOneData[1] = rotate.y;\n\t\tthis._pOneData[2] = rotate.z;\n\t\tif (rotate.w <= 0)\n\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\t\t// it's used as angle/2 in agal\n\t\tthis._pOneData[3] = Math.PI/rotate.w;\n\t}\n}\n\nexport = ParticleRotationalVelocityNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleScaleState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleScaleState\");\n\n/**\n * A particle animation node used to control the scale variation of a particle over time.\n */\nclass ParticleScaleNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\n\t/** @private */\n\tpublic _iMinScale:number;\n\t/** @private */\n\tpublic _iMaxScale:number;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\n\t/**\n\t * Reference for scale node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> representing the min scale (x), max scale(y), optional cycle speed (z) and phase offset (w) applied to the particle.\n\t */\n\tpublic static SCALE_VECTOR3D:string = \"ScaleVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleScaleNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] usesCycle       Defines whether the node uses the <code>cycleDuration</code> property in the shader to calculate the period of animation independent of particle duration. Defaults to false.\n\t * @param    [optional] usesPhase       Defines whether the node uses the <code>cyclePhase</code> property in the shader to calculate a starting offset to the animation cycle. Defaults to false.\n\t * @param    [optional] minScale        Defines the default min scale transform of the node, when in global mode. Defaults to 1.\n\t * @param    [optional] maxScale        Defines the default max color transform of the node, when in global mode. Defaults to 1.\n\t * @param    [optional] cycleDuration   Defines the default duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the default phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tconstructor(mode:number /*uint*/, usesCycle:boolean, usesPhase:boolean, minScale:number = 1, maxScale:number = 1, cycleDuration:number = 1, cyclePhase:number = 0)\n\t{\n\t\tsuper(\"ParticleScale\", mode, (usesCycle && usesPhase)? 4 : ((usesCycle || usesPhase)? 3 : 2), 3);\n\n\t\tthis._pStateClass = ParticleScaleState;\n\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iMinScale = minScale;\n\t\tthis._iMaxScale = maxScale;\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iCyclePhase = cyclePhase;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\n\t\tvar scaleRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleScaleState.SCALE_INDEX, scaleRegister.index);\n\n\t\tif (this._iUsesCycle) {\n\t\t\tcode += \"mul \" + temp + \",\" + animationRegisterCache.vertexTime + \",\" + scaleRegister + \".z\\n\";\n\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tcode += \"add \" + temp + \",\" + temp + \",\" + scaleRegister + \".w\\n\";\n\n\t\t\tcode += \"sin \" + temp + \",\" + temp + \"\\n\";\n\t\t}\n\n\t\tcode += \"mul \" + temp + \",\" + scaleRegister + \".y,\" + ((this._iUsesCycle)? temp : animationRegisterCache.vertexLife) + \"\\n\";\n\t\tcode += \"add \" + temp + \",\" + scaleRegister + \".x,\" + temp + \"\\n\";\n\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleScaleState\n\t{\n\t\treturn <ParticleScaleState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar scale:Vector3D = param[ParticleScaleNode.SCALE_VECTOR3D];\n\t\tif (!scale)\n\t\t\tthrow(new Error(\"there is no \" + ParticleScaleNode.SCALE_VECTOR3D + \" in param!\"));\n\n\t\tif (this._iUsesCycle) {\n\t\t\tthis._pOneData[0] = (scale.x + scale.y)/2;\n\t\t\tthis._pOneData[1] = Math.abs(scale.x - scale.y)/2;\n\t\t\tif (scale.z <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tthis._pOneData[2] = Math.PI*2/scale.z;\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tthis._pOneData[3] = scale.w*Math.PI/180;\n\t\t} else {\n\t\t\tthis._pOneData[0] = scale.x;\n\t\t\tthis._pOneData[1] = scale.y - scale.x;\n\t\t}\n\t}\n}\n\nexport = ParticleScaleNode;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ColorSegmentPoint\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ColorSegmentPoint\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleSegmentedColorState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState\");\n\n/**\n *\n */\nclass ParticleSegmentedColorNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesMultiplier:boolean;\n\t/** @private */\n\tpublic _iUsesOffset:boolean;\n\t/** @private */\n\tpublic _iStartColor:ColorTransform;\n\t/** @private */\n\tpublic _iEndColor:ColorTransform;\n\t/** @private */\n\tpublic _iNumSegmentPoint:number /*int*/;\n\t/** @private */\n\tpublic _iSegmentPoints:Array<ColorSegmentPoint>;\n\n\tconstructor(usesMultiplier:boolean, usesOffset:boolean, numSegmentPoint:number /*int*/, startColor:ColorTransform, endColor:ColorTransform, segmentPoints:Array<ColorSegmentPoint>)\n\t{\n\t\t//because of the stage3d register limitation, it only support the global mode\n\t\tsuper(\"ParticleSegmentedColor\", ParticlePropertiesMode.GLOBAL, 0, ParticleAnimationSet.COLOR_PRIORITY);\n\n\t\tthis._pStateClass = ParticleSegmentedColorState;\n\n\t\tif (numSegmentPoint > 4)\n\t\t\tthrow(new Error(\"the numSegmentPoint must be less or equal 4\"));\n\t\tthis._iUsesMultiplier = usesMultiplier;\n\t\tthis._iUsesOffset = usesOffset;\n\t\tthis._iNumSegmentPoint = numSegmentPoint;\n\t\tthis._iStartColor = startColor;\n\t\tthis._iEndColor = endColor;\n\t\tthis._iSegmentPoints = segmentPoints;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tif (this._iUsesMultiplier)\n\t\t\tparticleAnimationSet.hasColorMulNode = true;\n\t\tif (this._iUsesOffset)\n\t\t\tparticleAnimationSet.hasColorAddNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tvar accMultiplierColor:ShaderRegisterElement;\n\t\t\t//var accOffsetColor:ShaderRegisterElement;\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\taccMultiplierColor = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tanimationRegisterCache.addVertexTempUsages(accMultiplierColor, 1);\n\t\t\t}\n\n\t\t\tvar tempColor:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(tempColor, 1);\n\n\t\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tvar accTime:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\t\tvar tempTime:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\n\t\t\tif (this._iUsesMultiplier)\n\t\t\t\tanimationRegisterCache.removeVertexTempUsage(accMultiplierColor);\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(tempColor);\n\n\t\t\t//for saving all the life values (at most 4)\n\t\t\tvar lifeTimeRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSegmentedColorState.TIME_DATA_INDEX, lifeTimeRegister.index);\n\n\t\t\tvar i:number /*int*/;\n\n\t\t\tvar startMulValue:ShaderRegisterElement;\n\t\t\tvar deltaMulValues:Array<ShaderRegisterElement>;\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tstartMulValue = animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSegmentedColorState.START_MULTIPLIER_INDEX, startMulValue.index);\n\t\t\t\tdeltaMulValues = new Array<ShaderRegisterElement>();\n\t\t\t\tfor (i = 0; i < this._iNumSegmentPoint + 1; i++)\n\t\t\t\t\tdeltaMulValues.push(animationRegisterCache.getFreeVertexConstant());\n\t\t\t}\n\n\t\t\tvar startOffsetValue:ShaderRegisterElement;\n\t\t\tvar deltaOffsetValues:Array<ShaderRegisterElement>;\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tstartOffsetValue = animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSegmentedColorState.START_OFFSET_INDEX, startOffsetValue.index);\n\t\t\t\tdeltaOffsetValues = new Array<ShaderRegisterElement>();\n\t\t\t\tfor (i = 0; i < this._iNumSegmentPoint + 1; i++)\n\t\t\t\t\tdeltaOffsetValues.push(animationRegisterCache.getFreeVertexConstant());\n\t\t\t}\n\n\t\t\tif (this._iUsesMultiplier)\n\t\t\t\tcode += \"mov \" + accMultiplierColor + \",\" + startMulValue + \"\\n\";\n\t\t\tif (this._iUsesOffset)\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + animationRegisterCache.colorAddTarget + \",\" + startOffsetValue + \"\\n\";\n\n\t\t\tfor (i = 0; i < this._iNumSegmentPoint; i++) {\n\t\t\t\tswitch (i) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + animationRegisterCache.vertexLife + \",\" + lifeTimeRegister + \".x\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + animationRegisterCache.vertexLife + \",\" + lifeTimeRegister + \".x\\n\";\n\t\t\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + tempTime + \",\" + lifeTimeRegister + \".y\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".y\\n\";\n\t\t\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + tempTime + \",\" + lifeTimeRegister + \".z\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".z\\n\";\n\t\t\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + tempTime + \",\" + lifeTimeRegister + \".w\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaMulValues[i] + \"\\n\";\n\t\t\t\t\tcode += \"add \" + accMultiplierColor + \",\" + accMultiplierColor + \",\" + tempColor + \"\\n\";\n\t\t\t\t}\n\t\t\t\tif (this._iUsesOffset) {\n\t\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaOffsetValues[i] + \"\\n\";\n\t\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + animationRegisterCache.colorAddTarget + \",\" + tempColor + \"\\n\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//for the last segment:\n\t\t\tif (this._iNumSegmentPoint == 0)\n\t\t\t\ttempTime = animationRegisterCache.vertexLife;\n\t\t\telse {\n\t\t\t\tswitch (this._iNumSegmentPoint) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + animationRegisterCache.vertexLife + \",\" + lifeTimeRegister + \".x\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".y\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".z\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".w\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t}\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaMulValues[this._iNumSegmentPoint] + \"\\n\";\n\t\t\t\tcode += \"add \" + accMultiplierColor + \",\" + accMultiplierColor + \",\" + tempColor + \"\\n\";\n\t\t\t\tcode += \"mul \" + animationRegisterCache.colorMulTarget + \",\" + animationRegisterCache.colorMulTarget + \",\" + accMultiplierColor + \"\\n\";\n\t\t\t}\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaOffsetValues[this._iNumSegmentPoint] + \"\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + animationRegisterCache.colorAddTarget + \",\" + tempColor + \"\\n\";\n\t\t\t}\n\n\t\t}\n\t\treturn code;\n\t}\n\n}\n\nexport = ParticleSegmentedColorNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleSpriteSheetState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState\");\n\n/**\n * A particle animation node used when a spritesheet texture is required to animate the particle.\n * NB: to enable use of this node, the <code>repeat</code> property on the material has to be set to true.\n */\nclass ParticleSpriteSheetNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\n\t/** @private */\n\tpublic _iTotalFrames:number /*int*/;\n\t/** @private */\n\tpublic _iNumColumns:number /*int*/;\n\t/** @private */\n\tpublic _iNumRows:number /*int*/;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\n\t/**\n\t * Reference for spritesheet node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> representing the cycleDuration (x), optional phaseTime (y).\n\t */\n\tpublic static UV_VECTOR3D:string = \"UVVector3D\";\n\n\t/**\n\t * Defines the number of columns in the spritesheet, when in global mode. Defaults to 1. Read only.\n\t */\n\tpublic get numColumns():number\n\t{\n\t\treturn this._iNumColumns;\n\t}\n\n\t/**\n\t * Defines the number of rows in the spritesheet, when in global mode. Defaults to 1. Read only.\n\t */\n\tpublic get numRows():number\n\t{\n\t\treturn this._iNumRows;\n\t}\n\n\t/**\n\t * Defines the total number of frames used by the spritesheet, when in global mode. Defaults to the number defined by numColumns and numRows. Read only.\n\t */\n\tpublic get totalFrames():number\n\t{\n\t\treturn this._iTotalFrames;\n\t}\n\n\t/**\n\t * Creates a new <code>ParticleSpriteSheetNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] numColumns      Defines the number of columns in the spritesheet, when in global mode. Defaults to 1.\n\t * @param    [optional] numRows         Defines the number of rows in the spritesheet, when in global mode. Defaults to 1.\n\t * @param    [optional] cycleDuration   Defines the default cycle duration in seconds, when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the default cycle phase, when in global mode. Defaults to 0.\n\t * @param    [optional] totalFrames     Defines the total number of frames used by the spritesheet, when in global mode. Defaults to the number defined by numColumns and numRows.\n\t * @param    [optional] looping         Defines whether the spritesheet animation is set to loop indefinitely. Defaults to true.\n\t */\n\tconstructor(mode:number /*uint*/, usesCycle:boolean, usesPhase:boolean, numColumns:number /*int*/ = 1, numRows:number /*uint*/ = 1, cycleDuration:number = 1, cyclePhase:number = 0, totalFrames:number /*uint*/ = Number.MAX_VALUE)\n\t{\n\t\tsuper(\"ParticleSpriteSheet\", mode, usesCycle? (usesPhase? 3 : 2) : 1, ParticleAnimationSet.POST_PRIORITY + 1);\n\n\t\tthis._pStateClass = ParticleSpriteSheetState;\n\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iNumColumns = numColumns;\n\t\tthis._iNumRows = numRows;\n\t\tthis._iCyclePhase = cyclePhase;\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iTotalFrames = Math.min(totalFrames, numColumns*numRows);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\t//get 2 vc\n\t\tvar uvParamConst1:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tvar uvParamConst2:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSpriteSheetState.UV_INDEX_0, uvParamConst1.index);\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSpriteSheetState.UV_INDEX_1, uvParamConst2.index);\n\n\t\tvar uTotal:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst1.regName, uvParamConst1.index, 0);\n\t\tvar uStep:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst1.regName, uvParamConst1.index, 1);\n\t\tvar vStep:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst1.regName, uvParamConst1.index, 2);\n\n\t\tvar uSpeed:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst2.regName, uvParamConst2.index, 0);\n\t\tvar cycle:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst2.regName, uvParamConst2.index, 1);\n\t\tvar phaseTime:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst2.regName, uvParamConst2.index, 2);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar time:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\tvar vOffset:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\ttemp = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\tvar temp2:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 3);\n\n\t\tvar u:ShaderRegisterElement = new ShaderRegisterElement(animationRegisterCache.uvTarget.regName, animationRegisterCache.uvTarget.index, 0);\n\t\tvar v:ShaderRegisterElement = new ShaderRegisterElement(animationRegisterCache.uvTarget.regName, animationRegisterCache.uvTarget.index, 1);\n\n\t\tvar code:string = \"\";\n\t\t//scale uv\n\t\tcode += \"mul \" + u + \",\" + u + \",\" + uStep + \"\\n\";\n\t\tif (this._iNumRows > 1)\n\t\t\tcode += \"mul \" + v + \",\" + v + \",\" + vStep + \"\\n\";\n\n\t\tif (this._iUsesCycle) {\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tcode += \"add \" + time + \",\" + animationRegisterCache.vertexTime + \",\" + phaseTime + \"\\n\";\n\t\t\telse\n\t\t\t\tcode += \"mov \" + time + \",\" + animationRegisterCache.vertexTime + \"\\n\";\n\t\t\tcode += \"div \" + time + \",\" + time + \",\" + cycle + \"\\n\";\n\t\t\tcode += \"frc \" + time + \",\" + time + \"\\n\";\n\t\t\tcode += \"mul \" + time + \",\" + time + \",\" + cycle + \"\\n\";\n\t\t\tcode += \"mul \" + temp + \",\" + time + \",\" + uSpeed + \"\\n\";\n\t\t} else\n\t\t\tcode += \"mul \" + temp.toString() + \",\" + animationRegisterCache.vertexLife + \",\" + uTotal + \"\\n\";\n\n\t\tif (this._iNumRows > 1) {\n\t\t\tcode += \"frc \" + temp2 + \",\" + temp + \"\\n\";\n\t\t\tcode += \"sub \" + vOffset + \",\" + temp + \",\" + temp2 + \"\\n\";\n\t\t\tcode += \"mul \" + vOffset + \",\" + vOffset + \",\" + vStep + \"\\n\";\n\t\t\tcode += \"add \" + v + \",\" + v + \",\" + vOffset + \"\\n\";\n\t\t}\n\n\t\tcode += \"div \" + temp2 + \",\" + temp + \",\" + uStep + \"\\n\";\n\t\tcode += \"frc \" + temp + \",\" + temp2 + \"\\n\";\n\t\tcode += \"sub \" + temp2 + \",\" + temp2 + \",\" + temp + \"\\n\";\n\t\tcode += \"mul \" + temp + \",\" + temp2 + \",\" + uStep + \"\\n\";\n\n\t\tif (this._iNumRows > 1)\n\t\t\tcode += \"frc \" + temp + \",\" + temp + \"\\n\";\n\t\tcode += \"add \" + u + \",\" + u + \",\" + temp + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleSpriteSheetState\n\t{\n\t\treturn <ParticleSpriteSheetState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.hasUVNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tif (this._iUsesCycle) {\n\t\t\tvar uvCycle:Vector3D = param[ParticleSpriteSheetNode.UV_VECTOR3D];\n\t\t\tif (!uvCycle)\n\t\t\t\tthrow(new Error(\"there is no \" + ParticleSpriteSheetNode.UV_VECTOR3D + \" in param!\"));\n\t\t\tif (uvCycle.x <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tvar uTotal:number = this._iTotalFrames/this._iNumColumns;\n\t\t\tthis._pOneData[0] = uTotal/uvCycle.x;\n\t\t\tthis._pOneData[1] = uvCycle.x;\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tthis._pOneData[2] = uvCycle.y;\n\t\t}\n\t}\n}\n\nexport = ParticleSpriteSheetNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleTimeState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleTimeState\");\n\n/**\n * A particle animation node used as the base node for timekeeping inside a particle. Automatically added to a particle animation set on instatiation.\n */\nclass ParticleTimeNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesDuration:boolean;\n\t/** @private */\n\tpublic _iUsesDelay:boolean;\n\t/** @private */\n\tpublic _iUsesLooping:boolean;\n\n\t/**\n\t * Creates a new <code>ParticleTimeNode</code>\n\t *\n\t * @param    [optional] usesDuration    Defines whether the node uses the <code>duration</code> data in the static properties to determine how long a particle is visible for. Defaults to false.\n\t * @param    [optional] usesDelay       Defines whether the node uses the <code>delay</code> data in the static properties to determine how long a particle is hidden for. Defaults to false. Requires <code>usesDuration</code> to be true.\n\t * @param    [optional] usesLooping     Defines whether the node creates a looping timeframe for each particle determined by the <code>startTime</code>, <code>duration</code> and <code>delay</code> data in the static properties function. Defaults to false. Requires <code>usesLooping</code> to be true.\n\t */\n\tconstructor(usesDuration:boolean = false, usesLooping:boolean = false, usesDelay:boolean = false)\n\t{\n\t\tthis._pStateClass = ParticleTimeState;\n\n\t\tthis._iUsesDuration = usesDuration;\n\t\tthis._iUsesLooping = usesLooping;\n\t\tthis._iUsesDelay = usesDelay;\n\n\t\tsuper(\"ParticleTime\", ParticlePropertiesMode.LOCAL_STATIC, 4, 0);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar timeStreamRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexAttribute(); //timeStreamRegister.x is starttimeStreamRegister.y is during time\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleTimeState.TIME_STREAM_INDEX, timeStreamRegister.index);\n\t\tvar timeConst:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleTimeState.TIME_CONSTANT_INDEX, timeConst.index);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"sub \" + animationRegisterCache.vertexTime + \",\" + timeConst + \",\" + timeStreamRegister + \".x\\n\";\n\t\t//if time=0,set the position to zero.\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\tcode += \"sge \" + temp + \",\" + animationRegisterCache.vertexTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp + \"\\n\";\n\t\tif (this._iUsesDuration) {\n\t\t\tif (this._iUsesLooping) {\n\t\t\t\tvar div:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\t\t\tif (this._iUsesDelay) {\n\t\t\t\t\tcode += \"div \" + div + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".z\\n\";\n\t\t\t\t\tcode += \"frc \" + div + \",\" + div + \"\\n\";\n\t\t\t\t\tcode += \"mul \" + animationRegisterCache.vertexTime + \",\" + div + \",\" + timeStreamRegister + \".z\\n\";\n\t\t\t\t\tcode += \"slt \" + div + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".y\\n\";\n\t\t\t\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + div + \"\\n\";\n\t\t\t\t} else {\n\t\t\t\t\tcode += \"mul \" + div + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".w\\n\";\n\t\t\t\t\tcode += \"frc \" + div + \",\" + div + \"\\n\";\n\t\t\t\t\tcode += \"mul \" + animationRegisterCache.vertexTime + \",\" + div + \",\" + timeStreamRegister + \".y\\n\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar sge:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\t\t\tcode += \"sge \" + sge + \",\" + timeStreamRegister + \".y,\" + animationRegisterCache.vertexTime + \"\\n\";\n\t\t\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + sge + \"\\n\";\n\t\t\t}\n\t\t}\n\t\tcode += \"mul \" + animationRegisterCache.vertexLife + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".w\\n\";\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleTimeState\n\t{\n\t\treturn <ParticleTimeState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tthis._pOneData[0] = param.startTime;\n\t\tthis._pOneData[1] = param.duration;\n\t\tthis._pOneData[2] = param.delay + param.duration;\n\t\tthis._pOneData[3] = 1/param.duration;\n\n\t}\n}\n\nexport = ParticleTimeNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleUVState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleUVState\");\n\n/**\n * A particle animation node used to control the UV offset and scale of a particle over time.\n */\nclass ParticleUVNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUvData:Vector3D;\n\n\t/**\n\t *\n\t */\n\tpublic static U_AXIS:string = \"x\";\n\n\t/**\n\t *\n\t */\n\tpublic static V_AXIS:string = \"y\";\n\n\tprivate _cycle:number;\n\tprivate _scale:number;\n\tprivate _axis:string;\n\n\t/**\n\t * Creates a new <code>ParticleTimeNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] cycle           Defines whether the time track is in loop mode. Defaults to false.\n\t * @param    [optional] scale           Defines whether the time track is in loop mode. Defaults to false.\n\t * @param    [optional] axis            Defines whether the time track is in loop mode. Defaults to false.\n\t */\n\tconstructor(mode:number /*uint*/, cycle:number = 1, scale:number = 1, axis:string = \"x\")\n\t{\n\t\t//because of the stage3d register limitation, it only support the global mode\n\t\tsuper(\"ParticleUV\", ParticlePropertiesMode.GLOBAL, 4, ParticleAnimationSet.POST_PRIORITY + 1);\n\n\t\tthis._pStateClass = ParticleUVState;\n\n\t\tthis._cycle = cycle;\n\t\tthis._scale = scale;\n\t\tthis._axis = axis;\n\n\t\tthis.updateUVData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get cycle():number\n\t{\n\t\treturn this._cycle;\n\t}\n\n\tpublic set cycle(value:number)\n\t{\n\t\tthis._cycle = value;\n\n\t\tthis.updateUVData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get scale():number\n\t{\n\t\treturn this._scale;\n\t}\n\n\tpublic set scale(value:number)\n\t{\n\t\tthis._scale = value;\n\n\t\tthis.updateUVData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get axis():string\n\t{\n\t\treturn this._axis;\n\t}\n\n\tpublic set axis(value:string)\n\t{\n\t\tthis._axis = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tvar uvConst:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleUVState.UV_INDEX, uvConst.index);\n\n\t\tvar axisIndex:number = this._axis == \"x\"? 0 : (this._axis == \"y\"? 1 : 2);\n\n\t\tvar target:ShaderRegisterElement = new ShaderRegisterElement(animationRegisterCache.uvTarget.regName, animationRegisterCache.uvTarget.index, axisIndex);\n\n\t\tvar sin:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\n\t\tif (this._scale != 1)\n\t\t\tcode += \"mul \" + target + \",\" + target + \",\" + uvConst + \".y\\n\";\n\n\t\tcode += \"mul \" + sin + \",\" + animationRegisterCache.vertexTime + \",\" + uvConst + \".x\\n\";\n\t\tcode += \"sin \" + sin + \",\" + sin + \"\\n\";\n\t\tcode += \"add \" + target + \",\" + target + \",\" + sin + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleUVState\n\t{\n\t\treturn <ParticleUVState> animator.getAnimationState(this);\n\t}\n\n\tprivate updateUVData()\n\t{\n\t\tthis._iUvData = new Vector3D(Math.PI*2/this._cycle, this._scale, 0, 0);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.hasUVNode = true;\n\t}\n}\n\nexport = ParticleUVNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleVelocityState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleVelocityState\");\n\n/**\n * A particle animation node used to set the starting velocity of a particle.\n */\nclass ParticleVelocityNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iVelocity:Vector3D;\n\n\t/**\n\t * Reference for velocity node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the direction of movement on the particle.\n\t */\n\tpublic static VELOCITY_VECTOR3D:string = \"VelocityVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleVelocityNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] velocity        Defines the default velocity vector of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, velocity:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleVelocity\", mode, 3);\n\n\t\tthis._pStateClass = ParticleVelocityState;\n\n\t\tthis._iVelocity = velocity || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shaderObject:ShaderObjectBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar velocityValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleVelocityState.VELOCITY_INDEX, velocityValue.index);\n\n\t\tvar distance:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar code:string = \"\";\n\t\tcode += \"mul \" + distance + \",\" + animationRegisterCache.vertexTime + \",\" + velocityValue + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \",\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity)\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + velocityValue + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleVelocityState\n\t{\n\t\treturn <ParticleVelocityState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar _tempVelocity:Vector3D = param[ParticleVelocityNode.VELOCITY_VECTOR3D];\n\t\tif (!_tempVelocity)\n\t\t\tthrow new Error(\"there is no \" + ParticleVelocityNode.VELOCITY_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = _tempVelocity.x;\n\t\tthis._pOneData[1] = _tempVelocity.y;\n\t\tthis._pOneData[2] = _tempVelocity.z;\n\t}\n}\n\nexport = ParticleVelocityNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonBinaryLERPState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState\");\n\n/**\n * A skeleton animation node that uses two animation node inputs to blend a lineraly interpolated output of a skeleton pose.\n */\nclass SkeletonBinaryLERPNode extends AnimationNodeBase\n{\n\t/**\n\t * Defines input node A to use for the blended output.\n\t */\n\tpublic inputA:AnimationNodeBase;\n\n\t/**\n\t * Defines input node B to use for the blended output.\n\t */\n\tpublic inputB:AnimationNodeBase;\n\n\t/**\n\t * Creates a new <code>SkeletonBinaryLERPNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonBinaryLERPState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonBinaryLERPState\n\t{\n\t\treturn <SkeletonBinaryLERPState> animator.getAnimationState(this);\n\t}\n}\n\nexport = SkeletonBinaryLERPNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\nimport SkeletonClipState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonClipState\");\n\n/**\n * A skeleton animation node containing time-based animation data as individual skeleton poses.\n */\nclass SkeletonClipNode extends AnimationClipNodeBase\n{\n\tprivate _frames:Array<SkeletonPose> = new Array<SkeletonPose>();\n\n\t/**\n\t * Determines whether to use SLERP equations (true) or LERP equations (false) in the calculation\n\t * of the output skeleton pose. Defaults to false.\n\t */\n\tpublic highQuality:boolean = false;\n\n\t/**\n\t * Returns a vector of skeleton poses representing the pose of each animation frame in the clip.\n\t */\n\tpublic get frames():Array<SkeletonPose>\n\t{\n\t\treturn this._frames;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonClipNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonClipState;\n\t}\n\n\t/**\n\t * Adds a skeleton pose frame to the internal timeline of the animation node.\n\t *\n\t * @param skeletonPose The skeleton pose object to add to the timeline of the node.\n\t * @param duration The specified duration of the frame in milliseconds.\n\t */\n\tpublic addFrame(skeletonPose:SkeletonPose, duration:number /*number /*uint*/)\n\t{\n\t\tthis._frames.push(skeletonPose);\n\t\tthis._pDurations.push(duration);\n\n\t\tthis._pNumFrames = this._pDurations.length;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonClipState\n\t{\n\t\treturn <SkeletonClipState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateStitch()\n\t{\n\t\tsuper._pUpdateStitch();\n\n\t\tvar i:number /*uint*/ = this._pNumFrames - 1;\n\t\tvar p1:Vector3D, p2:Vector3D, delta:Vector3D;\n\t\twhile (i--) {\n\t\t\tthis._pTotalDuration += this._pDurations[i];\n\t\t\tp1 = this._frames[i].jointPoses[0].translation;\n\t\t\tp2 = this._frames[i + 1].jointPoses[0].translation;\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\n\t\tif (this._pStitchFinalFrame || !this._pLooping) {\n\t\t\tthis._pTotalDuration += this._pDurations[this._pNumFrames - 1];\n\t\t\tp1 = this._frames[0].jointPoses[0].translation;\n\t\t\tp2 = this._frames[1].jointPoses[0].translation;\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\t}\n}\n\nexport = SkeletonClipNode;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonDifferenceState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonDifferenceState\");\n\n/**\n * A skeleton animation node that uses a difference input pose with a base input pose to blend a linearly interpolated output of a skeleton pose.\n */\nclass SkeletonDifferenceNode extends AnimationNodeBase\n{\n\t/**\n\t * Defines a base input node to use for the blended output.\n\t */\n\tpublic baseInput:AnimationNodeBase;\n\n\t/**\n\t * Defines a difference input node to use for the blended output.\n\t */\n\tpublic differenceInput:AnimationNodeBase;\n\n\t/**\n\t * Creates a new <code>SkeletonAdditiveNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonDifferenceState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonDifferenceState\n\t{\n\t\treturn <SkeletonDifferenceState> animator.getAnimationState(this);\n\t}\n}\n\nexport = SkeletonDifferenceNode",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonDirectionalState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonDirectionalState\");\n\n/**\n * A skeleton animation node that uses four directional input poses with an input direction to blend a linearly interpolated output of a skeleton pose.\n */\nclass SkeletonDirectionalNode extends AnimationNodeBase\n{\n\t/**\n\t * Defines the forward configured input node to use for the blended output.\n\t */\n\tpublic forward:AnimationNodeBase;\n\n\t/**\n\t * Defines the backwards configured input node to use for the blended output.\n\t */\n\tpublic backward:AnimationNodeBase;\n\n\t/**\n\t * Defines the left configured input node to use for the blended output.\n\t */\n\tpublic left:AnimationNodeBase;\n\n\t/**\n\t * Defines the right configured input node to use for the blended output.\n\t */\n\tpublic right:AnimationNodeBase;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonDirectionalState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonDirectionalState\n\t{\n\t\treturn <SkeletonDirectionalState> animator.getAnimationState(this);\n\t}\n\n}\n\nexport = SkeletonDirectionalNode;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonNaryLERPState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState\");\n\n/**\n * A skeleton animation node that uses an n-dimensional array of animation node inputs to blend a lineraly interpolated output of a skeleton pose.\n */\nclass SkeletonNaryLERPNode extends AnimationNodeBase\n{\n\tpublic _iInputs:Array<AnimationNodeBase> = new Array<AnimationNodeBase>();\n\n\tprivate _numInputs:number /*uint*/;\n\n\tpublic get numInputs():number /*uint*/\n\t{\n\t\treturn this._numInputs;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonNaryLERPNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonNaryLERPState;\n\t}\n\n\t/**\n\t * Returns an integer representing the input index of the given skeleton animation node.\n\t *\n\t * @param input The skeleton animation node for with the input index is requested.\n\t */\n\tpublic getInputIndex(input:AnimationNodeBase):number /*int*/\n\t{\n\t\treturn this._iInputs.indexOf(input);\n\t}\n\n\t/**\n\t * Returns the skeleton animation node object that resides at the given input index.\n\t *\n\t * @param index The input index for which the skeleton animation node is requested.\n\t */\n\tpublic getInputAt(index:number /*uint*/):AnimationNodeBase\n\t{\n\t\treturn this._iInputs[index];\n\t}\n\n\t/**\n\t * Adds a new skeleton animation node input to the animation node.\n\t */\n\tpublic addInput(input:AnimationNodeBase)\n\t{\n\t\tthis._iInputs[this._numInputs++] = input;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonNaryLERPState\n\t{\n\t\treturn <SkeletonNaryLERPState> animator.getAnimationState(this);\n\t}\n}\n\nexport = SkeletonNaryLERPNode",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-core/lib/data/Geometry\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\nimport VertexClipState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/VertexClipState\");\n\n/**\n * A vertex animation node containing time-based animation data as individual geometry obejcts.\n */\nclass VertexClipNode extends AnimationClipNodeBase\n{\n\tprivate _frames:Array<Geometry> = new Array<Geometry>();\n\tprivate _translations:Array<Vector3D> = new Array<Vector3D>();\n\n\t/**\n\t * Returns a vector of geometry frames representing the vertex values of each animation frame in the clip.\n\t */\n\tpublic get frames():Array<Geometry>\n\t{\n\t\treturn this._frames;\n\t}\n\n\t/**\n\t * Creates a new <code>VertexClipNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = VertexClipState;\n\t}\n\n\t/**\n\t * Adds a geometry object to the internal timeline of the animation node.\n\t *\n\t * @param geometry The geometry object to add to the timeline of the node.\n\t * @param duration The specified duration of the frame in milliseconds.\n\t * @param translation The absolute translation of the frame, used in root delta calculations for mesh movement.\n\t */\n\tpublic addFrame(geometry:Geometry, duration:number /*uint*/, translation:Vector3D = null)\n\t{\n\t\tthis._frames.push(geometry);\n\t\tthis._pDurations.push(duration);\n\t\tthis._translations.push(translation || new Vector3D());\n\n\t\tthis._pNumFrames = this._pDurations.length;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateStitch()\n\t{\n\t\tsuper._pUpdateStitch();\n\n\t\tvar i:number /*uint*/ = this._pNumFrames - 1;\n\t\tvar p1:Vector3D, p2:Vector3D, delta:Vector3D;\n\t\twhile (i--) {\n\t\t\tthis._pTotalDuration += this._pDurations[i];\n\t\t\tp1 = this._translations[i];\n\t\t\tp2 = this._translations[i + 1];\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\n\t\tif (this._pNumFrames > 1 && (this._pStitchFinalFrame || !this._pLooping)) {\n\t\t\tthis._pTotalDuration += this._pDurations[this._pNumFrames - 1];\n\t\t\tp1 = this._translations[0];\n\t\t\tp2 = this._translations[1];\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\t}\n}\n\nexport = VertexClipNode;",
    "import AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\n\n/**\n *\n */\nclass AnimationClipState extends AnimationStateBase\n{\n\tprivate _animationClipNode:AnimationClipNodeBase;\n\tprivate _animationStatePlaybackComplete:AnimationStateEvent;\n\tpublic _pBlendWeight:number;\n\tpublic _pCurrentFrame:number /*uint*/;\n\tpublic _pNextFrame:number /*uint*/;\n\n\tpublic _pOldFrame:number /*uint*/;\n\tpublic _pTimeDir:number /*int*/;\n\tpublic _pFramesDirty:boolean = true;\n\n\t/**\n\t * Returns a fractional value between 0 and 1 representing the blending ratio of the current playhead position\n\t * between the current frame (0) and next frame (1) of the animation.\n\t *\n\t * @see #currentFrame\n\t * @see #nextFrame\n\t */\n\tpublic get blendWeight():number\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._pBlendWeight;\n\t}\n\n\t/**\n\t * Returns the current frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get currentFrame():number /*uint*/\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._pCurrentFrame;\n\t}\n\n\t/**\n\t * Returns the next frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get nextFrame():number /*uint*/\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._pNextFrame;\n\t}\n\n\tconstructor(animator:AnimatorBase, animationClipNode:AnimationClipNodeBase)\n\t{\n\t\tsuper(animator, animationClipNode);\n\n\t\tthis._animationClipNode = animationClipNode;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic update(time:number /*int*/)\n\t{\n\t\tif (!this._animationClipNode.looping) {\n\t\t\tif (time > this._pStartTime + this._animationClipNode.totalDuration)\n\t\t\t\ttime = this._pStartTime + this._animationClipNode.totalDuration; else if (time < this._pStartTime)\n\t\t\t\ttime = this._pStartTime;\n\t\t}\n\n\t\tif (this._pTime == time - this._pStartTime)\n\t\t\treturn;\n\n\t\tthis._pUpdateTime(time);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tvar time:number /*int*/ = value*this._animationClipNode.totalDuration + this._pStartTime;\n\n\t\tif (this._pTime == time - this._pStartTime)\n\t\t\treturn;\n\n\t\tthis._pUpdateTime(time);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._pFramesDirty = true;\n\n\t\tthis._pTimeDir = (time - this._pStartTime > this._pTime)? 1 : -1;\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Updates the nodes internal playhead to determine the current and next animation frame, and the blendWeight between the two.\n\t *\n\t * @see #currentFrame\n\t * @see #nextFrame\n\t * @see #blendWeight\n\t */\n\tpublic _pUpdateFrames()\n\t{\n\t\tthis._pFramesDirty = false;\n\n\t\tvar looping:boolean = this._animationClipNode.looping;\n\t\tvar totalDuration:number /*uint*/ = this._animationClipNode.totalDuration;\n\t\tvar lastFrame:number /*uint*/ = this._animationClipNode.lastFrame;\n\t\tvar time:number /*int*/ = this._pTime;\n\n\t\t//trace(\"time\", time, totalDuration)\n\t\tif (looping && (time >= totalDuration || time < 0)) {\n\t\t\ttime %= totalDuration;\n\t\t\tif (time < 0)\n\t\t\t\ttime += totalDuration;\n\t\t}\n\n\t\tif (!looping && time >= totalDuration) {\n\t\t\tthis.notifyPlaybackComplete();\n\t\t\tthis._pCurrentFrame = lastFrame;\n\t\t\tthis._pNextFrame = lastFrame;\n\t\t\tthis._pBlendWeight = 0;\n\t\t} else if (!looping && time <= 0) {\n\t\t\tthis._pCurrentFrame = 0;\n\t\t\tthis._pNextFrame = 0;\n\t\t\tthis._pBlendWeight = 0;\n\t\t} else if (this._animationClipNode.fixedFrameRate) {\n\t\t\tvar t:number = time/totalDuration*lastFrame;\n\t\t\tthis._pCurrentFrame = Math.floor(t);\n\t\t\tthis._pBlendWeight = t - this._pCurrentFrame;\n\t\t\tthis._pNextFrame = this._pCurrentFrame + 1;\n\t\t} else {\n\t\t\tthis._pCurrentFrame = 0;\n\t\t\tthis._pNextFrame = 0;\n\n\t\t\tvar dur:number /*uint*/ = 0, frameTime:number /*uint*/;\n\t\t\tvar durations:Array<number> /*uint*/ = this._animationClipNode.durations;\n\n\t\t\tdo {\n\t\t\t\tframeTime = dur;\n\t\t\t\tdur += durations[this._pNextFrame];\n\t\t\t\tthis._pCurrentFrame = this._pNextFrame++;\n\t\t\t} while (time > dur);\n\n\t\t\tif (this._pCurrentFrame == lastFrame) {\n\t\t\t\tthis._pCurrentFrame = 0;\n\t\t\t\tthis._pNextFrame = 1;\n\t\t\t}\n\n\t\t\tthis._pBlendWeight = (time - frameTime)/durations[this._pCurrentFrame];\n\t\t}\n\t}\n\n\tprivate notifyPlaybackComplete()\n\t{\n\t\tif (this._animationStatePlaybackComplete == null)\n\t\t\tthis._animationStatePlaybackComplete = new AnimationStateEvent(AnimationStateEvent.PLAYBACK_COMPLETE, this._pAnimator, this, this._animationClipNode);\n\n\t\tthis._animationClipNode.dispatchEvent(this._animationStatePlaybackComplete);\n\t}\n}\n\nexport = AnimationClipState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport IAnimationState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IAnimationState\");\n\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\n\n/**\n *\n */\nclass AnimationStateBase implements IAnimationState\n{\n\tpublic _pAnimationNode:AnimationNodeBase;\n\tpublic _pRootDelta:Vector3D = new Vector3D();\n\tpublic _pPositionDeltaDirty:boolean = true;\n\n\tpublic _pTime:number;\n\tpublic _pStartTime:number = 0;\n\tpublic _pAnimator:AnimatorBase;\n\n\t/**\n\t * Returns a 3d vector representing the translation delta of the animating entity for the current timestep of animation\n\t */\n\tpublic get positionDelta():Vector3D\n\t{\n\t\tif (this._pPositionDeltaDirty) {\n\n\t\t\tthis._pUpdatePositionDelta();\n\t\t}\n\n\t\treturn this._pRootDelta;\n\n\t}\n\n\tconstructor(animator:AnimatorBase, animationNode:AnimationNodeBase)\n\t{\n\t\tthis._pAnimator = animator;\n\t\tthis._pAnimationNode = animationNode;\n\t}\n\n\t/**\n\t * Resets the start time of the node to a  new value.\n\t *\n\t * @param startTime The absolute start time (in milliseconds) of the node's starting time.\n\t */\n\tpublic offset(startTime:number)\n\t{\n\t\tthis._pStartTime = startTime;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t}\n\n\t/**\n\t * Updates the configuration of the node to its current state.\n\t *\n\t * @param time The absolute time (in milliseconds) of the animator's play head position.\n\t *\n\t * @see AnimatorBase#update()\n\t */\n\tpublic update(time:number)\n\t{\n\t\tif (this._pTime == time - this._pStartTime) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._pUpdateTime(time);\n\n\t}\n\n\t/**\n\t * Sets the animation phase of the node.\n\t *\n\t * @param value The phase value to use. 0 represents the beginning of an animation clip, 1 represents the end.\n\t */\n\tpublic phase(value:number)\n\t{\n\n\t}\n\n\t/**\n\t * Updates the node's internal playhead position.\n\t *\n\t * @param time The local time (in milliseconds) of the node's playhead position.\n\t */\n\tpublic _pUpdateTime(time:number)\n\t{\n\t\tthis._pTime = time - this._pStartTime;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t}\n\n\t/**\n\t * Updates the node's root delta position\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t}\n}\n\nexport = AnimationStateBase;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleAccelerationNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleAccelerationState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static ACCELERATION_INDEX:number /*int*/ = 0;\n\n\tprivate _particleAccelerationNode:ParticleAccelerationNode;\n\tprivate _acceleration:Vector3D;\n\tprivate _halfAcceleration:Vector3D;\n\t\n\t/**\n\t * Defines the acceleration vector of the state, used when in global mode.\n\t */\n\tpublic get acceleration():Vector3D\n\t{\n\t\treturn this._acceleration;\n\t}\n\t\n\tpublic set acceleration(value:Vector3D)\n\t{\n\t\tthis._acceleration.x = value.x;\n\t\tthis._acceleration.y = value.y;\n\t\tthis._acceleration.z = value.z;\n\n\t\tthis.updateAccelerationData();\n\t}\n\t\n\tconstructor(animator:ParticleAnimator, particleAccelerationNode:ParticleAccelerationNode)\n\t{\n\t\tsuper(animator, particleAccelerationNode);\n\n\t\tthis._particleAccelerationNode = particleAccelerationNode;\n\t\tthis._acceleration = this._particleAccelerationNode._acceleration;\n\n\t\tthis.updateAccelerationData();\n\t}\n\t\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleAccelerationState.ACCELERATION_INDEX);\n\t\t\n\t\tif (this._particleAccelerationNode.mode == ParticlePropertiesMode.LOCAL_STATIC)\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleAccelerationNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\telse\n\t\t\tanimationRegisterCache.setVertexConst(index, this._halfAcceleration.x, this._halfAcceleration.y, this._halfAcceleration.z);\n\t}\n\t\n\tprivate updateAccelerationData()\n\t{\n\t\tif (this._particleAccelerationNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tthis._halfAcceleration = new Vector3D(this._acceleration.x/2, this._acceleration.y/2, this._acceleration.z/2);\n\t}\n}\n\nexport = ParticleAccelerationState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleBezierCurveNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n/**\n * ...\n */\nclass ParticleBezierCurveState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static BEZIER_CONTROL_INDEX:number /*int*/ = 0;\n\n\t/** @private */\n\tpublic static BEZIER_END_INDEX:number /*int*/ = 1;\n\n\tprivate _particleBezierCurveNode:ParticleBezierCurveNode;\n\tprivate _controlPoint:Vector3D;\n\tprivate _endPoint:Vector3D;\n\n\t/**\n\t * Defines the default control point of the node, used when in global mode.\n\t */\n\tpublic get controlPoint():Vector3D\n\t{\n\t\treturn this._controlPoint;\n\t}\n\n\tpublic set controlPoint(value:Vector3D)\n\t{\n\t\tthis._controlPoint = value;\n\t}\n\n\t/**\n\t * Defines the default end point of the node, used when in global mode.\n\t */\n\tpublic get endPoint():Vector3D\n\t{\n\t\treturn this._endPoint;\n\t}\n\n\tpublic set endPoint(value:Vector3D)\n\t{\n\t\tthis._endPoint = value;\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleBezierCurveNode:ParticleBezierCurveNode)\n\t{\n\t\tsuper(animator, particleBezierCurveNode);\n\n\t\tthis._particleBezierCurveNode = particleBezierCurveNode;\n\t\tthis._controlPoint = this._particleBezierCurveNode._iControlPoint;\n\t\tthis._endPoint = this._particleBezierCurveNode._iEndPoint;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar controlIndex:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleBezierCurveState.BEZIER_CONTROL_INDEX);\n\t\tvar endIndex:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleBezierCurveState.BEZIER_END_INDEX);\n\n\t\tif (this._particleBezierCurveNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tanimationSubGeometry.activateVertexBuffer(controlIndex, this._particleBezierCurveNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\tanimationSubGeometry.activateVertexBuffer(endIndex, this._particleBezierCurveNode._iDataOffset + 3, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else {\n\t\t\tanimationRegisterCache.setVertexConst(controlIndex, this._controlPoint.x, this._controlPoint.y, this._controlPoint.z);\n\t\t\tanimationRegisterCache.setVertexConst(endIndex, this._endPoint.x, this._endPoint.y, this._endPoint.z);\n\t\t}\n\t}\n}\n\nexport = ParticleBezierCurveState;",
    "import MathConsts\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/MathConsts\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport Orientation3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Orientation3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleBillboardNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleBillboardState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MATRIX_INDEX:number /*int*/ = 0;\n\n\tprivate _matrix:Matrix3D = new Matrix3D;\n\n\tprivate _billboardAxis:Vector3D;\n\n\t/**\n\t *\n\t */\n\tconstructor(animator:ParticleAnimator, particleNode:ParticleBillboardNode)\n\t{\n\t\tsuper(animator, particleNode);\n\n\t\tthis._billboardAxis = particleNode._iBillboardAxis;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar comps:Array<Vector3D>;\n\t\tif (this._billboardAxis) {\n\t\t\tvar pos:Vector3D = renderable.sourceEntity.sceneTransform.position;\n\t\t\tvar look:Vector3D = camera.sceneTransform.position.subtract(pos);\n\t\t\tvar right:Vector3D = look.crossProduct(this._billboardAxis);\n\t\t\tright.normalize();\n\t\t\tlook = this.billboardAxis.crossProduct(right);\n\t\t\tlook.normalize();\n\n\t\t\t//create a quick inverse projection matrix\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tcomps = this._matrix.decompose(Orientation3D.AXIS_ANGLE);\n\t\t\tthis._matrix.copyColumnFrom(0, right);\n\t\t\tthis._matrix.copyColumnFrom(1, this.billboardAxis);\n\t\t\tthis._matrix.copyColumnFrom(2, look);\n\t\t\tthis._matrix.copyColumnFrom(3, pos);\n\t\t\tthis._matrix.appendRotation(-comps[1].w*MathConsts.RADIANS_TO_DEGREES, comps[1]);\n\t\t} else {\n\t\t\t//create a quick inverse projection matrix\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tthis._matrix.append(camera.inverseSceneTransform);\n\n\t\t\t//decompose using axis angle rotations\n\t\t\tcomps = this._matrix.decompose(Orientation3D.AXIS_ANGLE);\n\n\t\t\t//recreate the matrix with just the rotation data\n\t\t\tthis._matrix.identity();\n\t\t\tthis._matrix.appendRotation(-comps[1].w*MathConsts.RADIANS_TO_DEGREES, comps[1]);\n\t\t}\n\n\t\t//set a new matrix transform constant\n\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleBillboardState.MATRIX_INDEX), this._matrix);\n\t}\n\n\t/**\n\t * Defines the billboard axis.\n\t */\n\tpublic get billboardAxis():Vector3D\n\t{\n\t\treturn this.billboardAxis;\n\t}\n\n\tpublic set billboardAxis(value:Vector3D)\n\t{\n\t\tthis.billboardAxis = value? value.clone() : null;\n\t\tif (this.billboardAxis)\n\t\t\tthis.billboardAxis.normalize();\n\t}\n\n}\n\nexport = ParticleBillboardState;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleColorNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleColorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n * @author ...\n */\nclass ParticleColorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static START_MULTIPLIER_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static DELTA_MULTIPLIER_INDEX:number /*uint*/ = 1;\n\n\t/** @private */\n\tpublic static START_OFFSET_INDEX:number /*uint*/ = 2;\n\n\t/** @private */\n\tpublic static DELTA_OFFSET_INDEX:number /*uint*/ = 3;\n\n\t/** @private */\n\tpublic static CYCLE_INDEX:number /*uint*/ = 4;\n\n\tprivate _particleColorNode:ParticleColorNode;\n\tprivate _usesMultiplier:boolean;\n\tprivate _usesOffset:boolean;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _startColor:ColorTransform;\n\tprivate _endColor:ColorTransform;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _cycleData:Vector3D;\n\tprivate _startMultiplierData:Vector3D;\n\tprivate _deltaMultiplierData:Vector3D;\n\tprivate _startOffsetData:Vector3D;\n\tprivate _deltaOffsetData:Vector3D;\n\n\t/**\n\t * Defines the start color transform of the state, when in global mode.\n\t */\n\tpublic get startColor():ColorTransform\n\t{\n\t\treturn this._startColor;\n\t}\n\n\tpublic set startColor(value:ColorTransform)\n\t{\n\t\tthis._startColor = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the end color transform of the state, when in global mode.\n\t */\n\tpublic get endColor():ColorTransform\n\t{\n\t\treturn this._endColor;\n\t}\n\n\tpublic set endColor(value:ColorTransform)\n\t{\n\t\tthis._endColor = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleColorNode:ParticleColorNode)\n\t{\n\t\tsuper(animator, particleColorNode);\n\n\t\tthis._particleColorNode = particleColorNode;\n\t\tthis._usesMultiplier = this._particleColorNode._iUsesMultiplier;\n\t\tthis._usesOffset = this._particleColorNode._iUsesOffset;\n\t\tthis._usesCycle = this._particleColorNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleColorNode._iUsesPhase;\n\t\tthis._startColor = this._particleColorNode._iStartColor;\n\t\tthis._endColor = this._particleColorNode._iEndColor;\n\t\tthis._cycleDuration = this._particleColorNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleColorNode._iCyclePhase;\n\n\t\tthis.updateColorData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tvar dataOffset:number /*uint*/ = this._particleColorNode._iDataOffset;\n\t\t\tif (this._usesCycle)\n\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.CYCLE_INDEX), this._cycleData.x, this._cycleData.y, this._cycleData.z, this._cycleData.w);\n\n\t\t\tif (this._usesMultiplier) {\n\t\t\t\tif (this._particleColorNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_MULTIPLIER_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_MULTIPLIER_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t} else {\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_MULTIPLIER_INDEX), this._startMultiplierData.x, this._startMultiplierData.y, this._startMultiplierData.z, this._startMultiplierData.w);\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_MULTIPLIER_INDEX), this._deltaMultiplierData.x, this._deltaMultiplierData.y, this._deltaMultiplierData.z, this._deltaMultiplierData.w);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._usesOffset) {\n\t\t\t\tif (this._particleColorNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_OFFSET_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_OFFSET_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t} else {\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_OFFSET_INDEX), this._startOffsetData.x, this._startOffsetData.y, this._startOffsetData.z, this._startOffsetData.w);\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_OFFSET_INDEX), this._deltaOffsetData.x, this._deltaOffsetData.y, this._deltaOffsetData.z, this._deltaOffsetData.w);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateColorData()\n\t{\n\t\tif (this._usesCycle) {\n\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tthis._cycleData = new Vector3D(Math.PI*2/this._cycleDuration, this._cyclePhase*Math.PI/180, 0, 0);\n\t\t}\n\t\tif (this._particleColorNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._usesMultiplier) {\n\t\t\t\t\tthis._startMultiplierData = new Vector3D((this._startColor.redMultiplier + this._endColor.redMultiplier)/2, (this._startColor.greenMultiplier + this._endColor.greenMultiplier)/2, (this._startColor.blueMultiplier + this._endColor.blueMultiplier)/2, (this._startColor.alphaMultiplier + this._endColor.alphaMultiplier)/2);\n\t\t\t\t\tthis._deltaMultiplierData = new Vector3D((this._endColor.redMultiplier - this._startColor.redMultiplier)/2, (this._endColor.greenMultiplier - this._startColor.greenMultiplier)/2, (this._endColor.blueMultiplier - this._startColor.blueMultiplier)/2, (this._endColor.alphaMultiplier - this._startColor.alphaMultiplier)/2);\n\t\t\t\t}\n\n\t\t\t\tif (this._usesOffset) {\n\t\t\t\t\tthis._startOffsetData = new Vector3D((this._startColor.redOffset + this._endColor.redOffset)/(255*2), (this._startColor.greenOffset + this._endColor.greenOffset)/(255*2), (this._startColor.blueOffset + this._endColor.blueOffset)/(255*2), (this._startColor.alphaOffset + this._endColor.alphaOffset)/(255*2));\n\t\t\t\t\tthis._deltaOffsetData = new Vector3D((this._endColor.redOffset - this._startColor.redOffset)/(255*2), (this._endColor.greenOffset - this._startColor.greenOffset)/(255*2), (this._endColor.blueOffset - this._startColor.blueOffset)/(255*2), (this._endColor.alphaOffset - this._startColor.alphaOffset)/(255*2));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this._usesMultiplier) {\n\t\t\t\t\tthis._startMultiplierData = new Vector3D(this._startColor.redMultiplier, this._startColor.greenMultiplier, this._startColor.blueMultiplier, this._startColor.alphaMultiplier);\n\t\t\t\t\tthis._deltaMultiplierData = new Vector3D((this._endColor.redMultiplier - this._startColor.redMultiplier), (this._endColor.greenMultiplier - this._startColor.greenMultiplier), (this._endColor.blueMultiplier - this._startColor.blueMultiplier), (this._endColor.alphaMultiplier - this._startColor.alphaMultiplier));\n\t\t\t\t}\n\n\t\t\t\tif (this._usesOffset) {\n\t\t\t\t\tthis._startOffsetData = new Vector3D(this._startColor.redOffset/255, this._startColor.greenOffset/255, this._startColor.blueOffset/255, this._startColor.alphaOffset/255);\n\t\t\t\t\tthis._deltaOffsetData = new Vector3D((this._endColor.redOffset - this._startColor.redOffset)/255, (this._endColor.greenOffset - this._startColor.greenOffset)/255, (this._endColor.blueOffset - this._startColor.blueOffset )/255, (this._endColor.alphaOffset - this._startColor.alphaOffset)/255);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport = ParticleColorState;",
    "import MathConsts\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/MathConsts\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticleFollowNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleFollowNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleFollowState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static FOLLOW_POSITION_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static FOLLOW_ROTATION_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleFollowNode:ParticleFollowNode;\n\tprivate _followTarget:DisplayObject;\n\n\tprivate _targetPos:Vector3D = new Vector3D();\n\tprivate _targetEuler:Vector3D = new Vector3D();\n\tprivate _prePos:Vector3D;\n\tprivate _preEuler:Vector3D;\n\tprivate _smooth:boolean;\n\n\t//temporary vector3D for calculation\n\tprivate _temp:Vector3D = new Vector3D();\n\n\tconstructor(animator:ParticleAnimator, particleFollowNode:ParticleFollowNode)\n\t{\n\t\tsuper(animator, particleFollowNode, true);\n\n\t\tthis._particleFollowNode = particleFollowNode;\n\t\tthis._smooth = particleFollowNode._iSmooth;\n\t}\n\n\tpublic get followTarget():DisplayObject\n\t{\n\t\treturn this._followTarget;\n\t}\n\n\tpublic set followTarget(value:DisplayObject)\n\t{\n\t\tthis._followTarget = value;\n\t}\n\n\tpublic get smooth():boolean\n\t{\n\t\treturn this._smooth;\n\t}\n\n\tpublic set smooth(value:boolean)\n\t{\n\t\tthis._smooth = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._followTarget) {\n\t\t\tif (this._particleFollowNode._iUsesPosition) {\n\t\t\t\tthis._targetPos.x = this._followTarget.transform.position.x/renderable.sourceEntity.scaleX;\n\t\t\t\tthis._targetPos.y = this._followTarget.transform.position.y/renderable.sourceEntity.scaleY;\n\t\t\t\tthis._targetPos.z = this._followTarget.transform.position.z/renderable.sourceEntity.scaleZ;\n\t\t\t}\n\t\t\tif (this._particleFollowNode._iUsesRotation) {\n\t\t\t\tthis._targetEuler.x = this._followTarget.rotationX;\n\t\t\t\tthis._targetEuler.y = this._followTarget.rotationY;\n\t\t\t\tthis._targetEuler.z = this._followTarget.rotationZ;\n\t\t\t\tthis._targetEuler.scaleBy(MathConsts.DEGREES_TO_RADIANS);\n\t\t\t}\n\t\t}\n\t\t//initialization\n\t\tif (!this._prePos)\n\t\t\tthis._prePos = this._targetPos.clone();\n\t\tif (!this._preEuler)\n\t\t\tthis._preEuler = this._targetEuler.clone();\n\n\t\tvar currentTime:number = this._pTime/1000;\n\t\tvar previousTime:number = animationSubGeometry.previousTime;\n\t\tvar deltaTime:number = currentTime - previousTime;\n\n\t\tvar needProcess:boolean = previousTime != currentTime;\n\n\t\tif (this._particleFollowNode._iUsesPosition && this._particleFollowNode._iUsesRotation) {\n\t\t\tif (needProcess)\n\t\t\t\tthis.processPositionAndRotation(currentTime, deltaTime, animationSubGeometry);\n\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_POSITION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_ROTATION_INDEX), this._particleFollowNode._iDataOffset + 3, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else if (this._particleFollowNode._iUsesPosition) {\n\t\t\tif (needProcess)\n\t\t\t\tthis.processPosition(currentTime, deltaTime, animationSubGeometry);\n\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_POSITION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else if (this._particleFollowNode._iUsesRotation) {\n\t\t\tif (needProcess)\n\t\t\t\tthis.precessRotation(currentTime, deltaTime, animationSubGeometry);\n\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_ROTATION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t}\n\n\t\tthis._prePos.copyFrom(this._targetPos);\n\t\tthis._targetEuler.copyFrom(this._targetEuler);\n\t\tanimationSubGeometry.previousTime = currentTime;\n\t}\n\n\tprivate processPosition(currentTime:number, deltaTime:number, animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tvar data:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\n\t\tvar changed:boolean = false;\n\t\tvar len:number /*uint*/ = data.length;\n\t\tvar interpolatedPos:Vector3D;\n\t\tvar posVelocity:Vector3D;\n\t\tif (this._smooth) {\n\t\t\tposVelocity = this._prePos.subtract(this._targetPos);\n\t\t\tposVelocity.scaleBy(1/deltaTime);\n\t\t} else\n\t\t\tinterpolatedPos = this._targetPos;\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++) {\n\t\t\tvar k:number = (currentTime - data[i].startTime)/data[i].totalTime;\n\t\t\tvar t:number = (k - Math.floor(k))*data[i].totalTime;\n\t\t\tif (t - deltaTime <= 0) {\n\t\t\t\tvar inc:number /*int*/ = data[i].startVertexIndex*animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;\n\n\t\t\t\tif (this._smooth) {\n\t\t\t\t\tthis._temp.copyFrom(posVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedPos = this._targetPos.add(this._temp);\n\t\t\t\t}\n\n\t\t\t\tif (vertexData[inc] != interpolatedPos.x || vertexData[inc + 1] != interpolatedPos.y || vertexData[inc + 2] != interpolatedPos.z) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfor (var j:number /*uint*/ = 0; j < data[i].numVertices; j++) {\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.z;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (changed)\n\t\t\tanimationSubGeometry.invalidateBuffer();\n\n\t}\n\n\tprivate precessRotation(currentTime:number, deltaTime:number, animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tvar data:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\n\t\tvar changed:boolean = false;\n\t\tvar len:number /*uint*/ = data.length;\n\n\t\tvar interpolatedRotation:Vector3D;\n\t\tvar rotationVelocity:Vector3D;\n\n\t\tif (this._smooth) {\n\t\t\trotationVelocity = this._preEuler.subtract(this._targetEuler);\n\t\t\trotationVelocity.scaleBy(1/deltaTime);\n\t\t} else\n\t\t\tinterpolatedRotation = this._targetEuler;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++) {\n\t\t\tvar k:number = (currentTime - data[i].startTime)/data[i].totalTime;\n\t\t\tvar t:number = (k - Math.floor(k))*data[i].totalTime;\n\t\t\tif (t - deltaTime <= 0) {\n\t\t\t\tvar inc:number /*int*/ = data[i].startVertexIndex*animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;\n\n\t\t\t\tif (this._smooth) {\n\t\t\t\t\tthis._temp.copyFrom(rotationVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedRotation = this._targetEuler.add(this._temp);\n\t\t\t\t}\n\n\t\t\t\tif (vertexData[inc] != interpolatedRotation.x || vertexData[inc + 1] != interpolatedRotation.y || vertexData[inc + 2] != interpolatedRotation.z) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfor (var j:number /*uint*/ = 0; j < data[i].numVertices; j++) {\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.z;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (changed)\n\t\t\tanimationSubGeometry.invalidateBuffer();\n\n\t}\n\n\tprivate processPositionAndRotation(currentTime:number, deltaTime:number, animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tvar data:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\n\t\tvar changed:boolean = false;\n\t\tvar len:number /*uint*/ = data.length;\n\n\t\tvar interpolatedPos:Vector3D;\n\t\tvar interpolatedRotation:Vector3D;\n\n\t\tvar posVelocity:Vector3D;\n\t\tvar rotationVelocity:Vector3D;\n\t\tif (this._smooth) {\n\t\t\tposVelocity = this._prePos.subtract(this._targetPos);\n\t\t\tposVelocity.scaleBy(1/deltaTime);\n\t\t\trotationVelocity = this._preEuler.subtract(this._targetEuler);\n\t\t\trotationVelocity.scaleBy(1/deltaTime);\n\t\t} else {\n\t\t\tinterpolatedPos = this._targetPos;\n\t\t\tinterpolatedRotation = this._targetEuler;\n\t\t}\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++) {\n\t\t\tvar k:number = (currentTime - data[i].startTime)/data[i].totalTime;\n\t\t\tvar t:number = (k - Math.floor(k))*data[i].totalTime;\n\t\t\tif (t - deltaTime <= 0) {\n\t\t\t\tvar inc:number /*int*/ = data[i].startVertexIndex*animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;\n\t\t\t\tif (this._smooth) {\n\t\t\t\t\tthis._temp.copyFrom(posVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedPos = this._targetPos.add(this._temp);\n\n\t\t\t\t\tthis._temp.copyFrom(rotationVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedRotation = this._targetEuler.add(this._temp);\n\t\t\t\t}\n\n\t\t\t\tif (vertexData[inc] != interpolatedPos.x || vertexData[inc + 1] != interpolatedPos.y || vertexData[inc + 2] != interpolatedPos.z || vertexData[inc + 3] != interpolatedRotation.x || vertexData[inc + 4] != interpolatedRotation.y || vertexData[inc + 5] != interpolatedRotation.z) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfor (var j:number /*uint*/ = 0; j < data[i].numVertices; j++) {\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.z;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.z;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (changed)\n\t\t\tanimationSubGeometry.invalidateBuffer();\n\t}\n\n}\n\nexport = ParticleFollowState;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleInitialColorNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n*\n*/\nclass ParticleInitialColorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MULTIPLIER_INDEX:number /*uint*/ = 0;\n\t/** @private */\n\tpublic static OFFSET_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleInitialColorNode:ParticleInitialColorNode;\n\tprivate _usesMultiplier:boolean;\n\tprivate _usesOffset:boolean;\n\tprivate _initialColor:ColorTransform;\n\tprivate _multiplierData:Vector3D;\n\tprivate _offsetData:Vector3D;\n\n\tconstructor(animator:ParticleAnimator, particleInitialColorNode:ParticleInitialColorNode)\n\t{\n\t\tsuper(animator, particleInitialColorNode);\n\n\t\tthis._particleInitialColorNode = particleInitialColorNode;\n\t\tthis._usesMultiplier = particleInitialColorNode._iUsesMultiplier;\n\t\tthis._usesOffset = particleInitialColorNode._iUsesOffset;\n\t\tthis._initialColor = particleInitialColorNode._iInitialColor;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the initial color transform of the state, when in global mode.\n\t */\n\tpublic get initialColor():ColorTransform\n\t{\n\t\treturn this._initialColor;\n\t}\n\n\tpublic set initialColor(value:ColorTransform)\n\t{\n\t\tthis._initialColor = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\t// TODO: not used\n\t\trenderable = renderable;\n\t\tcamera = camera;\n\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tif (this._particleInitialColorNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\tvar dataOffset:number /*uint*/ = this._particleInitialColorNode._iDataOffset;\n\t\t\t\tif (this._usesMultiplier) {\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.MULTIPLIER_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t}\n\t\t\t\tif (this._usesOffset)\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.OFFSET_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t} else {\n\t\t\t\tif (this._usesMultiplier)\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.MULTIPLIER_INDEX), this._multiplierData.x, this._multiplierData.y, this._multiplierData.z, this._multiplierData.w);\n\t\t\t\tif (this._usesOffset)\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.OFFSET_INDEX), this._offsetData.x, this._offsetData.y, this._offsetData.z, this._offsetData.w);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateColorData()\n\t{\n\t\tif (this._particleInitialColorNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._usesMultiplier)\n\t\t\t\tthis._multiplierData = new Vector3D(this._initialColor.redMultiplier, this._initialColor.greenMultiplier, this._initialColor.blueMultiplier, this._initialColor.alphaMultiplier);\n\t\t\tif (this._usesOffset)\n\t\t\t\tthis._offsetData = new Vector3D(this._initialColor.redOffset/255, this._initialColor.greenOffset/255, this._initialColor.blueOffset/255, this._initialColor.alphaOffset/255);\n\t\t}\n\t}\n\n}\n\nexport = ParticleInitialColorState;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleOrbitNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleOrbitState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static ORBIT_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static EULERS_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleOrbitNode:ParticleOrbitNode;\n\tprivate _usesEulers:boolean;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _radius:number;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _eulers:Vector3D;\n\tprivate _orbitData:Vector3D;\n\tprivate _eulersMatrix:Matrix3D;\n\n\t/**\n\t * Defines the radius of the orbit when in global mode. Defaults to 100.\n\t */\n\tpublic get radius():number\n\t{\n\t\treturn this._radius;\n\t}\n\n\tpublic set radius(value:number)\n\t{\n\t\tthis._radius = value;\n\n\t\tthis.updateOrbitData();\n\t}\n\n\t/**\n\t * Defines the duration of the orbit in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateOrbitData();\n\t}\n\n\t/**\n\t * Defines the phase of the orbit in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateOrbitData();\n\t}\n\n\t/**\n\t * Defines the euler rotation in degrees, applied to the orientation of the orbit when in global mode.\n\t */\n\tpublic get eulers():Vector3D\n\t{\n\t\treturn this._eulers;\n\t}\n\n\tpublic set eulers(value:Vector3D)\n\t{\n\t\tthis._eulers = value;\n\n\t\tthis.updateOrbitData();\n\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleOrbitNode:ParticleOrbitNode)\n\t{\n\t\tsuper(animator, particleOrbitNode);\n\n\t\tthis._particleOrbitNode = particleOrbitNode;\n\t\tthis._usesEulers = this._particleOrbitNode._iUsesEulers;\n\t\tthis._usesCycle = this._particleOrbitNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleOrbitNode._iUsesPhase;\n\t\tthis._eulers = this._particleOrbitNode._iEulers;\n\t\tthis._radius = this._particleOrbitNode._iRadius;\n\t\tthis._cycleDuration = this._particleOrbitNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleOrbitNode._iCyclePhase;\n\t\tthis.updateOrbitData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleOrbitState.ORBIT_INDEX);\n\n\t\tif (this._particleOrbitNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tif (this._usesPhase)\n\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleOrbitNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\telse\n\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleOrbitNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else\n\t\t\tanimationRegisterCache.setVertexConst(index, this._orbitData.x, this._orbitData.y, this._orbitData.z, this._orbitData.w);\n\n\t\tif (this._usesEulers)\n\t\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleOrbitState.EULERS_INDEX), this._eulersMatrix);\n\t}\n\n\tprivate updateOrbitData()\n\t{\n\t\tif (this._usesEulers) {\n\t\t\tthis._eulersMatrix = new Matrix3D();\n\t\t\tthis._eulersMatrix.appendRotation(this._eulers.x, Vector3D.X_AXIS);\n\t\t\tthis._eulersMatrix.appendRotation(this._eulers.y, Vector3D.Y_AXIS);\n\t\t\tthis._eulersMatrix.appendRotation(this._eulers.z, Vector3D.Z_AXIS);\n\t\t}\n\t\tif (this._particleOrbitNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tthis._orbitData = new Vector3D(this._radius, 0, this._radius*Math.PI*2, this._cyclePhase*Math.PI/180);\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\t\tthis._orbitData.y = Math.PI*2/this._cycleDuration;\n\t\t\t} else\n\t\t\t\tthis._orbitData.y = Math.PI*2;\n\t\t}\n\t}\n}\n\nexport = ParticleOrbitState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleOscillatorNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleOscillatorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static OSCILLATOR_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleOscillatorNode:ParticleOscillatorNode;\n\tprivate _oscillator:Vector3D;\n\tprivate _oscillatorData:Vector3D;\n\n\t/**\n\t * Defines the default oscillator axis (x, y, z) and cycleDuration (w) of the state, used when in global mode.\n\t */\n\tpublic get oscillator():Vector3D\n\t{\n\t\treturn this._oscillator;\n\t}\n\n\tpublic set oscillator(value:Vector3D)\n\t{\n\t\tthis._oscillator = value;\n\n\t\tthis.updateOscillatorData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleOscillatorNode:ParticleOscillatorNode)\n\t{\n\t\tsuper(animator, particleOscillatorNode);\n\n\t\tthis._particleOscillatorNode = particleOscillatorNode;\n\t\tthis._oscillator = this._particleOscillatorNode._iOscillator;\n\n\t\tthis.updateOscillatorData();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleOscillatorState.OSCILLATOR_INDEX);\n\n\t\tif (this._particleOscillatorNode.mode == ParticlePropertiesMode.LOCAL_STATIC)\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleOscillatorNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\telse\n\t\t\tanimationRegisterCache.setVertexConst(index, this._oscillatorData.x, this._oscillatorData.y, this._oscillatorData.z, this._oscillatorData.w);\n\t}\n\n\tprivate updateOscillatorData()\n\t{\n\t\tif (this._particleOscillatorNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._oscillator.w <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\n\t\t\tif (this._oscillatorData == null)\n\t\t\t\tthis._oscillatorData = new Vector3D();\n\n\t\t\tthis._oscillatorData.x = this._oscillator.x;\n\t\t\tthis._oscillatorData.y = this._oscillator.y;\n\t\t\tthis._oscillatorData.z = this._oscillator.z;\n\t\t\tthis._oscillatorData.w = Math.PI*2/this._oscillator.w;\n\t\t}\n\t}\n}\n\nexport = ParticleOscillatorState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticlePositionNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticlePositionNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n * @author ...\n */\nclass ParticlePositionState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static POSITION_INDEX:number /*uint*/ = 0;\n\n\tprivate _particlePositionNode:ParticlePositionNode;\n\tprivate _position:Vector3D;\n\n\t/**\n\t * Defines the position of the particle when in global mode. Defaults to 0,0,0.\n\t */\n\tpublic get position():Vector3D\n\t{\n\t\treturn this._position;\n\t}\n\n\tpublic set position(value:Vector3D)\n\t{\n\t\tthis._position = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getPositions():Array<Vector3D>\n\t{\n\t\treturn this._pDynamicProperties;\n\t}\n\n\tpublic setPositions(value:Array<Vector3D>)\n\t{\n\t\tthis._pDynamicProperties = value;\n\n\t\tthis._pDynamicPropertiesDirty = new Object();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particlePositionNode:ParticlePositionNode)\n\t{\n\t\tsuper(animator, particlePositionNode);\n\n\t\tthis._particlePositionNode = particlePositionNode;\n\t\tthis._position = this._particlePositionNode._iPosition;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._particlePositionNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])\n\t\t\tthis._pUpdateDynamicProperties(animationSubGeometry);\n\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticlePositionState.POSITION_INDEX);\n\n\t\tif (this._particlePositionNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tanimationRegisterCache.setVertexConst(index, this._position.x, this._position.y, this._position.z);\n\t\telse\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particlePositionNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t}\n}\n\nexport = ParticlePositionState;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotateToHeadingNode\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleRotateToHeadingState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MATRIX_INDEX:number /*int*/ = 0;\n\n\tprivate _matrix:Matrix3D = new Matrix3D();\n\n\tconstructor(animator:ParticleAnimator, particleNode:ParticleNodeBase)\n\t{\n\t\tsuper(animator, particleNode);\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tthis._matrix.append(camera.inverseSceneTransform);\n\t\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotateToHeadingState.MATRIX_INDEX), this._matrix);\n\t\t}\n\t}\n\n}\n\nexport = ParticleRotateToHeadingState;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleRotateToPositionNode\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleRotateToPositionState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MATRIX_INDEX:number /*int*/ = 0;\n\t/** @private */\n\tpublic static POSITION_INDEX:number /*int*/ = 1;\n\n\tprivate _particleRotateToPositionNode:ParticleRotateToPositionNode;\n\tprivate _position:Vector3D;\n\tprivate _matrix:Matrix3D = new Matrix3D();\n\tprivate _offset:Vector3D;\n\n\t/**\n\t * Defines the position of the point the particle will rotate to face when in global mode. Defaults to 0,0,0.\n\t */\n\tpublic get position():Vector3D\n\t{\n\t\treturn this._position;\n\t}\n\n\tpublic set position(value:Vector3D)\n\t{\n\t\tthis._position = value;\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleRotateToPositionNode:ParticleRotateToPositionNode)\n\t{\n\t\tsuper(animator, particleRotateToPositionNode);\n\n\t\tthis._particleRotateToPositionNode = particleRotateToPositionNode;\n\t\tthis._position = this._particleRotateToPositionNode._iPosition;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotateToPositionState.POSITION_INDEX);\n\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tthis._matrix.append(camera.inverseSceneTransform);\n\t\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotateToPositionState.MATRIX_INDEX), this._matrix);\n\t\t}\n\n\t\tif (this._particleRotateToPositionNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tthis._offset = renderable.sourceEntity.inverseSceneTransform.transformVector(this._position);\n\t\t\tanimationRegisterCache.setVertexConst(index, this._offset.x, this._offset.y, this._offset.z);\n\t\t} else\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleRotateToPositionNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\n\t}\n\n}\n\nexport = ParticleRotateToPositionState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleRotationalVelocityNode\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleRotationalVelocityState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static ROTATIONALVELOCITY_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleRotationalVelocityNode:ParticleRotationalVelocityNode;\n\tprivate _rotationalVelocityData:Vector3D;\n\tprivate _rotationalVelocity:Vector3D;\n\n\t/**\n\t * Defines the default rotationalVelocity of the state, used when in global mode.\n\t */\n\tpublic get rotationalVelocity():Vector3D\n\t{\n\t\treturn this._rotationalVelocity;\n\t}\n\n\tpublic set rotationalVelocity(value:Vector3D)\n\t{\n\t\tthis._rotationalVelocity = value;\n\n\t\tthis.updateRotationalVelocityData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getRotationalVelocities():Array<Vector3D>\n\t{\n\t\treturn this._pDynamicProperties;\n\t}\n\n\tpublic setRotationalVelocities(value:Array<Vector3D>)\n\t{\n\t\tthis._pDynamicProperties = value;\n\n\t\tthis._pDynamicPropertiesDirty = new Object();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleRotationNode:ParticleRotationalVelocityNode)\n\t{\n\t\tsuper(animator, particleRotationNode);\n\n\t\tthis._particleRotationalVelocityNode = particleRotationNode;\n\t\tthis._rotationalVelocity = this._particleRotationalVelocityNode._iRotationalVelocity;\n\n\t\tthis.updateRotationalVelocityData();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])\n\t\t\tthis._pUpdateDynamicProperties(animationSubGeometry);\n\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX);\n\n\t\tif (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tanimationRegisterCache.setVertexConst(index, this._rotationalVelocityData.x, this._rotationalVelocityData.y, this._rotationalVelocityData.z, this._rotationalVelocityData.w);\n\t\telse\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleRotationalVelocityNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t}\n\n\tprivate updateRotationalVelocityData()\n\t{\n\t\tif (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._rotationalVelocity.w <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\t\t\tvar rotation:Vector3D = this._rotationalVelocity.clone();\n\n\t\t\tif (rotation.length <= 0)\n\t\t\t\trotation.z = 1; //set the default direction\n\t\t\telse\n\t\t\t\trotation.normalize();\n\t\t\t// w is used as angle/2 in agal\n\t\t\tthis._rotationalVelocityData = new Vector3D(rotation.x, rotation.y, rotation.z, Math.PI/rotation.w);\n\t\t}\n\t}\n}\n\nexport = ParticleRotationalVelocityState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleScaleNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleScaleNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleScaleState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static SCALE_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleScaleNode:ParticleScaleNode;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _minScale:number;\n\tprivate _maxScale:number;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _scaleData:Vector3D;\n\n\t/**\n\t * Defines the end scale of the state, when in global mode. Defaults to 1.\n\t */\n\tpublic get minScale():number\n\t{\n\t\treturn this._minScale;\n\t}\n\n\tpublic set minScale(value:number)\n\t{\n\t\tthis._minScale = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\t/**\n\t * Defines the end scale of the state, when in global mode. Defaults to 1.\n\t */\n\tpublic get maxScale():number\n\t{\n\t\treturn this._maxScale;\n\t}\n\n\tpublic set maxScale(value:number)\n\t{\n\t\tthis._maxScale = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\t/**\n\t * Defines the duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\t/**\n\t * Defines the phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleScaleNode:ParticleScaleNode)\n\t{\n\t\tsuper(animator, particleScaleNode);\n\n\t\tthis._particleScaleNode = particleScaleNode;\n\t\tthis._usesCycle = this._particleScaleNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleScaleNode._iUsesPhase;\n\t\tthis._minScale = this._particleScaleNode._iMinScale;\n\t\tthis._maxScale = this._particleScaleNode._iMaxScale;\n\t\tthis._cycleDuration = this._particleScaleNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleScaleNode._iCyclePhase;\n\n\t\tthis.updateScaleData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleScaleState.SCALE_INDEX);\n\n\t\tif (this._particleScaleNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._usesPhase)\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleScaleNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\telse\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleScaleNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\t} else\n\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleScaleNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t} else\n\t\t\tanimationRegisterCache.setVertexConst(index, this._scaleData.x, this._scaleData.y, this._scaleData.z, this._scaleData.w);\n\t}\n\n\tprivate updateScaleData()\n\t{\n\t\tif (this._particleScaleNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\t\tthis._scaleData = new Vector3D((this._minScale + this._maxScale)/2, Math.abs(this._minScale - this._maxScale)/2, Math.PI*2/this._cycleDuration, this._cyclePhase*Math.PI/180);\n\t\t\t} else\n\t\t\t\tthis._scaleData = new Vector3D(this._minScale, this._maxScale - this._minScale, 0, 0);\n\t\t}\n\t}\n}\n\nexport = ParticleScaleState;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ColorSegmentPoint\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ColorSegmentPoint\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleSegmentedColorNode\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n *\n */\nclass ParticleSegmentedColorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static START_MULTIPLIER_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static START_OFFSET_INDEX:number /*uint*/ = 1;\n\n\t/** @private */\n\tpublic static TIME_DATA_INDEX:number /*uint*/ = 2;\n\n\tprivate _usesMultiplier:boolean;\n\tprivate _usesOffset:boolean;\n\tprivate _startColor:ColorTransform;\n\tprivate _endColor:ColorTransform;\n\tprivate _segmentPoints:Array<ColorSegmentPoint>;\n\tprivate _numSegmentPoint:number /*int*/;\n\n\tprivate _timeLifeData:Array<number>;\n\tprivate _multiplierData:Array<number>;\n\tprivate _offsetData:Array<number>;\n\n\t/**\n\t * Defines the start color transform of the state, when in global mode.\n\t */\n\tpublic get startColor():ColorTransform\n\t{\n\t\treturn this._startColor;\n\t}\n\n\tpublic set startColor(value:ColorTransform)\n\t{\n\t\tthis._startColor = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the end color transform of the state, when in global mode.\n\t */\n\tpublic get endColor():ColorTransform\n\t{\n\t\treturn this._endColor;\n\t}\n\n\tpublic set endColor(value:ColorTransform)\n\t{\n\t\tthis._endColor = value;\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the number of segments.\n\t */\n\tpublic get numSegmentPoint():number /*int*/\n\t{\n\t\treturn this._numSegmentPoint;\n\t}\n\n\t/**\n\t * Defines the key points of color\n\t */\n\tpublic get segmentPoints():Array<ColorSegmentPoint>\n\t{\n\t\treturn this._segmentPoints;\n\t}\n\n\tpublic set segmentPoints(value:Array<ColorSegmentPoint>)\n\t{\n\t\tthis._segmentPoints = value;\n\t\tthis.updateColorData();\n\t}\n\n\tpublic get usesMultiplier():boolean\n\t{\n\t\treturn this._usesMultiplier;\n\t}\n\n\tpublic get usesOffset():boolean\n\t{\n\t\treturn this._usesOffset;\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleSegmentedColorNode:ParticleSegmentedColorNode)\n\t{\n\t\tsuper(animator, particleSegmentedColorNode);\n\n\t\tthis._usesMultiplier = particleSegmentedColorNode._iUsesMultiplier;\n\t\tthis._usesOffset = particleSegmentedColorNode._iUsesOffset;\n\t\tthis._startColor = particleSegmentedColorNode._iStartColor;\n\t\tthis._endColor = particleSegmentedColorNode._iEndColor;\n\t\tthis._segmentPoints = particleSegmentedColorNode._iSegmentPoints;\n\t\tthis._numSegmentPoint = particleSegmentedColorNode._iNumSegmentPoint;\n\t\tthis.updateColorData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tif (this._numSegmentPoint > 0)\n\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSegmentedColorState.TIME_DATA_INDEX), this._timeLifeData[0], this._timeLifeData[1], this._timeLifeData[2], this._timeLifeData[3]);\n\t\t\tif (this._usesMultiplier)\n\t\t\t\tanimationRegisterCache.setVertexConstFromArray(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSegmentedColorState.START_MULTIPLIER_INDEX), this._multiplierData);\n\t\t\tif (this._usesOffset)\n\t\t\t\tanimationRegisterCache.setVertexConstFromArray(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSegmentedColorState.START_OFFSET_INDEX), this._offsetData);\n\t\t}\n\t}\n\n\tprivate updateColorData()\n\t{\n\t\tthis._timeLifeData = new Array<number>();\n\t\tthis._multiplierData = new Array<number>();\n\t\tthis._offsetData = new Array<number>();\n\t\tvar i:number /*int*/;\n\t\tfor (i = 0; i < this._numSegmentPoint; i++) {\n\t\t\tif (i == 0)\n\t\t\t\tthis._timeLifeData.push(this._segmentPoints[i].life);\n\t\t\telse\n\t\t\t\tthis._timeLifeData.push(this._segmentPoints[i].life - this._segmentPoints[i - 1].life);\n\t\t}\n\t\tif (this._numSegmentPoint == 0)\n\t\t\tthis._timeLifeData.push(1);\n\t\telse\n\t\t\tthis._timeLifeData.push(1 - this._segmentPoints[i - 1].life);\n\n\t\tif (this._usesMultiplier) {\n\t\t\tthis._multiplierData.push(this._startColor.redMultiplier, this._startColor.greenMultiplier, this._startColor.blueMultiplier, this._startColor.alphaMultiplier);\n\t\t\tfor (i = 0; i < this._numSegmentPoint; i++) {\n\t\t\t\tif (i == 0)\n\t\t\t\t\tthis._multiplierData.push((this._segmentPoints[i].color.redMultiplier - this._startColor.redMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.greenMultiplier - this._startColor.greenMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.blueMultiplier - this._startColor.blueMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.alphaMultiplier - this._startColor.alphaMultiplier)/this._timeLifeData[i]);\n\t\t\t\telse\n\t\t\t\t\tthis._multiplierData.push((this._segmentPoints[i].color.redMultiplier - this._segmentPoints[i - 1].color.redMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.greenMultiplier - this._segmentPoints[i - 1].color.greenMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.blueMultiplier - this._segmentPoints[i - 1].color.blueMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.alphaMultiplier - this._segmentPoints[i - 1].color.alphaMultiplier)/this._timeLifeData[i]);\n\t\t\t}\n\t\t\tif (this._numSegmentPoint == 0)\n\t\t\t\tthis._multiplierData.push(this._endColor.redMultiplier - this._startColor.redMultiplier, this._endColor.greenMultiplier - this._startColor.greenMultiplier, this._endColor.blueMultiplier - this._startColor.blueMultiplier, this._endColor.alphaMultiplier - this._startColor.alphaMultiplier);\n\t\t\telse\n\t\t\t\tthis._multiplierData.push((this._endColor.redMultiplier - this._segmentPoints[i - 1].color.redMultiplier)/this._timeLifeData[i], (this._endColor.greenMultiplier - this._segmentPoints[i - 1].color.greenMultiplier)/this._timeLifeData[i], (this._endColor.blueMultiplier - this._segmentPoints[i - 1].color.blueMultiplier)/this._timeLifeData[i], (this._endColor.alphaMultiplier - this._segmentPoints[i - 1].color.alphaMultiplier)/this._timeLifeData[i]);\n\t\t}\n\n\t\tif (this._usesOffset) {\n\t\t\tthis._offsetData.push(this._startColor.redOffset/255, this._startColor.greenOffset/255, this._startColor.blueOffset/255, this._startColor.alphaOffset/255);\n\t\t\tfor (i = 0; i < this._numSegmentPoint; i++) {\n\t\t\t\tif (i == 0)\n\t\t\t\t\tthis._offsetData.push((this._segmentPoints[i].color.redOffset - this._startColor.redOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.greenOffset - this._startColor.greenOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.blueOffset - this._startColor.blueOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.alphaOffset - this._startColor.alphaOffset)/this._timeLifeData[i]/255);\n\t\t\t\telse\n\t\t\t\t\tthis._offsetData.push((this._segmentPoints[i].color.redOffset - this._segmentPoints[i - 1].color.redOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.greenOffset - this._segmentPoints[i - 1].color.greenOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.blueOffset - this._segmentPoints[i - 1].color.blueOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.alphaOffset - this._segmentPoints[i - 1].color.alphaOffset)/this._timeLifeData[i]/255);\n\t\t\t}\n\t\t\tif (this._numSegmentPoint == 0)\n\t\t\t\tthis._offsetData.push((this._endColor.redOffset - this._startColor.redOffset)/255, (this._endColor.greenOffset - this._startColor.greenOffset)/255, (this._endColor.blueOffset - this._startColor.blueOffset)/255, (this._endColor.alphaOffset - this._startColor.alphaOffset)/255);\n\t\t\telse\n\t\t\t\tthis._offsetData.push((this._endColor.redOffset - this._segmentPoints[i - 1].color.redOffset)/this._timeLifeData[i]/255, (this._endColor.greenOffset - this._segmentPoints[i - 1].color.greenOffset)/this._timeLifeData[i]/255, (this._endColor.blueOffset - this._segmentPoints[i - 1].color.blueOffset)/this._timeLifeData[i]/255, (this._endColor.alphaOffset - this._segmentPoints[i - 1].color.alphaOffset)/this._timeLifeData[i]/255);\n\t\t}\n\t\t//cut off the data\n\t\tthis._timeLifeData.length = 4;\n\t}\n}\n\nexport = ParticleSegmentedColorState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleSpriteSheetNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleSpriteSheetState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static UV_INDEX_0:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static UV_INDEX_1:number /*uint*/ = 1;\n\n\tprivate _particleSpriteSheetNode:ParticleSpriteSheetNode;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _totalFrames:number /*int*/;\n\tprivate _numColumns:number /*int*/;\n\tprivate _numRows:number /*int*/;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _spriteSheetData:Array<number>;\n\n\t/**\n\t * Defines the cycle phase, when in global mode. Defaults to zero.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateSpriteSheetData();\n\t}\n\n\t/**\n\t * Defines the cycle duration in seconds, when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateSpriteSheetData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleSpriteSheetNode:ParticleSpriteSheetNode)\n\t{\n\t\tsuper(animator, particleSpriteSheetNode);\n\n\t\tthis._particleSpriteSheetNode = particleSpriteSheetNode;\n\n\t\tthis._usesCycle = this._particleSpriteSheetNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleSpriteSheetNode._iUsesCycle;\n\t\tthis._totalFrames = this._particleSpriteSheetNode._iTotalFrames;\n\t\tthis._numColumns = this._particleSpriteSheetNode._iNumColumns;\n\t\tthis._numRows = this._particleSpriteSheetNode._iNumRows;\n\t\tthis._cycleDuration = this._particleSpriteSheetNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleSpriteSheetNode._iCyclePhase;\n\n\t\tthis.updateSpriteSheetData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needUVAnimation) {\n\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSpriteSheetState.UV_INDEX_0), this._spriteSheetData[0], this._spriteSheetData[1], this._spriteSheetData[2], this._spriteSheetData[3]);\n\t\t\tif (this._usesCycle) {\n\t\t\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSpriteSheetState.UV_INDEX_1);\n\t\t\t\tif (this._particleSpriteSheetNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\t\tif (this._usesPhase)\n\t\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleSpriteSheetNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\t\t\telse\n\t\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleSpriteSheetNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\t\t} else\n\t\t\t\t\tanimationRegisterCache.setVertexConst(index, this._spriteSheetData[4], this._spriteSheetData[5]);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateSpriteSheetData()\n\t{\n\t\tthis._spriteSheetData = new Array<number>(8);\n\n\t\tvar uTotal:number = this._totalFrames/this._numColumns;\n\n\t\tthis._spriteSheetData[0] = uTotal;\n\t\tthis._spriteSheetData[1] = 1/this._numColumns;\n\t\tthis._spriteSheetData[2] = 1/this._numRows;\n\n\t\tif (this._usesCycle) {\n\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tthis._spriteSheetData[4] = uTotal/this._cycleDuration;\n\t\t\tthis._spriteSheetData[5] = this._cycleDuration;\n\t\t\tif (this._usesPhase)\n\t\t\t\tthis._spriteSheetData[6] = this._cyclePhase;\n\t\t}\n\t}\n}\n\nexport = ParticleSpriteSheetState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleStateBase extends AnimationStateBase\n{\n\tprivate _particleNode:ParticleNodeBase;\n\n\tpublic _pDynamicProperties:Array<Vector3D> = new Array<Vector3D>();\n\tpublic _pDynamicPropertiesDirty:Object = new Object();\n\n\tpublic _pNeedUpdateTime:boolean;\n\n\tconstructor(animator:ParticleAnimator, particleNode:ParticleNodeBase, needUpdateTime:boolean = false)\n\t{\n\t\tsuper(animator, particleNode);\n\n\t\tthis._particleNode = particleNode;\n\t\tthis._pNeedUpdateTime = needUpdateTime;\n\t}\n\n\tpublic get needUpdateTime():boolean\n\t{\n\t\treturn this._pNeedUpdateTime;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\n\t}\n\n\tpublic _pUpdateDynamicProperties(animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tthis._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId] = true;\n\n\t\tvar animationParticles:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\t\tvar totalLenOfOneVertex:number /*uint*/ = animationSubGeometry.totalLenOfOneVertex;\n\t\tvar dataLength:number /*uint*/ = this._particleNode.dataLength;\n\t\tvar dataOffset:number /*uint*/ = this._particleNode._iDataOffset;\n\t\tvar vertexLength:number /*uint*/;\n\t\t//\t\t\tvar particleOffset:number /*uint*/;\n\t\tvar startingOffset:number /*uint*/;\n\t\tvar vertexOffset:number /*uint*/;\n\t\tvar data:Vector3D;\n\t\tvar animationParticle:ParticleAnimationData;\n\n\t\t//\t\t\tvar numParticles:number /*uint*/ = _positions.length/dataLength;\n\t\tvar numParticles:number /*uint*/ = this._pDynamicProperties.length;\n\t\tvar i:number /*uint*/ = 0;\n\t\tvar j:number /*uint*/ = 0;\n\t\tvar k:number /*uint*/ = 0;\n\n\t\t//loop through all particles\n\t\twhile (i < numParticles) {\n\t\t\t//loop through each particle data for the current particle\n\t\t\twhile (j < numParticles && (animationParticle = animationParticles[j]).index == i) {\n\t\t\t\tdata = this._pDynamicProperties[i];\n\t\t\t\tvertexLength = animationParticle.numVertices*totalLenOfOneVertex;\n\t\t\t\tstartingOffset = animationParticle.startVertexIndex*totalLenOfOneVertex + dataOffset;\n\t\t\t\t//loop through each vertex in the particle data\n\t\t\t\tfor (k = 0; k < vertexLength; k += totalLenOfOneVertex) {\n\t\t\t\t\tvertexOffset = startingOffset + k;\n\t\t\t\t\t//\t\t\t\t\t\tparticleOffset = i * dataLength;\n\t\t\t\t\t//loop through all vertex data for the current particle data\n\t\t\t\t\tfor (k = 0; k < vertexLength; k += totalLenOfOneVertex) {\n\t\t\t\t\t\tvertexOffset = startingOffset + k;\n\t\t\t\t\t\tvertexData[vertexOffset++] = data.x;\n\t\t\t\t\t\tvertexData[vertexOffset++] = data.y;\n\t\t\t\t\t\tvertexData[vertexOffset++] = data.z;\n\n\t\t\t\t\t\tif (dataLength == 4)\n\t\t\t\t\t\t\tvertexData[vertexOffset++] = data.w;\n\t\t\t\t\t}\n\t\t\t\t\t\t//loop through each value in the particle vertex\n\t\t\t\t\t\t//\t\t\t\t\t\tswitch(dataLength) {\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tj++;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\n\t\tanimationSubGeometry.invalidateBuffer();\n\t}\n\n}\n\nexport = ParticleStateBase;",
    "import Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleTimeNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleTimeState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static TIME_STREAM_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static TIME_CONSTANT_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleTimeNode:ParticleTimeNode;\n\n\tconstructor(animator:ParticleAnimator, particleTimeNode:ParticleTimeNode)\n\t{\n\t\tsuper(animator, particleTimeNode, true);\n\n\t\tthis._particleTimeNode = particleTimeNode;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleTimeState.TIME_STREAM_INDEX), this._particleTimeNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\n\t\tvar particleTime:number = this._pTime/1000;\n\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleTimeState.TIME_CONSTANT_INDEX), particleTime, particleTime, particleTime, particleTime);\n\t}\n\n}\n\nexport = ParticleTimeState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleUVNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleUVNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleUVState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static UV_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleUVNode:ParticleUVNode;\n\n\tconstructor(animator:ParticleAnimator, particleUVNode:ParticleUVNode)\n\t{\n\t\tsuper(animator, particleUVNode);\n\n\t\tthis._particleUVNode = particleUVNode;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needUVAnimation) {\n\t\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleUVState.UV_INDEX);\n\t\t\tvar data:Vector3D = this._particleUVNode._iUvData;\n\t\t\tanimationRegisterCache.setVertexConst(index, data.x, data.y);\n\t\t}\n\t}\n\n}\n\nexport = ParticleUVState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleVelocityNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleVelocityState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static VELOCITY_INDEX:number /*int*/ = 0;\n\n\tprivate _particleVelocityNode:ParticleVelocityNode;\n\tprivate _velocity:Vector3D;\n\n\t/**\n\t * Defines the default velocity vector of the state, used when in global mode.\n\t */\n\tpublic get velocity():Vector3D\n\t{\n\t\treturn this._velocity;\n\t}\n\n\tpublic set velocity(value:Vector3D)\n\t{\n\t\tthis._velocity = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getVelocities():Array<Vector3D>\n\t{\n\t\treturn this._pDynamicProperties;\n\t}\n\n\tpublic setVelocities(value:Array<Vector3D>)\n\t{\n\t\tthis._pDynamicProperties = value;\n\n\t\tthis._pDynamicPropertiesDirty = new Object();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleVelocityNode:ParticleVelocityNode)\n\t{\n\t\tsuper(animator, particleVelocityNode);\n\n\t\tthis._particleVelocityNode = particleVelocityNode;\n\t\tthis._velocity = this._particleVelocityNode._iVelocity;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._particleVelocityNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])\n\t\t\tthis._pUpdateDynamicProperties(animationSubGeometry);\n\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleVelocityState.VELOCITY_INDEX);\n\n\t\tif (this._particleVelocityNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tanimationRegisterCache.setVertexConst(index, this._velocity.x, this._velocity.y, this._velocity.z);\n\t\telse\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleVelocityNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t}\n}\n\nexport = ParticleVelocityState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonBinaryLERPNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonBinaryLERPState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _blendWeight:number = 0;\n\tprivate _skeletonAnimationNode:SkeletonBinaryLERPNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _inputA:ISkeletonAnimationState;\n\tprivate _inputB:ISkeletonAnimationState;\n\n\t/**\n\t * Defines a fractional value between 0 and 1 representing the blending ratio between inputA (0) and inputB (1),\n\t * used to produce the skeleton pose output.\n\t *\n\t * @see inputA\n\t * @see inputB\n\t */\n\tpublic get blendWeight():number\n\t{\n\t\treturn this._blendWeight;\n\t}\n\n\tpublic set blendWeight(value:number)\n\t{\n\t\tthis._blendWeight = value;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t\tthis._skeletonPoseDirty = true;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonBinaryLERPNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tthis._inputA = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.inputA);\n\t\tthis._inputB = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.inputB);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tthis._inputA.phase(value);\n\t\tthis._inputB.phase(value);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._inputA.update(time);\n\t\tthis._inputB.update(time);\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tvar deltA:Vector3D = this._inputA.positionDelta;\n\t\tvar deltB:Vector3D = this._inputB.positionDelta;\n\n\t\tthis._pRootDelta.x = deltA.x + this._blendWeight*(deltB.x - deltA.x);\n\t\tthis._pRootDelta.y = deltA.y + this._blendWeight*(deltB.y - deltA.y);\n\t\tthis._pRootDelta.z = deltA.z + this._blendWeight*(deltB.z - deltA.z);\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the blendWeight value between input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tvar endPose:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar poses1:Array<JointPose> = this._inputA.getSkeletonPose(skeleton).jointPoses;\n\t\tvar poses2:Array<JointPose> = this._inputB.getSkeletonPose(skeleton).jointPoses;\n\t\tvar pose1:JointPose, pose2:JointPose;\n\t\tvar p1:Vector3D, p2:Vector3D;\n\t\tvar tr:Vector3D;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tpose1 = poses1[i];\n\t\t\tpose2 = poses2[i];\n\t\t\tp1 = pose1.translation;\n\t\t\tp2 = pose2.translation;\n\n\t\t\tendPose.orientation.lerp(pose1.orientation, pose2.orientation, this._blendWeight);\n\n\t\t\ttr = endPose.translation;\n\t\t\ttr.x = p1.x + this._blendWeight*(p2.x - p1.x);\n\t\t\ttr.y = p1.y + this._blendWeight*(p2.y - p1.y);\n\t\t\ttr.z = p1.z + this._blendWeight*(p2.z - p1.z);\n\t\t}\n\t}\n}\n\nexport = SkeletonBinaryLERPState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport SkeletonAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimator\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode\");\nimport AnimationClipState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationClipState\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonClipState extends AnimationClipState implements ISkeletonAnimationState\n{\n\tprivate _rootPos:Vector3D = new Vector3D();\n\tprivate _frames:Array<SkeletonPose>;\n\tprivate _skeletonClipNode:SkeletonClipNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _currentPose:SkeletonPose;\n\tprivate _nextPose:SkeletonPose;\n\n\t/**\n\t * Returns the current skeleton pose frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get currentPose():SkeletonPose\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._currentPose;\n\t}\n\n\t/**\n\t * Returns the next skeleton pose frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get nextPose():SkeletonPose\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._nextPose;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonClipNode:SkeletonClipNode)\n\t{\n\t\tsuper(animator, skeletonClipNode);\n\n\t\tthis._skeletonClipNode = skeletonClipNode;\n\t\tthis._frames = this._skeletonClipNode.frames;\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateFrames()\n\t{\n\t\tsuper._pUpdateFrames();\n\n\t\tthis._currentPose = this._frames[this._pCurrentFrame];\n\n\t\tif (this._skeletonClipNode.looping && this._pNextFrame >= this._skeletonClipNode.lastFrame) {\n\t\t\tthis._nextPose = this._frames[0];\n\t\t\t(<SkeletonAnimator> this._pAnimator).dispatchCycleEvent();\n\t\t} else\n\t\t\tthis._nextPose = this._frames[this._pNextFrame];\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the internal playhead position.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tif (!this._skeletonClipNode.totalDuration)\n\t\t\treturn;\n\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\tvar currentPose:Array<JointPose> = this._currentPose.jointPoses;\n\t\tvar nextPose:Array<JointPose> = this._nextPose.jointPoses;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\t\tvar p1:Vector3D, p2:Vector3D;\n\t\tvar pose1:JointPose, pose2:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar endPose:JointPose;\n\t\tvar tr:Vector3D;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tif ((numJoints != currentPose.length) || (numJoints != nextPose.length))\n\t\t\tthrow new Error(\"joint counts don't match!\");\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tpose1 = currentPose[i];\n\t\t\tpose2 = nextPose[i];\n\t\t\tp1 = pose1.translation;\n\t\t\tp2 = pose2.translation;\n\n\t\t\tif (this._skeletonClipNode.highQuality)\n\t\t\t\tendPose.orientation.slerp(pose1.orientation, pose2.orientation, this._pBlendWeight); else\n\t\t\t\tendPose.orientation.lerp(pose1.orientation, pose2.orientation, this._pBlendWeight);\n\n\t\t\tif (i > 0) {\n\t\t\t\ttr = endPose.translation;\n\t\t\t\ttr.x = p1.x + this._pBlendWeight*(p2.x - p1.x);\n\t\t\t\ttr.y = p1.y + this._pBlendWeight*(p2.y - p1.y);\n\t\t\t\ttr.z = p1.z + this._pBlendWeight*(p2.z - p1.z);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\tvar p1:Vector3D, p2:Vector3D, p3:Vector3D;\n\t\tvar totalDelta:Vector3D = this._skeletonClipNode.totalDelta;\n\n\t\t// jumping back, need to reset position\n\t\tif ((this._pTimeDir > 0 && this._pNextFrame < this._pOldFrame) || (this._pTimeDir < 0 && this._pNextFrame > this._pOldFrame)) {\n\t\t\tthis._rootPos.x -= totalDelta.x*this._pTimeDir;\n\t\t\tthis._rootPos.y -= totalDelta.y*this._pTimeDir;\n\t\t\tthis._rootPos.z -= totalDelta.z*this._pTimeDir;\n\t\t}\n\n\t\tvar dx:number = this._rootPos.x;\n\t\tvar dy:number = this._rootPos.y;\n\t\tvar dz:number = this._rootPos.z;\n\n\t\tif (this._skeletonClipNode.stitchFinalFrame && this._pNextFrame == this._skeletonClipNode.lastFrame) {\n\t\t\tp1 = this._frames[0].jointPoses[0].translation;\n\t\t\tp2 = this._frames[1].jointPoses[0].translation;\n\t\t\tp3 = this._currentPose.jointPoses[0].translation;\n\n\t\t\tthis._rootPos.x = p3.x + p1.x + this._pBlendWeight*(p2.x - p1.x);\n\t\t\tthis._rootPos.y = p3.y + p1.y + this._pBlendWeight*(p2.y - p1.y);\n\t\t\tthis._rootPos.z = p3.z + p1.z + this._pBlendWeight*(p2.z - p1.z);\n\t\t} else {\n\t\t\tp1 = this._currentPose.jointPoses[0].translation;\n\t\t\tp2 = this._frames[this._pNextFrame].jointPoses[0].translation; //cover the instances where we wrap the pose but still want the final frame translation values\n\t\t\tthis._rootPos.x = p1.x + this._pBlendWeight*(p2.x - p1.x);\n\t\t\tthis._rootPos.y = p1.y + this._pBlendWeight*(p2.y - p1.y);\n\t\t\tthis._rootPos.z = p1.z + this._pBlendWeight*(p2.z - p1.z);\n\t\t}\n\n\t\tthis._pRootDelta.x = this._rootPos.x - dx;\n\t\tthis._pRootDelta.y = this._rootPos.y - dy;\n\t\tthis._pRootDelta.z = this._rootPos.z - dz;\n\n\t\tthis._pOldFrame = this._pNextFrame;\n\t}\n}\n\nexport = SkeletonClipState;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonDifferenceNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonDifferenceState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _blendWeight:number = 0;\n\tprivate static _tempQuat:Quaternion = new Quaternion();\n\tprivate _skeletonAnimationNode:SkeletonDifferenceNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _baseInput:ISkeletonAnimationState;\n\tprivate _differenceInput:ISkeletonAnimationState;\n\n\t/**\n\t * Defines a fractional value between 0 and 1 representing the blending ratio between the base input (0) and difference input (1),\n\t * used to produce the skeleton pose output.\n\t *\n\t * @see #baseInput\n\t * @see #differenceInput\n\t */\n\tpublic get blendWeight():number\n\t{\n\t\treturn this._blendWeight;\n\t}\n\n\tpublic set blendWeight(value:number)\n\t{\n\t\tthis._blendWeight = value;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t\tthis._skeletonPoseDirty = true;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonDifferenceNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tthis._baseInput = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.baseInput);\n\t\tthis._differenceInput = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.differenceInput);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tthis._baseInput.phase(value);\n\t\tthis._baseInput.phase(value);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._baseInput.update(time);\n\t\tthis._differenceInput.update(time);\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tvar deltA:Vector3D = this._baseInput.positionDelta;\n\t\tvar deltB:Vector3D = this._differenceInput.positionDelta;\n\n\t\tthis.positionDelta.x = deltA.x + this._blendWeight*deltB.x;\n\t\tthis.positionDelta.y = deltA.y + this._blendWeight*deltB.y;\n\t\tthis.positionDelta.z = deltA.z + this._blendWeight*deltB.z;\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the blendWeight value between base input and difference input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tvar endPose:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar basePoses:Array<JointPose> = this._baseInput.getSkeletonPose(skeleton).jointPoses;\n\t\tvar diffPoses:Array<JointPose> = this._differenceInput.getSkeletonPose(skeleton).jointPoses;\n\t\tvar base:JointPose, diff:JointPose;\n\t\tvar basePos:Vector3D, diffPos:Vector3D;\n\t\tvar tr:Vector3D;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tbase = basePoses[i];\n\t\t\tdiff = diffPoses[i];\n\t\t\tbasePos = base.translation;\n\t\t\tdiffPos = diff.translation;\n\n\t\t\tSkeletonDifferenceState._tempQuat.multiply(diff.orientation, base.orientation);\n\t\t\tendPose.orientation.lerp(base.orientation, SkeletonDifferenceState._tempQuat, this._blendWeight);\n\n\t\t\ttr = endPose.translation;\n\t\t\ttr.x = basePos.x + this._blendWeight*diffPos.x;\n\t\t\ttr.y = basePos.y + this._blendWeight*diffPos.y;\n\t\t\ttr.z = basePos.z + this._blendWeight*diffPos.z;\n\t\t}\n\t}\n}\n\nexport = SkeletonDifferenceState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonDirectionalNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonDirectionalState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _skeletonAnimationNode:SkeletonDirectionalNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _inputA:ISkeletonAnimationState;\n\tprivate _inputB:ISkeletonAnimationState;\n\tprivate _blendWeight:number = 0;\n\tprivate _direction:number = 0;\n\tprivate _blendDirty:boolean = true;\n\tprivate _forward:ISkeletonAnimationState;\n\tprivate _backward:ISkeletonAnimationState;\n\tprivate _left:ISkeletonAnimationState;\n\tprivate _right:ISkeletonAnimationState;\n\n\t/**\n\t * Defines the direction in degrees of the aniamtion between the forwards (0), right(90) backwards (180) and left(270) input nodes,\n\t * used to produce the skeleton pose output.\n\t */\n\tpublic set direction(value:number)\n\t{\n\t\tif (this._direction == value)\n\t\t\treturn;\n\n\t\tthis._direction = value;\n\n\t\tthis._blendDirty = true;\n\n\t\tthis._skeletonPoseDirty = true;\n\t\tthis._pPositionDeltaDirty = true;\n\t}\n\n\tpublic get direction():number\n\t{\n\t\treturn this._direction;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonDirectionalNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tthis._forward = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.forward);\n\t\tthis._backward = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.backward);\n\t\tthis._left = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.left);\n\t\tthis._right = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.right);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tthis._inputA.phase(value);\n\t\tthis._inputB.phase(value);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUdateTime(time:number /*int*/)\n\t{\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._inputA.update(time);\n\t\tthis._inputB.update(time);\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tvar deltA:Vector3D = this._inputA.positionDelta;\n\t\tvar deltB:Vector3D = this._inputB.positionDelta;\n\n\t\tthis.positionDelta.x = deltA.x + this._blendWeight*(deltB.x - deltA.x);\n\t\tthis.positionDelta.y = deltA.y + this._blendWeight*(deltB.y - deltA.y);\n\t\tthis.positionDelta.z = deltA.z + this._blendWeight*(deltB.z - deltA.z);\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the direction value between forward, backwards, left and right input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tvar endPose:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar poses1:Array<JointPose> = this._inputA.getSkeletonPose(skeleton).jointPoses;\n\t\tvar poses2:Array<JointPose> = this._inputB.getSkeletonPose(skeleton).jointPoses;\n\t\tvar pose1:JointPose, pose2:JointPose;\n\t\tvar p1:Vector3D, p2:Vector3D;\n\t\tvar tr:Vector3D;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tpose1 = poses1[i];\n\t\t\tpose2 = poses2[i];\n\t\t\tp1 = pose1.translation;\n\t\t\tp2 = pose2.translation;\n\n\t\t\tendPose.orientation.lerp(pose1.orientation, pose2.orientation, this._blendWeight);\n\n\t\t\ttr = endPose.translation;\n\t\t\ttr.x = p1.x + this._blendWeight*(p2.x - p1.x);\n\t\t\ttr.y = p1.y + this._blendWeight*(p2.y - p1.y);\n\t\t\ttr.z = p1.z + this._blendWeight*(p2.z - p1.z);\n\t\t}\n\t}\n\n\t/**\n\t * Updates the blend value for the animation output based on the direction value between forward, backwards, left and right input nodes.\n\t *\n\t * @private\n\t */\n\tprivate updateBlend()\n\t{\n\t\tthis._blendDirty = false;\n\n\t\tif (this._direction < 0 || this._direction > 360) {\n\t\t\tthis._direction %= 360;\n\t\t\tif (this._direction < 0)\n\t\t\t\tthis._direction += 360;\n\t\t}\n\n\t\tif (this._direction < 90) {\n\t\t\tthis._inputA = this._forward;\n\t\t\tthis._inputB = this._right;\n\t\t\tthis._blendWeight = this._direction/90;\n\t\t} else if (this._direction < 180) {\n\t\t\tthis._inputA = this._right;\n\t\t\tthis._inputB = this._backward;\n\t\t\tthis._blendWeight = (this._direction - 90)/90;\n\t\t} else if (this._direction < 270) {\n\t\t\tthis._inputA = this._backward;\n\t\t\tthis._inputB = this._left;\n\t\t\tthis._blendWeight = (this._direction - 180)/90;\n\t\t} else {\n\t\t\tthis._inputA = this._left;\n\t\t\tthis._inputB = this._forward;\n\t\t\tthis._blendWeight = (this._direction - 270)/90;\n\t\t}\n\t}\n}\n\nexport = SkeletonDirectionalState;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonNaryLERPNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonNaryLERPState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _skeletonAnimationNode:SkeletonNaryLERPNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _blendWeights:Array<number> = new Array<number>();\n\tprivate _inputs:Array<ISkeletonAnimationState> = new Array<ISkeletonAnimationState>();\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonNaryLERPNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tvar i:number /*uint*/ = this._skeletonAnimationNode.numInputs;\n\n\t\twhile (i--)\n\t\t\tthis._inputs[i] = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode._iInputs[i]);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tif (this._blendWeights[j])\n\t\t\t\tthis._inputs[j].update(value);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUdateTime(time:number /*int*/)\n\t{\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tif (this._blendWeights[j])\n\t\t\t\tthis._inputs[j].update(time);\n\t\t}\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * Returns the blend weight of the skeleton aniamtion node that resides at the given input index.\n\t *\n\t * @param index The input index for which the skeleton animation node blend weight is requested.\n\t */\n\tpublic getBlendWeightAt(index:number /*uint*/):number\n\t{\n\t\treturn this._blendWeights[index];\n\t}\n\n\t/**\n\t * Sets the blend weight of the skeleton aniamtion node that resides at the given input index.\n\t *\n\t * @param index The input index on which the skeleton animation node blend weight is to be set.\n\t * @param blendWeight The blend weight value to use for the given skeleton animation node index.\n\t */\n\tpublic setBlendWeightAt(index:number /*uint*/, blendWeight:number)\n\t{\n\t\tthis._blendWeights[index] = blendWeight;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t\tthis._skeletonPoseDirty = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tvar delta:Vector3D;\n\t\tvar weight:number;\n\n\t\tthis.positionDelta.x = 0;\n\t\tthis.positionDelta.y = 0;\n\t\tthis.positionDelta.z = 0;\n\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tweight = this._blendWeights[j];\n\n\t\t\tif (weight) {\n\t\t\t\tdelta = this._inputs[j].positionDelta;\n\t\t\t\tthis.positionDelta.x += weight*delta.x;\n\t\t\t\tthis.positionDelta.y += weight*delta.y;\n\t\t\t\tthis.positionDelta.z += weight*delta.z;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the blend weight values given to the input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tvar weight:number;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar poses:Array<JointPose>;\n\t\tvar endPose:JointPose, pose:JointPose;\n\t\tvar endTr:Vector3D, tr:Vector3D;\n\t\tvar endQuat:Quaternion, q:Quaternion;\n\t\tvar firstPose:Array<JointPose>;\n\t\tvar i:number /*uint*/;\n\t\tvar w0:number, x0:number, y0:number, z0:number;\n\t\tvar w1:number, x1:number, y1:number, z1:number;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tweight = this._blendWeights[j];\n\n\t\t\tif (!weight)\n\t\t\t\tcontinue;\n\n\t\t\tposes = this._inputs[j].getSkeletonPose(skeleton).jointPoses;\n\n\t\t\tif (!firstPose) {\n\t\t\t\tfirstPose = poses;\n\t\t\t\tfor (i = 0; i < numJoints; ++i) {\n\t\t\t\t\tendPose = endPoses[i];\n\n\t\t\t\t\tif (endPose == null)\n\t\t\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\t\t\tpose = poses[i];\n\t\t\t\t\tq = pose.orientation;\n\t\t\t\t\ttr = pose.translation;\n\n\t\t\t\t\tendQuat = endPose.orientation;\n\n\t\t\t\t\tendQuat.x = weight*q.x;\n\t\t\t\t\tendQuat.y = weight*q.y;\n\t\t\t\t\tendQuat.z = weight*q.z;\n\t\t\t\t\tendQuat.w = weight*q.w;\n\n\t\t\t\t\tendTr = endPose.translation;\n\t\t\t\t\tendTr.x = weight*tr.x;\n\t\t\t\t\tendTr.y = weight*tr.y;\n\t\t\t\t\tendTr.z = weight*tr.z;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (i = 0; i < skeleton.numJoints; ++i) {\n\t\t\t\t\tendPose = endPoses[i];\n\t\t\t\t\tpose = poses[i];\n\n\t\t\t\t\tq = firstPose[i].orientation;\n\t\t\t\t\tx0 = q.x;\n\t\t\t\t\ty0 = q.y;\n\t\t\t\t\tz0 = q.z;\n\t\t\t\t\tw0 = q.w;\n\n\t\t\t\t\tq = pose.orientation;\n\t\t\t\t\ttr = pose.translation;\n\n\t\t\t\t\tx1 = q.x;\n\t\t\t\t\ty1 = q.y;\n\t\t\t\t\tz1 = q.z;\n\t\t\t\t\tw1 = q.w;\n\t\t\t\t\t// find shortest direction\n\t\t\t\t\tif (x0*x1 + y0*y1 + z0*z1 + w0*w1 < 0) {\n\t\t\t\t\t\tx1 = -x1;\n\t\t\t\t\t\ty1 = -y1;\n\t\t\t\t\t\tz1 = -z1;\n\t\t\t\t\t\tw1 = -w1;\n\t\t\t\t\t}\n\t\t\t\t\tendQuat = endPose.orientation;\n\t\t\t\t\tendQuat.x += weight*x1;\n\t\t\t\t\tendQuat.y += weight*y1;\n\t\t\t\t\tendQuat.z += weight*z1;\n\t\t\t\t\tendQuat.w += weight*w1;\n\n\t\t\t\t\tendTr = endPose.translation;\n\t\t\t\t\tendTr.x += weight*tr.x;\n\t\t\t\t\tendTr.y += weight*tr.y;\n\t\t\t\t\tendTr.z += weight*tr.z;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < skeleton.numJoints; ++i)\n\t\t\tendPoses[i].orientation.normalize();\n\t}\n}\n\nexport = SkeletonNaryLERPState;",
    "import Geometry\t\t\t\t\t\t\t= require(\"awayjs-core/lib/data/Geometry\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport VertexAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimator\");\nimport VertexClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/VertexClipNode\");\nimport AnimationClipState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationClipState\");\nimport IVertexAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IVertexAnimationState\");\n\n/**\n *\n */\nclass VertexClipState extends AnimationClipState implements IVertexAnimationState\n{\n\tprivate _frames:Array<Geometry>;\n\tprivate _vertexClipNode:VertexClipNode;\n\tprivate _currentGeometry:Geometry;\n\tprivate _nextGeometry:Geometry;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get currentGeometry():Geometry\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._currentGeometry;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get nextGeometry():Geometry\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._nextGeometry;\n\t}\n\n\tconstructor(animator:AnimatorBase, vertexClipNode:VertexClipNode)\n\t{\n\t\tsuper(animator, vertexClipNode);\n\n\t\tthis._vertexClipNode = vertexClipNode;\n\t\tthis._frames = this._vertexClipNode.frames;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateFrames()\n\t{\n\t\tsuper._pUpdateFrames();\n\n\t\tthis._currentGeometry = this._frames[this._pCurrentFrame];\n\n\t\tif (this._vertexClipNode.looping && this._pNextFrame >= this._vertexClipNode.lastFrame) {\n\t\t\tthis._nextGeometry = this._frames[0];\n\t\t\t(<VertexAnimator> this._pAnimator).dispatchCycleEvent();\n\t\t} else\n\t\t\tthis._nextGeometry = this._frames[this._pNextFrame];\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\t//TODO:implement positiondelta functionality for vertex animations\n\t}\n}\n\nexport = VertexClipState;",
    "import SkeletonBinaryLERPNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode\");\nimport CrossfadeTransitionState\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState\");\n\n/**\n * A skeleton animation node that uses two animation node inputs to blend a lineraly interpolated output of a skeleton pose.\n */\nclass CrossfadeTransitionNode extends SkeletonBinaryLERPNode\n{\n\tpublic blendSpeed:number;\n\n\tpublic startBlend:number /*int*/;\n\n\t/**\n\t * Creates a new <code>CrossfadeTransitionNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = CrossfadeTransitionState;\n\t}\n}\n\nexport = CrossfadeTransitionNode;",
    "import AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport SkeletonBinaryLERPNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode\");\nimport SkeletonBinaryLERPState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState\");\nimport CrossfadeTransitionNode\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode\");\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\n\n/**\n *\n */\nclass CrossfadeTransitionState extends SkeletonBinaryLERPState\n{\n\tprivate _crossfadeTransitionNode:CrossfadeTransitionNode;\n\tprivate _animationStateTransitionComplete:AnimationStateEvent;\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:CrossfadeTransitionNode)\n\t{\n\t\tsuper(animator, <SkeletonBinaryLERPNode> skeletonAnimationNode);\n\n\t\tthis._crossfadeTransitionNode = skeletonAnimationNode;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis.blendWeight = Math.abs(time - this._crossfadeTransitionNode.startBlend)/(1000*this._crossfadeTransitionNode.blendSpeed);\n\n\t\tif (this.blendWeight >= 1) {\n\t\t\tthis.blendWeight = 1;\n\n\t\t\tif (this._animationStateTransitionComplete == null)\n\t\t\t\tthis._animationStateTransitionComplete = new AnimationStateEvent(AnimationStateEvent.TRANSITION_COMPLETE, this._pAnimator, this, this._crossfadeTransitionNode);\n\n\t\t\tthis._crossfadeTransitionNode.dispatchEvent(this._animationStateTransitionComplete);\n\t\t}\n\n\t\tsuper._pUpdateTime(time);\n\t}\n}\n\nexport = CrossfadeTransitionState;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport CrossfadeTransitionNode\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode\");\nimport IAnimationTransition\t\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/IAnimationTransition\");\n\n/**\n *\n */\nclass CrossfadeTransition implements IAnimationTransition\n{\n\tpublic blendSpeed:number = 0.5;\n\n\tconstructor(blendSpeed:number)\n\t{\n\t\tthis.blendSpeed = blendSpeed;\n\t}\n\n\tpublic getAnimationNode(animator:AnimatorBase, startNode:AnimationNodeBase, endNode:AnimationNodeBase, startBlend:number /*int*/):AnimationNodeBase\n\t{\n\t\tvar crossFadeTransitionNode:CrossfadeTransitionNode = new CrossfadeTransitionNode();\n\t\tcrossFadeTransitionNode.inputA = startNode;\n\t\tcrossFadeTransitionNode.inputB = endNode;\n\t\tcrossFadeTransitionNode.blendSpeed = this.blendSpeed;\n\t\tcrossFadeTransitionNode.startBlend = startBlend;\n\n\t\treturn <AnimationNodeBase> crossFadeTransitionNode;\n\t}\n}\n\nexport = CrossfadeTransition;",
    "import Geometry\t\t\t\t\t\t\t= require(\"awayjs-core/lib/data/Geometry\");\n\nimport ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\n\n/**\n * @class away.base.ParticleGeometry\n */\nclass ParticleGeometry extends Geometry\n{\n\tpublic particles:Array<ParticleData>;\n\n\tpublic numParticles:number /*uint*/;\n\n}\n\nexport = ParticleGeometry;",
    "import IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport RenderObjectPool\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectPool\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport DepthPass\t\t\t\t\t= require(\"awayjs-renderergl/lib/passes/DepthPass\");\n\n/**\n * DepthRenderObject forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass DepthRenderObject extends RenderObjectBase\n{\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"depth\";\n\n\tconstructor(pool:RenderObjectPool, renderObjectOwner:IRenderObjectOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, renderObjectOwner, renderableClass, stage);\n\n\t\tthis._pAddScreenPass(new DepthPass(this, renderObjectOwner, renderableClass, this._stage));\n\t}\n}\n\nexport = DepthRenderObject;",
    "import IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderObjectPool\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectPool\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport DistancePass\t\t\t\t\t= require(\"awayjs-renderergl/lib/passes/DistancePass\");\n\n/**\n * DistanceRenderObject is a pass that writes distance values to a depth map as a 32-bit value exploded over the 4 texture channels.\n * This is used to render omnidirectional shadow maps.\n */\nclass DistanceRenderObject extends RenderObjectBase\n{\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"distance\";\n\n\t/**\n\t * Creates a new DistanceRenderObject object.\n\t *\n\t * @param material The material to which this pass belongs.\n\t */\n\tconstructor(pool:RenderObjectPool, renderObjectOwner:IRenderObjectOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, renderObjectOwner, renderableClass, stage);\n\n\t\tthis._pAddScreenPass(new DistancePass(this, renderObjectOwner, renderableClass, this._stage));\n\t}\n}\n\nexport = DistanceRenderObject;",
    "import ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\n/**\n * RegisterPool is used by the shader compilation process to keep track of which registers of a certain type are\n * currently used and should not be allowed to be written to. Either entire registers can be requested and locked,\n * or single components (x, y, z, w) of a single register.\n * It is used by ShaderRegisterCache to track usages of individual register types.\n *\n * @see away.materials.ShaderRegisterCache\n */\nclass RegisterPool\n{\n\tprivate static _regPool:Object = new Object();\n\tprivate static _regCompsPool:Object = new Object();\n\n\tprivate _vectorRegisters:Array<ShaderRegisterElement>;\n\tprivate _registerComponents;\n\n\tprivate _regName:string;\n\tprivate _usedSingleCount:Array<Array<number>>;\n\tprivate _usedVectorCount:Array<number> /*uint*/;\n\tprivate _regCount:number;\n\n\tprivate _persistent:boolean;\n\n\t/**\n\t * Creates a new RegisterPool object.\n\t * @param regName The base name of the register type (\"ft\" for fragment temporaries, \"vc\" for vertex constants, etc)\n\t * @param regCount The amount of available registers of this type.\n\t * @param persistent Whether or not registers, once reserved, can be freed again. For example, temporaries are not persistent, but constants are.\n\t */\n\tconstructor(regName:string, regCount:number, persistent:boolean = true)\n\t{\n\t\tthis._regName = regName;\n\t\tthis._regCount = regCount;\n\t\tthis._persistent = persistent;\n\t\tthis.initRegisters(regName, regCount);\n\t}\n\n\t/**\n\t * Retrieve an entire vector register that's still available.\n\t */\n\tpublic requestFreeVectorReg():ShaderRegisterElement\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i) {\n\t\t\tif (!this.isRegisterUsed(i)) {\n\t\t\t\tif (this._persistent)\n\t\t\t\t\tthis._usedVectorCount[i]++;\n\n\t\t\t\treturn this._vectorRegisters[i];\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(\"Register overflow!\");\n\t}\n\n\t/**\n\t * Retrieve a single vector component that's still available.\n\t */\n\tpublic requestFreeRegComponent():ShaderRegisterElement\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i) {\n\t\t\tif (this._usedVectorCount[i] > 0)\n\t\t\t\tcontinue;\n\n\t\t\tfor (var j:number = 0; j < 4; ++j) {\n\t\t\t\tif (this._usedSingleCount[j][i] == 0) {\n\t\t\t\t\tif (this._persistent)\n\t\t\t\t\t\tthis._usedSingleCount[j][i]++;\n\n\t\t\t\t\treturn this._registerComponents[j][i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(\"Register overflow!\");\n\t}\n\n\t/**\n\t * Marks a register as used, so it cannot be retrieved. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addUsage(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tif (register._component > -1)\n\t\t\tthis._usedSingleCount[register._component][register.index] += usageCount;\n\t\telse\n\t\t\tthis._usedVectorCount[register.index] += usageCount;\n\t}\n\n\t/**\n\t * Removes a usage from a register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeUsage(register:ShaderRegisterElement)\n\t{\n\t\tif (register._component > -1) {\n\t\t\tif (--this._usedSingleCount[register._component][register.index] < 0)\n\t\t\t\tthrow new Error(\"More usages removed than exist!\");\n\t\t} else {\n\t\t\tif (--this._usedVectorCount[register.index] < 0)\n\t\t\t\tthrow new Error(\"More usages removed than exist!\");\n\t\t}\n\t}\n\n\t/**\n\t * Disposes any resources used by the current RegisterPool object.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._vectorRegisters = null;\n\t\tthis._registerComponents = null;\n\t\tthis._usedSingleCount = null;\n\t\tthis._usedVectorCount = null;\n\t}\n\n\t/**\n\t * Indicates whether or not any registers are in use.\n\t */\n\tpublic hasRegisteredRegs():boolean\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i)\n\t\t\tif (this.isRegisterUsed(i))\n\t\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Initializes all registers.\n\t */\n\tprivate initRegisters(regName:string, regCount:number)\n\t{\n\t\tvar hash:string = RegisterPool._initPool(regName, regCount);\n\n\t\tthis._vectorRegisters = RegisterPool._regPool[hash];\n\t\tthis._registerComponents = RegisterPool._regCompsPool[hash];\n\n\t\tthis._usedVectorCount = this._initArray(Array<number>(regCount), 0);\n\n\t\tthis._usedSingleCount = new Array<Array<number>>(4);\n\t\tthis._usedSingleCount[0] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[1] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[2] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[3] = this._initArray(new Array<number>(regCount), 0);\n\t}\n\n\tprivate static _initPool(regName:string, regCount:number):string\n\t{\n\t\tvar hash:string = regName + regCount;\n\n\t\tif (RegisterPool._regPool[hash] != undefined)\n\t\t\treturn hash;\n\n\t\tvar vectorRegisters:Array<ShaderRegisterElement> = new Array<ShaderRegisterElement>(regCount);\n\t\tRegisterPool._regPool[hash] = vectorRegisters;\n\n\t\tvar registerComponents = [\n\t\t\t[],\n\t\t\t[],\n\t\t\t[],\n\t\t\t[]\n\t\t];\n\t\tRegisterPool._regCompsPool[hash] = registerComponents;\n\n\t\tfor (var i:number = 0; i < regCount; ++i) {\n\n\t\t\tvectorRegisters[i] = new ShaderRegisterElement(regName, i);\n\n\t\t\tfor (var j:number = 0; j < 4; ++j)\n\t\t\t\tregisterComponents[j][i] = new ShaderRegisterElement(regName, i, j);\n\t\t}\n\n\t\treturn hash;\n\t}\n\n\n\t/**\n\t * Check if the temp register is either used for single or vector use\n\t */\n\tprivate isRegisterUsed(index:number):boolean\n\t{\n\t\tif (this._usedVectorCount[index] > 0)\n\t\t\treturn true;\n\n\t\tfor (var i:number = 0; i < 4; ++i)\n\t\t\tif (this._usedSingleCount[i][index] > 0)\n\t\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\n\tprivate _initArray(a:Array<any>, val:any):Array<any>\n\t{\n\t\tvar l:number = a.length;\n\n\t\tfor (var c:number = 0; c < l; c++)\n\t\t\ta[c] = val;\n\n\t\treturn a;\n\t}\n}\n\nexport = RegisterPool;\n",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport RenderObjectPool\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectPool\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport BasicMaterialPass\t\t\t= require(\"awayjs-renderergl/lib/passes/BasicMaterialPass\");\n\n/**\n * RenderMaterialObject forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass RenderBasicMaterialObject extends RenderObjectBase\n{\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"basic\";\n\n\tprivate _material:BasicMaterial;\n\tprivate _screenPass:BasicMaterialPass;\n\n\n\tconstructor(pool:RenderObjectPool, material:BasicMaterial, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, material, renderableClass, stage);\n\n\t\tthis._material = material;\n\n\t\tthis._pAddScreenPass(this._screenPass = new BasicMaterialPass(this, material, renderableClass, this._stage));\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateRenderObject()\n\t{\n\t\tsuper._pUpdateRenderObject();\n\n\t\tthis._pRequiresBlending = (this._material.blendMode != BlendMode.NORMAL || this._material.alphaBlending || (this._material.colorTransform && this._material.colorTransform.alphaMultiplier < 1));\n\t\tthis._screenPass.preserveAlpha = this._material.preserveAlpha;//this._pRequiresBlending;\n\t\tthis._screenPass.setBlendMode((this._renderObjectOwner.blendMode == BlendMode.NORMAL && this._pRequiresBlending)? BlendMode.LAYER : this._material.blendMode);\n\t\t//this._screenPass.forceSeparateMVP = false;\n\t}\n}\n\nexport = RenderBasicMaterialObject;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport IRenderObject\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderObject\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport RenderObjectPool\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectPool\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\n\n/**\n *\n * @class away.pool.ScreenPasses\n */\nclass RenderObjectBase implements IRenderObject\n{\n\tpublic _forceSeparateMVP:boolean = false;\n\n\tprivate _pool:RenderObjectPool;\n\tpublic _renderObjectOwner:IRenderObjectOwner;\n\tpublic _renderableClass:IRenderableClass;\n\tpublic _stage:Stage;\n\n\tprivate _renderOrderId:number;\n\tprivate _invalidAnimation:boolean = true;\n\tprivate _invalidRenderObject:boolean = true;\n\tprivate _passes:Array<RenderPassBase> = new Array<RenderPassBase>();\n\n\n\n\tpublic _pRequiresBlending:boolean = false;\n\n\tprivate _onPassChangeDelegate:(event:Event) => void;\n\n\tpublic renderObjectId:number;\n\n\t/**\n\t * Indicates whether or not the renderable requires alpha blending during rendering.\n\t */\n\tpublic get requiresBlending():boolean\n\t{\n\t\treturn this._pRequiresBlending;\n\t}\n\n\tpublic get renderOrderId():number\n\t{\n\t\tif (this._invalidAnimation)\n\t\t\tthis._updateAnimation();\n\n\t\treturn this._renderOrderId;\n\t}\n\n\tpublic get passes():Array<RenderPassBase>\n\t{\n\t\tif (this._invalidAnimation)\n\t\t\tthis._updateAnimation();\n\n\t\treturn this._passes;\n\t}\n\n\tconstructor(pool:RenderObjectPool, renderObjectOwner:IRenderObjectOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tthis._pool = pool;\n\t\tthis.renderObjectId = renderObjectOwner.id;\n\t\tthis._renderObjectOwner = renderObjectOwner;\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\n\n\t\tthis._onPassChangeDelegate = (event:Event) => this.onPassChange(event);\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tthis._renderableClass._iIncludeDependencies(shaderObject);\n\n\t\tshaderObject.alphaThreshold = this._renderObjectOwner.alphaThreshold;\n\t\tshaderObject.useMipmapping = this._renderObjectOwner.mipmap;\n\t\tshaderObject.useSmoothTextures = this._renderObjectOwner.smooth;\n\n\t\tif (this._renderObjectOwner.isAsset(MaterialBase)) {\n\t\t\tvar material:MaterialBase = <MaterialBase> this._renderObjectOwner;\n\t\t\tshaderObject.useAlphaPremultiplied = material.alphaPremultiplied;\n\t\t\tshaderObject.useBothSides = material.bothSides;\n\t\t\tshaderObject.repeatTextures = material.repeat;\n\t\t\tshaderObject.usesUVTransform = material.animateUVs;\n\t\t\tif (material.texture)\n\t\t\t\tshaderObject.texture = shaderObject.getTextureObject(material.texture);\n\t\t\tshaderObject.color = material.color;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pClearScreenPasses();\n\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._passes[i].dispose();\n\n\t\tthis._passes = null;\n\n\t\tthis._pool.disposeItem(this._renderObjectOwner);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateRenderObject()\n\t{\n\t\tthis._invalidRenderObject = true;\n\t\tthis._invalidAnimation = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidatePasses()\n\t{\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._passes[i].invalidatePass();\n\n\t\tthis._invalidAnimation = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateAnimation()\n\t{\n\t\tthis._invalidAnimation = true;\n\t}\n\n\t/**\n\t *\n\t * @param renderObjectOwner\n\t */\n\tprivate _updateAnimation()\n\t{\n\t\tif (this._invalidRenderObject)\n\t\t\tthis._pUpdateRenderObject();\n\n\t\tthis._invalidAnimation = false;\n\n\t\tvar enabledGPUAnimation:boolean = this._getEnabledGPUAnimation();\n\n\t\tvar renderOrderId = 0;\n\t\tvar mult:number = 1;\n\t\tvar shaderObject:ShaderObjectBase;\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tshaderObject = this._passes[i].shader;\n\n\t\t\tif (shaderObject.usesAnimation != enabledGPUAnimation) {\n\t\t\t\tshaderObject.usesAnimation = enabledGPUAnimation;\n\t\t\t\tshaderObject.invalidateProgram();\n\t\t\t}\n\n\t\t\trenderOrderId += shaderObject.programData.id*mult;\n\t\t\tmult *= 1000;\n\t\t}\n\n\t\tthis._renderOrderId = renderOrderId;\n\t}\n\n\t/**\n\t * Performs any processing that needs to occur before any of its passes are used.\n\t *\n\t * @private\n\t */\n\tpublic _pUpdateRenderObject()\n\t{\n\t\tthis._invalidRenderObject = false;\n\n\t\t//overrride to update shader object properties\n\t}\n\n\t/**\n\t * Removes a pass from the renderObjectOwner.\n\t * @param pass The pass to be removed.\n\t */\n\tpublic _pRemoveScreenPass(pass:RenderPassBase)\n\t{\n\t\tpass.removeEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\t\tthis._passes.splice(this._passes.indexOf(pass), 1);\n\t}\n\n\t/**\n\t * Removes all passes from the renderObjectOwner\n\t */\n\tpublic _pClearScreenPasses()\n\t{\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._passes[i].removeEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\n\t\tthis._passes.length = 0;\n\t}\n\n\t/**\n\t * Adds a pass to the renderObjectOwner\n\t * @param pass\n\t */\n\tpublic _pAddScreenPass(pass:RenderPassBase)\n\t{\n\t\tthis._passes.push(pass);\n\t\tpass.addEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\t}\n\n\t/**\n\t * Listener for when a pass's shader code changes. It recalculates the render order id.\n\t */\n\tprivate onPassChange(event:Event)\n\t{\n\t\tthis.invalidateAnimation();\n\t}\n\n\n\t/**\n\t * test if animation will be able to run on gpu BEFORE compiling materials\n\t * test if the shader objects supports animating the animation set in the vertex shader\n\t * if any object using this material fails to support accelerated animations for any of the shader objects,\n\t * we should do everything on cpu (otherwise we have the cost of both gpu + cpu animations)\n\t */\n\tprivate _getEnabledGPUAnimation():boolean\n\t{\n\t\tif (this._renderObjectOwner.animationSet) {\n\t\t\tthis._renderObjectOwner.animationSet.resetGPUCompatibility();\n\n\t\t\tvar owners:Array<IRenderableOwner> = this._renderObjectOwner.iOwners;\n\t\t\tvar numOwners:number = owners.length;\n\n\t\t\tvar len:number = this._passes.length;\n\t\t\tfor (var i:number = 0; i < len; i++)\n\t\t\t\tfor (var j:number = 0; j < numOwners; j++)\n\t\t\t\t\tif (owners[j].animator)\n\t\t\t\t\t\t(<AnimatorBase> owners[j].animator).testGPUCompatibility(this._passes[i].shader);\n\n\t\t\treturn !this._renderObjectOwner.animationSet.usesCPU;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\nexport = RenderObjectBase;",
    "import IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderObjectClass\t\t\t= require(\"awayjs-renderergl/lib/compilation/IRenderObjectClass\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * @class away.pool.RenderObjectPool\n */\nclass RenderObjectPool\n{\n\tprivate _renderObjectPool:Object = new Object();\n\tprivate _renderObjectClass:IRenderObjectClass;\n\tprivate _renderableClass:IRenderableClass;\n\tprivate _stage:Stage;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderObjectClass\n\t */\n\tconstructor(renderObjectClass:IRenderObjectClass, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tthis._renderObjectClass = renderObjectClass;\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t * @returns IRenderable\n\t */\n\tpublic getItem(renderObjectOwner:IRenderObjectOwner):RenderObjectBase\n\t{\n\t\treturn (this._renderObjectPool[renderObjectOwner.id] || (this._renderObjectPool[renderObjectOwner.id] = renderObjectOwner._iAddRenderObject(new this._renderObjectClass(this, renderObjectOwner, this._renderableClass, this._stage))))\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t */\n\tpublic disposeItem(renderObjectOwner:IRenderObjectOwner)\n\t{\n\t\trenderObjectOwner._iRemoveRenderObject(this._renderObjectPool[renderObjectOwner.id]);\n\n\t\tthis._renderObjectPool[renderObjectOwner.id] = null;\n\t}\n}\n\nexport = RenderObjectPool;",
    "import RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport IRenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/IRenderPassBase\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\n\n/**\n * ShaderCompilerBase is an abstract base class for shader compilers that use modular shader methods to assemble a\n * material. Concrete subclasses are used by the default materials.\n *\n * @see away.materials.ShadingMethodBase\n */\nclass ShaderCompilerBase\n{\n\tpublic _pShaderObject:ShaderObjectBase;\n\tpublic _pSharedRegisters:ShaderRegisterData;\n\tpublic _pRegisterCache:ShaderRegisterCache;\n\tpublic _pRenderableClass:IRenderableClass;\n\tpublic _pRenderPass:IRenderPassBase;\n\n\tpublic _pVertexCode:string = ''; // Changed to emtpy string- AwayTS\n\tpublic _pFragmentCode:string = '';// Changed to emtpy string - AwayTS\n\tpublic _pPostAnimationFragmentCode:string = '';// Changed to emtpy string - AwayTS\n\n\t//The attributes that need to be animated by animators.\n\tpublic _pAnimatableAttributes:Array<string>;\n\n\t//The target registers for animated properties, written to by the animators.\n\tpublic _pAnimationTargetRegisters:Array<string>;\n\n\t//The target register to place the animated UV coordinate.\n\tprivate _uvTarget:string;\n\n\t//The souce register providing the UV coordinate to animate.\n\tprivate _uvSource:string;\n\n\t/**\n\t * Creates a new ShaderCompilerBase object.\n\t * @param profile The compatibility profile of the renderer.\n\t */\n\tconstructor(renderableClass:IRenderableClass, renderPass:IRenderPassBase, shaderObject:ShaderObjectBase)\n\t{\n\t\tthis._pRenderableClass = renderableClass;\n\t\tthis._pRenderPass = renderPass;\n\t\tthis._pShaderObject = shaderObject;\n\n\t\tthis._pSharedRegisters = new ShaderRegisterData();\n\n\t\tthis._pRegisterCache = new ShaderRegisterCache(shaderObject.profile);\n\t\tthis._pRegisterCache.vertexAttributesOffset = renderableClass.vertexAttributesOffset;\n\t\tthis._pRegisterCache.reset();\n\t}\n\n\t/**\n\t * Compiles the code after all setup on the compiler has finished.\n\t */\n\tpublic compile()\n\t{\n\t\tthis._pShaderObject.reset();\n\n\t\tthis.pIncludeDependencies();\n\n\t\tthis.pInitRegisterIndices();\n\n\t\tthis.pCompileDependencies();\n\n\t\t//compile custom vertex & fragment codes\n\t\tthis._pVertexCode += this._pRenderPass._iGetVertexCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pPostAnimationFragmentCode += this._pRenderPass._iGetFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t//assign the final output color to the output register\n\t\tthis._pPostAnimationFragmentCode += \"mov \" + this._pRegisterCache.fragmentOutputRegister + \", \" + this._pSharedRegisters.shadedTarget + \"\\n\";\n\t\tthis._pRegisterCache.removeFragmentTempUsage(this._pSharedRegisters.shadedTarget);\n\n\t\t//initialise the required shader constants\n\t\tthis._pShaderObject.initConstantData(this._pRegisterCache, this._pAnimatableAttributes, this._pAnimationTargetRegisters, this._uvSource, this._uvTarget);\n\t\tthis._pRenderPass._iInitConstantData(this._pShaderObject);\n\t}\n\n\tpublic pIncludeDependencies()\n\t{\n\t\tthis._pShaderObject._iIncludeDependencies();\n\n\t\tthis._pShaderObject.outputsNormals = this._pRenderPass._pOutputsNormals(this._pShaderObject);\n\t\tthis._pShaderObject.outputsTangentNormals = this._pShaderObject.outputsNormals && this._pRenderPass._pOutputsTangentNormals(this._pShaderObject);\n\t\tthis._pShaderObject.usesTangentSpace = this._pShaderObject.outputsTangentNormals && this._pRenderPass._pUsesTangentSpace(this._pShaderObject);\n\n\t\tif (!this._pShaderObject.usesTangentSpace && this._pShaderObject.viewDirDependencies > 0)\n\t\t\tthis._pShaderObject.globalPosDependencies++;\n\t}\n\n\t/**\n\t * Compile the code for the methods.\n\t */\n\tpublic pCompileDependencies()\n\t{\n\t\tthis._pSharedRegisters.shadedTarget = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadedTarget, 1);\n\n\t\t//compile the world-space position if required\n\t\tif (this._pShaderObject.globalPosDependencies > 0)\n\t\t\tthis.compileGlobalPositionCode();\n\n        //compile the local-space position if required\n        if (this._pShaderObject.usesLocalPosFragment)\n            this.compileLocalPositionCode();\n\n\t\t//Calculate the (possibly animated) UV coordinates.\n\t\tif (this._pShaderObject.uvDependencies > 0)\n\t\t\tthis.compileUVCode();\n\n\t\tif (this._pShaderObject.secondaryUVDependencies > 0)\n\t\t\tthis.compileSecondaryUVCode();\n\n\t\tif (this._pShaderObject.normalDependencies > 0)\n\t\t\tthis.compileNormalCode();\n\n\t\tif (this._pShaderObject.viewDirDependencies > 0)\n\t\t\tthis.compileViewDirCode();\n\n\t\t//collect code from material\n\t\tthis._pVertexCode += this._pRenderableClass._iGetVertexCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._pRenderableClass._iGetFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t//collect code from pass\n\t\tthis._pVertexCode += this._pRenderPass._iGetPreLightingVertexCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._pRenderPass._iGetPreLightingFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t}\n\n\tprivate compileGlobalPositionCode()\n\t{\n\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.globalPositionVertex = this._pRegisterCache.getFreeVertexVectorTemp(), this._pShaderObject.globalPosDependencies);\n\n\t\tvar sceneMatrixReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\n\t\tthis._pShaderObject.sceneMatrixIndex = sceneMatrixReg.index*4;\n\n\t\tthis._pVertexCode += \"m44 \" + this._pSharedRegisters.globalPositionVertex + \", \" + this._pSharedRegisters.localPosition + \", \" + sceneMatrixReg + \"\\n\";\n\n\t\tif (this._pShaderObject.usesGlobalPosFragment) {\n\t\t\tthis._pSharedRegisters.globalPositionVarying = this._pRegisterCache.getFreeVarying();\n\t\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.globalPositionVarying + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t}\n\t}\n    private compileLocalPositionCode()\n    {\n        this._pSharedRegisters.localPositionVarying = this._pRegisterCache.getFreeVarying();\n        this._pVertexCode += \"mov \" + this._pSharedRegisters.localPositionVarying + \", \" + this._pSharedRegisters.localPosition + \"\\n\";\n    }\n\t/**\n\t * Calculate the (possibly animated) UV coordinates.\n\t */\n\tprivate compileUVCode()\n\t{\n\t\tvar uvAttributeReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexAttribute();\n\t\tthis._pShaderObject.uvBufferIndex = uvAttributeReg.index;\n\n\t\tvar varying:ShaderRegisterElement = this._pSharedRegisters.uvVarying = this._pRegisterCache.getFreeVarying();\n\n\t\tif (this._pShaderObject.usesUVTransform) {\n\t\t\t// a, b, 0, tx\n\t\t\t// c, d, 0, ty\n\t\t\tvar uvTransform1:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tvar uvTransform2:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tthis._pShaderObject.uvTransformIndex = uvTransform1.index*4;\n\n\t\t\tthis._pVertexCode += \"dp4 \" + varying + \".x, \" + uvAttributeReg + \", \" + uvTransform1 + \"\\n\" +\n\t\t\t\t\t\t\t\t \"dp4 \" + varying + \".y, \" + uvAttributeReg + \", \" + uvTransform2 + \"\\n\" +\n\t\t\t\t\t\t\t\t \"mov \" + varying + \".zw, \" + uvAttributeReg + \".zw \\n\";\n\t\t} else {\n\t\t\tthis._pShaderObject.uvTransformIndex = -1;\n\t\t\tthis._uvTarget = varying.toString();\n\t\t\tthis._uvSource = uvAttributeReg.toString();\n\t\t}\n\t}\n\n\t/**\n\t * Provide the secondary UV coordinates.\n\t */\n\tprivate compileSecondaryUVCode()\n\t{\n\t\tvar uvAttributeReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexAttribute();\n\t\tthis._pShaderObject.secondaryUVBufferIndex = uvAttributeReg.index;\n\t\tthis._pSharedRegisters.secondaryUVVarying = this._pRegisterCache.getFreeVarying();\n\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.secondaryUVVarying + \", \" + uvAttributeReg + \"\\n\";\n\t}\n\n\t/**\n\t * Calculate the view direction.\n\t */\n\tpublic compileViewDirCode()\n\t{\n\t\tvar cameraPositionReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pSharedRegisters.viewDirVarying = this._pRegisterCache.getFreeVarying();\n\t\tthis._pSharedRegisters.viewDirFragment = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.viewDirFragment, this._pShaderObject.viewDirDependencies);\n\n\t\tthis._pShaderObject.cameraPositionIndex = cameraPositionReg.index*4;\n\n\t\tif (this._pShaderObject.usesTangentSpace) {\n\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pVertexCode += \"sub \" + temp + \", \" + cameraPositionReg + \", \" + this._pSharedRegisters.localPosition + \"\\n\" +\n\t\t\t\t\"m33 \" + this._pSharedRegisters.viewDirVarying + \".xyz, \" + temp + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.viewDirVarying + \".w, \" + this._pSharedRegisters.localPosition + \".w\\n\";\n\t\t} else {\n\t\t\tthis._pVertexCode += \"sub \" + this._pSharedRegisters.viewDirVarying + \", \" + cameraPositionReg + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.globalPositionVertex);\n\t\t}\n\n\t\t//TODO is this required in all cases? (re: distancemappass)\n\t\tthis._pFragmentCode += \"nrm \" + this._pSharedRegisters.viewDirFragment + \".xyz, \" + this._pSharedRegisters.viewDirVarying + \"\\n\" +\n\t\t\t\"mov \" + this._pSharedRegisters.viewDirFragment + \".w,   \" + this._pSharedRegisters.viewDirVarying + \".w\\n\";\n\t}\n\n\t/**\n\t * Calculate the normal.\n\t */\n\tpublic compileNormalCode()\n\t{\n\t\tthis._pSharedRegisters.normalFragment = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.normalFragment, this._pShaderObject.normalDependencies);\n\n\t\t//simple normal aquisition if no tangent space is being used\n\t\tif (this._pShaderObject.outputsNormals && !this._pShaderObject.outputsTangentNormals) {\n\t\t\tthis._pVertexCode += this._pRenderPass._iGetNormalVertexCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\t\tthis._pFragmentCode += this._pRenderPass._iGetNormalFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar normalMatrix:Array<ShaderRegisterElement>;\n\n\t\tif (!this._pShaderObject.outputsNormals || !this._pShaderObject.usesTangentSpace) {\n\t\t\tnormalMatrix = new Array<ShaderRegisterElement>(3);\n\t\t\tnormalMatrix[0] = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tnormalMatrix[1] = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tnormalMatrix[2] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\tthis._pRegisterCache.getFreeVertexConstant();\n\n\t\t\tthis._pShaderObject.sceneNormalMatrixIndex = normalMatrix[0].index*4;\n\n\t\t\tthis._pSharedRegisters.normalVarying = this._pRegisterCache.getFreeVarying();\n\t\t}\n\n\t\tif (this._pShaderObject.outputsNormals) {\n\t\t\tif (this._pShaderObject.usesTangentSpace) {\n\t\t\t\t// normalize normal + tangent vector and generate (approximated) bitangent used in m33 operation for view\n\t\t\t\tthis._pVertexCode += \"nrm \" + this._pSharedRegisters.animatedNormal + \".xyz, \" + this._pSharedRegisters.animatedNormal + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedTangent + \".xyz, \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"crs \" + this._pSharedRegisters.bitangent + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\";\n\n\t\t\t\tthis._pFragmentCode += this._pRenderPass._iGetNormalFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t} else {\n\t\t\t\t//Compiles the vertex shader code for tangent-space normal maps.\n\t\t\t\tthis._pSharedRegisters.tangentVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tthis._pSharedRegisters.bitangentVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + temp + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedNormal + \".xyz, \" + temp + \"\\n\" +\n\t\t\t\t\t\"m33 \" + temp + \".xyz, \" + this._pSharedRegisters.animatedTangent + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedTangent + \".xyz, \" + temp + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".x  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".x  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".z  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".z  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"crs \" + temp + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".y, \" + temp + \".x    \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".y, \" + temp + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".y, \" + temp + \".z    \\n\";\n\n\t\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedTangent);\n\n\t\t\t\t//Compiles the fragment shader code for tangent-space normal maps.\n\t\t\t\tvar t:ShaderRegisterElement;\n\t\t\t\tvar b:ShaderRegisterElement;\n\t\t\t\tvar n:ShaderRegisterElement;\n\n\t\t\t\tt = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(t, 1);\n\t\t\t\tb = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(b, 1);\n\t\t\t\tn = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(n, 1);\n\n\t\t\t\tthis._pFragmentCode += \"nrm \" + t + \".xyz, \" + this._pSharedRegisters.tangentVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + t + \".w, \" + this._pSharedRegisters.tangentVarying + \".w\t\\n\" +\n\t\t\t\t\t\"nrm \" + b + \".xyz, \" + this._pSharedRegisters.bitangentVarying + \"\\n\" +\n\t\t\t\t\t\"nrm \" + n + \".xyz, \" + this._pSharedRegisters.normalVarying + \"\\n\";\n\n\t\t\t\t//compile custom fragment code for normal calcs\n\t\t\t\tthis._pFragmentCode += this._pRenderPass._iGetNormalFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters) +\n\t\t\t\t\t\"m33 \" + this._pSharedRegisters.normalFragment + \".xyz, \" + this._pSharedRegisters.normalFragment + \", \" + t + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalFragment + \".w, \" + this._pSharedRegisters.normalVarying + \".w\\n\";\n\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(b);\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(t);\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(n);\n\t\t\t}\n\t\t} else {\n\t\t\t// no output, world space is enough\n\t\t\tthis._pVertexCode += \"m33 \" + this._pSharedRegisters.normalVarying + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".w, \" + this._pSharedRegisters.animatedNormal + \".w\\n\";\n\n\t\t\tthis._pFragmentCode += \"nrm \" + this._pSharedRegisters.normalFragment + \".xyz, \" + this._pSharedRegisters.normalVarying + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.normalFragment + \".w, \" + this._pSharedRegisters.normalVarying + \".w\\n\";\n\n\t\t\tif (this._pShaderObject.tangentDependencies > 0) {\n\t\t\t\tthis._pSharedRegisters.tangentVarying = this._pRegisterCache.getFreeVarying();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + this._pSharedRegisters.tangentVarying + \".xyz, \" + this._pSharedRegisters.animatedTangent + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".w, \" + this._pSharedRegisters.animatedTangent + \".w\\n\";\n\t\t\t}\n\t\t}\n\n\t\tif (!this._pShaderObject.usesTangentSpace)\n\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedNormal);\n\t}\n\n\t/**\n\t * Reset all the indices to \"unused\".\n\t */\n\tpublic pInitRegisterIndices()\n\t{\n\t\tthis._pShaderObject.pInitRegisterIndices();\n\n\t\tthis._pAnimatableAttributes = new Array<string>(\"va0\");\n\t\tthis._pAnimationTargetRegisters = new Array<string>(\"vt0\");\n\t\tthis._pVertexCode = \"\";\n\t\tthis._pFragmentCode = \"\";\n\t\tthis._pPostAnimationFragmentCode = \"\";\n\n\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.localPosition = this._pRegisterCache.getFreeVertexVectorTemp(), 1);\n\n\t\t//create commonly shared constant registers\n\t\tthis._pSharedRegisters.commons = this._pRegisterCache.getFreeFragmentConstant();\n\t\tthis._pShaderObject.commonsDataIndex = this._pSharedRegisters.commons.index*4;\n\n\t\t//Creates the registers to contain the tangent data.\n\t\t// need to be created FIRST and in this order (for when using tangent space)\n\t\tif (this._pShaderObject.tangentDependencies > 0 || this._pShaderObject.outputsNormals) {\n\t\t\tthis._pSharedRegisters.tangentInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShaderObject.tangentBufferIndex = this._pSharedRegisters.tangentInput.index;\n\n\t\t\tthis._pSharedRegisters.animatedTangent = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedTangent, 1);\n\n\t\t\tif (this._pShaderObject.usesTangentSpace) {\n\t\t\t\tthis._pSharedRegisters.bitangent = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.bitangent, 1);\n\t\t\t}\n\n\t\t\tthis._pAnimatableAttributes.push(this._pSharedRegisters.tangentInput.toString());\n\t\t\tthis._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedTangent.toString());\n\t\t}\n\n\t\tif (this._pShaderObject.normalDependencies > 0) {\n\t\t\tthis._pSharedRegisters.normalInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShaderObject.normalBufferIndex = this._pSharedRegisters.normalInput.index;\n\n\t\t\tthis._pSharedRegisters.animatedNormal = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedNormal, 1);\n\n\t\t\tthis._pAnimatableAttributes.push(this._pSharedRegisters.normalInput.toString());\n\t\t\tthis._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedNormal.toString());\n\t\t}\n\n\t\tif (this._pShaderObject.colorDependencies > 0) {\n\t\t\tthis._pSharedRegisters.colorInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShaderObject.colorBufferIndex = this._pSharedRegisters.colorInput.index;\n\n\t\t\tthis._pSharedRegisters.colorVarying = this._pRegisterCache.getFreeVarying();\n\t\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.colorVarying + \", \" + this._pSharedRegisters.colorInput + \"\\n\";\n\t\t}\n\t}\n\n\t/**\n\t * Disposes all resources used by the compiler.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pRegisterCache.dispose();\n\t\tthis._pRegisterCache = null;\n\t\tthis._pSharedRegisters = null;\n\t}\n\n\t/**\n\t * The generated vertex code.\n\t */\n\tpublic get vertexCode():string\n\t{\n\t\treturn this._pVertexCode;\n\t}\n\n\t/**\n\t * The generated fragment code.\n\t */\n\tpublic get fragmentCode():string\n\t{\n\t\treturn this._pFragmentCode;\n\t}\n\n\t/**\n\t * The generated fragment code.\n\t */\n\tpublic get postAnimationFragmentCode():string\n\t{\n\t\treturn this._pPostAnimationFragmentCode;\n\t}\n\n\t/**\n\t * The register name containing the final shaded colour.\n\t */\n\tpublic get shadedTarget():string\n\t{\n\t\treturn this._pSharedRegisters.shadedTarget.toString();\n\t}\n}\n\nexport = ShaderCompilerBase;",
    "import ContextGLProfile\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProfile\");\n\nimport ShaderLightingObject\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderLightingObject\");\nimport ShaderCompilerBase\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderCompilerBase\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport IRenderLightingPass\t\t= require(\"awayjs-renderergl/lib/passes/IRenderLightingPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\n\n/**\n * ShaderCompilerBase is an abstract base class for shader compilers that use modular shader methods to assemble a\n * material. Concrete subclasses are used by the default materials.\n *\n * @see away.materials.ShadingMethodBase\n */\nclass ShaderLightingCompiler extends ShaderCompilerBase\n{\n\tprivate _shaderLightingObject:ShaderLightingObject;\n\tprivate _renderLightingPass:IRenderLightingPass;\n\tpublic _pointLightFragmentConstants:Array<ShaderRegisterElement>;\n\tpublic _pointLightVertexConstants:Array<ShaderRegisterElement>;\n\tpublic _dirLightFragmentConstants:Array<ShaderRegisterElement>;\n\tpublic _dirLightVertexConstants:Array<ShaderRegisterElement>;\n\n\tpublic _pNumProbeRegisters:number;\n\n\t/**\n\t * Creates a new ShaderCompilerBase object.\n\t * @param profile The compatibility profile of the renderer.\n\t */\n\tconstructor(renderableClass:IRenderableClass, renderLightingPass:IRenderLightingPass, shaderLightingObject:ShaderLightingObject)\n\t{\n\t\tsuper(renderableClass, renderLightingPass, shaderLightingObject);\n\n\t\tthis._shaderLightingObject = shaderLightingObject;\n\t\tthis._renderLightingPass = renderLightingPass;\n\t}\n\n\t/**\n\t * Compile the code for the methods.\n\t */\n\tpublic pCompileDependencies()\n\t{\n\t\tsuper.pCompileDependencies();\n\n\t\t//compile the lighting code\n\t\tif (this._shaderLightingObject.usesShadows)\n\t\t\tthis.pCompileShadowCode();\n\n\t\tif (this._shaderLightingObject.usesLights) {\n\t\t\tthis.initLightRegisters();\n\t\t\tthis.compileLightCode();\n\t\t}\n\n\t\tif (this._shaderLightingObject.usesProbes)\n\t\t\tthis.compileLightProbeCode();\n\n\t\tthis._pVertexCode += this._renderLightingPass._iGetPostLightingVertexCode(this._shaderLightingObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._renderLightingPass._iGetPostLightingFragmentCode(this._shaderLightingObject, this._pRegisterCache, this._pSharedRegisters);\n\t}\n\n\t/**\n\t * Provides the code to provide shadow mapping.\n\t */\n\tpublic pCompileShadowCode()\n\t{\n\t\tif (this._shaderLightingObject.normalDependencies > 0) {\n\t\t\tthis._pSharedRegisters.shadowTarget = this._pSharedRegisters.normalFragment;\n\t\t} else {\n\t\t\tthis._pSharedRegisters.shadowTarget = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadowTarget, 1);\n\t\t}\n\t}\n\n\t/**\n\t * Initializes constant registers to contain light data.\n\t */\n\tprivate initLightRegisters()\n\t{\n\t\t// init these first so we're sure they're in sequence\n\t\tvar i:number, len:number;\n\n\t\tif (this._dirLightVertexConstants) {\n\t\t\tlen = this._dirLightVertexConstants.length;\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tthis._dirLightVertexConstants[i] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tif (this._shaderLightingObject.lightVertexConstantIndex == -1)\n\t\t\t\t\tthis._shaderLightingObject.lightVertexConstantIndex = this._dirLightVertexConstants[i].index*4;\n\t\t\t}\n\t\t}\n\n\t\tif (this._pointLightVertexConstants) {\n\t\t\tlen = this._pointLightVertexConstants.length;\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tthis._pointLightVertexConstants[i] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tif (this._shaderLightingObject.lightVertexConstantIndex == -1)\n\t\t\t\t\tthis._shaderLightingObject.lightVertexConstantIndex = this._pointLightVertexConstants[i].index*4;\n\t\t\t}\n\t\t}\n\n\t\tlen = this._dirLightFragmentConstants.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._dirLightFragmentConstants[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = this._dirLightFragmentConstants[i].index*4;\n\t\t}\n\n\t\tlen = this._pointLightFragmentConstants.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._pointLightFragmentConstants[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = this._pointLightFragmentConstants[i].index*4;\n\t\t}\n\t}\n\n\t/**\n\t * Compiles the shading code for directional and point lights.\n\t */\n\tprivate compileLightCode()\n\t{\n\t\tvar diffuseColorReg:ShaderRegisterElement;\n\t\tvar specularColorReg:ShaderRegisterElement;\n\t\tvar lightPosReg:ShaderRegisterElement;\n\t\tvar lightDirReg:ShaderRegisterElement;\n\t\tvar vertexRegIndex:number = 0;\n\t\tvar fragmentRegIndex:number = 0;\n\t\tvar addSpec:boolean = this._shaderLightingObject.usesLightsForSpecular;\n\t\tvar addDiff:boolean = this._shaderLightingObject.usesLightsForDiffuse;\n\n\t\t//compile the shading code for directional lights.\n\t\tfor (var i:number = 0; i < this._shaderLightingObject.numDirectionalLights; ++i) {\n\t\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\t\tlightDirReg = this._dirLightVertexConstants[vertexRegIndex++];\n\n\t\t\t\tvar lightVarying:ShaderRegisterElement = this._pRegisterCache.getFreeVarying();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + lightVarying + \".xyz, \" + lightDirReg + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightVarying + \".w, \" + lightDirReg + \".w\\n\";\n\n\t\t\t\tlightDirReg = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addVertexTempUsages(lightDirReg, 1);\n\n\t\t\t\tthis._pFragmentCode += \"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightDirReg + \".w, \" + lightVarying + \".w\\n\";\n\n\t\t\t} else {\n\t\t\t\tlightDirReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\t\t\t}\n\n\t\t\tdiffuseColorReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\t\t\tspecularColorReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._pFragmentCode += this._renderLightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject, lightDirReg, diffuseColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._pFragmentCode += this._renderLightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject, lightDirReg, specularColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace)\n\t\t\t\tthis._pRegisterCache.removeVertexTempUsage(lightDirReg);\n\t\t}\n\n\t\tvertexRegIndex = 0;\n\t\tfragmentRegIndex = 0;\n\n\t\t//compile the shading code for point lights\n\t\tfor (var i:number = 0; i < this._shaderLightingObject.numPointLights; ++i) {\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace || !this._shaderLightingObject.usesGlobalPosFragment)\n\t\t\t\tlightPosReg = this._pointLightVertexConstants[vertexRegIndex++];\n\t\t\telse\n\t\t\t\tlightPosReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tdiffuseColorReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\t\t\tspecularColorReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tlightDirReg = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\tthis._pRegisterCache.addFragmentTempUsages(lightDirReg, 1);\n\n\t\t\tvar lightVarying:ShaderRegisterElement;\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\t\tlightVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tthis._pVertexCode += \"sub \" + temp + \", \" + lightPosReg + \", \" + this._pSharedRegisters.localPosition + \"\\n\" +\n\t\t\t\t\t\"m33 \" + lightVarying + \".xyz, \" + temp + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightVarying + \".w, \" + this._pSharedRegisters.localPosition + \".w\\n\";\n\t\t\t} else if (!this._shaderLightingObject.usesGlobalPosFragment) {\n\t\t\t\tlightVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tthis._pVertexCode += \"sub \" + lightVarying + \", \" + lightPosReg + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t\t} else {\n\t\t\t\tlightVarying = lightDirReg;\n\t\t\t\tthis._pFragmentCode += \"sub \" + lightDirReg + \", \" + lightPosReg + \", \" + this._pSharedRegisters.globalPositionVarying + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._shaderLightingObject.usesLightFallOff) {\n\t\t\t\t// calculate attenuation\n\t\t\t\tthis._pFragmentCode += // attenuate\n\t\t\t\t\t\"dp3 \" + lightDirReg + \".w, \" + lightVarying + \", \" + lightVarying + \"\\n\" + // w = d - radius\n\t\t\t\t\t\"sub \" + lightDirReg + \".w, \" + lightDirReg + \".w, \" + diffuseColorReg + \".w\\n\" + // w = (d - radius)/(max-min)\n\t\t\t\t\t\"mul \" + lightDirReg + \".w, \" + lightDirReg + \".w, \" + specularColorReg + \".w\\n\" + // w = clamp(w, 0, 1)\n\t\t\t\t\t\"sat \" + lightDirReg + \".w, \" + lightDirReg + \".w\\n\" + // w = 1-w\n\t\t\t\t\t\"sub \" + lightDirReg + \".w, \" + this._pSharedRegisters.commons + \".w, \" + lightDirReg + \".w\\n\" + // normalize\n\t\t\t\t\t\"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\";\n\t\t\t} else {\n\t\t\t\tthis._pFragmentCode += \"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightDirReg + \".w, \" + lightVarying + \".w\\n\";\n\t\t\t}\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = lightPosReg.index*4;\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._pFragmentCode += this._renderLightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject, lightDirReg, diffuseColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._pFragmentCode += this._renderLightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject, lightDirReg, specularColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tthis._pRegisterCache.removeFragmentTempUsage(lightDirReg);\n\t\t}\n\t}\n\n\t/**\n\t * Compiles shading code for light probes.\n\t */\n\tprivate compileLightProbeCode()\n\t{\n\t\tvar weightReg:string;\n\t\tvar weightComponents = [ \".x\", \".y\", \".z\", \".w\" ];\n\t\tvar weightRegisters:Array<ShaderRegisterElement> = new Array<ShaderRegisterElement>();\n\t\tvar i:number;\n\t\tvar texReg:ShaderRegisterElement;\n\t\tvar addSpec:boolean = this._shaderLightingObject.usesProbesForSpecular;\n\t\tvar addDiff:boolean = this._shaderLightingObject.usesProbesForDiffuse;\n\n\t\tif (addDiff)\n\t\t\tthis._shaderLightingObject.lightProbeDiffuseIndices = new Array<number>();\n\n\t\tif (addSpec)\n\t\t\tthis._shaderLightingObject.lightProbeSpecularIndices = new Array<number>();\n\n\t\tfor (i = 0; i < this._pNumProbeRegisters; ++i) {\n\t\t\tweightRegisters[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (i == 0)\n\t\t\t\tthis._shaderLightingObject.probeWeightsIndex = weightRegisters[i].index*4;\n\t\t}\n\n\t\tfor (i = 0; i < this._shaderLightingObject.numLightProbes; ++i) {\n\t\t\tweightReg = weightRegisters[Math.floor(i/4)].toString() + weightComponents[i%4];\n\n\t\t\tif (addDiff) {\n\t\t\t\ttexReg = this._pRegisterCache.getFreeTextureReg();\n\t\t\t\tthis._shaderLightingObject.lightProbeDiffuseIndices[i] = texReg.index;\n\t\t\t\tthis._pFragmentCode += this._renderLightingPass._iGetPerProbeDiffuseFragmentCode(this._shaderLightingObject, texReg, weightReg, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t}\n\n\t\t\tif (addSpec) {\n\t\t\t\ttexReg = this._pRegisterCache.getFreeTextureReg();\n\t\t\t\tthis._shaderLightingObject.lightProbeSpecularIndices[i] = texReg.index;\n\t\t\t\tthis._pFragmentCode += this._renderLightingPass._iGetPerProbeSpecularFragmentCode(this._shaderLightingObject, texReg, weightReg, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Reset all the indices to \"unused\".\n\t */\n\tpublic pInitRegisterIndices()\n\t{\n\t\tsuper.pInitRegisterIndices();\n\n\t\tthis._shaderLightingObject.lightVertexConstantIndex = -1;\n\t\tthis._shaderLightingObject.lightFragmentConstantIndex = -1;\n\t\tthis._shaderLightingObject.probeWeightsIndex = -1;\n\n\t\tthis._pNumProbeRegisters = Math.ceil(this._shaderLightingObject.numLightProbes/4);\n\n\t\t//init light data\n\t\tif (this._shaderLightingObject.usesTangentSpace || !this._shaderLightingObject.usesGlobalPosFragment) {\n\t\t\tthis._pointLightVertexConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numPointLights);\n\t\t\tthis._pointLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numPointLights*2);\n\t\t} else {\n\t\t\tthis._pointLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numPointLights*3);\n\t\t}\n\n\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\tthis._dirLightVertexConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numDirectionalLights);\n\t\t\tthis._dirLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numDirectionalLights*2);\n\t\t} else {\n\t\t\tthis._dirLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numDirectionalLights*3);\n\t\t}\n\t}\n}\n\nexport = ShaderLightingCompiler;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport LightProbe\t\t\t\t\t= require(\"awayjs-display/lib/entities/LightProbe\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\nimport LightSources\t\t\t\t\t= require(\"awayjs-display/lib/materials/LightSources\");\n\nimport ContextGLProfile\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProfile\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\n\nimport IRenderLightingPass\t\t\t= require(\"awayjs-renderergl/lib/passes/IRenderLightingPass\");\nimport ShaderLightingCompiler\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderLightingCompiler\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShaderCompilerBase\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderCompilerBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\n\n/**\n * ShaderObjectBase keeps track of the number of dependencies for \"named registers\" used across a pass.\n * Named registers are that are not necessarily limited to a single method. They are created by the compiler and\n * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed\n * each time a method has been compiled into the shader.\n *\n * @see RegisterPool.addUsage\n */\nclass ShaderLightingObject extends ShaderObjectBase\n{\n\tpublic _renderLightingPass:IRenderLightingPass;\n\n\tprivate _includeCasters:boolean = true;\n\n\t/**\n\t * The first index for the fragment constants containing the light data.\n\t */\n\tpublic lightFragmentConstantIndex:number;\n\n\t/**\n\t * The starting index if the vertex constant to which light data needs to be uploaded.\n\t */\n\tpublic lightVertexConstantIndex:number;\n\n\t/**\n\t * Indices for the light probe diffuse textures.\n\t */\n\tpublic lightProbeDiffuseIndices:Array<number> /*uint*/;\n\n\t/**\n\t * Indices for the light probe specular textures.\n\t */\n\tpublic lightProbeSpecularIndices:Array<number> /*uint*/;\n\n\t/**\n\t * The index of the fragment constant containing the weights for the light probes.\n\t */\n\tpublic probeWeightsIndex:number;\n\n\tpublic numLights:number;\n\tpublic numDirectionalLights:number;\n\tpublic numPointLights:number;\n\tpublic numLightProbes:number;\n\n\tpublic usesLightFallOff:boolean;\n\n\tpublic usesShadows:boolean;\n\n\t/**\n\t * Indicates whether the shader uses any lights.\n\t */\n\tpublic usesLights:boolean;\n\n\t/**\n\t * Indicates whether the shader uses any light probes.\n\t */\n\tpublic usesProbes:boolean;\n\n\t/**\n\t * Indicates whether the lights uses any specular components.\n\t */\n\tpublic usesLightsForSpecular:boolean;\n\n\t/**\n\t * Indicates whether the probes uses any specular components.\n\t */\n\tpublic usesProbesForSpecular:boolean;\n\n\t/**\n\t * Indicates whether the lights uses any diffuse components.\n\t */\n\tpublic usesLightsForDiffuse:boolean;\n\n\t/**\n\t * Indicates whether the probes uses any diffuse components.\n\t */\n\tpublic usesProbesForDiffuse:boolean;\n\n\t/**\n\t * Creates a new MethodCompilerVO object.\n\t */\n\tconstructor(renderableClass:IRenderableClass, renderLightingPass:IRenderLightingPass, stage:Stage)\n\t{\n\t\tsuper(renderableClass, renderLightingPass, stage);\n\n\t\tthis._renderLightingPass = renderLightingPass;\n\t}\n\n\tpublic _iIncludeDependencies()\n\t{\n\t\tthis.numPointLights = this._renderLightingPass.numPointLights;\n\t\tthis.numDirectionalLights = this._renderLightingPass.numDirectionalLights;\n\t\tthis.numLightProbes = this._renderLightingPass.numLightProbes;\n\n\t\tvar numAllLights:number = this._renderLightingPass.numPointLights + this._renderLightingPass.numDirectionalLights;\n\t\tvar numLightProbes:number = this._renderLightingPass.numLightProbes;\n\t\tvar diffuseLightSources:number = this._renderLightingPass._iUsesDiffuse(this)? this._renderLightingPass.diffuseLightSources : 0x00;\n\t\tvar specularLightSources:number = this._renderLightingPass._iUsesSpecular(this)? this._renderLightingPass.specularLightSources : 0x00;\n\t\tvar combinedLightSources:number = diffuseLightSources | specularLightSources;\n\n\t\tthis.usesLightFallOff = this._renderLightingPass.enableLightFallOff && this.profile != ContextGLProfile.BASELINE_CONSTRAINED;\n\t\tthis.numLights = numAllLights + numLightProbes;\n\t\tthis.usesLights = numAllLights > 0 && (combinedLightSources & LightSources.LIGHTS) != 0;\n\t\tthis.usesProbes = numLightProbes > 0 && (combinedLightSources & LightSources.PROBES) != 0;\n\t\tthis.usesLightsForSpecular = numAllLights > 0 && (specularLightSources & LightSources.LIGHTS) != 0;\n\t\tthis.usesProbesForSpecular = numLightProbes > 0 && (specularLightSources & LightSources.PROBES) != 0;\n\t\tthis.usesLightsForDiffuse = numAllLights > 0 && (diffuseLightSources & LightSources.LIGHTS) != 0;\n\t\tthis.usesProbesForDiffuse = numLightProbes > 0 && (diffuseLightSources & LightSources.PROBES) != 0;\n\t\tthis.usesShadows = this._renderLightingPass._iUsesShadows(this);\n\n\t\t//IMPORTANT this must occur after shader lighting initialisation above\n\t\tsuper._iIncludeDependencies();\n\t}\n\n\t/**\n\t * Factory method to create a concrete compiler object for this object\n\t *\n\t * @param materialPassVO\n\t * @returns {away.materials.ShaderLightingCompiler}\n\t */\n\tpublic createCompiler(renderableClass:IRenderableClass, renderPass:IRenderLightingPass):ShaderCompilerBase\n\t{\n\t\treturn new ShaderLightingCompiler(renderableClass, renderPass, this);\n\t}\n\n\t/**\n\t * Clears dependency counts for all registers. Called when recompiling a pass.\n\t */\n\tpublic reset()\n\t{\n\t\tsuper.reset();\n\n\t\tthis.numLights = 0;\n\t\tthis.usesLightFallOff = true;\n\t}\n\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRender(renderable, camera, viewProjection);\n\n\t\tif (this._renderLightingPass.lightPicker)\n\t\t\tthis._renderLightingPass.lightPicker.collectLights(renderable);\n\n\t\tif (this.usesLights)\n\t\t\tthis.updateLights();\n\n\t\tif (this.usesProbes)\n\t\t\tthis.updateProbes();\n\t}\n\n\t/**\n\t * Updates constant data render state used by the lights. This method is optional for subclasses to implement.\n\t */\n\tprivate updateLights()\n\t{\n\t\tvar dirLight:DirectionalLight;\n\t\tvar pointLight:PointLight;\n\t\tvar i:number = 0;\n\t\tvar k:number = 0;\n\t\tvar len:number;\n\t\tvar dirPos:Vector3D;\n\t\tvar total:number = 0;\n\t\tvar numLightTypes:number = this.usesShadows? 2 : 1;\n\t\tvar l:number;\n\t\tvar offset:number;\n\n\t\tthis.ambientR = this.ambientG = this.ambientB = 0;\n\n\t\tl = this.lightVertexConstantIndex;\n\t\tk = this.lightFragmentConstantIndex;\n\n\t\tvar cast:number = 0;\n\t\tvar dirLights:Array<DirectionalLight> = this._renderLightingPass.lightPicker.directionalLights;\n\t\toffset = this._renderLightingPass.directionalLightsOffset;\n\t\tlen = this._renderLightingPass.lightPicker.directionalLights.length;\n\n\t\tif (offset > len) {\n\t\t\tcast = 1;\n\t\t\toffset -= len;\n\t\t}\n\n\t\tfor (; cast < numLightTypes; ++cast) {\n\t\t\tif (cast)\n\t\t\t\tdirLights = this._renderLightingPass.lightPicker.castingDirectionalLights;\n\n\t\t\tlen = dirLights.length;\n\n\t\t\tif (len > this.numDirectionalLights)\n\t\t\t\tlen = this.numDirectionalLights;\n\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tdirLight = dirLights[offset + i];\n\t\t\t\tdirPos = dirLight.sceneDirection;\n\n\t\t\t\tthis.ambientR += dirLight._iAmbientR;\n\t\t\t\tthis.ambientG += dirLight._iAmbientG;\n\t\t\t\tthis.ambientB += dirLight._iAmbientB;\n\n\t\t\t\tif (this.usesTangentSpace) {\n\t\t\t\t\tvar x:number = -dirPos.x;\n\t\t\t\t\tvar y:number = -dirPos.y;\n\t\t\t\t\tvar z:number = -dirPos.z;\n\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.x;\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.y;\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.z;\n\t\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseR;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseG;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseB;\n\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularR;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularG;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularB;\n\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\n\t\t\t\tif (++total == this.numDirectionalLights) {\n\t\t\t\t\t// break loop\n\t\t\t\t\ti = len;\n\t\t\t\t\tcast = numLightTypes;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// more directional supported than currently picked, need to clamp all to 0\n\t\tif (this.numDirectionalLights > total) {\n\t\t\ti = k + (this.numDirectionalLights - total)*12;\n\n\t\t\twhile (k < i)\n\t\t\t\tthis.fragmentConstantData[k++] = 0;\n\t\t}\n\n\t\ttotal = 0;\n\n\t\tvar pointLights:Array<PointLight> = this._renderLightingPass.lightPicker.pointLights;\n\t\toffset = this._renderLightingPass.pointLightsOffset;\n\t\tlen = this._renderLightingPass.lightPicker.pointLights.length;\n\n\t\tif (offset > len) {\n\t\t\tcast = 1;\n\t\t\toffset -= len;\n\t\t} else {\n\t\t\tcast = 0;\n\t\t}\n\n\t\tfor (; cast < numLightTypes; ++cast) {\n\t\t\tif (cast)\n\t\t\t\tpointLights = this._renderLightingPass.lightPicker.castingPointLights;\n\n\t\t\tlen = pointLights.length;\n\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tpointLight = pointLights[offset + i];\n\t\t\t\tdirPos = pointLight.scenePosition;\n\n\t\t\t\tthis.ambientR += pointLight._iAmbientR;\n\t\t\t\tthis.ambientG += pointLight._iAmbientG;\n\t\t\t\tthis.ambientB += pointLight._iAmbientB;\n\n\t\t\t\tif (this.usesTangentSpace) {\n\t\t\t\t\tx = dirPos.x;\n\t\t\t\t\ty = dirPos.y;\n\t\t\t\t\tz = dirPos.z;\n\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z + this._pInverseSceneMatrix[12];\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z + this._pInverseSceneMatrix[13];\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z + this._pInverseSceneMatrix[14];\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else if (!this.usesGlobalPosFragment) {\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.x;\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.y;\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.z;\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.x;\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.y;\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.z;\n\t\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseR;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseG;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseB;\n\n\t\t\t\tvar radius:number = pointLight._pRadius;\n\t\t\t\tthis.fragmentConstantData[k++] = radius*radius;\n\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularR;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularG;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularB;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._pFallOffFactor;\n\n\t\t\t\tif (++total == this.numPointLights) {\n\t\t\t\t\t// break loop\n\t\t\t\t\ti = len;\n\t\t\t\t\tcast = numLightTypes;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// more directional supported than currently picked, need to clamp all to 0\n\t\tif (this.numPointLights > total) {\n\t\t\ti = k + (total - this.numPointLights)*12;\n\n\t\t\tfor (; k < i; ++k)\n\t\t\t\tthis.fragmentConstantData[k] = 0;\n\t\t}\n\t}\n\n\t/**\n\t * Updates constant data render state used by the light probes. This method is optional for subclasses to implement.\n\t */\n\tprivate updateProbes()\n\t{\n\t\tvar probe:LightProbe;\n\t\tvar lightProbes:Array<LightProbe> = this._renderLightingPass.lightPicker.lightProbes;\n\t\tvar weights:Array<number> = this._renderLightingPass.lightPicker.lightProbeWeights;\n\t\tvar len:number = lightProbes.length - this._renderLightingPass.lightProbesOffset;\n\t\tvar addDiff:boolean = this.usesProbesForDiffuse;\n\t\tvar addSpec:boolean = this.usesProbesForSpecular;\n\n\t\tif (!(addDiff || addSpec))\n\t\t\treturn;\n\n\t\tif (len > this.numLightProbes)\n\t\t\tlen = this.numLightProbes;\n\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tprobe = lightProbes[ this._renderLightingPass.lightProbesOffset + i];\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._stage.getImageObject(probe.diffuseMap).activate(this.lightProbeDiffuseIndices[i], false, this.useSmoothTextures, this.useMipmapping);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._stage.getImageObject(probe.specularMap).activate(this.lightProbeSpecularIndices[i], false, this.useSmoothTextures, this.useMipmapping);\n\t\t}\n\n\t\tfor (i = 0; i < len; ++i)\n\t\t\tthis.fragmentConstantData[this.probeWeightsIndex + i] = weights[this._renderLightingPass.lightProbesOffset + i];\n\t}\n}\n\nexport = ShaderLightingObject;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/LineSubGeometry\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport TextureBase\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport ContextGLTriangleFace\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTriangleFace\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\n\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport TextureObjectPool\t\t\t= require(\"awayjs-renderergl/lib/pool/TextureObjectPool\");\nimport TextureObjectBase\t\t\t= require(\"awayjs-renderergl/lib/pool/TextureObjectBase\");\nimport IRenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/IRenderPassBase\");\nimport ShaderCompilerBase\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderCompilerBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\n\n/**\n * ShaderObjectBase keeps track of the number of dependencies for \"named registers\" used across a pass.\n * Named registers are that are not necessarily limited to a single method. They are created by the compiler and\n * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed\n * each time a method has been compiled into the shader.\n *\n * @see RegisterPool.addUsage\n */\nclass ShaderObjectBase\n{\n\tprivate _textureObjectPool:TextureObjectPool;\n\tprivate _renderableClass:IRenderableClass;\n\tprivate _renderPass:IRenderPassBase;\n\tpublic _stage:Stage;\n\tprivate _programData:ProgramData;\n\n\tprivate _invalidShader:boolean = true;\n\tprivate _invalidProgram:boolean = true;\n\tprivate _animationVertexCode:string = \"\";\n\tprivate _animationFragmentCode:string = \"\";\n\n\tpublic get programData():ProgramData\n\t{\n\t\tif (this._invalidProgram)\n\t\t\tthis._updateProgram();\n\n\t\treturn this._programData;\n\t}\n\n\tpublic profile:string;\n\n\tpublic usesAnimation:boolean;\n\n\tprivate _defaultCulling:string = ContextGLTriangleFace.BACK;\n\n\tpublic _pInverseSceneMatrix:Array<number> = new Array<number>();\n\n\tpublic animationRegisterCache:AnimationRegisterCache;\n\n\t/**\n\t * The amount of used vertex constants in the vertex code. Used by the animation code generation to know from which index on registers are available.\n\t */\n\tpublic numUsedVertexConstants:number;\n\n\t/**\n\t * The amount of used fragment constants in the fragment code. Used by the animation code generation to know from which index on registers are available.\n\t */\n\tpublic numUsedFragmentConstants:number;\n\n\t/**\n\t * The amount of used vertex streams in the vertex code. Used by the animation code generation to know from which index on streams are available.\n\t */\n\tpublic numUsedStreams:number;\n\n\t/**\n\t *\n\t */\n\tpublic numUsedTextures:number;\n\n\t/**\n\t *\n\t */\n\tpublic numUsedVaryings:number;\n\n\tpublic animatableAttributes:Array<string>;\n\tpublic animationTargetRegisters:Array<string>;\n\tpublic uvSource:string;\n\tpublic uvTarget:string;\n\n\tpublic useAlphaPremultiplied:boolean;\n\tpublic useBothSides:boolean;\n\tpublic useMipmapping:boolean;\n\tpublic useSmoothTextures:boolean;\n\tpublic repeatTextures:boolean;\n\tpublic usesUVTransform:boolean;\n\tpublic alphaThreshold:number;\n\tpublic texture:TextureObjectBase;\n\tpublic color:number;\n\n\n\t//set ambient values to default\n\tpublic ambientR:number = 0xFF;\n\tpublic ambientG:number = 0xFF;\n\tpublic ambientB:number = 0xFF;\n\n\t/**\n\t * Indicates whether the pass requires any fragment animation code.\n\t */\n\tpublic usesFragmentAnimation:boolean;\n\n\t/**\n\t * The amount of dependencies on the projected position.\n\t */\n\tpublic projectionDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the normal vector.\n\t */\n\tpublic normalDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the vertex color.\n\t */\n\tpublic colorDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the view direction.\n\t */\n\tpublic viewDirDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the primary UV coordinates.\n\t */\n\tpublic uvDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the secondary UV coordinates.\n\t */\n\tpublic secondaryUVDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the global position. This can be 0 while hasGlobalPosDependencies is true when\n\t * the global position is used as a temporary value (fe to calculate the view direction)\n\t */\n\tpublic globalPosDependencies:number;\n\n\t/**\n\t * The amount of tangent vector dependencies (fragment shader).\n\t */\n\tpublic tangentDependencies:number;\n\n\t/**\n\t *\n\t */\n\tpublic outputsNormals:boolean;\n\n\t/**\n\t *\n\t */\n\tpublic outputsColors:boolean;\n\n\t/**\n\t * Indicates whether or not normal calculations are expected in tangent space. This is only the case if no world-space\n\t * dependencies exist.\n\t */\n\tpublic usesTangentSpace:boolean;\n\n\t/**\n\t * Indicates whether or not normal calculations are output in tangent space.\n\t */\n\tpublic outputsTangentNormals:boolean;\n\n\t/**\n\t * Indicates whether there are any dependencies on the world-space position vector.\n\t */\n\tpublic usesGlobalPosFragment:boolean = false;\n\n\t/**\n\t * Indicates whether there are any dependencies on the local position vector.\n\t */\n\tpublic usesLocalPosFragment:boolean = false;\n\n\tpublic vertexConstantData:Array<number> = new Array<number>();\n\tpublic fragmentConstantData:Array<number> = new Array<number>();\n\n\t/**\n\t * The index for the common data register.\n\t */\n\tpublic commonsDataIndex:number;\n\n\t/**\n\t * The index for the UV vertex attribute stream.\n\t */\n\tpublic uvBufferIndex:number;\n\n\t/**\n\t * The index for the secondary UV vertex attribute stream.\n\t */\n\tpublic secondaryUVBufferIndex:number;\n\n\t/**\n\t * The index for the vertex normal attribute stream.\n\t */\n\tpublic normalBufferIndex:number;\n\n\t/**\n\t * The index for the color attribute stream.\n\t */\n\tpublic colorBufferIndex:number;\n\n\t/**\n\t * The index for the vertex tangent attribute stream.\n\t */\n\tpublic tangentBufferIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the view matrix.\n\t */\n\tpublic viewMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the scene matrix.\n\t */\n\tpublic sceneMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the uniform scene matrix (the inverse transpose).\n\t */\n\tpublic sceneNormalMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the camera position.\n\t */\n\tpublic cameraPositionIndex:number;\n\n\t/**\n\t * The index for the UV transformation matrix vertex constant.\n\t */\n\tpublic uvTransformIndex:number;\n\n\t/**\n\t * Creates a new MethodCompilerVO object.\n\t */\n\tconstructor(renderableClass:IRenderableClass, renderPass:IRenderPassBase, stage:Stage)\n\t{\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._renderPass = renderPass;\n\t\tthis._stage = stage;\n\t\tthis.profile = this._stage.profile;\n\n\t\tthis._textureObjectPool = new TextureObjectPool(this._stage);\n\t}\n\n\tpublic getTextureObject(texture:TextureBase):TextureObjectBase\n\t{\n\t\treturn this._textureObjectPool.getItem(texture);\n\t}\n\n\tpublic _iIncludeDependencies()\n\t{\n\t\tthis._renderPass._iIncludeDependencies(this);\n\t}\n\n\t/**\n\t * Factory method to create a concrete compiler object for this object\n\t *\n\t * @param renderableClass\n\t * @param renderPass\n\t * @param stage\n\t * @returns {ShaderCompilerBase}\n\t */\n\tpublic createCompiler(renderableClass:IRenderableClass, renderPass:IRenderPassBase):ShaderCompilerBase\n\t{\n\t\treturn new ShaderCompilerBase(renderableClass, renderPass, this);\n\t}\n\n\t/**\n\t * Clears dependency counts for all registers. Called when recompiling a pass.\n\t */\n\tpublic reset()\n\t{\n\t\tthis.projectionDependencies = 0;\n\t\tthis.normalDependencies = 0;\n\t\tthis.colorDependencies = 0;\n\t\tthis.viewDirDependencies = 0;\n\t\tthis.uvDependencies = 0;\n\t\tthis.secondaryUVDependencies = 0;\n\t\tthis.globalPosDependencies = 0;\n\t\tthis.tangentDependencies = 0;\n\t\tthis.usesGlobalPosFragment = false;\n\t\tthis.usesLocalPosFragment = false;\n\t\tthis.usesFragmentAnimation = false;\n\t\tthis.usesTangentSpace = false;\n\t\tthis.outputsNormals = false;\n\t\tthis.outputsTangentNormals = false;\n\t}\n\n\tpublic pInitRegisterIndices()\n\t{\n\t\tthis.commonsDataIndex = -1;\n\t\tthis.cameraPositionIndex = -1;\n\t\tthis.uvBufferIndex = -1;\n\t\tthis.uvTransformIndex = -1;\n\t\tthis.secondaryUVBufferIndex = -1;\n\t\tthis.normalBufferIndex = -1;\n\t\tthis.colorBufferIndex = -1;\n\t\tthis.tangentBufferIndex = -1;\n\t\tthis.sceneMatrixIndex = -1;\n\t\tthis.sceneNormalMatrixIndex = -1;\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this shader object.\n\t */\n\tpublic initConstantData(registerCache:ShaderRegisterCache, animatableAttributes:Array<string>, animationTargetRegisters:Array<string>, uvSource:string, uvTarget:string)\n\t{\n\t\t//Updates the amount of used register indices.\n\t\tthis.numUsedVertexConstants = registerCache.numUsedVertexConstants;\n\t\tthis.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;\n\t\tthis.numUsedStreams = registerCache.numUsedStreams;\n\t\tthis.numUsedTextures = registerCache.numUsedTextures;\n\t\tthis.numUsedVaryings = registerCache.numUsedVaryings;\n\t\tthis.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;\n\n\t\tthis.animatableAttributes = animatableAttributes;\n\t\tthis.animationTargetRegisters = animationTargetRegisters;\n\t\tthis.uvSource = uvSource;\n\t\tthis.uvTarget = uvTarget;\n\n\t\tthis.vertexConstantData.length = this.numUsedVertexConstants*4;\n\t\tthis.fragmentConstantData.length = this.numUsedFragmentConstants*4;\n\n\t\t//Initializes commonly required constant values.\n\t\tthis.fragmentConstantData[this.commonsDataIndex] = .5;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 1] = 0;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 2] = 1/255;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 3] = 1;\n\n\t\t//Initializes the default UV transformation matrix.\n\t\tif (this.uvTransformIndex >= 0) {\n\t\t\tthis.vertexConstantData[this.uvTransformIndex] = 1;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 2] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = 1;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 6] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = 0;\n\t\t}\n\n\t\tif (this.cameraPositionIndex >= 0)\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 3] = 1;\n\t}\n\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tif (this.usesAnimation)\n\t\t\t(<AnimationSetBase> this._renderPass.animationSet).activate(this, this._stage);\n\n\t\tthis._stage.context.setCulling(this.useBothSides? ContextGLTriangleFace.NONE : this._defaultCulling, camera.projection.coordinateSystem);\n\n\t\tif (!this.usesTangentSpace && this.cameraPositionIndex >= 0) {\n\t\t\tvar pos:Vector3D = camera.scenePosition;\n\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex] = pos.x;\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 1] = pos.y;\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 2] = pos.z;\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iDeactivate()\n\t{\n\t\tif (this.usesAnimation)\n\t\t\t(<AnimationSetBase> this._renderPass.animationSet).deactivate(this, this._stage);\n\n\t}\n\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tif (renderable.renderableOwner.animator)\n\t\t\t(<AnimatorBase> renderable.renderableOwner.animator).setRenderState(this, renderable, this._stage, camera, this.numUsedVertexConstants, this.numUsedStreams);\n\n\t\tif (this.uvBufferIndex >= 0)\n\t\t\tthis._stage.activateBuffer(this.uvBufferIndex, renderable.getVertexData(TriangleSubGeometry.UV_DATA), renderable.getVertexOffset(TriangleSubGeometry.UV_DATA), TriangleSubGeometry.UV_FORMAT);\n\n\t\tif (this.secondaryUVBufferIndex >= 0)\n\t\t\tthis._stage.activateBuffer(this.secondaryUVBufferIndex, renderable.getVertexData(TriangleSubGeometry.SECONDARY_UV_DATA), renderable.getVertexOffset(TriangleSubGeometry.SECONDARY_UV_DATA), TriangleSubGeometry.SECONDARY_UV_FORMAT);\n\n\t\tif (this.normalBufferIndex >= 0)\n\t\t\tthis._stage.activateBuffer(this.normalBufferIndex, renderable.getVertexData(TriangleSubGeometry.NORMAL_DATA), renderable.getVertexOffset(TriangleSubGeometry.NORMAL_DATA), TriangleSubGeometry.NORMAL_FORMAT);\n\n\t\tif (this.tangentBufferIndex >= 0)\n\t\t\tthis._stage.activateBuffer(this.tangentBufferIndex, renderable.getVertexData(TriangleSubGeometry.TANGENT_DATA), renderable.getVertexOffset(TriangleSubGeometry.TANGENT_DATA), TriangleSubGeometry.TANGENT_FORMAT);\n\n\t\tif (this.colorBufferIndex >= 0)\n\t\t\tthis._stage.activateBuffer(this.colorBufferIndex, renderable.getVertexData(LineSubGeometry.COLOR_DATA), renderable.getVertexOffset(LineSubGeometry.COLOR_DATA), LineSubGeometry.COLOR_FORMAT);\n\n\n\t\tif (this.usesUVTransform) {\n\t\t\tvar uvTransform:Matrix = renderable.renderableOwner.uvTransform.matrix;\n\n\t\t\tif (uvTransform) {\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex] = uvTransform.a;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = uvTransform.b;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = uvTransform.tx;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = uvTransform.c;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = uvTransform.d;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = uvTransform.ty;\n\t\t\t} else {\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex] = 1;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = 1;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = 0;\n\t\t\t}\n\t\t}\n\n\t\tif (this.sceneNormalMatrixIndex >= 0)\n\t\t\trenderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this.vertexConstantData, this.sceneNormalMatrixIndex, false);\n\n\t\tif (this.usesTangentSpace && this.cameraPositionIndex >= 0) {\n\n\t\t\trenderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this._pInverseSceneMatrix);\n\t\t\tvar pos:Vector3D = camera.scenePosition;\n\t\t\tvar x:number = pos.x;\n\t\t\tvar y:number = pos.y;\n\t\t\tvar z:number = pos.z;\n\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z + this._pInverseSceneMatrix[12];\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 1] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z + this._pInverseSceneMatrix[13];\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 2] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z + this._pInverseSceneMatrix[14];\n\t\t}\n\t}\n\t\n\tpublic invalidateProgram()\n\t{\n\t\tthis._invalidProgram = true;\n\t}\n\n\tpublic invalidateShader()\n\t{\n\t\tthis._invalidShader = true;\n\t\tthis._invalidProgram = true;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._programData.dispose();\n\t\tthis._programData = null;\n\t}\n\n\tprivate _updateProgram()\n\t{\n\t\tthis._invalidProgram = false;\n\n\t\tvar compiler:ShaderCompilerBase;\n\n\t\tif (this._invalidShader) {\n\t\t\tthis._invalidShader = false;\n\n\t\t\tcompiler = this.createCompiler(this._renderableClass, this._renderPass);\n\t\t\tcompiler.compile();\n\t\t}\n\n\t\tthis._calcAnimationCode(compiler.shadedTarget);\n\n\t\tvar programData:ProgramData = this._stage.getProgramData(this._animationVertexCode + compiler.vertexCode, compiler.fragmentCode + this._animationFragmentCode + compiler.postAnimationFragmentCode);\n\n\t\t//check program data hasn't changed, keep count of program usages\n\t\tif (this._programData != programData) {\n\t\t\tif (this._programData)\n\t\t\t\tthis._programData.dispose();\n\n\t\t\tthis._programData = programData;\n\n\t\t\tprogramData.usages++;\n\t\t}\n\t}\n\n\tprivate _calcAnimationCode(shadedTarget:string)\n\t{\n\t\t//reset code\n\t\tthis._animationVertexCode = \"\";\n\t\tthis._animationFragmentCode = \"\";\n\n\t\t//check to see if GPU animation is used\n\t\tif (this.usesAnimation) {\n\n\t\t\tvar animationSet:AnimationSetBase = <AnimationSetBase> this._renderPass.animationSet;\n\n\t\t\tthis._animationVertexCode += animationSet.getAGALVertexCode(this);\n\n\t\t\tif (this.uvDependencies > 0 && !this.usesUVTransform)\n\t\t\t\tthis._animationVertexCode += animationSet.getAGALUVCode(this);\n\n\t\t\tif (this.usesFragmentAnimation)\n\t\t\t\tthis._animationFragmentCode += animationSet.getAGALFragmentCode(this, shadedTarget);\n\n\t\t\tanimationSet.doneAGALCode(this);\n\n\t\t} else {\n\t\t\t// simply write attributes to targets, do not animate them\n\t\t\t// projection will pick up on targets[0] to do the projection\n\t\t\tvar len:number = this.animatableAttributes.length;\n\t\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\t\tthis._animationVertexCode += \"mov \" + this.animationTargetRegisters[i] + \", \" + this.animatableAttributes[i] + \"\\n\";\n\n\t\t\tif (this.uvDependencies > 0 && !this.usesUVTransform)\n\t\t\t\tthis._animationVertexCode += \"mov \" + this.uvTarget + \",\" + this.uvSource + \"\\n\";\n\t\t}\n\t}\n}\n\nexport = ShaderObjectBase;",
    "import RegisterPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RegisterPool\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\n/**\n * ShaderRegister Cache provides the usage management system for all registers during shading compilation.\n */\nclass ShaderRegisterCache\n{\n\tprivate _fragmentTempCache:RegisterPool;\n\tprivate _vertexTempCache:RegisterPool;\n\tprivate _varyingCache:RegisterPool;\n\tprivate _fragmentConstantsCache:RegisterPool;\n\tprivate _vertexConstantsCache:RegisterPool;\n\tprivate _textureCache:RegisterPool;\n\tprivate _vertexAttributesCache:RegisterPool;\n\tprivate _vertexConstantOffset:number; //TODO: check if this should be initialised to 0\n\tprivate _vertexAttributesOffset:number;//TODO: check if this should be initialised to 0\n\tprivate _varyingsOffset:number;//TODO: check if this should be initialised to 0\n\tprivate _fragmentConstantOffset:number;//TODO: check if this should be initialised to 0\n\n\tprivate _fragmentOutputRegister:ShaderRegisterElement;\n\tprivate _vertexOutputRegister:ShaderRegisterElement;\n\tprivate _numUsedVertexConstants:number = 0;\n\tprivate _numUsedFragmentConstants:number = 0;\n\tprivate _numUsedStreams:number = 0;\n\tprivate _numUsedTextures:number = 0;\n\tprivate _numUsedVaryings:number = 0;\n\tprivate _profile:string;\n\n\t/**\n\t * Create a new ShaderRegisterCache object.\n\t *\n\t * @param profile The compatibility profile used by the renderer.\n\t */\n\tconstructor(profile:string)\n\t{\n\t\tthis._profile = profile;\n\t}\n\n\t/**\n\t * Resets all registers.\n\t */\n\tpublic reset()\n\t{\n\t\tthis._fragmentTempCache = new RegisterPool(\"ft\", 8, false);\n\t\tthis._vertexTempCache = new RegisterPool(\"vt\", 8, false);\n\t\tthis._varyingCache = new RegisterPool(\"v\", 8);\n\t\tthis._textureCache = new RegisterPool(\"fs\", 8);\n\t\tthis._vertexAttributesCache = new RegisterPool(\"va\", 8);\n\t\tthis._fragmentConstantsCache = new RegisterPool(\"fc\", 28);\n\t\tthis._vertexConstantsCache = new RegisterPool(\"vc\", 128);\n\t\tthis._fragmentOutputRegister = new ShaderRegisterElement(\"oc\", -1);\n\t\tthis._vertexOutputRegister = new ShaderRegisterElement(\"op\", -1);\n\t\tthis._numUsedVertexConstants = 0;\n\t\tthis._numUsedStreams = 0;\n\t\tthis._numUsedTextures = 0;\n\t\tthis._numUsedVaryings = 0;\n\t\tthis._numUsedFragmentConstants = 0;\n\n\t\tvar i:number;\n\n\t\tfor (i = 0; i < this._vertexAttributesOffset; ++i)\n\t\t\tthis.getFreeVertexAttribute();\n\n\t\tfor (i = 0; i < this._vertexConstantOffset; ++i)\n\t\t\tthis.getFreeVertexConstant();\n\n\t\tfor (i = 0; i < this._varyingsOffset; ++i)\n\t\t\tthis.getFreeVarying();\n\n\t\tfor (i = 0; i < this._fragmentConstantOffset; ++i)\n\t\t\tthis.getFreeFragmentConstant();\n\t}\n\n\t/**\n\t * Disposes all resources used.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._fragmentTempCache.dispose();\n\t\tthis._vertexTempCache.dispose();\n\t\tthis._varyingCache.dispose();\n\t\tthis._fragmentConstantsCache.dispose();\n\t\tthis._vertexAttributesCache.dispose();\n\n\t\tthis._fragmentTempCache = null;\n\t\tthis._vertexTempCache = null;\n\t\tthis._varyingCache = null;\n\t\tthis._fragmentConstantsCache = null;\n\t\tthis._vertexAttributesCache = null;\n\t\tthis._fragmentOutputRegister = null;\n\t\tthis._vertexOutputRegister = null;\n\t}\n\n\t/**\n\t * Marks a fragment temporary register as used, so it cannot be retrieved. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addFragmentTempUsages(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tthis._fragmentTempCache.addUsage(register, usageCount);\n\t}\n\n\t/**\n\t * Removes a usage from a fragment temporary register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeFragmentTempUsage(register:ShaderRegisterElement)\n\t{\n\t\tthis._fragmentTempCache.removeUsage(register);\n\t}\n\n\t/**\n\t * Marks a vertex temporary register as used, so it cannot be retrieved. The register won't be able to be used\n\t * until removeUsage has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addVertexTempUsages(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tthis._vertexTempCache.addUsage(register, usageCount);\n\t}\n\n\t/**\n\t * Removes a usage from a vertex temporary register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeVertexTempUsage(register:ShaderRegisterElement)\n\t{\n\t\tthis._vertexTempCache.removeUsage(register);\n\t}\n\n\t/**\n\t * Retrieve an entire fragment temporary register that's still available. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t */\n\tpublic getFreeFragmentVectorTemp():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentTempCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve a single component from a fragment temporary register that's still available.\n\t */\n\tpublic getFreeFragmentSingleTemp():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentTempCache.requestFreeRegComponent();\n\t}\n\n\t/**\n\t * Retrieve an available varying register\n\t */\n\tpublic getFreeVarying():ShaderRegisterElement\n\t{\n\t\t++this._numUsedVaryings;\n\t\treturn this._varyingCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available fragment constant register\n\t */\n\tpublic getFreeFragmentConstant():ShaderRegisterElement\n\t{\n\t\t++this._numUsedFragmentConstants;\n\t\treturn this._fragmentConstantsCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available vertex constant register\n\t */\n\tpublic getFreeVertexConstant():ShaderRegisterElement\n\t{\n\t\t++this._numUsedVertexConstants;\n\t\treturn this._vertexConstantsCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an entire vertex temporary register that's still available.\n\t */\n\tpublic getFreeVertexVectorTemp():ShaderRegisterElement\n\t{\n\t\treturn this._vertexTempCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve a single component from a vertex temporary register that's still available.\n\t */\n\tpublic getFreeVertexSingleTemp():ShaderRegisterElement\n\t{\n\t\treturn this._vertexTempCache.requestFreeRegComponent();\n\t}\n\n\t/**\n\t * Retrieve an available vertex attribute register\n\t */\n\tpublic getFreeVertexAttribute():ShaderRegisterElement\n\t{\n\t\t++this._numUsedStreams;\n\t\treturn this._vertexAttributesCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available texture register\n\t */\n\tpublic getFreeTextureReg():ShaderRegisterElement\n\t{\n\t\t++this._numUsedTextures;\n\t\treturn this._textureCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve vertex constants.\n\t */\n\tpublic get vertexConstantOffset():number\n\t{\n\t\treturn this._vertexConstantOffset;\n\t}\n\n\tpublic set vertexConstantOffset(vertexConstantOffset:number)\n\t{\n\t\tthis._vertexConstantOffset = vertexConstantOffset;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve vertex attributes.\n\t */\n\tpublic get vertexAttributesOffset():number\n\t{\n\t\treturn this._vertexAttributesOffset;\n\t}\n\n\tpublic set vertexAttributesOffset(value:number)\n\t{\n\t\tthis._vertexAttributesOffset = value;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve varying registers.\n\t */\n\tpublic get varyingsOffset():number\n\t{\n\t\treturn this._varyingsOffset;\n\t}\n\n\tpublic set varyingsOffset(value:number)\n\t{\n\t\tthis._varyingsOffset = value;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve fragment constants.\n\t */\n\tpublic get fragmentConstantOffset():number\n\t{\n\t\treturn this._fragmentConstantOffset;\n\t}\n\n\tpublic set fragmentConstantOffset(value:number)\n\t{\n\t\tthis._fragmentConstantOffset = value;\n\t}\n\n\t/**\n\t * The fragment output register.\n\t */\n\tpublic get fragmentOutputRegister():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentOutputRegister;\n\t}\n\n\t/**\n\t * The amount of used vertex constant registers.\n\t */\n\tpublic get numUsedVertexConstants():number\n\t{\n\t\treturn this._numUsedVertexConstants;\n\t}\n\n\t/**\n\t * The amount of used fragment constant registers.\n\t */\n\tpublic get numUsedFragmentConstants():number\n\t{\n\t\treturn this._numUsedFragmentConstants;\n\t}\n\n\t/**\n\t * The amount of used vertex streams.\n\t */\n\tpublic get numUsedStreams():number\n\t{\n\t\treturn this._numUsedStreams;\n\t}\n\n\t/**\n\t * The amount of used texture slots.\n\t */\n\tpublic get numUsedTextures():number\n\t{\n\t\treturn this._numUsedTextures;\n\t}\n\n\t/**\n\t * The amount of used varying registers.\n\t */\n\tpublic get numUsedVaryings():number\n\t{\n\t\treturn this._numUsedVaryings;\n\t}\n}\n\nexport = ShaderRegisterCache;",
    "import ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\n/**\n * ShaderRegisterData contains the \"named\" registers, generated by the compiler and to be passed on to the methods.\n */\nclass ShaderRegisterData\n{\n\tpublic normalVarying:ShaderRegisterElement;\n\tpublic colorVarying:ShaderRegisterElement\n\tpublic tangentVarying:ShaderRegisterElement;\n\tpublic bitangentVarying:ShaderRegisterElement;\n\tpublic uvVarying:ShaderRegisterElement;\n\tpublic secondaryUVVarying:ShaderRegisterElement;\n\tpublic viewDirVarying:ShaderRegisterElement;\n\tpublic shadowTarget:ShaderRegisterElement;\n\tpublic shadedTarget:ShaderRegisterElement;\n\tpublic globalPositionVertex:ShaderRegisterElement;\n\tpublic globalPositionVarying:ShaderRegisterElement;\n    public localPositionVarying:ShaderRegisterElement;\n\tpublic localPosition:ShaderRegisterElement;\n\tpublic normalInput:ShaderRegisterElement;\n\tpublic colorInput:ShaderRegisterElement;\n\tpublic tangentInput:ShaderRegisterElement;\n\tpublic animatedNormal:ShaderRegisterElement;\n\tpublic animatedTangent:ShaderRegisterElement;\n\tpublic commons:ShaderRegisterElement;\n\tpublic projectionFragment:ShaderRegisterElement;\n\tpublic normalFragment:ShaderRegisterElement;\n\tpublic viewDirFragment:ShaderRegisterElement;\n\tpublic bitangent:ShaderRegisterElement;\n\n\tconstructor()\n\t{\n\n\t}\n}\n\nexport = ShaderRegisterData;",
    "/**\n * A single register element (an entire register or a single register's component) used by the RegisterPool.\n */\nclass ShaderRegisterElement\n{\n\tprivate _regName:string;\n\tprivate _index:number;\n\tprivate _toStr:string;\n\n\tprivate static COMPONENTS = [\"x\", \"y\", \"z\", \"w\"];\n\n\tpublic _component:number;\n\n\t/**\n\t * Creates a new ShaderRegisterElement object.\n\t *\n\t * @param regName The name of the register.\n\t * @param index The index of the register.\n\t * @param component The register's component, if not the entire register is represented.\n\t */\n\tconstructor(regName:string, index:number, component:number = -1)\n\t{\n\t\tthis._component = component;\n\t\tthis._regName = regName;\n\t\tthis._index = index;\n\n\t\tthis._toStr = this._regName;\n\n\t\tif (this._index >= 0)\n\t\t\tthis._toStr += this._index;\n\n\t\tif (component > -1)\n\t\t\tthis._toStr += \".\" + ShaderRegisterElement.COMPONENTS[component];\n\t}\n\n\t/**\n\t * Converts the register or the components AGAL string representation.\n\t */\n\tpublic toString():string\n\t{\n\t\treturn this._toStr;\n\t}\n\n\t/**\n\t * The register's name.\n\t */\n\tpublic get regName():string\n\t{\n\t\treturn this._regName;\n\t}\n\n\t/**\n\t * The register's index.\n\t */\n\tpublic get index():number\n\t{\n\t\treturn this._index;\n\t}\n}\n\nexport = ShaderRegisterElement;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport RenderObjectPool\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectPool\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport SkyboxPass\t\t\t\t\t= require(\"awayjs-renderergl/lib/passes/SkyboxPass\");\n\n/**\n * SkyboxRenderObject forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass SkyboxRenderObject extends RenderObjectBase\n{\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"skybox\";\n\n\tprivate _screenPass:SkyboxPass;\n\n\tconstructor(pool:RenderObjectPool, renderObjectOwner:IRenderObjectOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, renderObjectOwner, renderableClass, stage);\n\n\t\tthis._screenPass = new SkyboxPass(this, renderObjectOwner, renderableClass, this._stage);\n\n\t\tthis._pAddScreenPass(this._screenPass);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateRenderObject()\n\t{\n\t\tsuper._pUpdateRenderObject();\n\n\t\tthis._pRequiresBlending = (this._renderObjectOwner.blendMode != BlendMode.NORMAL);\n\n\t\tthis._screenPass.setBlendMode((this._renderObjectOwner.blendMode == BlendMode.NORMAL && this._pRequiresBlending)? BlendMode.LAYER : this._renderObjectOwner.blendMode);\n\t}\n}\n\nexport = SkyboxRenderObject;",
    "import Error\t\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\n\nclass AnimationSetError extends Error\n{\n\tconstructor(message:string)\n\t{\n\t\tsuper(message);\n\t}\n}\n\nexport = AnimationSetError;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport Event\t\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport IAnimationState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IAnimationState\");\n\n/**\n * Dispatched to notify changes in an animation state's state.\n */\nclass AnimationStateEvent extends Event\n{\n\t/**\n\t * Dispatched when a non-looping clip node inside an animation state reaches the end of its timeline.\n\t */\n\tpublic static PLAYBACK_COMPLETE:string = \"playbackComplete\";\n\n\tpublic static TRANSITION_COMPLETE:string = \"transitionComplete\";\n\n\tprivate _animator:AnimatorBase;\n\tprivate _animationState:IAnimationState;\n\tprivate _animationNode:AnimationNodeBase;\n\n\t/**\n\t * Create a new <code>AnimatonStateEvent</code>\n\t *\n\t * @param type The event type.\n\t * @param animator The animation state object that is the subject of this event.\n\t * @param animationNode The animation node inside the animation state from which the event originated.\n\t */\n\tconstructor(type:string, animator:AnimatorBase, animationState:IAnimationState, animationNode:AnimationNodeBase)\n\t{\n\t\tsuper(type);\n\n\t\tthis._animator = animator;\n\t\tthis._animationState = animationState;\n\t\tthis._animationNode = animationNode;\n\t}\n\n\t/**\n\t * The animator object that is the subject of this event.\n\t */\n\tpublic get animator():AnimatorBase\n\t{\n\t\treturn this._animator;\n\t}\n\n\t/**\n\t * The animation state object that is the subject of this event.\n\t */\n\tpublic get animationState():IAnimationState\n\t{\n\t\treturn this._animationState;\n\t}\n\n\t/**\n\t * The animation node inside the animation state from which the event originated.\n\t */\n\tpublic get animationNode():AnimationNodeBase\n\t{\n\t\treturn this._animationNode;\n\t}\n\n\t/**\n\t * Clones the event.\n\t *\n\t * @return An exact duplicate of the current object.\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn new AnimationStateEvent(this.type, this._animator, this._animationState, this._animationNode);\n\t}\n}\n\nexport = AnimationStateEvent;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\n/**\n * Dispatched to notify changes in an animator's state.\n */\nclass AnimatorEvent extends Event\n{\n\t/**\n\t * Defines the value of the type property of a start event object.\n\t */\n\tpublic static START:string = \"start\";\n\n\t/**\n\t * Defines the value of the type property of a stop event object.\n\t */\n\tpublic static STOP:string = \"stop\";\n\n\t/**\n\t * Defines the value of the type property of a cycle complete event object.\n\t */\n\tpublic static CYCLE_COMPLETE:string = \"cycle_complete\";\n\n\tprivate _animator:AnimatorBase;\n\n\t/**\n\t * Create a new <code>AnimatorEvent</code> object.\n\t *\n\t * @param type The event type.\n\t * @param animator The animator object that is the subject of this event.\n\t */\n\tconstructor(type:string, animator:AnimatorBase)\n\t{\n\t\tsuper(type);\n\t\tthis._animator = animator;\n\t}\n\n\tpublic get animator():AnimatorBase\n\t{\n\t\treturn this._animator;\n\t}\n\n\t/**\n\t * Clones the event.\n\t *\n\t * @return An exact duplicate of the current event object.\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn new AnimatorEvent(this.type, this._animator);\n\t}\n}\n\nexport = AnimatorEvent;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass ShadingMethodEvent extends Event\n{\n\tpublic static SHADER_INVALIDATED:string = \"ShaderInvalidated\";\n\n\tconstructor(type:string)\n\t{\n\n\t\tsuper(type);\n\n\t}\n}\n\nexport = ShadingMethodEvent;",
    "import Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\n\nimport Filter3DTaskBase\t\t\t\t= require(\"awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase\");\n\nclass Filter3DBase\n{\n\tprivate _tasks:Array<Filter3DTaskBase>;\n\tprivate _requireDepthRender:boolean;\n\tprivate _textureWidth:number;\n\tprivate _textureHeight:number;\n\n\tconstructor()\n\t{\n\t\tthis._tasks = new Array<Filter3DTaskBase>();\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n\tpublic pAddTask(filter:Filter3DTaskBase)\n\t{\n\t\tthis._tasks.push(filter);\n\n\t\tif (this._requireDepthRender == null)\n\t\t\tthis._requireDepthRender = filter.requireDepthRender;\n\t}\n\n\tpublic get tasks():Filter3DTaskBase[]\n\t{\n\t\treturn this._tasks;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\treturn this._tasks[0].getMainInputTexture(stage);\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic set textureWidth(value:number)\n\t{\n\t\tthis._textureWidth = value;\n\n\t\tfor (var i:number = 0; i < this._tasks.length; ++i)\n\t\t\tthis._tasks[i].textureWidth = value;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic set textureHeight(value:number)\n\t{\n\t\tthis._textureHeight = value;\n\n\t\tfor (var i:number = 0; i < this._tasks.length; ++i)\n\t\t\tthis._tasks[i].textureHeight = value;\n\t}\n\n\t// link up the filters correctly with the next filter\n\tpublic setRenderTargets(mainTarget:ITexture, stage:Stage)\n\t{\n\t\tthis._tasks[this._tasks.length - 1].target = mainTarget;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var i:number = 0; i < this._tasks.length; ++i)\n\t\t\tthis._tasks[i].dispose();\n\t}\n\n\tpublic update(stage:Stage, camera:Camera)\n\t{\n\n\t}\n}\n\nexport = Filter3DBase;",
    "import AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport AGALMiniAssembler\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport ContextGLTextureFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IProgram\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\n\nclass Filter3DTaskBase\n{\n\tprivate _mainInputTexture:ITexture;\n\n\tprivate _scaledTextureWidth:number = -1;\n\tprivate _scaledTextureHeight:number = -1;\n\tprivate _textureWidth:number = -1;\n\tprivate _textureHeight:number = -1;\n\tprivate _textureDimensionsInvalid:boolean = true;\n\tprivate _program3DInvalid:boolean = true;\n\tprivate _program3D:IProgram;\n\tprivate _target:ITexture;\n\tprivate _requireDepthRender:boolean;\n\tprivate _textureScale:number = 0;\n\n\tconstructor(requireDepthRender:boolean = false)\n\t{\n\n\t\tthis._requireDepthRender = requireDepthRender;\n\n\t}\n\n\t/**\n\t * The texture scale for the input of this texture. This will define the output of the previous entry in the chain\n\t */\n\tpublic get textureScale():number\n\t{\n\t\treturn this._textureScale;\n\t}\n\n\tpublic set textureScale(value:number)\n\t{\n\t\tif (this._textureScale == value)\n\t\t\treturn;\n\n\t\tthis._textureScale = value;\n\t\tthis._scaledTextureWidth = this._textureWidth >> this._textureScale;\n\t\tthis._scaledTextureHeight = this._textureHeight >> this._textureScale;\n\t\tthis._textureDimensionsInvalid = true;\n\t}\n\n\tpublic get target():ITexture\n\t{\n\t\treturn this._target;\n\t}\n\n\tpublic set target(value:ITexture)\n\t{\n\t\tthis._target = value;\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic set textureWidth(value:number)\n\t{\n\t\tif (this._textureWidth == value)\n\t\t\treturn;\n\n\t\tthis._textureWidth = value;\n\t\tthis._scaledTextureWidth = this._textureWidth >> this._textureScale;\n\t\tthis._textureDimensionsInvalid = true;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic set textureHeight(value:number)\n\t{\n\t\tif (this._textureHeight == value)\n\t\t\treturn;\n\n\t\tthis._textureHeight = value;\n\t\tthis._scaledTextureHeight = this._textureHeight >> this._textureScale;\n\t\tthis._textureDimensionsInvalid = true;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\tif (this._textureDimensionsInvalid)\n\t\t\tthis.pUpdateTextures(stage);\n\n\t\treturn this._mainInputTexture;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tif (this._mainInputTexture)\n\t\t\tthis._mainInputTexture.dispose();\n\n\t\tif (this._program3D)\n\t\t\tthis._program3D.dispose();\n\t}\n\n\tpublic pInvalidateProgram()\n\t{\n\t\tthis._program3DInvalid = true;\n\t}\n\n\tpublic pUpdateProgram(stage:Stage)\n\t{\n\t\tif (this._program3D)\n\t\t\tthis._program3D.dispose();\n\n\t\tthis._program3D = stage.context.createProgram();\n\n\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + this.pGetVertexCode() + \"endpart\"))['vertex'].data;\n\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + this.pGetFragmentCode() + \"endpart\"))['fragment'].data;\n\t\tthis._program3D.upload(vertexByteCode, fragmentByteCode);\n\t\tthis._program3DInvalid = false;\n\t}\n\n\tpublic pGetVertexCode():string\n\t{\n\t\t// TODO: imeplement AGAL <> GLSL\n\n\t\treturn \"mov op, va0\\n\" + \"mov v0, va1\\n\";\n\t}\n\n\tpublic pGetFragmentCode():string\n\t{\n\t\tthrow new AbstractMethodError();\n\n\t\treturn null;\n\t}\n\n\tpublic pUpdateTextures(stage:Stage)\n\t{\n\t\tif (this._mainInputTexture)\n\t\t\tthis._mainInputTexture.dispose();\n\n\t\tthis._mainInputTexture = stage.context.createTexture(this._scaledTextureWidth, this._scaledTextureHeight, ContextGLTextureFormat.BGRA, true);\n\n\t\tthis._textureDimensionsInvalid = false;\n\t}\n\n\tpublic getProgram(stage:Stage):IProgram\n\t{\n\t\tif (this._program3DInvalid)\n\t\t\tthis.pUpdateProgram(stage);\n\n\t\treturn this._program3D;\n\t}\n\n\tpublic activate(stage:Stage, camera:Camera, depthTexture:ITexture)\n\t{\n\t}\n\n\tpublic deactivate(stage:Stage)\n\t{\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n}\n\nexport = Filter3DTaskBase;",
    "import Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ImageUtils\t\t\t\t\t= require(\"awayjs-core/lib/utils/ImageUtils\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nclass RTTBufferManager extends EventDispatcher\n{\n\tprivate static _instances:Array<RTTBufferManagerVO>;\n\n\tprivate _renderToTextureVertexBuffer:IVertexBuffer;\n\tprivate _renderToScreenVertexBuffer:IVertexBuffer;\n\n\tprivate _indexBuffer:IIndexBuffer;\n\tprivate _stage:Stage;\n\tprivate _viewWidth:number = -1;\n\tprivate _viewHeight:number = -1;\n\tprivate _textureWidth:number = -1;\n\tprivate _textureHeight:number = -1;\n\tprivate _renderToTextureRect:Rectangle;\n\tprivate _buffersInvalid:boolean = true;\n\n\tprivate _textureRatioX:number;\n\tprivate _textureRatioY:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper();\n\n\t\tthis._renderToTextureRect = new Rectangle();\n\n\t\tthis._stage = stage;\n\n\t}\n\n\tpublic static getInstance(stage:Stage):RTTBufferManager\n\t{\n\t\tif (!stage)\n\t\t\tthrow new Error(\"stage key cannot be null!\");\n\n\t\tif (RTTBufferManager._instances == null)\n\t\t\tRTTBufferManager._instances = new Array<RTTBufferManagerVO>();\n\n\t\tvar rttBufferManager:RTTBufferManager = RTTBufferManager.getRTTBufferManagerFromStage(stage);\n\n\t\tif (rttBufferManager == null) {\n\t\t\trttBufferManager = new RTTBufferManager(stage);\n\n\t\t\tvar vo:RTTBufferManagerVO = new RTTBufferManagerVO();\n\n\t\t\tvo.stage3d = stage;\n\t\t\tvo.rttbfm = rttBufferManager;\n\n\t\t\tRTTBufferManager._instances.push(vo);\n\t\t}\n\n\t\treturn rttBufferManager;\n\n\t}\n\n\tprivate static getRTTBufferManagerFromStage(stage:Stage):RTTBufferManager\n\t{\n\n\t\tvar l:number = RTTBufferManager._instances.length;\n\t\tvar r:RTTBufferManagerVO;\n\n\t\tfor (var c:number = 0; c < l; c++) {\n\t\t\tr = RTTBufferManager._instances[ c ];\n\n\t\t\tif (r.stage3d === stage)\n\t\t\t\treturn r.rttbfm;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate static deleteRTTBufferManager(stage:Stage):void\n\t{\n\t\tvar l:number = RTTBufferManager._instances.length;\n\t\tvar r:RTTBufferManagerVO;\n\n\t\tfor (var c:number = 0; c < l; c++) {\n\t\t\tr = RTTBufferManager._instances[ c ];\n\n\t\t\tif (r.stage3d === stage) {\n\t\t\t\tRTTBufferManager._instances.splice(c, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get textureRatioX():number\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._textureRatioX;\n\t}\n\n\tpublic get textureRatioY():number\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._textureRatioY;\n\t}\n\n\tpublic get viewWidth():number\n\t{\n\t\treturn this._viewWidth;\n\t}\n\n\tpublic set viewWidth(value:number)\n\t{\n\t\tif (value == this._viewWidth)\n\t\t\treturn;\n\n\t\tthis._viewWidth = value;\n\n\t\tthis._buffersInvalid = true;\n\n\t\tthis._textureWidth = ImageUtils.getBestPowerOf2(this._viewWidth);\n\n\t\tif (this._textureWidth > this._viewWidth) {\n\t\t\tthis._renderToTextureRect.x = Math.floor((this._textureWidth - this._viewWidth)*.5);\n\t\t\tthis._renderToTextureRect.width = this._viewWidth;\n\t\t} else {\n\t\t\tthis._renderToTextureRect.x = 0;\n\t\t\tthis._renderToTextureRect.width = this._textureWidth;\n\t\t}\n\n\t\tthis.dispatchEvent(new Event(Event.RESIZE));\n\t}\n\n\tpublic get viewHeight():number\n\t{\n\t\treturn this._viewHeight;\n\t}\n\n\tpublic set viewHeight(value:number)\n\t{\n\t\tif (value == this._viewHeight)\n\t\t\treturn;\n\n\t\tthis._viewHeight = value;\n\n\t\tthis._buffersInvalid = true;\n\n\t\tthis._textureHeight = ImageUtils.getBestPowerOf2(this._viewHeight);\n\n\t\tif (this._textureHeight > this._viewHeight) {\n\t\t\tthis._renderToTextureRect.y = Math.floor((this._textureHeight - this._viewHeight)*.5);\n\t\t\tthis._renderToTextureRect.height = this._viewHeight;\n\t\t} else {\n\t\t\tthis._renderToTextureRect.y = 0;\n\t\t\tthis._renderToTextureRect.height = this._textureHeight;\n\t\t}\n\n\t\tthis.dispatchEvent(new Event(Event.RESIZE));\n\t}\n\n\tpublic get renderToTextureVertexBuffer():IVertexBuffer\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToTextureVertexBuffer;\n\t}\n\n\tpublic get renderToScreenVertexBuffer():IVertexBuffer\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToScreenVertexBuffer;\n\n\t}\n\n\tpublic get indexBuffer():IIndexBuffer\n\t{\n\t\treturn this._indexBuffer;\n\t}\n\n\tpublic get renderToTextureRect():Rectangle\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToTextureRect;\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tRTTBufferManager.deleteRTTBufferManager(this._stage);\n\n\t\tif (this._indexBuffer) {\n\t\t\tthis._indexBuffer.dispose();\n\t\t\tthis._renderToScreenVertexBuffer.dispose();\n\t\t\tthis._renderToTextureVertexBuffer.dispose();\n\t\t\tthis._renderToScreenVertexBuffer = null;\n\t\t\tthis._renderToTextureVertexBuffer = null;\n\t\t\tthis._indexBuffer = null;\n\t\t}\n\t}\n\n\t// todo: place all this in a separate model, since it's used all over the place\n\t// maybe it even has a place in the core (together with screenRect etc)?\n\t// needs to be stored per view of course\n\tprivate updateRTTBuffers()\n\t{\n\t\tvar context:IContextGL = this._stage.context;\n\t\tvar textureVerts:number[];\n\t\tvar screenVerts:number[];\n\n\t\tvar x:number;\n\t\tvar y:number;\n\n\t\tif (this._renderToTextureVertexBuffer == null)\n\t\t\tthis._renderToTextureVertexBuffer = context.createVertexBuffer(4, 5);\n\n\t\tif (this._renderToScreenVertexBuffer == null)\n\t\t\tthis._renderToScreenVertexBuffer = context.createVertexBuffer(4, 5);\n\n\t\tif (!this._indexBuffer) {\n\t\t\tthis._indexBuffer = context.createIndexBuffer(6);\n\n\t\t\tthis._indexBuffer.uploadFromArray([2, 1, 0, 3, 2, 0], 0, 6);\n\t\t}\n\n\t\tthis._textureRatioX = x = Math.min(this._viewWidth/this._textureWidth, 1);\n\t\tthis._textureRatioY = y = Math.min(this._viewHeight/this._textureHeight, 1);\n\n\t\tvar u1:number = (1 - x)*.5;\n\t\tvar u2:number = (x + 1)*.5;\n\t\tvar v1:number = (y + 1)*.5;\n\t\tvar v2:number = (1 - y)*.5;\n\n\t\t// last element contains indices for data per vertex that can be passed to the vertex shader if necessary (ie: frustum corners for deferred rendering)\n\t\ttextureVerts = [    -x, -y, u1, v1, 0, x, -y, u2, v1, 1, x, y, u2, v2, 2, -x, y, u1, v2, 3 ];\n\n\t\tscreenVerts = [     -1, -1, u1, v1, 0, 1, -1, u2, v1, 1, 1, 1, u2, v2, 2, -1, 1, u1, v2, 3 ];\n\n\t\tthis._renderToTextureVertexBuffer.uploadFromArray(textureVerts, 0, 4);\n\t\tthis._renderToScreenVertexBuffer.uploadFromArray(screenVerts, 0, 4);\n\n\t\tthis._buffersInvalid = false;\n\t}\n}\n\nexport = RTTBufferManager;\n\nclass RTTBufferManagerVO\n{\n\tpublic stage3d:Stage;\n\n\tpublic rttbfm:RTTBufferManager;\n}",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n\n/**\n * BasicMaterialPass forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass BasicMaterialPass extends RenderPassBase\n{\n\tprivate _diffuseR:number = 1;\n\tprivate _diffuseG:number = 1;\n\tprivate _diffuseB:number = 1;\n\tprivate _diffuseA:number = 1;\n\n\tprivate _fragmentConstantsIndex:number;\n\n\tconstructor(renderObject:RenderObjectBase, renderObjectOwner:IRenderObjectOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(renderObject, renderObjectOwner, renderableClass, stage);\n\n\t\tthis._shader = new ShaderObjectBase(renderableClass, this, this._stage);\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tsuper._iIncludeDependencies(shaderObject);\n\n\t\tif (shaderObject.texture != null)\n\t\t\tshaderObject.uvDependencies++;\n    }\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n        var alphaReg:ShaderRegisterElement;\n\n        if (this.preserveAlpha) {\n            alphaReg = regCache.getFreeFragmentSingleTemp();\n            regCache.addFragmentTempUsages(alphaReg, 1);\n            code += \"mov \" + alphaReg + \", \" + sharedReg.shadedTarget + \".w\\n\";\n        }\n\n\t\tvar targetReg:ShaderRegisterElement = sharedReg.shadedTarget;\n\n\t\tif (shaderObject.texture != null) {\n\n\t\t\tshaderObject.texture._iInitRegisters(shaderObject, regCache);\n\n\t\t\tcode += shaderObject.texture._iGetFragmentCode(shaderObject, targetReg, regCache, sharedReg.uvVarying);\n\n\t\t\tif (shaderObject.alphaThreshold > 0) {\n\t\t\t\tvar cutOffReg:ShaderRegisterElement = regCache.getFreeFragmentConstant();\n\t\t\t\tthis._fragmentConstantsIndex = cutOffReg.index*4;\n\n\t\t\t\tcode += \"sub \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\" + \"kil \" + targetReg + \".w\\n\" + \"add \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\";\n\t\t\t}\n\t\t} else if (shaderObject.colorBufferIndex != -1) {\n\n\t\t\tcode += \"mov \" + targetReg + \", \" + sharedReg.colorVarying + \"\\n\";\n\t\t} else {\n\t\t\tvar diffuseInputReg:ShaderRegisterElement = regCache.getFreeFragmentConstant();\n\n\t\t\tthis._fragmentConstantsIndex = diffuseInputReg.index*4;\n\n\t\t\tcode += \"mov \" + targetReg + \", \" + diffuseInputReg + \"\\n\";\n\t\t}\n\n        if (this.preserveAlpha) {\n            code += \"mul \" + sharedReg.shadedTarget + \".w, \" + sharedReg.shadedTarget + \".w, \" + alphaReg + \"\\n\";\n            regCache.removeFragmentTempUsage(alphaReg);\n        }\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tif (this._shader.texture != null) {\n\t\t\tthis._shader.texture.activate(this._shader);\n\n\t\t\tif (this._shader.alphaThreshold > 0)\n\t\t\t\tthis._shader.fragmentConstantData[this._fragmentConstantsIndex] = this._shader.alphaThreshold;\n\t\t} else if (this._shader.colorBufferIndex == -1) {\n\t\t\tvar index:number = this._fragmentConstantsIndex;\n\t\t\tvar data:Array<number> = this._shader.fragmentConstantData;\n\t\t\tdata[index] = this._diffuseR;\n\t\t\tdata[index + 1] = this._diffuseG;\n\t\t\tdata[index + 2] = this._diffuseB;\n\t\t\tdata[index + 3] = this._diffuseA;\n\t\t}\n\t}\n}\n\nexport = BasicMaterialPass;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * DepthRenderObject forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass DepthPass extends RenderPassBase\n{\n\n\tprivate _fragmentConstantsIndex:number;\n\n\tconstructor(renderObject:RenderObjectBase, renderObjectOwner:IRenderObjectOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(renderObject, renderObjectOwner, renderableClass, stage);\n\n\t\tthis._shader = new ShaderObjectBase(renderableClass, this, this._stage);\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tsuper._iIncludeDependencies(shaderObject);\n\n\t\tshaderObject.projectionDependencies++;\n\n\t\tif (shaderObject.alphaThreshold > 0)\n\t\t\tshaderObject.uvDependencies++;\n\t}\n\n\n\tpublic _iInitConstantData(shaderObject:ShaderObjectBase)\n\t{\n\t\tsuper._iInitConstantData(shaderObject);\n\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\tdata[index] = 1.0;\n\t\tdata[index + 1] = 255.0;\n\t\tdata[index + 2] = 65025.0;\n\t\tdata[index + 3] = 16581375.0;\n\t\tdata[index + 4] = 1.0/255.0;\n\t\tdata[index + 5] = 1.0/255.0;\n\t\tdata[index + 6] = 1.0/255.0;\n\t\tdata[index + 7] = 0.0;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar targetReg:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\t\tvar diffuseInputReg:ShaderRegisterElement = registerCache.getFreeTextureReg();\n\t\tvar dataReg1:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tvar dataReg2:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\tthis._fragmentConstantsIndex = dataReg1.index*4;\n\n\t\tvar temp1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp1, 1);\n\t\tvar temp2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp2, 1);\n\n\t\tcode += \"div \" + temp1 + \", \" + sharedRegisters.projectionFragment + \", \" + sharedRegisters.projectionFragment + \".w\\n\" + //\"sub ft2.z, fc0.x, ft2.z\\n\" +    //invert\n\t\t\"mul \" + temp1 + \", \" + dataReg1 + \", \" + temp1 + \".z\\n\" +\n\t\t\"frc \" + temp1 + \", \" + temp1 + \"\\n\" +\n\t\t\"mul \" + temp2 + \", \" + temp1 + \".yzww, \" + dataReg2 + \"\\n\";\n\n\t\t//codeF += \"mov ft1.w, fc1.w\t\\n\" +\n\t\t//    \"mov ft0.w, fc0.x\t\\n\";\n\n\t\tif (shaderObject.texture && shaderObject.alphaThreshold > 0) {\n\n\t\t\tshaderObject.texture._iInitRegisters(shaderObject, registerCache);\n\n\t\t\tvar albedo:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\t\tcode += shaderObject.texture._iGetFragmentCode(shaderObject, albedo, registerCache, sharedRegisters.uvVarying);\n\n\t\t\tvar cutOffReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\t\tcode += \"sub \" + albedo + \".w, \" + albedo + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\"kil \" + albedo + \".w\\n\";\n\t\t}\n\n\t\tcode += \"sub \" + targetReg + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\tregisterCache.removeFragmentTempUsage(temp1);\n\t\tregisterCache.removeFragmentTempUsage(temp2);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tvar context:IContextGL = this._stage.context;\n\n\t\tif (this._shader.texture && this._shader.alphaThreshold > 0) {\n\t\t\tthis._shader.texture.activate(this._shader);\n\n\t\t\tthis._shader.fragmentConstantData[this._fragmentConstantsIndex + 8] = this._shader.alphaThreshold;\n\t\t}\n\t}\n\n}\n\nexport = DepthPass;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * DistancePass is a pass that writes distance values to a depth map as a 32-bit value exploded over the 4 texture channels.\n * This is used to render omnidirectional shadow maps.\n */\nclass DistancePass extends RenderPassBase\n{\n\tprivate _fragmentConstantsIndex:number;\n\n\t/**\n\t * Creates a new DistancePass object.\n\t *\n\t * @param material The material to which this pass belongs.\n\t */\n\tconstructor(renderObject:RenderObjectBase, renderObjectOwner:IRenderObjectOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(renderObject, renderObjectOwner, renderableClass, stage);\n\n\t\tthis._shader = new ShaderObjectBase(renderableClass, this, this._stage);\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this material.\n\t */\n\tpublic _iInitConstantData(shaderObject:ShaderObjectBase)\n\t{\n\t\tsuper._iInitConstantData(shaderObject);\n\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\tdata[index + 4] = 1.0/255.0;\n\t\tdata[index + 5] = 1.0/255.0;\n\t\tdata[index + 6] = 1.0/255.0;\n\t\tdata[index + 7] = 0.0;\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tsuper._iIncludeDependencies(shaderObject);\n\n\t\tshaderObject.projectionDependencies++;\n\t\tshaderObject.viewDirDependencies++;\n\n\t\tif (shaderObject.alphaThreshold > 0)\n\t\t\tshaderObject.uvDependencies++;\n\n\t\tif (shaderObject.viewDirDependencies > 0)\n\t\t\tshaderObject.globalPosDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string;\n\t\tvar targetReg:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\t\tvar dataReg1:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tvar dataReg2:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\tthis._fragmentConstantsIndex = dataReg1.index*4;\n\n\t\tvar temp1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp1, 1);\n\t\tvar temp2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp2, 1);\n\n\t\t// squared distance to view\n\t\tcode = \"dp3 \" + temp1 + \".z, \" + sharedRegisters.viewDirVarying + \".xyz, \" + sharedRegisters.viewDirVarying + \".xyz\\n\" +\n\t\t\t   \"mul \" + temp1 + \", \" + dataReg1 + \", \" + temp1 + \".z\\n\" +\n\t\t\t   \"frc \" + temp1 + \", \" + temp1 + \"\\n\" +\n\t\t\t   \"mul \" + temp2 + \", \" + temp1 + \".yzww, \" + dataReg2 + \"\\n\";\n\n\t\tif (shaderObject.alphaThreshold > 0) {\n\t\t\tshaderObject.texture._iInitRegisters(shaderObject, registerCache);\n\n\t\t\tvar albedo:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\t\tcode += shaderObject.texture._iGetFragmentCode(shaderObject, albedo, registerCache, sharedRegisters.uvVarying);\n\n\t\t\tvar cutOffReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\t\tcode += \"sub \" + albedo + \".w, \" + albedo + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\t\"kil \" + albedo + \".w\\n\";\n\t\t}\n\n\t\tcode += \"sub \" + targetReg + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tvar context:IContextGL = this._stage.context;\n\n\t\tvar f:number = camera.projection.far;\n\n\t\tf = 1/(2*f*f);\n\t\t// sqrt(f*f+f*f) is largest possible distance for any frustum, so we need to divide by it. Rarely a tight fit, but with 32 bits precision, it's enough.\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = this._shader.fragmentConstantData;\n\t\tdata[index] = 1.0*f;\n\t\tdata[index + 1] = 255.0*f;\n\t\tdata[index + 2] = 65025.0*f;\n\t\tdata[index + 3] = 16581375.0*f;\n\n\t\tif (this._shader.alphaThreshold > 0) {\n\t\t\tthis._shader.texture.activate(this._shader);\n\n\t\t\tdata[index + 8] = this._shader.alphaThreshold;\n\t\t}\n\t}\n}\n\nexport = DistancePass;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\")\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\n\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport IRenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/IRenderPassBase\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\n\n/**\n * RenderPassBase provides an abstract base class for material shader passes. A material pass constitutes at least\n * a render call per required renderable.\n */\nclass RenderPassBase extends EventDispatcher implements IRenderPassBase\n{\n\tprivate _renderObject:RenderObjectBase;\n\tpublic _renderObjectOwner:IRenderObjectOwner;\n\tpublic _renderableClass:IRenderableClass;\n\tpublic _stage:Stage;\n\t\n\tpublic _shader:ShaderObjectBase;\n\n\tprivate _preserveAlpha:boolean = true;\n\tprivate _forceSeparateMVP:boolean = false;\n\n\tprivate _depthCompareMode:string = ContextGLCompareMode.LESS_EQUAL;\n\n\tprivate _blendFactorSource:string = ContextGLBlendFactor.ONE;\n\tprivate _blendFactorDest:string = ContextGLBlendFactor.ZERO;\n\n\tpublic _pEnableBlending:boolean = false;\n\n\tprivate _writeDepth:boolean = true;\n\n\tpublic get shader():ShaderObjectBase\n\t{\n\t\treturn this._shader;\n\t}\n\n\tpublic get animationSet():AnimationSetBase\n\t{\n\t\treturn <AnimationSetBase> this._renderObjectOwner.animationSet;\n\t}\n\n\t/**\n\t * Indicates whether the output alpha value should remain unchanged compared to the material's original alpha.\n\t */\n\tpublic get preserveAlpha():boolean\n\t{\n\t\treturn this._preserveAlpha;\n\t}\n\n\tpublic set preserveAlpha(value:boolean)\n\t{\n\t\tif (this._preserveAlpha == value)\n\t\t\treturn;\n\n\t\tthis._preserveAlpha = value;\n\n\t\tthis.invalidatePass();\n\t}\n\n\t/**\n\t * Indicates whether the screen projection should be calculated by forcing a separate scene matrix and\n\t * view-projection matrix. This is used to prevent rounding errors when using multiple passes with different\n\t * projection code.\n\t */\n\tpublic get forceSeparateMVP():boolean\n\t{\n\t\treturn this._forceSeparateMVP;\n\t}\n\n\tpublic set forceSeparateMVP(value:boolean)\n\t{\n\t\tif (this._forceSeparateMVP == value)\n\t\t\treturn;\n\n\t\tthis._forceSeparateMVP = value;\n\n\t\tthis.invalidatePass();\n\t}\n\n\t/**\n\t * Creates a new RenderPassBase object.\n\t */\n\tconstructor(renderObject:RenderObjectBase, renderObjectOwner:IRenderObjectOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper();\n\n\t\tthis._renderObject = renderObject;\n\t\tthis._renderObjectOwner = renderObjectOwner;\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\t}\n\t\n\n\t/**\n\t * Indicate whether this pass should write to the depth buffer or not. Ignored when blending is enabled.\n\t */\n\tpublic get writeDepth():boolean\n\t{\n\t\treturn this._writeDepth;\n\t}\n\n\tpublic set writeDepth(value:boolean)\n\t{\n\t\tthis._writeDepth = value;\n\t}\n\n\t/**\n\t * The depth compare mode used to render the renderables using this material.\n\t *\n\t * @see away.stagegl.ContextGLCompareMode\n\t */\n\tpublic get depthCompareMode():string\n\t{\n\t\treturn this._depthCompareMode;\n\t}\n\n\tpublic set depthCompareMode(value:string)\n\t{\n\t\tthis._depthCompareMode = value;\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t * @param deep Indicates whether other resources should be cleaned up, that could potentially be shared across different instances.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._shader.dispose();\n\n\t\tthis._shader = null;\n\t}\n\n\t/**\n\t * Renders the current pass. Before calling renderPass, activatePass needs to be called with the same index.\n\t * @param pass The pass used to render the renderable.\n\t * @param renderable The IRenderable object to draw.\n\t * @param stage The Stage object used for rendering.\n\t * @param entityCollector The EntityCollector object that contains the visible scene data.\n\t * @param viewProjection The view-projection matrix used to project to the screen. This is not the same as\n\t * camera.viewProjection as it includes the scaling factors when rendering to textures.\n\t *\n\t * @internal\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tthis._shader._iRender(renderable, camera, viewProjection);\n\t}\n\t/**\n\t * The blend mode to use when drawing this renderable. The following blend modes are supported:\n\t * <ul>\n\t * <li>BlendMode.NORMAL: No blending, unless the material inherently needs it</li>\n\t * <li>BlendMode.LAYER: Force blending. This will draw the object the same as NORMAL, but without writing depth writes.</li>\n\t * <li>BlendMode.MULTIPLY</li>\n\t * <li>BlendMode.ADD</li>\n\t * <li>BlendMode.ALPHA</li>\n\t * </ul>\n\t */\n\tpublic setBlendMode(value:string)\n\t{\n\t\tswitch (value) {\n\t\t\tcase BlendMode.NORMAL:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ONE;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._pEnableBlending = false;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.LAYER:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ONE_MINUS_SOURCE_ALPHA;\n\t\t\t\tthis._pEnableBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.MULTIPLY:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.SOURCE_COLOR;\n\t\t\t\tthis._pEnableBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.ADD:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ONE;\n\t\t\t\tthis._pEnableBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.ALPHA:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._pEnableBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new ArgumentError(\"Unsupported blend mode!\");\n\t\t}\n\t}\n\n\t/**\n\t * Sets the render state for the pass that is independent of the rendered object. This needs to be called before\n\t * calling renderPass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tthis._stage.context.setDepthTest(( this._writeDepth && !this._pEnableBlending ), this._depthCompareMode);\n\n\t\tif (this._pEnableBlending)\n\t\t\tthis._stage.context.setBlendFactors(this._blendFactorSource, this._blendFactorDest);\n\n\t\tthis._shader._iActivate(camera);\n\t}\n\n\t/**\n\t * Clears the render state for the pass. This needs to be called before activating another pass.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @private\n\t */\n\tpublic _iDeactivate()\n\t{\n\t\tthis._shader._iDeactivate();\n\n\t\t//For the love of god don't remove this if you want your multi-material shadows to not flicker like shit\n\t\tthis._stage.context.setDepthTest(true, ContextGLCompareMode.LESS_EQUAL);\n\t}\n\n\t/**\n\t * Marks the shader program as invalid, so it will be recompiled before the next render.\n\t *\n\t * @param updateMaterial Indicates whether the invalidation should be performed on the entire material. Should always pass \"true\" unless it's called from the material itself.\n\t */\n\tpublic invalidatePass()\n\t{\n\t\tthis._shader.invalidateShader();\n\n\t\tthis.dispatchEvent(new Event(Event.CHANGE));\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tthis._renderObject._iIncludeDependencies(shaderObject);\n\t\t\n\t\tif (this._forceSeparateMVP)\n\t\t\tshaderObject.globalPosDependencies++;\n\t}\n\n\n\tpublic _iInitConstantData(shaderObject:ShaderObjectBase)\n\t{\n\n\t}\n\n\tpublic _iGetPreLightingVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetPreLightingFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Indicates whether or not normals are calculated at all.\n\t */\n\tpublic _pOutputsNormals(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * Indicates whether or not normals are calculated in tangent space.\n\t */\n\tpublic _pOutputsTangentNormals(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * Indicates whether or not normals are allowed in tangent space. This is only the case if no object-space\n\t * dependencies exist.\n\t */\n\tpublic _pUsesTangentSpace(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\treturn false;\n\t}\n}\n\nexport = RenderPassBase;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\n\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport TextureObjectBase\t\t\t= require(\"awayjs-renderergl/lib/pool/TextureObjectBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\n\n/**\n * SkyboxPass forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass SkyboxPass extends RenderPassBase\n{\n\tpublic _skybox:Skybox;\n\tpublic _cubeTexture:TextureObjectBase;\n\n\tconstructor(renderObject:RenderObjectBase, renderObjectOwner:IRenderObjectOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(renderObject, renderObjectOwner, renderableClass, stage);\n\n\t\tthis._skybox = <Skybox> renderObjectOwner;\n\n\t\tthis._shader = new ShaderObjectBase(renderableClass, this, this._stage);\n\n\t\tthis._cubeTexture = this._shader.getTextureObject(this._skybox.cubeMap);\n\t}\n\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tsuper._iIncludeDependencies(shaderObject);\n\n\t\tshaderObject.usesLocalPosFragment = true;\n\t}\n\n\t/**\n\t* @inheritDoc\n\t*/\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tthis._cubeTexture._iInitRegisters(shaderObject, registerCache);\n\n\t\treturn this._cubeTexture._iGetFragmentCode(shaderObject, sharedRegisters.shadedTarget, registerCache, sharedRegisters.localPositionVarying);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setDepthTest(false, ContextGLCompareMode.LESS);\n\t\tthis._cubeTexture.activate(this._shader);\n\t}\n}\n\nexport = SkyboxPass;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport PickingCollisionVO\t\t\t\t= require(\"awayjs-display/lib/pick/PickingCollisionVO\");\nimport IPickingCollider\t\t\t\t\t= require(\"awayjs-display/lib/pick/IPickingCollider\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport PickingColliderBase\t\t\t\t= require(\"awayjs-renderergl/lib/pick/PickingColliderBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * Pure JS picking collider for display objects. Used with the <code>RaycastPicker</code> picking object.\n *\n * @see away.base.DisplayObject#pickingCollider\n * @see away.pick.RaycastPicker\n *\n * @class away.pick.JSPickingCollider\n */\nclass JSPickingCollider extends PickingColliderBase implements IPickingCollider\n{\n\tprivate _findClosestCollision:boolean;\n\n\t/**\n\t * Creates a new <code>JSPickingCollider</code> object.\n\t *\n\t * @param findClosestCollision Determines whether the picking collider searches for the closest collision along the ray. Defaults to false.\n\t */\n\tconstructor(stage:Stage, findClosestCollision:boolean = false)\n\t{\n\t\tsuper(stage);\n\n\t\tthis._findClosestCollision = findClosestCollision;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pTestRenderableCollision(renderable:RenderableBase, pickingCollisionVO:PickingCollisionVO, shortestCollisionDistance:number):boolean\n\t{\n\t\tvar t:number;\n\t\tvar i0:number, i1:number, i2:number;\n\t\tvar rx:number, ry:number, rz:number;\n\t\tvar nx:number, ny:number, nz:number;\n\t\tvar cx:number, cy:number, cz:number;\n\t\tvar coeff:number, u:number, v:number, w:number;\n\t\tvar p0x:number, p0y:number, p0z:number;\n\t\tvar p1x:number, p1y:number, p1z:number;\n\t\tvar p2x:number, p2y:number, p2z:number;\n\t\tvar s0x:number, s0y:number, s0z:number;\n\t\tvar s1x:number, s1y:number, s1z:number;\n\t\tvar nl:number, nDotV:number, D:number, disToPlane:number;\n\t\tvar Q1Q2:number, Q1Q1:number, Q2Q2:number, RQ1:number, RQ2:number;\n\t\tvar indexData:Array<number> = renderable.getIndexData().data;\n\t\tvar collisionTriangleIndex:number = -1;\n\t\tvar bothSides:boolean = (<MaterialBase> renderable.renderObjectOwner).bothSides;\n\n\t\tvar positionData:Array<number> = renderable.getVertexData(TriangleSubGeometry.POSITION_DATA).data;\n\t\tvar positionStride:number = renderable.getVertexData(TriangleSubGeometry.POSITION_DATA).dataPerVertex;\n\t\tvar positionOffset:number = renderable.getVertexOffset(TriangleSubGeometry.POSITION_DATA);\n\t\tvar uvData:Array<number> = renderable.getVertexData(TriangleSubGeometry.UV_DATA).data;\n\t\tvar uvStride:number = renderable.getVertexData(TriangleSubGeometry.UV_DATA).dataPerVertex;\n\t\tvar uvOffset:number = renderable.getVertexOffset(TriangleSubGeometry.UV_DATA);\n\t\tvar numIndices:number = indexData.length;\n\n\t\tfor (var index:number = 0; index < numIndices; index += 3) { // sweep all triangles\n\t\t\t// evaluate triangle indices\n\t\t\ti0 = positionOffset + indexData[ index ]*positionStride;\n\t\t\ti1 = positionOffset + indexData[ (index + 1) ]*positionStride;\n\t\t\ti2 = positionOffset + indexData[ (index + 2) ]*positionStride;\n\n\t\t\t// evaluate triangle positions\n\t\t\tp0x = positionData[ i0 ];\n\t\t\tp0y = positionData[ (i0 + 1) ];\n\t\t\tp0z = positionData[ (i0 + 2) ];\n\t\t\tp1x = positionData[ i1 ];\n\t\t\tp1y = positionData[ (i1 + 1) ];\n\t\t\tp1z = positionData[ (i1 + 2) ];\n\t\t\tp2x = positionData[ i2 ];\n\t\t\tp2y = positionData[ (i2 + 1) ];\n\t\t\tp2z = positionData[ (i2 + 2) ];\n\n\t\t\t// evaluate sides and triangle normal\n\t\t\ts0x = p1x - p0x; // s0 = p1 - p0\n\t\t\ts0y = p1y - p0y;\n\t\t\ts0z = p1z - p0z;\n\t\t\ts1x = p2x - p0x; // s1 = p2 - p0\n\t\t\ts1y = p2y - p0y;\n\t\t\ts1z = p2z - p0z;\n\t\t\tnx = s0y*s1z - s0z*s1y; // n = s0 x s1\n\t\t\tny = s0z*s1x - s0x*s1z;\n\t\t\tnz = s0x*s1y - s0y*s1x;\n\t\t\tnl = 1/Math.sqrt(nx*nx + ny*ny + nz*nz); // normalize n\n\t\t\tnx *= nl;\n\t\t\tny *= nl;\n\t\t\tnz *= nl;\n\n\t\t\t// -- plane intersection test --\n\t\t\tnDotV = nx*this.rayDirection.x + ny* +this.rayDirection.y + nz*this.rayDirection.z; // rayDirection . normal\n\t\t\tif (( !bothSides && nDotV < 0.0 ) || ( bothSides && nDotV != 0.0 )) { // an intersection must exist\n\t\t\t\t// find collision t\n\t\t\t\tD = -( nx*p0x + ny*p0y + nz*p0z );\n\t\t\t\tdisToPlane = -( nx*this.rayPosition.x + ny*this.rayPosition.y + nz*this.rayPosition.z + D );\n\t\t\t\tt = disToPlane/nDotV;\n\t\t\t\t// find collision point\n\t\t\t\tcx = this.rayPosition.x + t*this.rayDirection.x;\n\t\t\t\tcy = this.rayPosition.y + t*this.rayDirection.y;\n\t\t\t\tcz = this.rayPosition.z + t*this.rayDirection.z;\n\t\t\t\t// collision point inside triangle? ( using barycentric coordinates )\n\t\t\t\tQ1Q2 = s0x*s1x + s0y*s1y + s0z*s1z;\n\t\t\t\tQ1Q1 = s0x*s0x + s0y*s0y + s0z*s0z;\n\t\t\t\tQ2Q2 = s1x*s1x + s1y*s1y + s1z*s1z;\n\t\t\t\trx = cx - p0x;\n\t\t\t\try = cy - p0y;\n\t\t\t\trz = cz - p0z;\n\t\t\t\tRQ1 = rx*s0x + ry*s0y + rz*s0z;\n\t\t\t\tRQ2 = rx*s1x + ry*s1y + rz*s1z;\n\t\t\t\tcoeff = 1/( Q1Q1*Q2Q2 - Q1Q2*Q1Q2 );\n\t\t\t\tv = coeff*( Q2Q2*RQ1 - Q1Q2*RQ2 );\n\t\t\t\tw = coeff*( -Q1Q2*RQ1 + Q1Q1*RQ2 );\n\t\t\t\tif (v < 0)\n\t\t\t\t\tcontinue;\n\t\t\t\tif (w < 0)\n\t\t\t\t\tcontinue;\n\t\t\t\tu = 1 - v - w;\n\t\t\t\tif (!( u < 0 ) && t > 0 && t < shortestCollisionDistance) { // all tests passed\n\t\t\t\t\tshortestCollisionDistance = t;\n\t\t\t\t\tcollisionTriangleIndex = index/3;\n\t\t\t\t\tpickingCollisionVO.rayEntryDistance = t;\n\t\t\t\t\tpickingCollisionVO.localPosition = new Vector3D(cx, cy, cz);\n\t\t\t\t\tpickingCollisionVO.localNormal = new Vector3D(nx, ny, nz);\n\t\t\t\t\tpickingCollisionVO.uv = this._pGetCollisionUV(indexData, uvData, index, v, w, u, uvOffset, uvStride);\n\t\t\t\t\tpickingCollisionVO.index = index;\n//\t\t\t\t\t\tpickingCollisionVO.subGeometryIndex = this.pGetMeshSubMeshIndex(renderable);\n\n\t\t\t\t\t// if not looking for best hit, first found will do...\n\t\t\t\t\tif (!this._findClosestCollision)\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tif (collisionTriangleIndex >= 0)\n\t\t\treturn true;\n\n\t\treturn false;\n\t}\n}\n\nexport = JSPickingCollider;",
    "import Point\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AbstractMethodError\t\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport PickingCollisionVO\t\t\t\t= require(\"awayjs-display/lib/pick/PickingCollisionVO\");\nimport Billboard\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport BillboardRenderable\t\t\t\t= require(\"awayjs-renderergl/lib/pool/BillboardRenderable\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/pool/TriangleSubMeshRenderable\");\nimport RenderablePoolBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\n\n/**\n * An abstract base class for all picking collider classes. It should not be instantiated directly.\n *\n * @class away.pick.PickingColliderBase\n */\nclass PickingColliderBase\n{\n\tprivate _billboardRenderablePool:RenderablePoolBase;\n\tprivate _subMeshRenderablePool:RenderablePoolBase;\n\n\tpublic rayPosition:Vector3D;\n\tpublic rayDirection:Vector3D;\n\n\tconstructor(stage:Stage)\n\t{\n\t\t//TODO\n\t\tthis._billboardRenderablePool = RenderablePoolBase.getPool(BillboardRenderable, stage);\n\t\tthis._subMeshRenderablePool = RenderablePoolBase.getPool(TriangleSubMeshRenderable, stage);\n\t}\n\n\tpublic _pPetCollisionNormal(indexData:Array<number> /*uint*/, vertexData:Array<number>, triangleIndex:number):Vector3D // PROTECTED\n\t{\n\t\tvar normal:Vector3D = new Vector3D();\n\t\tvar i0:number = indexData[ triangleIndex ]*3;\n\t\tvar i1:number = indexData[ triangleIndex + 1 ]*3;\n\t\tvar i2:number = indexData[ triangleIndex + 2 ]*3;\n\t\tvar p0:Vector3D = new Vector3D(vertexData[ i0 ], vertexData[ i0 + 1 ], vertexData[ i0 + 2 ]);\n\t\tvar p1:Vector3D = new Vector3D(vertexData[ i1 ], vertexData[ i1 + 1 ], vertexData[ i1 + 2 ]);\n\t\tvar p2:Vector3D = new Vector3D(vertexData[ i2 ], vertexData[ i2 + 1 ], vertexData[ i2 + 2 ]);\n\t\tvar side0:Vector3D = p1.subtract(p0);\n\t\tvar side1:Vector3D = p2.subtract(p0);\n\t\tnormal = side0.crossProduct(side1);\n\t\tnormal.normalize();\n\t\treturn normal;\n\t}\n\n\tpublic _pGetCollisionUV(indexData:Array<number> /*uint*/, uvData:Array<number>, triangleIndex:number, v:number, w:number, u:number, uvOffset:number, uvStride:number):Point // PROTECTED\n\t{\n\t\tvar uv:Point = new Point();\n\t\tvar uIndex:number = indexData[ triangleIndex ]*uvStride + uvOffset;\n\t\tvar uv0:Vector3D = new Vector3D(uvData[ uIndex ], uvData[ uIndex + 1 ]);\n\t\tuIndex = indexData[ triangleIndex + 1 ]*uvStride + uvOffset;\n\t\tvar uv1:Vector3D = new Vector3D(uvData[ uIndex ], uvData[ uIndex + 1 ]);\n\t\tuIndex = indexData[ triangleIndex + 2 ]*uvStride + uvOffset;\n\t\tvar uv2:Vector3D = new Vector3D(uvData[ uIndex ], uvData[ uIndex + 1 ]);\n\t\tuv.x = u*uv0.x + v*uv1.x + w*uv2.x;\n\t\tuv.y = u*uv0.y + v*uv1.y + w*uv2.y;\n\t\treturn uv;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pTestRenderableCollision(renderable:RenderableBase, pickingCollisionVO:PickingCollisionVO, shortestCollisionDistance:number):boolean\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setLocalRay(localPosition:Vector3D, localDirection:Vector3D)\n\t{\n\t\tthis.rayPosition = localPosition;\n\t\tthis.rayDirection = localDirection;\n\t}\n\n\t/**\n\t * Tests a <code>Billboard</code> object for a collision with the picking ray.\n\t *\n\t * @param billboard The billboard instance to be tested.\n\t * @param pickingCollisionVO The collision object used to store the collision results\n\t * @param shortestCollisionDistance The current value of the shortest distance to a detected collision along the ray.\n\t * @param findClosest\n\t */\n\tpublic testBillboardCollision(billboard:Billboard, pickingCollisionVO:PickingCollisionVO, shortestCollisionDistance:number)\n\t{\n\t\tthis.setLocalRay(pickingCollisionVO.localRayPosition, pickingCollisionVO.localRayDirection);\n\t\tpickingCollisionVO.renderableOwner = null;\n\n\t\tif (this._pTestRenderableCollision(<RenderableBase> this._billboardRenderablePool.getItem(billboard), pickingCollisionVO, shortestCollisionDistance)) {\n\t\t\tshortestCollisionDistance = pickingCollisionVO.rayEntryDistance;\n\n\t\t\tpickingCollisionVO.renderableOwner = billboard;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Tests a <code>Mesh</code> object for a collision with the picking ray.\n\t *\n\t * @param mesh The mesh instance to be tested.\n\t * @param pickingCollisionVO The collision object used to store the collision results\n\t * @param shortestCollisionDistance The current value of the shortest distance to a detected collision along the ray.\n\t * @param findClosest\n\t */\n\tpublic testMeshCollision(mesh:Mesh, pickingCollisionVO:PickingCollisionVO, shortestCollisionDistance:number, findClosest:boolean):boolean\n\t{\n\t\tthis.setLocalRay(pickingCollisionVO.localRayPosition, pickingCollisionVO.localRayDirection);\n\t\tpickingCollisionVO.renderableOwner = null;\n\n\t\tvar subMesh:ISubMesh;\n\n\t\tvar len:number = mesh.subMeshes.length;\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tsubMesh = mesh.subMeshes[i];\n\n\t\t\tif (this._pTestRenderableCollision(<RenderableBase> this._subMeshRenderablePool.getItem(subMesh), pickingCollisionVO, shortestCollisionDistance)) {\n\t\t\t\tshortestCollisionDistance = pickingCollisionVO.rayEntryDistance;\n\n\t\t\t\tpickingCollisionVO.renderableOwner = subMesh;\n\n\t\t\t\tif (!findClosest)\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn pickingCollisionVO.renderableOwner != null;\n\t}\n}\n\nexport = PickingColliderBase;",
    "import Debug\t\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/Debug\");\nimport BitmapImage2D\t\t\t\t\t\t= require(\"awayjs-core/lib/data/BitmapImage2D\");\nimport Box\t\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Box\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Point\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Rectangle\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport Scene\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport View\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/View\");\nimport IPicker\t\t\t\t\t\t\t= require(\"awayjs-display/lib/pick/IPicker\");\nimport PickingCollisionVO\t\t\t\t= require(\"awayjs-display/lib/pick/PickingCollisionVO\");\nimport EntityCollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport AGALMiniAssembler\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLClearMask\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport ContextGLCompareMode\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLTriangleFace\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTriangleFace\");\nimport IContextGL\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IProgram\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\nimport ITextureBase\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITextureBase\");\n\nimport DefaultRenderer\t\t\t\t\t= require(\"awayjs-renderergl/lib/DefaultRenderer\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * Picks a 3d object from a view or scene by performing a separate render pass on the scene around the area being picked using key color values,\n * then reading back the color value of the pixel in the render representing the picking ray. Requires multiple passes and readbacks for retriving details\n * on an entity that has its shaderPickingDetails property set to true.\n *\n * A read-back operation from any GPU is not a very efficient process, and the amount of processing used can vary significantly between different hardware.\n *\n * @see away.entities.Entity#shaderPickingDetails\n *\n * @class away.pick.ShaderPicker\n */\nclass ShaderPicker implements IPicker\n{\n\tprivate _opaqueRenderableHead:RenderableBase;\n\tprivate _blendedRenderableHead:RenderableBase;\n\n\tprivate _stage:Stage;\n\tprivate _context:IContextGL;\n\tprivate _onlyMouseEnabled:boolean = true;\n\n\tprivate _objectProgram:IProgram;\n\tprivate _triangleProgram:IProgram;\n\tprivate _bitmapImage2D:BitmapImage2D;\n\tprivate _viewportData:Array<number>;\n\tprivate _boundOffsetScale:Array<number>;\n\tprivate _id:Array<number>;\n\n\tprivate _interactives:Array<RenderableBase> = new Array<RenderableBase>();\n\tprivate _interactiveId:number;\n\tprivate _hitColor:number;\n\tprivate _projX:number;\n\tprivate _projY:number;\n\n\tprivate _hitRenderable:RenderableBase;\n\tprivate _hitEntity:IEntity;\n\tprivate _localHitPosition:Vector3D = new Vector3D();\n\tprivate _hitUV:Point = new Point();\n\tprivate _faceIndex:number;\n\tprivate _subGeometryIndex:number;\n\n\tprivate _localHitNormal:Vector3D = new Vector3D();\n\n\tprivate _rayPos:Vector3D = new Vector3D();\n\tprivate _rayDir:Vector3D = new Vector3D();\n\tprivate _potentialFound:boolean;\n\tprivate static MOUSE_SCISSOR_RECT:Rectangle = new Rectangle(0, 0, 1, 1);\n\n\tprivate _shaderPickingDetails:boolean;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get onlyMouseEnabled():boolean\n\t{\n\t\treturn this._onlyMouseEnabled;\n\t}\n\n\tpublic set onlyMouseEnabled(value:boolean)\n\t{\n\t\tthis._onlyMouseEnabled = value;\n\t}\n\n\t/**\n\t * Creates a new <code>ShaderPicker</code> object.\n\t *\n\t * @param shaderPickingDetails Determines whether the picker includes a second pass to calculate extra\n\t * properties such as uv and normal coordinates.\n\t */\n\tconstructor(shaderPickingDetails:boolean = false)\n\t{\n\t\tthis._shaderPickingDetails = shaderPickingDetails;\n\n\t\tthis._id = new Array<number>(4);\n\t\tthis._viewportData = new Array<number>(4); // first 2 contain scale, last 2 translation\n\t\tthis._boundOffsetScale = new Array<number>(8); // first 2 contain scale, last 2 translation\n\t\tthis._boundOffsetScale[3] = 0;\n\t\tthis._boundOffsetScale[7] = 1;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getViewCollision(x:number, y:number, view:View):PickingCollisionVO\n\t{\n\t\tvar collector:EntityCollector = <EntityCollector> view.iEntityCollector;\n\n\t\tthis._stage = (<DefaultRenderer> view.renderer).stage;\n\n\t\tif (!this._stage)\n\t\t\treturn null;\n\n\t\tthis._context = <IContextGL> this._stage.context;\n\n\t\tthis._viewportData[0] = view.width;\n\t\tthis._viewportData[1] = view.height;\n\t\tthis._viewportData[2] = -(this._projX = 2*x/view.width - 1);\n\t\tthis._viewportData[3] = this._projY = 2*y/view.height - 1;\n\n\t\t// _potentialFound will be set to true if any object is actually rendered\n\t\tthis._potentialFound = false;\n\n\t\t//reset head values\n\t\tthis._blendedRenderableHead = null;\n\t\tthis._opaqueRenderableHead = null;\n\n\t\tthis.pDraw(collector, null);\n\n\t\t// clear buffers\n\t\tthis._context.setVertexBufferAt(0, null);\n\n\t\tif (!this._context || !this._potentialFound)\n\t\t\treturn null;\n\n\t\tif (!this._bitmapImage2D)\n\t\t\tthis._bitmapImage2D = new BitmapImage2D(1, 1, false, 0);\n\n\t\tthis._context.drawToBitmapImage2D(this._bitmapImage2D);\n\t\tthis._hitColor = this._bitmapImage2D.getPixel(0, 0);\n\n\t\tif (!this._hitColor) {\n\t\t\tthis._context.present();\n\t\t\treturn null;\n\t\t}\n\n\t\tthis._hitRenderable = this._interactives[this._hitColor - 1];\n\t\tthis._hitEntity = this._hitRenderable.sourceEntity;\n\n\t\tif (this._onlyMouseEnabled && !this._hitEntity._iIsMouseEnabled())\n\t\t\treturn null;\n\n\t\tvar _collisionVO:PickingCollisionVO = this._hitEntity._iPickingCollisionVO;\n\t\tif (this._shaderPickingDetails) {\n\t\t\tthis.getHitDetails(view.camera);\n\t\t\t_collisionVO.localPosition = this._localHitPosition;\n\t\t\t_collisionVO.localNormal = this._localHitNormal;\n\t\t\t_collisionVO.uv = this._hitUV;\n\t\t\t_collisionVO.index = this._faceIndex;\n\t\t\t//_collisionVO.subGeometryIndex = this._subGeometryIndex;\n\n\t\t} else {\n\t\t\t_collisionVO.localPosition = null;\n\t\t\t_collisionVO.localNormal = null;\n\t\t\t_collisionVO.uv = null;\n\t\t\t_collisionVO.index = 0;\n\t\t\t//_collisionVO.subGeometryIndex = 0;\n\t\t}\n\n\t\treturn _collisionVO;\n\t}\n\n\t//*/\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getSceneCollision(position:Vector3D, direction:Vector3D, scene:Scene):PickingCollisionVO\n\t{\n\t\treturn null;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pDraw(entityCollector:EntityCollector, target:ITextureBase)\n\t{\n\n\t\tvar camera:Camera = entityCollector.camera;\n\n\t\tthis._context.clear(0, 0, 0, 1);\n\t\tthis._stage.scissorRect = ShaderPicker.MOUSE_SCISSOR_RECT;\n\n\t\tthis._interactives.length = this._interactiveId = 0;\n\n\t\tif (!this._objectProgram)\n\t\t\tthis.initObjectProgram();\n\n\t\tthis._context.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\tthis._context.setDepthTest(true, ContextGLCompareMode.LESS);\n\t\tthis._context.setProgram(this._objectProgram);\n\t\tthis._context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 4, this._viewportData, 1);\n\t\t//this.drawRenderables(entityCollector.opaqueRenderableHead, camera);\n\t\t//this.drawRenderables(entityCollector.blendedRenderableHead, camera);\n\t\t//TODO: reimplement ShaderPicker inheriting from RendererBase\n\t}\n\n\t/**\n\t * Draw a list of renderables.\n\t * @param renderables The renderables to draw.\n\t * @param camera The camera for which to render.\n\t */\n\tprivate drawRenderables(renderable:RenderableBase, camera:Camera)\n\t{\n\t\tvar matrix:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\t\tvar viewProjection:Matrix3D = camera.viewProjection;\n\n\t\twhile (renderable) {\n\t\t\t// it's possible that the renderable was already removed from the scene\n\t\t\tif (!renderable.sourceEntity.scene || !renderable.sourceEntity._iIsMouseEnabled()) {\n\t\t\t\trenderable = renderable.next;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis._potentialFound = true;\n\n\t\t\tthis._context.setCulling((<MaterialBase> renderable.renderObjectOwner).bothSides? ContextGLTriangleFace.NONE : ContextGLTriangleFace.BACK, camera.projection.coordinateSystem);\n\n\t\t\tthis._interactives[this._interactiveId++] = renderable;\n\t\t\t// color code so that reading from bitmapdata will contain the correct value\n\t\t\tthis._id[1] = (this._interactiveId >> 8)/255; // on green channel\n\t\t\tthis._id[2] = (this._interactiveId & 0xff)/255; // on blue channel\n\n\t\t\tmatrix.copyFrom(renderable.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix.append(viewProjection);\n\t\t\tthis._context.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, matrix, true);\n\t\t\tthis._context.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, this._id, 1);\n\t\t\tthis._stage.activateBuffer(0, renderable.getVertexData(TriangleSubGeometry.POSITION_DATA), renderable.getVertexOffset(TriangleSubGeometry.POSITION_DATA), TriangleSubGeometry.POSITION_FORMAT);\n\t\t\tthis._context.drawTriangles(this._stage.getIndexBuffer(renderable.getIndexData()), 0, renderable.numTriangles);\n\n\t\t\trenderable = renderable.next;\n\t\t}\n\n\t}\n\n\tprivate updateRay(camera:Camera)\n\t{\n\t\tthis._rayPos = camera.scenePosition;\n\n\t\tthis._rayDir = camera.getRay(this._projX, this._projY, 1);\n\t\tthis._rayDir.normalize();\n\t}\n\n\t/**\n\t * Creates the Program that color-codes objects.\n\t */\n\tprivate initObjectProgram()\n\t{\n\t\tvar vertexCode:string;\n\t\tvar fragmentCode:string;\n\n\t\tthis._objectProgram = this._context.createProgram();\n\n\t\tvertexCode = \"m44 vt0, va0, vc0\t\t\t\\n\" + \"mul vt1.xy, vt0.w, vc4.zw\t\\n\" + \"add vt0.xy, vt0.xy, vt1.xy\t\\n\" + \"mul vt0.xy, vt0.xy, vc4.xy\t\\n\" + \"mov op, vt0\t\\n\";\n\t\tfragmentCode = \"mov oc, fc0\"; // write identifier\n\n\t\tDebug.throwPIR('ShaderPicker', 'initTriangleProgram', 'Dependency: initObjectProgram')\n\t\t//_objectProgram.upload(new AGALMiniAssembler().assemble(ContextGLProgramType.VERTEX, vertexCode),new AGALMiniAssembler().assemble(ContextGLProgramType.FRAGMENT, fragmentCode));\n\t}\n\n\t/**\n\t * Creates the Program that renders positions.\n\t */\n\n\tprivate initTriangleProgram()\n\t{\n\t\tvar vertexCode:string;\n\t\tvar fragmentCode:string;\n\n\t\tthis._triangleProgram = this._context.createProgram();\n\n\t\t// todo: add animation code\n\t\tvertexCode = \"add vt0, va0, vc5 \t\t\t\\n\" + \"mul vt0, vt0, vc6 \t\t\t\\n\" + \"mov v0, vt0\t\t\t\t\\n\" + \"m44 vt0, va0, vc0\t\t\t\\n\" + \"mul vt1.xy, vt0.w, vc4.zw\t\\n\" + \"add vt0.xy, vt0.xy, vt1.xy\t\\n\" + \"mul vt0.xy, vt0.xy, vc4.xy\t\\n\" + \"mov op, vt0\t\\n\";\n\t\tfragmentCode = \"mov oc, v0\"; // write identifier\n\n\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + vertexCode + \"endpart\"))['vertex'].data;\n\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + fragmentCode + \"endpart\"))['fragment'].data;\n\t\tthis._triangleProgram.upload(vertexByteCode, fragmentByteCode);\n\t}\n\n\t/**\n\t * Gets more detailed information about the hir position, if required.\n\t * @param camera The camera used to view the hit object.\n\t */\n\tprivate getHitDetails(camera:Camera)\n\t{\n\t\tthis.getApproximatePosition(camera);\n\t\tthis.getPreciseDetails(camera);\n\t}\n\n\t/**\n\t * Finds a first-guess approximate position about the hit position.\n\t *\n\t * @param camera The camera used to view the hit object.\n\t */\n\tprivate getApproximatePosition(camera:Camera)\n\t{\n\t\tvar bounds:Box = this._hitRenderable.sourceEntity.getBox();\n\t\tvar col:number;\n\t\tvar scX:number, scY:number, scZ:number;\n\t\tvar offsX:number, offsY:number, offsZ:number;\n\t\tvar localViewProjection:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\tlocalViewProjection.copyFrom(this._hitRenderable.sourceEntity.getRenderSceneTransform(camera));\n\t\tlocalViewProjection.append(camera.viewProjection);\n\t\tif (!this._triangleProgram) {\n\t\t\tthis.initTriangleProgram();\n\t\t}\n\n\t\tthis._boundOffsetScale[4] = 1/(scX = bounds.width);\n\t\tthis._boundOffsetScale[5] = 1/(scY = bounds.height);\n\t\tthis._boundOffsetScale[6] = 1/(scZ = bounds.depth);\n\t\tthis._boundOffsetScale[0] = offsX = -bounds.x;\n\t\tthis._boundOffsetScale[1] = offsY = -bounds.y;\n\t\tthis._boundOffsetScale[2] = offsZ = -bounds.z;\n\n\t\tthis._context.setProgram(this._triangleProgram);\n\t\tthis._context.clear(0, 0, 0, 0, 1, 0, ContextGLClearMask.DEPTH);\n\t\tthis._context.setScissorRectangle(ShaderPicker.MOUSE_SCISSOR_RECT);\n\t\tthis._context.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, localViewProjection, true);\n\t\tthis._context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, this._boundOffsetScale, 2);\n\n\t\tthis._stage.activateBuffer(0, this._hitRenderable.getVertexData(TriangleSubGeometry.POSITION_DATA), this._hitRenderable.getVertexOffset(TriangleSubGeometry.POSITION_DATA), TriangleSubGeometry.POSITION_FORMAT);\n\t\tthis._context.drawTriangles(this._stage.getIndexBuffer(this._hitRenderable.getIndexData()), 0, this._hitRenderable.numTriangles);\n\n\t\tthis._context.drawToBitmapImage2D(this._bitmapImage2D);\n\n\t\tcol = this._bitmapImage2D.getPixel(0, 0);\n\n\t\tthis._localHitPosition.x = ((col >> 16) & 0xff)*scX/255 - offsX;\n\t\tthis._localHitPosition.y = ((col >> 8) & 0xff)*scY/255 - offsY;\n\t\tthis._localHitPosition.z = (col & 0xff)*scZ/255 - offsZ;\n\t}\n\n\t/**\n\t * Use the approximate position info to find the face under the mouse position from which we can derive the precise\n\t * ray-face intersection point, then use barycentric coordinates to figure out the uv coordinates, etc.\n\t * @param camera The camera used to view the hit object.\n\t */\n\tprivate getPreciseDetails(camera:Camera)\n\t{\n\t\tvar len:number = indices.length;\n\t\tvar x1:number, y1:number, z1:number;\n\t\tvar x2:number, y2:number, z2:number;\n\t\tvar x3:number, y3:number, z3:number;\n\t\tvar i:number = 0, j:number = 1, k:number = 2;\n\t\tvar t1:number, t2:number, t3:number;\n\t\tvar v0x:number, v0y:number, v0z:number;\n\t\tvar v1x:number, v1y:number, v1z:number;\n\t\tvar v2x:number, v2y:number, v2z:number;\n\t\tvar ni1:number, ni2:number, ni3:number;\n\t\tvar n1:number, n2:number, n3:number, nLength:number;\n\t\tvar dot00:number, dot01:number, dot02:number, dot11:number, dot12:number;\n\t\tvar s:number, t:number, invDenom:number;\n\t\tvar x:number = this._localHitPosition.x, y:number = this._localHitPosition.y, z:number = this._localHitPosition.z;\n\t\tvar u:number, v:number;\n\t\tvar ui1:number, ui2:number, ui3:number;\n\t\tvar s0x:number, s0y:number, s0z:number;\n\t\tvar s1x:number, s1y:number, s1z:number;\n\t\tvar nl:number;\n\t\tvar indices:Array<number> = this._hitRenderable.getIndexData().data;\n\n\t\tvar positions:Array<number> = this._hitRenderable.getVertexData(TriangleSubGeometry.POSITION_DATA).data;\n\t\tvar positionStride:number = this._hitRenderable.getVertexData(TriangleSubGeometry.POSITION_DATA).dataPerVertex;\n\t\tvar positionOffset:number = this._hitRenderable.getVertexOffset(TriangleSubGeometry.POSITION_DATA);\n\n\t\tvar uvs:Array<number> = this._hitRenderable.getVertexData(TriangleSubGeometry.UV_DATA).data;\n\t\tvar uvStride:number = this._hitRenderable.getVertexData(TriangleSubGeometry.UV_DATA).dataPerVertex;\n\t\tvar uvOffset:number = this._hitRenderable.getVertexOffset(TriangleSubGeometry.UV_DATA);\n\n\t\tvar normals:Array<number> = this._hitRenderable.getVertexData(TriangleSubGeometry.NORMAL_DATA).data;\n\t\tvar normalStride:number = this._hitRenderable.getVertexData(TriangleSubGeometry.NORMAL_DATA).dataPerVertex;\n\t\tvar normalOffset:number = this._hitRenderable.getVertexOffset(TriangleSubGeometry.NORMAL_DATA);\n\n\t\tthis.updateRay(camera);\n\n\t\twhile (i < len) {\n\t\t\tt1 = positionOffset + indices[i]*positionStride;\n\t\t\tt2 = positionOffset + indices[j]*positionStride;\n\t\t\tt3 = positionOffset + indices[k]*positionStride;\n\t\t\tx1 = positions[t1];\n\t\t\ty1 = positions[t1 + 1];\n\t\t\tz1 = positions[t1 + 2];\n\t\t\tx2 = positions[t2];\n\t\t\ty2 = positions[t2 + 1];\n\t\t\tz2 = positions[t2 + 2];\n\t\t\tx3 = positions[t3];\n\t\t\ty3 = positions[t3 + 1];\n\t\t\tz3 = positions[t3 + 2];\n\n\t\t\t// if within bounds\n\t\t\tif (!(    (x < x1 && x < x2 && x < x3) || (y < y1 && y < y2 && y < y3) || (z < z1 && z < z2 && z < z3) || (x > x1 && x > x2 && x > x3) || (y > y1 && y > y2 && y > y3) || (z > z1 && z > z2 && z > z3))) {\n\n\t\t\t\t// calculate barycentric coords for approximated position\n\t\t\t\tv0x = x3 - x1;\n\t\t\t\tv0y = y3 - y1;\n\t\t\t\tv0z = z3 - z1;\n\t\t\t\tv1x = x2 - x1;\n\t\t\t\tv1y = y2 - y1;\n\t\t\t\tv1z = z2 - z1;\n\t\t\t\tv2x = x - x1;\n\t\t\t\tv2y = y - y1;\n\t\t\t\tv2z = z - z1;\n\t\t\t\tdot00 = v0x*v0x + v0y*v0y + v0z*v0z;\n\t\t\t\tdot01 = v0x*v1x + v0y*v1y + v0z*v1z;\n\t\t\t\tdot02 = v0x*v2x + v0y*v2y + v0z*v2z;\n\t\t\t\tdot11 = v1x*v1x + v1y*v1y + v1z*v1z;\n\t\t\t\tdot12 = v1x*v2x + v1y*v2y + v1z*v2z;\n\t\t\t\tinvDenom = 1/(dot00*dot11 - dot01*dot01);\n\t\t\t\ts = (dot11*dot02 - dot01*dot12)*invDenom;\n\t\t\t\tt = (dot00*dot12 - dot01*dot02)*invDenom;\n\n\t\t\t\t// if inside the current triangle, fetch details hit information\n\t\t\t\tif (s >= 0 && t >= 0 && (s + t) <= 1) {\n\n\t\t\t\t\tni1 = normalOffset + indices[i]*normalStride;\n\t\t\t\t\tni2 = normalOffset + indices[j]*normalStride;\n\t\t\t\t\tni3 = normalOffset + indices[k]*normalStride;\n\n\t\t\t\t\tn1 = indices[ni1] + indices[ni2] + indices[ni3];\n\t\t\t\t\tn2 = indices[ni1 + 1] + indices[ni2 + 1] + indices[ni3 + 1];\n\t\t\t\t\tn3 = indices[ni1 + 2] + indices[ni2 + 2] + indices[ni3 + 2];\n\n\t\t\t\t\tnLength = Math.sqrt(n1*n1 + n2*n2 + n3*n3);\n\n\t\t\t\t\tn1 /= nLength;\n\t\t\t\t\tn2 /= nLength;\n\t\t\t\t\tn3 /= nLength;\n\n\t\t\t\t\t// this is def the triangle, now calculate precise coords\n\t\t\t\t\tthis.getPrecisePosition(this._hitRenderable.sourceEntity.inverseSceneTransform, n1, n2, n3, x1, y1, z1);\n\n\t\t\t\t\tv2x = this._localHitPosition.x - x1;\n\t\t\t\t\tv2y = this._localHitPosition.y - y1;\n\t\t\t\t\tv2z = this._localHitPosition.z - z1;\n\n\t\t\t\t\ts0x = x2 - x1; // s0 = p1 - p0\n\t\t\t\t\ts0y = y2 - y1;\n\t\t\t\t\ts0z = z2 - z1;\n\t\t\t\t\ts1x = x3 - x1; // s1 = p2 - p0\n\t\t\t\t\ts1y = y3 - y1;\n\t\t\t\t\ts1z = z3 - z1;\n\t\t\t\t\tthis._localHitNormal.x = s0y*s1z - s0z*s1y; // n = s0 x s1\n\t\t\t\t\tthis._localHitNormal.y = s0z*s1x - s0x*s1z;\n\t\t\t\t\tthis._localHitNormal.z = s0x*s1y - s0y*s1x;\n\t\t\t\t\tnl = 1/Math.sqrt(this._localHitNormal.x*this._localHitNormal.x + this._localHitNormal.y*this._localHitNormal.y + this._localHitNormal.z*this._localHitNormal.z); // normalize n\n\t\t\t\t\tthis._localHitNormal.x *= nl;\n\t\t\t\t\tthis._localHitNormal.y *= nl;\n\t\t\t\t\tthis._localHitNormal.z *= nl;\n\n\t\t\t\t\tdot02 = v0x*v2x + v0y*v2y + v0z*v2z;\n\t\t\t\t\tdot12 = v1x*v2x + v1y*v2y + v1z*v2z;\n\t\t\t\t\ts = (dot11*dot02 - dot01*dot12)*invDenom;\n\t\t\t\t\tt = (dot00*dot12 - dot01*dot02)*invDenom;\n\n\t\t\t\t\tui1 = uvOffset + indices[i]*uvStride\n\t\t\t\t\tui2 = uvOffset + indices[j]*uvStride\n\t\t\t\t\tui3 = uvOffset + indices[k]*uvStride\n\n\t\t\t\t\tu = uvs[ui1];\n\t\t\t\t\tv = uvs[ui1 + 1];\n\t\t\t\t\tthis._hitUV.x = u + t*(uvs[ui2] - u) + s*(uvs[ui3] - u);\n\t\t\t\t\tthis._hitUV.y = v + t*(uvs[ui2 + 1] - v) + s*(uvs[ui3 + 1] - v);\n\n\t\t\t\t\tthis._faceIndex = i;\n\t\t\t\t\t//TODO add back subGeometryIndex value\n\t\t\t\t\t//this._subGeometryIndex = away.utils.GeometryUtils.getMeshSubGeometryIndex(subGeom);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti += 3;\n\t\t\tj += 3;\n\t\t\tk += 3;\n\t\t}\n\t}\n\n\t/**\n\t * Finds the precise hit position by unprojecting the screen coordinate back unto the hit face's plane and\n\t * calculating the intersection point.\n\t * @param camera The camera used to render the object.\n\t * @param invSceneTransform The inverse scene transformation of the hit object.\n\t * @param nx The x-coordinate of the face's plane normal.\n\t * @param ny The y-coordinate of the face plane normal.\n\t * @param nz The z-coordinate of the face plane normal.\n\t * @param px The x-coordinate of a point on the face's plane (ie a face vertex)\n\t * @param py The y-coordinate of a point on the face's plane (ie a face vertex)\n\t * @param pz The z-coordinate of a point on the face's plane (ie a face vertex)\n\t */\n\n\tprivate getPrecisePosition(invSceneTransform:Matrix3D, nx:number, ny:number, nz:number, px:number, py:number, pz:number)\n\t{\n\t\t// calculate screen ray and find exact intersection position with triangle\n\t\tvar rx:number, ry:number, rz:number;\n\t\tvar ox:number, oy:number, oz:number;\n\t\tvar t:number;\n\t\tvar raw:Array<number> = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\tvar cx:number = this._rayPos.x, cy:number = this._rayPos.y, cz:number = this._rayPos.z;\n\n\t\t// unprojected projection point, gives ray dir in cam space\n\t\tox = this._rayDir.x;\n\t\toy = this._rayDir.y;\n\t\toz = this._rayDir.z;\n\n\t\t// transform ray dir and origin (cam pos) to object space\n\t\t//invSceneTransform.copyRawDataTo( raw  );\n\t\tinvSceneTransform.copyRawDataTo(raw);\n\t\trx = raw[0]*ox + raw[4]*oy + raw[8]*oz;\n\t\try = raw[1]*ox + raw[5]*oy + raw[9]*oz;\n\t\trz = raw[2]*ox + raw[6]*oy + raw[10]*oz;\n\n\t\tox = raw[0]*cx + raw[4]*cy + raw[8]*cz + raw[12];\n\t\toy = raw[1]*cx + raw[5]*cy + raw[9]*cz + raw[13];\n\t\toz = raw[2]*cx + raw[6]*cy + raw[10]*cz + raw[14];\n\n\t\tt = ((px - ox)*nx + (py - oy)*ny + (pz - oz)*nz)/(rx*nx + ry*ny + rz*nz);\n\n\t\tthis._localHitPosition.x = ox + rx*t;\n\t\tthis._localHitPosition.y = oy + ry*t;\n\t\tthis._localHitPosition.z = oz + rz*t;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._bitmapImage2D.dispose();\n\t\tif (this._triangleProgram)\n\t\t\tthis._triangleProgram.dispose();\n\n\t\tif (this._objectProgram)\n\t\t\tthis._objectProgram.dispose();\n\n\t\tthis._triangleProgram = null;\n\t\tthis._objectProgram = null;\n\t\tthis._bitmapImage2D = null;\n\t\tthis._hitRenderable = null;\n\t\tthis._hitEntity = null;\n\t}\n}\n\nexport = ShaderPicker;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\n\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-core/lib/data/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderablePoolBase\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * @class away.pool.RenderableListItem\n */\nclass BillboardRenderable extends RenderableBase\n{\n\tprivate static _materialGeometry:Object = new Object();\n\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"billboard\";\n\n\tpublic static vertexAttributesOffset:number = 1;\n\n\t/**\n\t *\n\t */\n\tprivate _billboard:Billboard;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param billboard\n\t */\n\tconstructor(pool:RenderablePoolBase, billboard:Billboard, stage:Stage)\n\t{\n\t\tsuper(pool, billboard, billboard, billboard.material, stage);\n\n\t\tthis._billboard = billboard;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {away.base.TriangleSubGeometry}\n\t */\n\tpublic _pGetSubGeometry():SubGeometryBase\n\t{\n\t\tvar material:MaterialBase = this._billboard.material;\n\t\tvar billboardRect:Rectangle = this._billboard.billboardRect;\n\n\t\tvar geometry:TriangleSubGeometry = BillboardRenderable._materialGeometry[material.id];\n\n\t\tif (!geometry) {\n\t\t\tgeometry = BillboardRenderable._materialGeometry[material.id] = new TriangleSubGeometry(true);\n\t\t\tgeometry.autoDeriveNormals = false;\n\t\t\tgeometry.autoDeriveTangents = false;\n\t\t\tgeometry.updateIndices(Array<number>(0, 1, 2, 0, 2, 3));\n\t\t\tgeometry.updatePositions(Array<number>(-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, -billboardRect.y, 0, -billboardRect.x, -billboardRect.y, 0));\n\t\t\tgeometry.updateVertexNormals(Array<number>(1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0));\n\t\t\tgeometry.updateVertexTangents(Array<number>(0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1));\n\t\t\tgeometry.updateUVs(Array<number>(0, 0, 1, 0, 1, 1, 0, 1));\n\t\t} else {\n\t\t\tgeometry.updatePositions(Array<number>(-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, -billboardRect.y, 0, -billboardRect.x, -billboardRect.y, 0));\n\t\t}\n\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.POSITION_DATA] = true;\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.NORMAL_DATA] = true;\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.TANGENT_DATA] = true;\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.UV_DATA] = true;\n\n\t\treturn geometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\n\t}\n\n\tpublic static _iGetVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shaderObject.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshaderObject.viewMatrixIndex = viewMatrixReg.index*4;\n\n\t\tif (shaderObject.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \", \" + viewMatrixReg + \"\\n\" +\n\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\"mov op, \" + temp + \"\\n\";\n\t\t} else {\n\t\t\tcode += \"m44 op, \" + position + \", \" + viewMatrixReg + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\tpublic _iActivate(pass:RenderPassBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, camera);\n\n\t\t//buffer the same for all materials, so can set here\n\t\tthis._stage.activateBuffer(0, this.getVertexData(TriangleSubGeometry.POSITION_DATA), this.getVertexOffset(TriangleSubGeometry.POSITION_DATA), TriangleSubGeometry.POSITION_FORMAT);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iRender(pass:RenderPassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRender(pass, camera, viewProjection);\n\n\t\tvar shader:ShaderObjectBase = pass.shader;\n\n\t\tif (shader.sceneMatrixIndex >= 0) {\n\t\t\tthis.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shader.vertexConstantData, shader.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(this.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shader.vertexConstantData, shader.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shader.fragmentConstantData, shader.numUsedFragmentConstants);\n\n\t\tthis._stage.context.drawTriangles(this._stage.getIndexBuffer(this.getIndexData()), 0, this.numTriangles);\n\t}\n}\n\nexport = BillboardRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport CurveSubMesh\t\t\t\t    = require(\"awayjs-display/lib/base/CurveSubMesh\");\nimport CurveSubGeometry\t\t    \t= require(\"awayjs-core/lib/data/CurveSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextWebGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextWebGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderablePoolBase\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * @class away.pool.TriangleSubMeshRenderable\n */\nclass CurveSubMeshRenderable extends RenderableBase\n{\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"curvesubmesh\";\n\n\tpublic static vertexAttributesOffset:number = 2;\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:CurveSubMesh;\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param indexOffset\n\t */\n\tconstructor(pool:RenderablePoolBase, subMesh:CurveSubMesh, stage:Stage, level:number = 0, indexOffset:number = 0)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, subMesh.material, stage, level, indexOffset);\n\n\t\tthis.subMesh = subMesh;\n\t}\n\n\t/**\n\t *\n\t * @returns {SubGeometryBase}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():CurveSubGeometry\n\t{\n\t\tvar subGeometry:CurveSubGeometry;\n\n\t\tif (this.subMesh.animator)\n\t\t\tsubGeometry = <CurveSubGeometry> this.subMesh.animator.getRenderableSubGeometry(this, this.subMesh.subGeometry);\n\t\telse\n\t\t\tsubGeometry = this.subMesh.subGeometry;\n\n\t\tthis._pVertexDataDirty[CurveSubGeometry.POSITION_DATA] = true;\n\n\t\tif (subGeometry.curves)\n\t\t\tthis._pVertexDataDirty[CurveSubGeometry.CURVE_DATA] = true;\n\n\t\tif (subGeometry.uvs)\n\t\t\tthis._pVertexDataDirty[CurveSubGeometry.UV_DATA] = true;\n\n\t\treturn subGeometry;\n\t}\n\n\n\tpublic static _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n        shaderObject.usesLocalPosFragment = true;\n\t}\n\n\tpublic static _iGetVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shaderObject.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshaderObject.viewMatrixIndex = viewMatrixReg.index*4;\n\n\n\t\tif (shaderObject.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \".xyw, \" + viewMatrixReg + \"\\n\" +\n\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\"mov v2 va1 \\n\" +\n\t\t\t\"mov op, \" + temp + \"\\n\";\n\n\t\t} else {\n\t\t\tcode += \"mov v2 va1 \\n\";\n\t\t\tcode += \"m44 op, \" + position + \".xyw, \" + viewMatrixReg + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n    /**\n     * @inheritDoc\n     */\n\tpublic static _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar sd:boolean = (<ContextWebGL>shaderObject._stage.context).standardDerivatives;\n\t\tvar pos:ShaderRegisterElement = sharedRegisters.localPositionVarying;\n\t\tvar out:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\n\t\tvar curve:string = \"v2\";\n\t\tvar curvex:string = \"v2.x\";\n\t\tvar curvey:string = \"v2.y\";\n\t\tvar curvez:string = pos + \".z\";\n\n\n\t\t//get some free registers\n\t\tvar free:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(free, 1);\n\t\tvar free1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(free1, 1);\n\t\tvar free2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(free2, 1);\n\n\t\t//distance from curve\n\t\tvar d:string = free + \".x\";\n\t\tvar dx:string = free + \".y\";\n\t\tvar dy:string = free + \".z\";\n\t\tvar t:string = free + \".w\";\n\t\tvar d2:string = free1 + \".x\";\n\t\tvar fixa:string = free1 + \".y\";\n\t\tvar fixb:string = free1 + \".z\";\n\n\t\tvar _aa:string = \"fc7.z\";\n\t\tvar _1:string = \"fc7.y\";\n\n\t\tvar nl:string = \"\\n\";\n\n\t\tvar code:Array<string> =  new Array<string>();\n\n\t\t//distance from curve\n\t\tcode.push(\"mul\",d, curvex, curvex, nl);\n\t\tcode.push(\"sub\",d, d, curvey, nl);\n\t\tcode.push(\"mul\",d, d, curvez, nl);\t//flipper\n\n\t\tcode.push(\"kil\" ,d, nl);\n\n\t\tif(sd)\n\t\t{\n\n\t\t\t//derivatives\n\t\t\tcode.push(\"ddx\", dx, d, nl);\n\t\t\tcode.push(\"ddy\", dy, d, nl);\n\n\t\t\t//AA\n\t\t\tcode.push(\"mul\",dx, dx, dx, nl);\n\t\t\tcode.push(\"mul\",dy, dy, dy, nl);\n\t\t\tcode.push(\"add\",t, dx, dy, nl);\n\t\t\tcode.push(\"sqt\",t, t, nl);\n\n\t\t\tcode.push(\"mul\",t, t, _aa, nl);\n\t\t\tcode.push(\"div\",d, d, t, nl);\n\n\n\t\t\t/*LINE*/\n\t\t\tcode.push(\"mov\", d2, curvey, nl);\n\t\t\tcode.push(\"ddx\", dx, curvey, nl);\n\t\t\tcode.push(\"ddy\", dy, curvey, nl);\n\t\t\tcode.push(\"mul\", dx, dx, dx, nl);\n\t\t\tcode.push(\"mul\", dy, dy, dy, nl);\n\t\t\tcode.push(\"add\", t, dx, dy, nl);\n\t\t\tcode.push(\"sqt\", t, t, nl);\n\t\t\tcode.push(\"mul\", t, t, _aa, nl);\n\n\t\t\tcode.push(\"div\", d2, d2, t, nl);\n\t\t\t/**/\n\n\t\t\t//code.push(\"sge\", fixa, curvex, _1, nl);\n\t\t\tcode.push(\"slt\", fixb, curvex, _1, nl);\n\t\t\tcode.push(\"sub\", fixa, _1, fixb, nl);\n\t\t\t//code.push(\"sub\", fixb, _1, fixa, nl);\n\t\t\tcode.push(\"mul\", d2, d2, fixa, nl);\n\t\t\tcode.push(\"mul\", d, d, fixb, nl);\n\n\t\t\tcode.push(\"add\", d, d, d2, nl);\n\t\t\tcode.push(\"abs\", d, d, nl);\n\n\t\t\tcode.push(\"min\", d, d, _1, nl);\n\n\t\t\tcode.push(\"mov\", out+\".w\", d, nl);\n\t\t}\n\t\treturn code.join(\" \");\n\t}\n    private _constants:Array<number> = new Array<number>(0, 1, 1, 0.5);\n    /**\n     * @inheritDoc\n     */\n    public _iActivate(pass:RenderPassBase, camera:Camera)\n    {\n        super._iActivate(pass, camera);\n\n        var context:IContextGL = this._stage.context;\n\n        context.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 7, this._constants, 1);\n\n    }\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iRender(pass:RenderPassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRender(pass, camera, viewProjection);\n\n\t\tvar shader:ShaderObjectBase = pass.shader;\n\n\t\tif (shader.sceneMatrixIndex >= 0) {\n\t\t\tthis.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shader.vertexConstantData, shader.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(this.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shader.vertexConstantData, shader.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shader.fragmentConstantData, shader.numUsedFragmentConstants);\n\n\t\tthis._stage.activateBuffer(0, this.getVertexData(CurveSubGeometry.POSITION_DATA), this.getVertexOffset(CurveSubGeometry.POSITION_DATA), CurveSubGeometry.POSITION_FORMAT);\n        this._stage.activateBuffer(1, this.getVertexData(CurveSubGeometry.CURVE_DATA), this.getVertexOffset(CurveSubGeometry.CURVE_DATA), CurveSubGeometry.CURVE_FORMAT);\n\n        this._stage.context.drawTriangles(this._stage.getIndexBuffer(this.getIndexData()), 0, this.numTriangles);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.TriangleSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowRenderable(indexOffset:number):RenderableBase\n\t{\n\t\treturn new CurveSubMeshRenderable(this._pool, <CurveSubMesh> this.renderableOwner, this._stage, this._level + 1, indexOffset);\n\t}\n}\n\nexport = CurveSubMeshRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/LineSubGeometry\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-core/lib/events/SubGeometryEvent\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport LineSegment\t\t\t\t\t= require(\"awayjs-display/lib/entities/LineSegment\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderablePoolBase\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * @class away.pool.LineSubMeshRenderable\n */\nclass LineSegmentRenderable extends RenderableBase\n{\n\tprivate static _lineGeometry:Object = new Object();\n\n\tpublic static pONE_VECTOR:Array<number> = Array<number>(1, 1, 1, 1);\n\tpublic static pFRONT_VECTOR:Array<number> = Array<number>(0, 0, -1, 0);\n\n\tprivate _constants:Array<number> = new Array<number>(0, 0, 0, 0);\n\tprivate _calcMatrix:Matrix3D;\n\tprivate _thickness:number = 1.25;\n\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"linesegment\";\n\n\tpublic static vertexAttributesOffset:number = 3;\n\n\t/**\n\t *\n\t */\n\tprivate _lineSegment:LineSegment;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param dataOffset\n\t */\n\tconstructor(pool:RenderablePoolBase, lineSegment:LineSegment, stage:Stage, level:number = 0, indexOffset:number = 0)\n\t{\n\t\tsuper(pool, lineSegment, lineSegment, lineSegment.material, stage, level, indexOffset);\n\n\t\tthis._lineSegment = lineSegment;\n\n\t\tthis._calcMatrix = new Matrix3D();\n\n\t\tthis._constants[1] = 1/255;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {base.LineSubGeometry}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():LineSubGeometry\n\t{\n\t\tvar geometry:LineSubGeometry = LineSegmentRenderable._lineGeometry[this._lineSegment.id] || (LineSegmentRenderable._lineGeometry[this._lineSegment.id] = new LineSubGeometry());\n\n\t\tthis._pVertexDataDirty[LineSubGeometry.START_POSITION_DATA] = true;\n\t\tthis._pVertexDataDirty[LineSubGeometry.END_POSITION_DATA] = true;\n\t\tthis._pVertexDataDirty[LineSubGeometry.THICKNESS_DATA] = true;\n\t\tthis._pVertexDataDirty[LineSubGeometry.COLOR_DATA] = true;\n\n\t\tvar start:Vector3D = this._lineSegment.startPostion;\n\t\tvar end:Vector3D = this._lineSegment.endPosition;\n\n\t\tvar startPositions:Array<number>;\n\t\tvar endPositions:Array<number>;\n\t\tvar thickness:Array<number>;\n\n\t\tif (geometry.indices != null) {\n\t\t\tstartPositions = geometry.startPositions;\n\t\t\tendPositions = geometry.endPositions;\n\t\t\tthickness = geometry.thickness;\n\t\t} else {\n\t\t\tstartPositions = new Array<number>(3);\n\t\t\tendPositions = new Array<number>(3);\n\t\t\tthickness = new Array<number>(1);\n\t\t}\n\n\t\tstartPositions[0] = start.x;\n\t\tstartPositions[1] = start.y;\n\t\tstartPositions[2] = start.z;\n\t\tendPositions[0] = end.x;\n\t\tendPositions[1] = end.y;\n\t\tendPositions[2] = end.z;\n\t\tthickness[0] = this._lineSegment.thickness;\n\n\t\tgeometry.updatePositions(startPositions, endPositions);\n\t\tgeometry.updateThickness(thickness);\n\n\t\treturn geometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tshaderObject.colorDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static _iGetVertexCode(shader:ShaderObjectBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\treturn \"m44 vt0, va0, vc8\t\t\t\\n\" + // transform Q0 to eye space\n\t\t\t\"m44 vt1, va1, vc8\t\t\t\\n\" + // transform Q1 to eye space\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\n\t\t\t\t// test if behind camera near plane\n\t\t\t\t// if 0 - Q0.z < Camera.near then the point needs to be clipped\n\t\t\t\t//\"neg vt5.x, vt0.z\t\t\t\t\\n\" + // 0 - Q0.z\n\t\t\t\"slt vt5.x, vt0.z, vc7.z\t\t\t\\n\" + // behind = ( 0 - Q0.z < -Camera.near ) ? 1 : 0\n\t\t\t\"sub vt5.y, vc5.x, vt5.x\t\t\t\\n\" + // !behind = 1 - behind\n\n\t\t\t\t// p = point on the plane (0,0,-near)\n\t\t\t\t// n = plane normal (0,0,-1)\n\t\t\t\t// D = Q1 - Q0\n\t\t\t\t// t = ( dot( n, ( p - Q0 ) ) / ( dot( n, d )\n\n\t\t\t\t// solve for t where line crosses Camera.near\n\t\t\t\"add vt4.x, vt0.z, vc7.z\t\t\t\\n\" + // Q0.z + ( -Camera.near )\n\t\t\t\"sub vt4.y, vt0.z, vt1.z\t\t\t\\n\" + // Q0.z - Q1.z\n\n\t\t\t\t// fix divide by zero for horizontal lines\n\t\t\t\"seq vt4.z, vt4.y vc6.x\t\t\t\\n\" + // offset = (Q0.z - Q1.z)==0 ? 1 : 0\n\t\t\t\"add vt4.y, vt4.y, vt4.z\t\t\t\\n\" + // ( Q0.z - Q1.z ) + offset\n\n\t\t\t\"div vt4.z, vt4.x, vt4.y\t\t\t\\n\" + // t = ( Q0.z - near ) / ( Q0.z - Q1.z )\n\n\t\t\t\"mul vt4.xyz, vt4.zzz, vt2.xyz\t\\n\" + // t(L)\n\t\t\t\"add vt3.xyz, vt0.xyz, vt4.xyz\t\\n\" + // Qclipped = Q0 + t(L)\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // Qclipped.w = 1\n\n\t\t\t\t// If necessary, replace Q0 with new Qclipped\n\t\t\t\"mul vt0, vt0, vt5.yyyy\t\t\t\\n\" + // !behind * Q0\n\t\t\t\"mul vt3, vt3, vt5.xxxx\t\t\t\\n\" + // behind * Qclipped\n\t\t\t\"add vt0, vt0, vt3\t\t\t\t\\n\" + // newQ0 = Q0 + Qclipped\n\n\t\t\t\t// calculate side vector for line\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\t\t\t\"nrm vt2.xyz, vt2.xyz\t\t\t\\n\" + // normalize( L )\n\t\t\t\"nrm vt5.xyz, vt0.xyz\t\t\t\\n\" + // D = normalize( Q1 )\n\t\t\t\"mov vt5.w, vc5.x\t\t\t\t\\n\" + // D.w = 1\n\t\t\t\"crs vt3.xyz, vt2, vt5\t\t\t\\n\" + // S = L x D\n\t\t\t\"nrm vt3.xyz, vt3.xyz\t\t\t\\n\" + // normalize( S )\n\n\t\t\t\t// face the side vector properly for the given point\n\t\t\t\"mul vt3.xyz, vt3.xyz, va2.xxx\t\\n\" + // S *= weight\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // S.w = 1\n\n\t\t\t\t// calculate the amount required to move at the point's distance to correspond to the line's pixel width\n\t\t\t\t// scale the side vector by that amount\n\t\t\t\"dp3 vt4.x, vt0, vc6\t\t\t\\n\" + // distance = dot( view )\n\t\t\t\"mul vt4.x, vt4.x, vc7.x\t\t\t\\n\" + // distance *= vpsod\n\t\t\t\"mul vt3.xyz, vt3.xyz, vt4.xxx\t\\n\" + // S.xyz *= pixelScaleFactor\n\n\t\t\t\t// add scaled side vector to Q0 and transform to clip space\n\t\t\t\"add vt0.xyz, vt0.xyz, vt3.xyz\t\\n\" + // Q0 + S\n\n\t\t\t\"m44 op, vt0, vc0\t\t\t\\n\"  // transform Q0 to clip space\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:RenderPassBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, camera);\n\n\t\tthis._constants[0] = this._thickness/((this._stage.scissorRect)? Math.min(this._stage.scissorRect.width, this._stage.scissorRect.height) : Math.min(this._stage.width, this._stage.height));\n\n\t\t// value to convert distance from camera to model length per pixel width\n\t\tthis._constants[2] = camera.projection.near;\n\n\t\tvar context:IContextGL = this._stage.context;\n\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, LineSegmentRenderable.pONE_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 6, LineSegmentRenderable.pFRONT_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 7, this._constants, 1);\n\n\t\t// projection matrix\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, camera.projection.matrix, true);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iRender(pass:RenderPassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRender(pass, camera, viewProjection);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tthis._calcMatrix.copyFrom(this.sourceEntity.sceneTransform);\n\t\tthis._calcMatrix.append(camera.inverseSceneTransform);\n\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 8, this._calcMatrix, true);\n\n\t\tthis._stage.activateBuffer(0, this.getVertexData(LineSubGeometry.START_POSITION_DATA), this.getVertexOffset(LineSubGeometry.START_POSITION_DATA), LineSubGeometry.POSITION_FORMAT);\n\t\tthis._stage.activateBuffer(1, this.getVertexData(LineSubGeometry.END_POSITION_DATA), this.getVertexOffset(LineSubGeometry.END_POSITION_DATA), LineSubGeometry.POSITION_FORMAT);\n\t\tthis._stage.activateBuffer(2, this.getVertexData(LineSubGeometry.THICKNESS_DATA), this.getVertexOffset(LineSubGeometry.THICKNESS_DATA), LineSubGeometry.THICKNESS_FORMAT);\n\n\t\tcontext.drawTriangles(this._stage.getIndexBuffer(this.getIndexData()), 0, this.numTriangles);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.LineSubMeshRenderable}\n\t * @private\n\t */\n\tpublic _pGetOverflowRenderable(indexOffset:number):RenderableBase\n\t{\n\t\treturn new LineSegmentRenderable(this._pool, <LineSegment> this.renderableOwner, this._stage, this._level + 1, indexOffset);\n\t}\n}\n\nexport = LineSegmentRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/LineSubGeometry\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-core/lib/events/SubGeometryEvent\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderablePoolBase\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * @class away.pool.LineSubMeshRenderable\n */\nclass LineSubMeshRenderable extends RenderableBase\n{\n\tpublic static pONE_VECTOR:Array<number> = Array<number>(1, 1, 1, 1);\n\tpublic static pFRONT_VECTOR:Array<number> = Array<number>(0, 0, -1, 0);\n\n\tprivate _constants:Array<number> = new Array<number>(0, 0, 0, 0);\n\tprivate _calcMatrix:Matrix3D;\n\tprivate _thickness:number = 1.25;\n\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"linesubmesh\";\n\n\tpublic static vertexAttributesOffset:number = 3;\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:LineSubMesh;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param dataOffset\n\t */\n\tconstructor(pool:RenderablePoolBase, subMesh:LineSubMesh, stage:Stage, level:number = 0, indexOffset:number = 0)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, subMesh.material, stage, level, indexOffset);\n\n\t\tthis.subMesh = subMesh;\n\n\t\tthis._calcMatrix = new Matrix3D();\n\n\t\tthis._constants[1] = 1/255;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {base.LineSubGeometry}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():LineSubGeometry\n\t{\n\t\tvar subGeometry:LineSubGeometry = this.subMesh.subGeometry;\n\n\t\tthis._pVertexDataDirty[LineSubGeometry.START_POSITION_DATA] = true;\n\t\tthis._pVertexDataDirty[LineSubGeometry.END_POSITION_DATA] = true;\n\n\t\tif (subGeometry.thickness)\n\t\t\tthis._pVertexDataDirty[LineSubGeometry.THICKNESS_DATA] = true;\n\n\t\tif (subGeometry.startColors)\n\t\t\tthis._pVertexDataDirty[LineSubGeometry.COLOR_DATA] = true;\n\n\t\treturn subGeometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tshaderObject.colorDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static _iGetVertexCode(shader:ShaderObjectBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\treturn \"m44 vt0, va0, vc8\t\t\t\\n\" + // transform Q0 to eye space\n\t\t\t\"m44 vt1, va1, vc8\t\t\t\\n\" + // transform Q1 to eye space\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\n\t\t\t\t// test if behind camera near plane\n\t\t\t\t// if 0 - Q0.z < Camera.near then the point needs to be clipped\n\t\t\t\t//\"neg vt5.x, vt0.z\t\t\t\t\\n\" + // 0 - Q0.z\n\t\t\t\"slt vt5.x, vt0.z, vc7.z\t\t\t\\n\" + // behind = ( 0 - Q0.z < -Camera.near ) ? 1 : 0\n\t\t\t\"sub vt5.y, vc5.x, vt5.x\t\t\t\\n\" + // !behind = 1 - behind\n\n\t\t\t\t// p = point on the plane (0,0,-near)\n\t\t\t\t// n = plane normal (0,0,-1)\n\t\t\t\t// D = Q1 - Q0\n\t\t\t\t// t = ( dot( n, ( p - Q0 ) ) / ( dot( n, d )\n\n\t\t\t\t// solve for t where line crosses Camera.near\n\t\t\t\"add vt4.x, vt0.z, vc7.z\t\t\t\\n\" + // Q0.z + ( -Camera.near )\n\t\t\t\"sub vt4.y, vt0.z, vt1.z\t\t\t\\n\" + // Q0.z - Q1.z\n\n\t\t\t\t// fix divide by zero for horizontal lines\n\t\t\t\"seq vt4.z, vt4.y vc6.x\t\t\t\\n\" + // offset = (Q0.z - Q1.z)==0 ? 1 : 0\n\t\t\t\"add vt4.y, vt4.y, vt4.z\t\t\t\\n\" + // ( Q0.z - Q1.z ) + offset\n\n\t\t\t\"div vt4.z, vt4.x, vt4.y\t\t\t\\n\" + // t = ( Q0.z - near ) / ( Q0.z - Q1.z )\n\n\t\t\t\"mul vt4.xyz, vt4.zzz, vt2.xyz\t\\n\" + // t(L)\n\t\t\t\"add vt3.xyz, vt0.xyz, vt4.xyz\t\\n\" + // Qclipped = Q0 + t(L)\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // Qclipped.w = 1\n\n\t\t\t\t// If necessary, replace Q0 with new Qclipped\n\t\t\t\"mul vt0, vt0, vt5.yyyy\t\t\t\\n\" + // !behind * Q0\n\t\t\t\"mul vt3, vt3, vt5.xxxx\t\t\t\\n\" + // behind * Qclipped\n\t\t\t\"add vt0, vt0, vt3\t\t\t\t\\n\" + // newQ0 = Q0 + Qclipped\n\n\t\t\t\t// calculate side vector for line\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\t\t\t\"nrm vt2.xyz, vt2.xyz\t\t\t\\n\" + // normalize( L )\n\t\t\t\"nrm vt5.xyz, vt0.xyz\t\t\t\\n\" + // D = normalize( Q1 )\n\t\t\t\"mov vt5.w, vc5.x\t\t\t\t\\n\" + // D.w = 1\n\t\t\t\"crs vt3.xyz, vt2, vt5\t\t\t\\n\" + // S = L x D\n\t\t\t\"nrm vt3.xyz, vt3.xyz\t\t\t\\n\" + // normalize( S )\n\n\t\t\t\t// face the side vector properly for the given point\n\t\t\t\"mul vt3.xyz, vt3.xyz, va2.xxx\t\\n\" + // S *= weight\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // S.w = 1\n\n\t\t\t\t// calculate the amount required to move at the point's distance to correspond to the line's pixel width\n\t\t\t\t// scale the side vector by that amount\n\t\t\t\"dp3 vt4.x, vt0, vc6\t\t\t\\n\" + // distance = dot( view )\n\t\t\t\"mul vt4.x, vt4.x, vc7.x\t\t\t\\n\" + // distance *= vpsod\n\t\t\t\"mul vt3.xyz, vt3.xyz, vt4.xxx\t\\n\" + // S.xyz *= pixelScaleFactor\n\n\t\t\t\t// add scaled side vector to Q0 and transform to clip space\n\t\t\t\"add vt0.xyz, vt0.xyz, vt3.xyz\t\\n\" + // Q0 + S\n\n\t\t\t\"m44 op, vt0, vc0\t\t\t\\n\"  // transform Q0 to clip space\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:RenderPassBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, camera);\n\n\t\tthis._constants[0] = this._thickness/((this._stage.scissorRect)? Math.min(this._stage.scissorRect.width, this._stage.scissorRect.height) : Math.min(this._stage.width, this._stage.height));\n\n\t\t// value to convert distance from camera to model length per pixel width\n\t\tthis._constants[2] = camera.projection.near;\n\n\t\tvar context:IContextGL = this._stage.context;\n\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, LineSubMeshRenderable.pONE_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 6, LineSubMeshRenderable.pFRONT_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 7, this._constants, 1);\n\n\t\t// projection matrix\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, camera.projection.matrix, true);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iRender(pass:RenderPassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRender(pass, camera, viewProjection);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tthis._calcMatrix.copyFrom(this.sourceEntity.sceneTransform);\n\t\tthis._calcMatrix.append(camera.inverseSceneTransform);\n\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 8, this._calcMatrix, true);\n\n\t\tthis._stage.activateBuffer(0, this.getVertexData(LineSubGeometry.START_POSITION_DATA), this.getVertexOffset(LineSubGeometry.START_POSITION_DATA), LineSubGeometry.POSITION_FORMAT);\n\t\tthis._stage.activateBuffer(1, this.getVertexData(LineSubGeometry.END_POSITION_DATA), this.getVertexOffset(LineSubGeometry.END_POSITION_DATA), LineSubGeometry.POSITION_FORMAT);\n\t\tthis._stage.activateBuffer(2, this.getVertexData(LineSubGeometry.THICKNESS_DATA), this.getVertexOffset(LineSubGeometry.THICKNESS_DATA), LineSubGeometry.THICKNESS_FORMAT);\n\n\t\tcontext.drawTriangles(this._stage.getIndexBuffer(this.getIndexData()), 0, this.numTriangles);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.LineSubMeshRenderable}\n\t * @private\n\t */\n\tpublic _pGetOverflowRenderable(indexOffset:number):RenderableBase\n\t{\n\t\treturn new LineSubMeshRenderable(this._pool, <LineSubMesh> this.renderableOwner, this._stage, this._level + 1, indexOffset);\n\t}\n}\n\nexport = LineSubMeshRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-core/lib/data/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport IRenderable\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport RenderableOwnerEvent\t\t\t= require(\"awayjs-display/lib/events/RenderableOwnerEvent\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-core/lib/events/SubGeometryEvent\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport IndexData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/IndexData\");\nimport IndexDataPool\t\t\t\t= require(\"awayjs-stagegl/lib/pool/IndexDataPool\");\nimport VertexData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/VertexData\");\nimport VertexDataPool\t\t\t\t= require(\"awayjs-stagegl/lib/pool/VertexDataPool\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport RenderablePoolBase\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * @class RenderableListItem\n */\nclass RenderableBase implements IRenderable\n{\n\n\tprivate _onIndicesUpdatedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onVerticesUpdatedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onRenderObjectOwnerUpdatedDelegate:(event:RenderableOwnerEvent) => void;\n\n\tprivate _subGeometry:SubGeometryBase;\n\tprivate _geometryDirty:boolean = true;\n\tprivate _indexData:IndexData;\n\tprivate _indexDataDirty:boolean = true;\n\tprivate _vertexData:Object = new Object();\n\tpublic _pVertexDataDirty:Object = new Object();\n\tprivate _vertexOffset:Object = new Object();\n\n\tpublic _level:number;\n\tprivate _indexOffset:number;\n\tprivate _overflow:RenderableBase;\n\tprivate _numTriangles:number;\n\tprivate _concatenateArrays:boolean;\n\n\tpublic JOINT_INDEX_FORMAT:string;\n\tpublic JOINT_WEIGHT_FORMAT:string;\n\n\t/**\n\t *\n\t */\n\tpublic _pool:RenderablePoolBase;\n\n\tpublic _stage:Stage;\n\n\t/**\n\t *\n\t */\n\tpublic get overflow():RenderableBase\n\t{\n\t\tif (this._indexDataDirty)\n\t\t\tthis._updateIndexData();\n\n\t\treturn this._overflow;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get numTriangles():number\n\t{\n\t\treturn this._numTriangles;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic next:RenderableBase;\n\n\tpublic id:number;\n\n\t/**\n\t *\n\t */\n\tpublic renderObjectId:number;\n\n\t/**\n\t *\n\t */\n\tpublic renderOrderId:number;\n\n\t/**\n\t *\n\t */\n\tpublic zIndex:number;\n\n\t/**\n\t *\n\t */\n\tpublic cascaded:boolean;\n\n\t/**\n\t *\n\t */\n\tpublic renderSceneTransform:Matrix3D;\n\n\t/**\n\t *\n\t */\n\tpublic sourceEntity:IEntity;\n\n\t/**\n\t *\n\t */\n\tpublic renderableOwner:IRenderableOwner;\n\n\n\t/**\n\t *\n\t */\n\tpublic renderObjectOwner:IRenderObjectOwner;\n\n\t/**\n\t *\n\t */\n\tpublic renderObject:RenderObjectBase;\n\n\t/**\n\t *\n\t */\n\tpublic getIndexData():IndexData\n\t{\n\t\tif (this._indexDataDirty)\n\t\t\tthis._updateIndexData();\n\n\t\treturn this._indexData;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getVertexData(dataType:string):VertexData\n\t{\n\t\tif (this._indexDataDirty)\n\t\t\tthis._updateIndexData();\n\n\t\tif (this._pVertexDataDirty[dataType])\n\t\t\tthis._updateVertexData(dataType);\n\n\t\treturn this._vertexData[this._concatenateArrays? TriangleSubGeometry.VERTEX_DATA : dataType]\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getVertexOffset(dataType:string):number\n\t{\n\t\tif (this._indexDataDirty)\n\t\t\tthis._updateIndexData();\n\n\t\tif (this._pVertexDataDirty[dataType])\n\t\t\tthis._updateVertexData(dataType);\n\n\t\treturn this._vertexOffset[dataType];\n\t}\n\n\t/**\n\t *\n\t * @param sourceEntity\n\t * @param renderableOwner\n\t * @param subGeometry\n\t * @param animationSubGeometry\n\t */\n\tconstructor(pool:RenderablePoolBase, sourceEntity:IEntity, renderableOwner:IRenderableOwner, renderObjectOwner:IRenderObjectOwner, stage:Stage, level:number = 0, indexOffset:number = 0)\n\t{\n\t\tthis._onIndicesUpdatedDelegate = (event:SubGeometryEvent) => this._onIndicesUpdated(event);\n\t\tthis._onVerticesUpdatedDelegate = (event:SubGeometryEvent) => this._onVerticesUpdated(event);\n\t\tthis._onRenderObjectOwnerUpdatedDelegate = (event:RenderableOwnerEvent) => this._onRenderObjectOwnerUpdated(event);\n\n\t\t//store a reference to the pool for later disposal\n\t\tthis._pool = pool;\n\t\tthis._stage = stage;\n\n\t\t//reference to level of overflow\n\t\tthis._level = level;\n\n\t\t//reference to the offset on indices (if this is an overflow renderable)\n\t\tthis._indexOffset = indexOffset;\n\n\t\tthis.sourceEntity = sourceEntity;\n\n\t\tthis.renderableOwner = renderableOwner;\n\n\t\tthis.renderableOwner.addEventListener(RenderableOwnerEvent.RENDER_OBJECT_OWNER_UPDATED, this._onRenderObjectOwnerUpdatedDelegate)\n\n\t\tthis.renderObjectOwner = renderObjectOwner;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this.renderableOwner);\n\n\t\tthis._indexData.dispose();\n\t\tthis._indexData = null;\n\n\t\tfor (var dataType in this._vertexData) {\n\t\t\t(<VertexData> this._vertexData[dataType]).dispose();\n\t\t\tthis._vertexData[dataType] = null;\n\t\t}\n\n\t\tif (this._overflow) {\n\t\t\tthis._overflow.dispose();\n\t\t\tthis._overflow = null;\n\t\t}\n\t}\n\n\tpublic invalidateGeometry()\n\t{\n\t\tthis._geometryDirty = true;\n\n\t\t//invalidate indices\n\t\tif (this._level == 0)\n\t\t\tthis._indexDataDirty = true;\n\n\t\tif (this._overflow)\n\t\t\tthis._overflow.invalidateGeometry();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateIndexData()\n\t{\n\t\tthis._indexDataDirty = true;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param dataType\n\t */\n\tpublic invalidateVertexData(dataType:string)\n\t{\n\t\tthis._pVertexDataDirty[dataType] = true;\n\t}\n\n\tpublic _pGetSubGeometry():SubGeometryBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic static _iGetVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic static _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param subGeometry\n\t * @param offset\n\t * @internal\n\t */\n\tpublic _iFillIndexData(indexOffset:number)\n\t{\n\t\tif (this._geometryDirty)\n\t\t\tthis._updateGeometry();\n\n\t\tthis._indexData = IndexDataPool.getItem(this._subGeometry, this._level, indexOffset);\n\n\t\tthis._numTriangles = this._indexData.data.length/3;\n\n\t\tindexOffset = this._indexData.offset;\n\n\t\t//check if there is more to split\n\t\tif (indexOffset < this._subGeometry.indices.length) {\n\t\t\tif (!this._overflow)\n\t\t\t\tthis._overflow = this._pGetOverflowRenderable(indexOffset);\n\n\t\t\tthis._overflow._iFillIndexData(indexOffset);\n\t\t} else if (this._overflow) {\n\t\t\tthis._overflow.dispose();\n\t\t\tthis._overflow = null;\n\t\t}\n\t}\n\n\tpublic _pGetOverflowRenderable(indexOffset:number):RenderableBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * Sets the render state for the pass that is independent of the rendered object. This needs to be called before\n\t * calling renderPass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivate(pass:RenderPassBase, camera:Camera)\n\t{\n\t\tpass._iActivate(camera);\n\t}\n\n\t/**\n\t * Renders an object to the current render target.\n\t *\n\t * @private\n\t */\n\tpublic _iRender(pass:RenderPassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tpass._iRender(this, camera, viewProjection);\n\t}\n\n\t/**\n\t * Clears the render state for the pass. This needs to be called before activating another pass.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @private\n\t */\n\tpublic _iDeactivate(pass:RenderPassBase)\n\t{\n\t\tpass._iDeactivate();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @private\n\t */\n\tprivate _updateGeometry()\n\t{\n\t\tif (this._subGeometry) {\n\t\t\tif (this._level == 0)\n\t\t\t\tthis._subGeometry.removeEventListener(SubGeometryEvent.INDICES_UPDATED, this._onIndicesUpdatedDelegate);\n\t\t\tthis._subGeometry.removeEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdatedDelegate);\n\t\t}\n\n\t\tthis._subGeometry = this._pGetSubGeometry();\n\n\t\tthis._concatenateArrays = this._subGeometry.concatenateArrays;\n\n\t\tif (this._subGeometry) {\n\t\t\tif (this._level == 0)\n\t\t\t\tthis._subGeometry.addEventListener(SubGeometryEvent.INDICES_UPDATED, this._onIndicesUpdatedDelegate);\n\t\t\tthis._subGeometry.addEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdatedDelegate);\n\t\t}\n\n\t\t//dispose\n//\t\t\tif (this._indexData) {\n//\t\t\t\tthis._indexData.dispose(); //TODO where is a good place to dispose?\n//\t\t\t\tthis._indexData = null;\n//\t\t\t}\n\n//\t\t\tfor (var dataType in this._vertexData) {\n//\t\t\t\t(<VertexData> this._vertexData[dataType]).dispose(); //TODO where is a good place to dispose?\n//\t\t\t\tthis._vertexData[dataType] = null;\n//\t\t\t}\n\n\t\tthis._geometryDirty = false;\n\n\t\t//specific vertex data types have to be invalidated in the specific renderable\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @private\n\t */\n\tprivate _updateIndexData()\n\t{\n\t\tthis._iFillIndexData(this._indexOffset);\n\n\t\tthis._indexDataDirty = false;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param dataType\n\t * @private\n\t */\n\tprivate _updateVertexData(dataType:string)\n\t{\n\t\tthis._vertexOffset[dataType] = this._subGeometry.getOffset(dataType);\n\n\t\tif (this._subGeometry.concatenateArrays)\n\t\t\tdataType = SubGeometryBase.VERTEX_DATA;\n\n\t\tthis._vertexData[dataType] = VertexDataPool.getItem(this._subGeometry, this.getIndexData(), dataType);\n\n\t\tthis._pVertexDataDirty[dataType] = false;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onIndicesUpdated(event:SubGeometryEvent)\n\t{\n\t\tthis.invalidateIndexData();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onVerticesUpdated(event:SubGeometryEvent)\n\t{\n\t\tthis._concatenateArrays = (<SubGeometryBase> event.target).concatenateArrays;\n\n\t\tthis.invalidateVertexData(event.dataType);\n\t}\n\n\tprivate _onRenderObjectOwnerUpdated(event:RenderableOwnerEvent)\n\t{\n\t\t//TODO flag unused renderObjects for deletion\n\t\tthis.renderObjectOwner = event.renderObjectOwner;\n\t}\n}\n\nexport = RenderableBase;",
    "import IRenderObjectOwner\t\t\t= require(\"awayjs-display/lib/base/IRenderObjectOwner\");\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport IRenderablePool\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderablePool\");\nimport IRenderObject\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderObject\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/pool/IRenderableClass\");\nimport RenderObjectPool\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectPool\");\nimport RenderBasicMaterialObject\t= require(\"awayjs-renderergl/lib/compilation/RenderBasicMaterialObject\");\nimport SkyboxRenderObject\t\t\t= require(\"awayjs-renderergl/lib/compilation/SkyboxRenderObject\");\nimport DepthRenderObject\t\t\t= require(\"awayjs-renderergl/lib/compilation/DepthRenderObject\");\nimport DistanceRenderObject\t\t\t= require(\"awayjs-renderergl/lib/compilation/DistanceRenderObject\");\nimport RenderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/RenderObjectBase\");\n\n/**\n * @class away.pool.RenderablePoolBase\n */\nclass RenderablePoolBase implements IRenderablePool\n{\n\tpublic static _pools:Object = new Object();\n\n\tpublic _stage:Stage;\n\tpublic _renderablePool:Object = new Object();\n\tpublic _renderableClass:IRenderableClass;\n\n\tprivate _materialRenderObjectPool:RenderObjectPool;\n\tprivate _skyboxRenderObjectPool:RenderObjectPool;\n\tprivate _depthRenderObjectPool:RenderObjectPool;\n\tprivate _distanceRenderObjectPool:RenderObjectPool;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t */\n\tconstructor(renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\n\t\tthis._materialRenderObjectPool = new RenderObjectPool(RenderBasicMaterialObject, this._renderableClass, this._stage);\n\t\tthis._skyboxRenderObjectPool = new RenderObjectPool(SkyboxRenderObject, this._renderableClass, this._stage);\n\t\tthis._depthRenderObjectPool = new RenderObjectPool(DepthRenderObject, this._renderableClass, this._stage);\n\t\tthis._distanceRenderObjectPool = new RenderObjectPool(DistanceRenderObject, this._renderableClass, this._stage);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t * @returns IRenderable\n\t */\n\tpublic getItem(renderableOwner:IRenderableOwner):RenderableBase\n\t{\n\t\treturn (this._renderablePool[renderableOwner.id] || (this._renderablePool[renderableOwner.id] = renderableOwner._iAddRenderable(new this._renderableClass(this, renderableOwner, this._stage))))\n\t}\n\n\t/**\n\t *\n\t * @param material\n\t * @param renderable\n\t */\n\tpublic getMaterialRenderObject(renderObjectOwner:IRenderObjectOwner):RenderObjectBase\n\t{\n\t\treturn this._materialRenderObjectPool.getItem(renderObjectOwner);\n\t}\n\n\t/**\n\t *\n\t * @param material\n\t * @param renderable\n\t */\n\tpublic getSkyboxRenderObject(renderObjectOwner:IRenderObjectOwner):RenderObjectBase\n\t{\n\t\treturn this._skyboxRenderObjectPool.getItem(renderObjectOwner);\n\t}\n\n\t/**\n\t *\n\t * @param material\n\t * @param renderable\n\t */\n\tpublic getDepthRenderObject(renderObjectOwner:IRenderObjectOwner):RenderObjectBase\n\t{\n\t\treturn this._depthRenderObjectPool.getItem(renderObjectOwner);\n\t}\n\n\t/**\n\t *\n\t * @param material\n\t * @param renderable\n\t */\n\tpublic getDistanceRenderObject(renderObjectOwner:IRenderObjectOwner):RenderObjectBase\n\t{\n\t\treturn this._distanceRenderObjectPool.getItem(renderObjectOwner);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t */\n\tpublic disposeItem(renderableOwner:IRenderableOwner)\n\t{\n\t\trenderableOwner._iRemoveRenderable(this._renderablePool[renderableOwner.id]);\n\n\t\tthis._renderablePool[renderableOwner.id] = null;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var id in this._renderablePool)\n\t\t\tthis._renderablePool[id].dispose();\n\n\t\tRenderablePoolBase.disposePool(this._renderableClass, this._stage);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t * @returns RenderablePoolBase\n\t */\n\tpublic static getPool(renderableClass:IRenderableClass, stage:Stage):RenderablePoolBase\n\t{\n\t\tvar pools:Object = (RenderablePoolBase._pools[stage.stageIndex] || (RenderablePoolBase._pools[stage.stageIndex] = new Object()));\n\n\t\treturn (pools[renderableClass.id] || (pools[renderableClass.id] = new RenderablePoolBase(renderableClass, stage)));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t */\n\tpublic static disposePool(renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tvar pools:Object = RenderablePoolBase._pools[stage.stageIndex];\n\n\t\tif (pools == undefined)\n\t\t\treturn;\n\n\t\tif (pools[renderableClass.id])\n\t\t\tpools[renderableClass.id] = undefined;\n\t}\n}\n\nexport = RenderablePoolBase;",
    "\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport CurveSubMesh\t\t\t    \t= require(\"awayjs-display/lib/base/CurveSubMesh\");\nimport IRendererPool\t\t\t\t= require(\"awayjs-display/lib/pool/IRendererPool\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport LineSegment\t\t\t\t\t= require(\"awayjs-display/lib/entities/LineSegment\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport BillboardRenderable\t\t\t= require(\"awayjs-renderergl/lib/pool/BillboardRenderable\");\nimport LineSegmentRenderable\t\t= require(\"awayjs-renderergl/lib/pool/LineSegmentRenderable\");\nimport LineSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/pool/LineSubMeshRenderable\");\nimport TriangleSubMeshRenderable\t= require(\"awayjs-renderergl/lib/pool/TriangleSubMeshRenderable\");\nimport CurveSubMeshRenderable\t    = require(\"awayjs-renderergl/lib/pool/CurveSubMeshRenderable\");\nimport RenderablePoolBase\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\n\n/**\n * RendererPoolBase forms an abstract base class for classes that are used in the rendering pipeline to render the\n * contents of a partition\n *\n * @class away.render.RendererPoolBase\n */\nclass RendererPoolBase implements IRendererPool\n{\n\tpublic _billboardRenderablePool:RenderablePoolBase;\n\tpublic _lineSegmentRenderablePool:RenderablePoolBase;\n\tpublic _triangleSubMeshRenderablePool:RenderablePoolBase;\n\tpublic _lineSubMeshRenderablePool:RenderablePoolBase;\n    public _curveSubMeshRenderablePool:RenderablePoolBase;\n\n\tpublic _pStage:Stage;\n\n\n\tprivate _renderer:RendererBase;\n\t\n\t/**\n\t * Creates a new RendererPoolBase object.\n\t */\n\tconstructor(renderer:RendererBase)\n\t{\n\t\tthis._renderer = renderer;\n\t}\n\n\t/**\n\t * The Stage that will provide the ContextGL used for rendering.\n\t */\n\tpublic get stage():Stage\n\t{\n\t\treturn this._pStage;\n\t}\n\n\tpublic set stage(value:Stage)\n\t{\n\t\tif (this._pStage == value)\n\t\t\treturn;\n\n\t\tif (this._pStage)\n\t\t\tthis.dispose();\n\n\t\tthis._pStage = value;\n\n\t\tif (this._pStage)\n\t\t\tthis._pUpdatePool();\n\t}\n\n\tpublic _pUpdatePool()\n\t{\n\t\tthis._billboardRenderablePool = RenderablePoolBase.getPool(BillboardRenderable, this._pStage);\n\t\tthis._lineSegmentRenderablePool = RenderablePoolBase.getPool(LineSegmentRenderable, this._pStage);\n\t\tthis._triangleSubMeshRenderablePool = RenderablePoolBase.getPool(TriangleSubMeshRenderable, this._pStage);\n\t\tthis._lineSubMeshRenderablePool = RenderablePoolBase.getPool(LineSubMeshRenderable, this._pStage);\n        this._curveSubMeshRenderablePool = RenderablePoolBase.getPool(CurveSubMeshRenderable, this._pStage);\n\t}\n\n\t/**\n\t * Disposes the resources used by the RendererPoolBase.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._billboardRenderablePool.dispose();\n\t\tthis._billboardRenderablePool = null;\n\n\t\tthis._lineSegmentRenderablePool.dispose();\n\t\tthis._lineSegmentRenderablePool = null;\n\n\t\tthis._triangleSubMeshRenderablePool.dispose();\n\t\tthis._triangleSubMeshRenderablePool = null;\n\n\t\tthis._lineSubMeshRenderablePool.dispose();\n\t\tthis._lineSubMeshRenderablePool = null;\n\n        this._curveSubMeshRenderablePool.dispose();\n        this._curveSubMeshRenderablePool = null;\n\t}\n\n\t/**\n\t *\n\t * @param billboard\n\t * @protected\n\t */\n\tpublic applyBillboard(billboard:Billboard)\n\t{\n\t\tthis._renderer.applyRenderable(this._billboardRenderablePool.getItem(billboard));\n\t}\n\n\t/**\n\t *\n\t * @param lineSubMesh\n\t */\n\tpublic applyLineSegment(lineSegment:LineSegment)\n\t{\n\t\tthis._renderer.applyRenderable(this._lineSegmentRenderablePool.getItem(lineSegment));\n\t}\n\n\t/**\n\t *\n\t * @param triangleSubMesh\n\t */\n\tpublic applyTriangleSubMesh(triangleSubMesh:TriangleSubMesh)\n\t{\n\t\tthis._renderer.applyRenderable(this._triangleSubMeshRenderablePool.getItem(triangleSubMesh));\n\t}\n    /**\n     *\n     * @param curveSubMesh\n     */\n    public applyCurveSubMesh(curveSubMesh:CurveSubMesh)\n    {\n        this._renderer.applyRenderable(this._curveSubMeshRenderablePool.getItem(curveSubMesh));\n    }\n\t/**\n\t *\n\t * @param lineSubMesh\n\t */\n\tpublic applyLineSubMesh(lineSubMesh:LineSubMesh)\n\t{\n\t\tthis._renderer.applyRenderable(this._lineSubMeshRenderablePool.getItem(lineSubMesh));\n\t}\n}\n\nexport = RendererPoolBase;",
    "import Sampler2D\t\t\t\t\t= require(\"awayjs-core/lib/data/Sampler2D\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport SamplerObjectBase\t\t\t= require(\"awayjs-renderergl/lib/pool/SamplerObjectBase\");\n\n/**\n *\n * @class away.pool.Sampler2DObject\n */\nclass Sampler2DObject extends SamplerObjectBase\n{\n\tpublic sampler2D:Sampler2D;\n\n\tpublic fragmentReg:ShaderRegisterElement;\n\n\tpublic fragmentIndex:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper(stage);\n\t}\n\n\n\tpublic initProperties(sampler2D:Sampler2D, regCache:ShaderRegisterCache)\n\t{\n\t\tthis.sampler2D = sampler2D;\n\n\t\tthis.samplerReg = regCache.getFreeTextureReg();\n\t\tthis.samplerIndex = this.samplerReg.index;\n\n\t\tif (this.sampler2D.imageRect) {\n\t\t\tthis.fragmentReg = regCache.getFreeFragmentConstant();\n\t\t\tthis.fragmentIndex = this.fragmentReg.index*4;\n\t\t}\n\t}\n\n\tpublic getFragmentCode(shaderObject:ShaderObjectBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar wrap:string = (shaderObject.repeatTextures? \"wrap\":\"clamp\");\n\t\tvar format:string = this.getFormatString(this.sampler2D);\n\t\tvar filter:string = (shaderObject.useSmoothTextures)? (shaderObject.useMipmapping? \"linear,miplinear\" : \"linear\") : (shaderObject.useMipmapping? \"nearest,mipnearest\" : \"nearest\");\n\n\t\tvar temp:ShaderRegisterElement;\n\n\t\t//handles texture atlasing\n\t\tif (this.sampler2D.imageRect) {\n\t\t\ttemp = regCache.getFreeFragmentVectorTemp();\n\n\t\t\tcode += \"mul \" + temp + \", \" + inputReg + \", \" + this.fragmentReg + \".xy\\n\";\n\t\t\tcode += \"add \" + temp + \", \" + temp + \", \" + this.fragmentReg + \".zw\\n\";\n\t\t} else {\n\t\t\ttemp = inputReg;\n\t\t}\n\n\t\tcode += \"tex \" + targetReg + \", \" + temp + \", \" + this.samplerReg + \" <2d,\" + filter + \",\" + format + wrap + \">\\n\";\n\n\t\treturn code;\n\t}\n\n\tpublic activate(shaderObject:ShaderObjectBase)\n\t{\n\t\tthis._stage.getImageObject(this.sampler2D.image2D).activate(this.samplerIndex, this.sampler2D.repeat || shaderObject.repeatTextures, this.sampler2D.smooth || shaderObject.useSmoothTextures, this.sampler2D.mipmap || shaderObject.useMipmapping);\n\n\t\tif (this.sampler2D.imageRect) {\n\t\t\tvar index:number = this.fragmentIndex;\n\t\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\t\tdata[index] = this.sampler2D.scaleX;\n\t\t\tdata[index + 1] = this.sampler2D.scaleY;\n\t\t\tdata[index + 2] = this.sampler2D.offsetX;\n\t\t\tdata[index + 3] = this.sampler2D.offsetY;\n\t\t}\n\t}\n}\n\nexport = Sampler2DObject;",
    "import SamplerCube\t\t\t\t\t= require(\"awayjs-core/lib/data/SamplerCube\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport SamplerObjectBase\t\t\t= require(\"awayjs-renderergl/lib/pool/SamplerObjectBase\");\n\n/**\n *\n * @class away.pool.BitmapObject\n */\nclass SamplerCubeObject extends SamplerObjectBase\n{\n\tpublic samplerCube:SamplerCube;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper(stage);\n\t}\n\n\tpublic initProperties(samplerCube:SamplerCube, regCache:ShaderRegisterCache)\n\t{\n\t\tthis.samplerCube = samplerCube;\n\n\t\tthis.samplerReg = regCache.getFreeTextureReg();\n\n\t\tthis.samplerIndex = this.samplerReg.index;\n\t}\n\n\tpublic getFragmentCode(shaderObject:ShaderObjectBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\tvar filter:string;\n\t\tvar format:string = this.getFormatString(this.samplerCube);\n\t\tvar filter:string = (shaderObject.useSmoothTextures)? (shaderObject.useMipmapping? \"linear,miplinear\" : \"linear\") : (shaderObject.useMipmapping? \"nearest,mipnearest\" : \"nearest\");\n\n\t\treturn \"tex \" + targetReg + \", \" + inputReg + \", \" + this.samplerReg + \" <cube,\" + format + filter + \">\\n\";\n\t}\n\n\tpublic activate(shaderObject:ShaderObjectBase)\n\t{\n\t\tthis._stage.getImageObject(this.samplerCube.imageCube).activate(this.samplerIndex, false, this.samplerCube.smooth || shaderObject.useSmoothTextures, this.samplerCube.mipmap || shaderObject.useMipmapping);\n\t}\n}\n\nexport = SamplerCubeObject;",
    "import SamplerBase\t\t\t\t\t= require(\"awayjs-core/lib/data/SamplerBase\");\n\nimport ContextGLTextureFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFormat\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\n\n\n/**\n *\n * @class away.pool.SamplerObjectBase\n */\nclass SamplerObjectBase\n{\n\tpublic _stage:Stage;\n\n\tpublic samplerReg:ShaderRegisterElement;\n\n\tpublic samplerIndex:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * Generates a texture format string for the sample instruction.\n\t * @param texture The texture for which to get the format string.\n\t * @return\n\t *\n\t * @protected\n\t */\n\tpublic getFormatString(bitmap:SamplerBase):string\n\t{\n\t\tswitch (bitmap.format) {\n\t\t\tcase ContextGLTextureFormat.COMPRESSED:\n\t\t\t\treturn \"dxt1,\";\n\t\t\t\tbreak;\n\t\t\tcase ContextGLTextureFormat.COMPRESSED_ALPHA:\n\t\t\t\treturn \"dxt5,\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn \"\";\n\t\t}\n\t}\n}\n\nexport = SamplerObjectBase;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport Single2DTexture\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport TextureObjectPool\t\t\t= require(\"awayjs-renderergl/lib/pool/TextureObjectPool\");\nimport TextureObjectBase\t\t\t= require(\"awayjs-renderergl/lib/pool/TextureObjectBase\");\nimport Sampler2DObject\t\t\t\t= require(\"awayjs-renderergl/lib/pool/Sampler2DObject\");\n\n/**\n *\n * @class away.pool.Single2DTextureObject\n */\nclass Single2DTextureObject extends TextureObjectBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = Single2DTexture;\n\n\tprivate _single2DTexture:Single2DTexture;\n\n\tprivate _sampler2DObject:Sampler2DObject;\n\n\tconstructor(pool:TextureObjectPool, single2DTexture:Single2DTexture, stage:Stage)\n\t{\n\t\tsuper(pool, single2DTexture, stage);\n\n\t\tthis._single2DTexture = single2DTexture;\n\n\t\tthis._sampler2DObject = new Sampler2DObject(stage);\n\t}\n\n\tpublic _iInitRegisters(shaderObject:ShaderObjectBase, regCache:ShaderRegisterCache)\n\t{\n\t\tthis._sampler2DObject.initProperties(this._single2DTexture.sampler2D, regCache);\n\t}\n\n\t/**\n\t *\n\t * @param shaderObject\n\t * @param regCache\n\t * @param targetReg The register in which to store the sampled colour.\n\t * @param uvReg The uv coordinate vector with which to sample the texture map.\n\t * @returns {string}\n\t * @private\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\treturn this._sampler2DObject.getFragmentCode(shaderObject, targetReg, regCache, inputReg);\n\t}\n\n\tpublic activate(shaderObject:ShaderObjectBase)\n\t{\n\t\tthis._sampler2DObject.activate(shaderObject);\n\t}\n}\n\nexport = Single2DTextureObject;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport SingleCubeTexture\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport TextureObjectPool\t\t\t= require(\"awayjs-renderergl/lib/pool/TextureObjectPool\");\nimport TextureObjectBase\t\t\t= require(\"awayjs-renderergl/lib/pool/TextureObjectBase\");\nimport SamplerCubeObject\t\t\t= require(\"awayjs-renderergl/lib/pool/SamplerCubeObject\");\n\n/**\n *\n * @class away.pool.TextureDataBase\n */\nclass SingleCubeTextureObject extends TextureObjectBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = SingleCubeTexture;\n\n\n\tprivate _singleCubeTexture:SingleCubeTexture;\n\n\tprivate _samplerCubeObject:SamplerCubeObject;\n\n\tconstructor(pool:TextureObjectPool, singleCubeTexture:SingleCubeTexture, stage:Stage)\n\t{\n\t\tsuper(pool, singleCubeTexture, stage);\n\n\t\tthis._singleCubeTexture = singleCubeTexture;\n\n\t\tthis._samplerCubeObject = new SamplerCubeObject(stage);\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase, includeInput:boolean = true)\n\t{\n\t\tif (includeInput)\n\t\t\tshaderObject.usesLocalPosFragment = true;\n\t}\n\n\tpublic _iInitRegisters(shaderObject:ShaderObjectBase, regCache:ShaderRegisterCache)\n\t{\n\t\tthis._samplerCubeObject.initProperties(this._singleCubeTexture.samplerCube, regCache);\n\t}\n\n\t/**\n\t *\n\t * @param shaderObject\n\t * @param regCache\n\t * @param targetReg The register in which to store the sampled colour.\n\t * @param uvReg The direction vector with which to sample the cube map.\n\t * @returns {string}\n\t * @private\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\treturn this._samplerCubeObject.getFragmentCode(shaderObject, targetReg, regCache, inputReg);\n\t}\n\n\tpublic activate(shaderObject:ShaderObjectBase)\n\t{\n\t\tthis._samplerCubeObject.activate(shaderObject);\n\t}\n}\n\nexport = SingleCubeTextureObject;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderablePoolBase\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * @class away.pool.SkyboxRenderable\n */\nclass SkyboxRenderable extends RenderableBase\n{\n\tprivate _vertexArray:Array<number>;\n\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"skybox\";\n\n\tpublic static vertexAttributesOffset:number = 1;\n\n\t/**\n\t *\n\t */\n\tprivate static _geometry:TriangleSubGeometry;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param skybox\n\t */\n\tconstructor(pool:RenderablePoolBase, skybox:Skybox, stage:Stage)\n\t{\n\t\tsuper(pool, skybox, skybox, skybox, stage);\n\n\t\tthis._vertexArray = new Array<number>(0, 0, 0, 0, 1, 1, 1, 1);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {away.base.TriangleSubGeometry}\n\t * @private\n\t */\n\tpublic _pGetSubGeometry():TriangleSubGeometry\n\t{\n\t\tvar geometry:TriangleSubGeometry = SkyboxRenderable._geometry;\n\n\t\tif (!geometry) {\n\t\t\tgeometry = SkyboxRenderable._geometry = new TriangleSubGeometry(true);\n\t\t\tgeometry.autoDeriveNormals = false;\n\t\t\tgeometry.autoDeriveTangents = false;\n\t\t\tgeometry.updateIndices(Array<number>(0, 1, 2, 2, 3, 0, 6, 5, 4, 4, 7, 6, 2, 6, 7, 7, 3, 2, 4, 5, 1, 1, 0, 4, 4, 0, 3, 3, 7, 4, 2, 1, 5, 5, 6, 2));\n\t\t\tgeometry.updatePositions(Array<number>(-1, 1, -1, 1, 1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1, 1));\n\t\t}\n\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.POSITION_DATA] = true;\n\n\t\treturn geometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static _iGetVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"mul vt0, va0, vc5\\n\" +\n\t\t\t\"add vt0, vt0, vc4\\n\" +\n\t\t\t\"m44 op, vt0, vc0\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iRender(pass:RenderPassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRender(pass, camera, viewProjection);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tvar pos:Vector3D = camera.scenePosition;\n\t\tthis._vertexArray[0] = pos.x;\n\t\tthis._vertexArray[1] = pos.y;\n\t\tthis._vertexArray[2] = pos.z;\n\t\tthis._vertexArray[4] = this._vertexArray[5] = this._vertexArray[6] = camera.projection.far/Math.sqrt(3);\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, viewProjection, true);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 4, this._vertexArray, 2);\n\n\t\tthis._stage.activateBuffer(0, this.getVertexData(TriangleSubGeometry.POSITION_DATA), this.getVertexOffset(TriangleSubGeometry.POSITION_DATA), TriangleSubGeometry.POSITION_FORMAT);\n\t\tcontext.drawTriangles(this._stage.getIndexBuffer(this.getIndexData()), 0, this.numTriangles);\n\t}\n}\n\nexport = SkyboxRenderable;",
    "import AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ITextureObject\t\t\t\t= require(\"awayjs-display/lib/pool/ITextureObject\");\nimport TextureBase\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport TextureObjectPool\t\t\t= require(\"awayjs-renderergl/lib/pool/TextureObjectPool\");\n\n/**\n *\n * @class away.pool.TextureObjectBaseBase\n */\nclass TextureObjectBase implements ITextureObject\n{\n\tprivate _pool:TextureObjectPool;\n\tprivate _texture:TextureBase;\n\n\tpublic _stage:Stage;\n\n\tpublic invalid:boolean;\n\n\tconstructor(pool:TextureObjectPool, texture:TextureBase, stage:Stage)\n\t{\n\t\tthis._pool = pool;\n\t\tthis._texture = texture;\n\t\tthis._stage = stage;\n\t}\n\n\tpublic _iInitRegisters(shaderObject:ShaderObjectBase, regCache:ShaderRegisterCache)\n\t{\n\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this._texture);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidate()\n\t{\n\t\tthis.invalid = true;\n\t}\n\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement = null):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic activate(shaderObject:ShaderObjectBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = TextureObjectBase;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport TextureBase\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport ITextureObjectClass\t\t\t= require(\"awayjs-renderergl/lib/pool/ITextureObjectClass\");\nimport TextureObjectBase\t\t\t= require(\"awayjs-renderergl/lib/pool/TextureObjectBase\");\nimport Single2DTextureObject\t\t= require(\"awayjs-renderergl/lib/pool/Single2DTextureObject\");\nimport SingleCubeTextureObject\t\t= require(\"awayjs-renderergl/lib/pool/SingleCubeTextureObject\");\n\n/**\n * @class away.pool.TextureObjectPool\n */\nclass TextureObjectPool\n{\n\tprivate static classPool:Object = new Object();\n\n\tpublic static _pools:Object = new Object();\n\n\tpublic _stage:Stage;\n\tprivate _pool:Object = new Object();\n\n\t/**\n\t * //TODO\n\t *\n\t * @param textureDataClass\n\t */\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ITexture\n\t */\n\tpublic getItem(texture:TextureBase):TextureObjectBase\n\t{\n\t\treturn (this._pool[texture.id] || (this._pool[texture.id] = texture._iAddTextureObject(new (TextureObjectPool.getClass(texture))(this, texture, this._stage))));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(texture:TextureBase)\n\t{\n\t\ttexture._iRemoveTextureObject(this._pool[texture.id]);\n\n\t\tthis._pool[texture.id] = null;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var id in this._pool)\n\t\t\tthis._pool[id].dispose();\n\n\t\tTextureObjectPool.disposePool(this._stage);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t * @returns RenderablePoolBase\n\t */\n\tpublic static getPool(stage:Stage):TextureObjectPool\n\t{\n\t\treturn (TextureObjectPool._pools[stage.stageIndex] || (TextureObjectPool._pools[stage.stageIndex] = new TextureObjectPool(stage)));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t */\n\tpublic static disposePool(stage:Stage)\n\t{\n\t\tTextureObjectPool._pools[stage.stageIndex] = undefined;\n\t}\n\n\t/**\n\t *\n\t * @param subMeshClass\n\t */\n\tpublic static registerClass(textureObjectClass:ITextureObjectClass)\n\t{\n\t\tTextureObjectPool.classPool[textureObjectClass.assetClass.assetType] = textureObjectClass;\n\t}\n\n\t/**\n\t *\n\t * @param subGeometry\n\t */\n\tpublic static getClass(texture:TextureBase):ITextureObjectClass\n\t{\n\t\treturn TextureObjectPool.classPool[texture.assetType];\n\t}\n\n\tprivate static main = TextureObjectPool.addDefaults();\n\n\tprivate static addDefaults()\n\t{\n\t\tTextureObjectPool.registerClass(Single2DTextureObject);\n\t\tTextureObjectPool.registerClass(SingleCubeTextureObject);\n\t}\n}\n\nexport = TextureObjectPool;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/compilation/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RenderablePoolBase\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderablePoolBase\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/passes/RenderPassBase\");\n\n/**\n * @class away.pool.TriangleSubMeshRenderable\n */\nclass TriangleSubMeshRenderable extends RenderableBase\n{\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"trianglesubmesh\";\n\n\tpublic static vertexAttributesOffset:number = 1;\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:TriangleSubMesh;\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param indexOffset\n\t */\n\tconstructor(pool:RenderablePoolBase, subMesh:TriangleSubMesh, stage:Stage, level:number = 0, indexOffset:number = 0)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, subMesh.material, stage, level, indexOffset);\n\n\t\tthis.subMesh = subMesh;\n\t}\n\n\t/**\n\t *\n\t * @returns {SubGeometryBase}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():TriangleSubGeometry\n\t{\n\t\tvar subGeometry:TriangleSubGeometry;\n\n\t\tif (this.subMesh.animator)\n\t\t\tsubGeometry = <TriangleSubGeometry> this.subMesh.animator.getRenderableSubGeometry(this, this.subMesh.subGeometry);\n\t\telse\n\t\t\tsubGeometry = this.subMesh.subGeometry;\n\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.POSITION_DATA] = true;\n\n\t\tif (subGeometry.vertexNormals)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.NORMAL_DATA] = true;\n\n\t\tif (subGeometry.vertexTangents)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.TANGENT_DATA] = true;\n\n\t\tif (subGeometry.uvs)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.UV_DATA] = true;\n\n\t\tif (subGeometry.secondaryUVs)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.SECONDARY_UV_DATA] = true;\n\n\t\tif (subGeometry.jointIndices)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.JOINT_INDEX_DATA] = true;\n\n\t\tif (subGeometry.jointWeights)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.JOINT_WEIGHT_DATA] = true;\n\n\t\tswitch(subGeometry.jointsPerVertex) {\n\t\t\tcase 1:\n\t\t\t\tthis.JOINT_INDEX_FORMAT = this.JOINT_WEIGHT_FORMAT = ContextGLVertexBufferFormat.FLOAT_1;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tthis.JOINT_INDEX_FORMAT = this.JOINT_WEIGHT_FORMAT = ContextGLVertexBufferFormat.FLOAT_2;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tthis.JOINT_INDEX_FORMAT = this.JOINT_WEIGHT_FORMAT = ContextGLVertexBufferFormat.FLOAT_3;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tthis.JOINT_INDEX_FORMAT = this.JOINT_WEIGHT_FORMAT = ContextGLVertexBufferFormat.FLOAT_4;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\n\t\treturn subGeometry;\n\t}\n\n\n\tpublic static _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\n\t}\n\n\tpublic static _iGetVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shaderObject.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshaderObject.viewMatrixIndex = viewMatrixReg.index*4;\n\n\t\tif (shaderObject.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \", \" + viewMatrixReg + \"\\n\" +\n\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\"mov op, \" + temp + \"\\n\";\n\t\t} else {\n\t\t\tcode += \"m44 op, \" + position + \", \" + viewMatrixReg + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iRender(pass:RenderPassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRender(pass, camera, viewProjection);\n\n\t\tvar shader:ShaderObjectBase = pass.shader;\n\n\t\tif (shader.sceneMatrixIndex >= 0) {\n\t\t\tthis.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shader.vertexConstantData, shader.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(this.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shader.vertexConstantData, shader.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shader.fragmentConstantData, shader.numUsedFragmentConstants);\n\n\t\tthis._stage.activateBuffer(0, this.getVertexData(TriangleSubGeometry.POSITION_DATA), this.getVertexOffset(TriangleSubGeometry.POSITION_DATA), TriangleSubGeometry.POSITION_FORMAT);\n\t\tthis._stage.context.drawTriangles(this._stage.getIndexBuffer(this.getIndexData()), 0, this.numTriangles);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.TriangleSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowRenderable(indexOffset:number):RenderableBase\n\t{\n\t\treturn new TriangleSubMeshRenderable(this._pool, <TriangleSubMesh> this.renderableOwner, this._stage, this._level + 1, indexOffset);\n\t}\n}\n\nexport = TriangleSubMeshRenderable;",
    "import Matrix3DUtils\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-core/lib/data/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n/**\n *  Class Merge merges two or more static meshes into one.<code>Merge</code>\n */\nclass Merge\n{\n\n\t//private const LIMIT:uint = 196605;\n\tprivate _objectSpace:boolean;\n\tprivate _keepMaterial:boolean;\n\tprivate _disposeSources:boolean;\n\tprivate _geomVOs:Array<GeometryVO>;\n\tprivate _toDispose:Array<Mesh>;\n\n\t/**\n\t * @param    keepMaterial    [optional]    Determines if the merged object uses the recevier mesh material information or keeps its source material(s). Defaults to false.\n\t * If false and receiver object has multiple materials, the last material found in receiver submeshes is applied to the merged submesh(es).\n\t * @param    disposeSources  [optional]    Determines if the mesh and geometry source(s) used for the merging are disposed. Defaults to false.\n\t * If true, only receiver geometry and resulting mesh are kept in  memory.\n\t * @param    objectSpace     [optional]    Determines if source mesh(es) is/are merged using objectSpace or worldspace. Defaults to false.\n\t */\n\tconstructor(keepMaterial:boolean = false, disposeSources:boolean = false, objectSpace:boolean = false)\n\t{\n\t\tthis._keepMaterial = keepMaterial;\n\t\tthis._disposeSources = disposeSources;\n\t\tthis._objectSpace = objectSpace;\n\t}\n\n\t/**\n\t * Determines if the mesh and geometry source(s) used for the merging are disposed. Defaults to false.\n\t */\n\tpublic set disposeSources(b:boolean)\n\t{\n\t\tthis._disposeSources = b;\n\t}\n\n\tpublic get disposeSources():boolean\n\t{\n\t\treturn this._disposeSources;\n\t}\n\n\t/**\n\t * Determines if the material source(s) used for the merging are disposed. Defaults to false.\n\t */\n\tpublic set keepMaterial(b:boolean)\n\t{\n\t\tthis._keepMaterial = b;\n\t}\n\n\tpublic get keepMaterial():boolean\n\t{\n\t\treturn this._keepMaterial;\n\t}\n\n\t/**\n\t * Determines if source mesh(es) is/are merged using objectSpace or worldspace. Defaults to false.\n\t */\n\tpublic set objectSpace(b:boolean)\n\t{\n\t\tthis._objectSpace = b;\n\t}\n\n\tpublic get objectSpace():boolean\n\t{\n\t\treturn this._objectSpace;\n\t}\n\n\t/**\n\t * Merges all the children of a container into a single Mesh. If no Mesh object is found, method returns the receiver without modification.\n\t *\n\t * @param    receiver           The Mesh to receive the merged contents of the container.\n\t * @param    objectContainer    The DisplayObjectContainer holding the meshes to be mergd.\n\t *\n\t * @return The merged Mesh instance.\n\t */\n\tpublic applyToContainer(receiver:Mesh, objectContainer:DisplayObjectContainer)\n\t{\n\t\tthis.reset();\n\n\t\t//collect container meshes\n\t\tthis.parseContainer(receiver, objectContainer);\n\n\t\t//collect receiver\n\t\tthis.collect(receiver, false);\n\n\t\t//merge to receiver\n\t\tthis.merge(receiver, this._disposeSources);\n\t}\n\n\t/**\n\t * Merges all the meshes found in the Array&lt;Mesh&gt; into a single Mesh.\n\t *\n\t * @param    receiver    The Mesh to receive the merged contents of the meshes.\n\t * @param    meshes      A series of Meshes to be merged with the reciever mesh.\n\t */\n\tpublic applyToMeshes(receiver:Mesh, meshes:Array<Mesh>)\n\t{\n\t\tthis.reset();\n\n\t\tif (!meshes.length)\n\t\t\treturn;\n\n\t\t//collect meshes in vector\n\t\tfor (var i:number /*uint*/ = 0; i < meshes.length; i++)\n\t\t\tif (meshes[i] != receiver)\n\t\t\t\tthis.collect(meshes[i], this._disposeSources);\n\n\t\t//collect receiver\n\t\tthis.collect(receiver, false);\n\n\t\t//merge to receiver\n\t\tthis.merge(receiver, this._disposeSources);\n\t}\n\n\t/**\n\t *  Merges 2 meshes into one. It is recommand to use apply when 2 meshes are to be merged. If more need to be merged, use either applyToMeshes or applyToContainer methods.\n\t *\n\t * @param    receiver    The Mesh to receive the merged contents of both meshes.\n\t * @param    mesh        The Mesh to be merged with the receiver mesh\n\t */\n\tpublic apply(receiver:Mesh, mesh:Mesh)\n\t{\n\t\tthis.reset();\n\n\t\t//collect mesh\n\t\tthis.collect(mesh, this._disposeSources);\n\n\t\t//collect receiver\n\t\tthis.collect(receiver, false);\n\n\t\t//merge to receiver\n\t\tthis.merge(receiver, this._disposeSources);\n\t}\n\n\tprivate reset()\n\t{\n\t\tthis._toDispose  = new Array<Mesh>();\n\t\tthis._geomVOs = new Array<GeometryVO>();\n\t}\n\n\tprivate merge(destMesh:Mesh, dispose:boolean)\n\t{\n\t\tvar i:number /*uint*/;\n\t\tvar subIdx:number /*uint*/;\n\t\tvar oldGeom:Geometry;\n\t\tvar destGeom:Geometry;\n\t\tvar useSubMaterials:boolean;\n\n\t\toldGeom = destMesh.geometry;\n\t\tdestGeom = destMesh.geometry = new Geometry();\n\t\tsubIdx = destMesh.subMeshes.length;\n\n\t\t// Only apply materials directly to sub-meshes if necessary,\n\t\t// i.e. if there is more than one material available.\n\t\tuseSubMaterials = (this._geomVOs.length > 1);\n\n\t\tfor (i = 0; i < this._geomVOs.length; i++) {\n\t\t\tvar s:number /*uint*/;\n\t\t\tvar data:GeometryVO;\n\t\t\tvar sub:TriangleSubGeometry = new TriangleSubGeometry(true);\n\t\t\tsub.autoDeriveNormals = false;\n\t\t\tsub.autoDeriveTangents = false;\n\n\t\t\tdata = this._geomVOs[i];\n\t\t\tsub.updateIndices(data.indices);\n\t\t\tsub.updatePositions(data.vertices);\n\t\t\tsub.updateVertexNormals(data.normals);\n\t\t\tsub.updateVertexTangents(data.tangents);\n\t\t\tsub.updateUVs(data.uvs);\n\n\t\t\tdestGeom.addSubGeometry(sub);\n\n\t\t\tif (this._keepMaterial && useSubMaterials)\n\t\t\t\tdestMesh.subMeshes[subIdx].material = data.material;\n\t\t}\n\n\t\tif (this._keepMaterial && !useSubMaterials && this._geomVOs.length)\n\t\t\tdestMesh.material = this._geomVOs[0].material;\n\n\t\tif (dispose) {\n\t\t\tvar m:Mesh;\n\t\t\tvar len:number = this._toDispose.length;\n\t\t\tfor (var i:number; i < len; i++) {\n\t\t\t\tm = this._toDispose[i];\n\t\t\t\tm.geometry.dispose();\n\t\t\t\tm.dispose();\n\t\t\t}\n\n\t\t\t//dispose of the original receiver geometry\n\t\t\toldGeom.dispose();\n\t\t}\n\n\t\tthis._toDispose = null;\n\t}\n\n\tprivate collect(mesh:Mesh, dispose:boolean)\n\t{\n\t\tif (mesh.geometry) {\n\t\t\tvar subIdx:number /*uint*/;\n\t\t\tvar subGeometries:Array<TriangleSubGeometry> = <Array<TriangleSubGeometry>> mesh.geometry.subGeometries;\n\t\t\tvar calc:number /*uint*/;\n\t\t\tfor (subIdx = 0; subIdx < subGeometries.length; subIdx++) {\n\t\t\t\tvar i:number /*uint*/;\n\t\t\t\tvar len:number /*uint*/;\n\t\t\t\tvar iIdx:number /*uint*/, vIdx:number /*uint*/, nIdx:number /*uint*/, tIdx:number /*uint*/, uIdx:number /*uint*/;\n\t\t\t\tvar indexOffset:number /*uint*/;\n\t\t\t\tvar subGeom:TriangleSubGeometry;\n\t\t\t\tvar vo:GeometryVO;\n\t\t\t\tvar vertices:Array<number>;\n\t\t\t\tvar normals:Array<number>;\n\t\t\t\tvar tangents:Array<number>;\n\t\t\t\tvar pd:Array<number>, nd:Array<number>, td:Array<number>, ud:Array<number>;\n\n\t\t\t\tsubGeom = subGeometries[subIdx];\n\t\t\t\tpd = subGeom.positions;\n\t\t\t\tnd = subGeom.vertexNormals;\n\t\t\t\ttd = subGeom.vertexTangents;\n\t\t\t\tud = subGeom.uvs;\n\n\t\t\t\t// Get (or create) a VO for this material\n\t\t\t\tvo = this.getSubGeomData(mesh.subMeshes[subIdx].material || mesh.material);\n\n\t\t\t\t// Vertices and normals are copied to temporary vectors, to be transformed\n\t\t\t\t// before concatenated onto those of the data. This is unnecessary if no\n\t\t\t\t// transformation will be performed, i.e. for object space merging.\n\t\t\t\tvertices = (this._objectSpace)? vo.vertices : new Array<number>();\n\t\t\t\tnormals = (this._objectSpace)? vo.normals : new Array<number>();\n\t\t\t\ttangents = (this._objectSpace)? vo.tangents : new Array<number>();\n\n\t\t\t\t// Copy over vertex attributes\n\t\t\t\tvIdx = vertices.length;\n\t\t\t\tnIdx = normals.length;\n\t\t\t\ttIdx = tangents.length;\n\t\t\t\tuIdx = vo.uvs.length;\n\t\t\t\tlen = subGeom.numVertices;\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\tcalc = i*3;\n\n\t\t\t\t\t// Position\n\t\t\t\t\tvertices[vIdx++] = pd[calc];\n\t\t\t\t\tvertices[vIdx++] = pd[calc + 1];\n\t\t\t\t\tvertices[vIdx++] = pd[calc + 2];\n\n\t\t\t\t\t// Normal\n\t\t\t\t\tnormals[nIdx++] = nd[calc];\n\t\t\t\t\tnormals[nIdx++] = nd[calc + 1];\n\t\t\t\t\tnormals[nIdx++] = nd[calc + 2];\n\n\t\t\t\t\t// Tangent\n\t\t\t\t\ttangents[tIdx++] = td[calc];\n\t\t\t\t\ttangents[tIdx++] = td[calc + 1];\n\t\t\t\t\ttangents[tIdx++] = td[calc + 2];\n\n\t\t\t\t\t// UV\n\t\t\t\t\tvo.uvs[uIdx++] = ud[i*2];\n\t\t\t\t\tvo.uvs[uIdx++] = ud[i*2 + 1];\n\t\t\t\t}\n\n\t\t\t\t// Copy over triangle indices\n\t\t\t\tindexOffset = (!this._objectSpace)? vo.vertices.length/3 :0;\n\t\t\t\tiIdx = vo.indices.length;\n\t\t\t\tlen = subGeom.numTriangles;\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\tcalc = i*3;\n\t\t\t\t\tvo.indices[iIdx++] = subGeom.indices[calc] + indexOffset;\n\t\t\t\t\tvo.indices[iIdx++] = subGeom.indices[calc + 1] + indexOffset;\n\t\t\t\t\tvo.indices[iIdx++] = subGeom.indices[calc + 2] + indexOffset;\n\t\t\t\t}\n\n\t\t\t\tif (!this._objectSpace) {\n\t\t\t\t\tmesh.sceneTransform.transformVectors(vertices, vertices);\n\t\t\t\t\tMatrix3DUtils.deltaTransformVectors(mesh.sceneTransform, normals, normals);\n\t\t\t\t\tMatrix3DUtils.deltaTransformVectors(mesh.sceneTransform, tangents, tangents);\n\n\t\t\t\t\t// Copy vertex data from temporary (transformed) vectors\n\t\t\t\t\tvIdx = vo.vertices.length;\n\t\t\t\t\tnIdx = vo.normals.length;\n\t\t\t\t\ttIdx = vo.tangents.length;\n\t\t\t\t\tlen = vertices.length;\n\t\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\t\tvo.vertices[vIdx++] = vertices[i];\n\t\t\t\t\t\tvo.normals[nIdx++] = normals[i];\n\t\t\t\t\t\tvo.tangents[tIdx++] = tangents[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (dispose)\n\t\t\t\tthis._toDispose.push(mesh);\n\t\t}\n\t}\n\n\tprivate getSubGeomData(material:MaterialBase):GeometryVO\n\t{\n\t\tvar data:GeometryVO;\n\n\t\tif (this._keepMaterial) {\n\t\t\tvar i:number /*uint*/;\n\t\t\tvar len:number /*uint*/;\n\n\t\t\tlen = this._geomVOs.length;\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\tif (this._geomVOs[i].material == material) {\n\t\t\t\t\tdata = this._geomVOs[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (this._geomVOs.length) {\n\t\t\t// If materials are not to be kept, all data can be\n\t\t\t// put into a single VO, so return that one.\n\t\t\tdata = this._geomVOs[0];\n\t\t}\n\n\t\t// No data (for this material) found, create new.\n\t\tif (!data) {\n\t\t\tdata = new GeometryVO();\n\t\t\tdata.vertices = new Array<number>();\n\t\t\tdata.normals = new Array<number>();\n\t\t\tdata.tangents = new Array<number>();\n\t\t\tdata.uvs = new Array<number>();\n\t\t\tdata.indices = new Array<number /*uint*/>();\n\t\t\tdata.material = material;\n\n\t\t\tthis._geomVOs.push(data);\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tprivate parseContainer(receiver:Mesh, object:DisplayObjectContainer)\n\t{\n\t\tvar child:DisplayObjectContainer;\n\t\tvar i:number /*uint*/;\n\n\t\tif (object instanceof Mesh && object != (<DisplayObjectContainer> receiver))\n\t\t\tthis.collect(<Mesh> object, this._disposeSources);\n\n\t\tfor (i = 0; i < object.numChildren; ++i) {\n\t\t\tchild = <DisplayObjectContainer> object.getChildAt(i);\n\t\t\tthis.parseContainer(receiver, child);\n\t\t}\n\t}\n}\n\nexport = Merge;\n\nclass GeometryVO\n{\n\tpublic uvs:Array<number>;\n\tpublic vertices:Array<number>;\n\tpublic normals:Array<number>;\n\tpublic tangents:Array<number>;\n\tpublic indices:Array<number /*uint*/>;\n\tpublic material:MaterialBase;\n}\n",
    "import Matrix\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\n/**\n * ...\n */\nclass ParticleGeometryTransform\n{\n\tprivate _defaultVertexTransform:Matrix3D;\n\tprivate _defaultInvVertexTransform:Matrix3D;\n\tprivate _defaultUVTransform:Matrix;\n\n\tpublic set vertexTransform(value:Matrix3D)\n\t{\n\t\tthis._defaultVertexTransform = value;\n\t\tthis._defaultInvVertexTransform = value.clone();\n\t\tthis._defaultInvVertexTransform.invert();\n\t\tthis._defaultInvVertexTransform.transpose();\n\t}\n\n\tpublic set UVTransform(value:Matrix)\n\t{\n\t\tthis._defaultUVTransform = value;\n\t}\n\n\tpublic get UVTransform():Matrix\n\t{\n\t\treturn this._defaultUVTransform;\n\t}\n\n\tpublic get vertexTransform():Matrix3D\n\t{\n\t\treturn this._defaultVertexTransform;\n\t}\n\n\tpublic get invVertexTransform():Matrix3D\n\t{\n\t\treturn this._defaultInvVertexTransform;\n\t}\n}\n\nexport = ParticleGeometryTransform;",
    "import Matrix\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Point\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-core/lib/data/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-core/lib/data/TriangleSubGeometry\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\nimport ParticleGeometry\t\t\t\t\t= require(\"awayjs-renderergl/lib/base/ParticleGeometry\");\nimport ParticleGeometryTransform\t\t= require(\"awayjs-renderergl/lib/tools/data/ParticleGeometryTransform\");\n\n/**\n * ...\n */\nclass ParticleGeometryHelper\n{\n\tpublic static MAX_VERTEX:number /*int*/ = 65535;\n\n\tpublic static generateGeometry(geometries:Array<Geometry>, transforms:Array<ParticleGeometryTransform> = null):ParticleGeometry\n\t{\n\t\tvar indicesVector:Array<Array<number>> /*uint*/ = new Array<Array<number>>() /*uint*/;\n\t\tvar positionsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar normalsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar tangentsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar uvsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar vertexCounters:Array<number> /*uint*/ = new Array<number>() /*uint*/;\n\t\tvar particles:Array<ParticleData> = new Array<ParticleData>();\n\t\tvar subGeometries:Array<TriangleSubGeometry> = new Array<TriangleSubGeometry>();\n\t\tvar numParticles:number /*uint*/ = geometries.length;\n\n\t\tvar sourceSubGeometries:Array<TriangleSubGeometry>;\n\t\tvar sourceSubGeometry:TriangleSubGeometry;\n\t\tvar numSubGeometries:number /*uint*/;\n\t\tvar indices:Array<number> /*uint*/;\n\t\tvar positions:Array<number>;\n\t\tvar normals:Array<number>;\n\t\tvar tangents:Array<number>;\n\t\tvar uvs:Array<number>;\n\t\tvar vertexCounter:number /*uint*/;\n\t\tvar subGeometry:TriangleSubGeometry;\n\t\tvar i:number /*int*/;\n\t\tvar j:number /*int*/;\n\t\tvar sub2SubMap:Array<number> /*int*/ = new Array<number>() /*int*/;\n\n\t\tvar tempVertex:Vector3D = new Vector3D;\n\t\tvar tempNormal:Vector3D = new Vector3D;\n\t\tvar tempTangents:Vector3D = new Vector3D;\n\t\tvar tempUV:Point = new Point;\n\n\t\tfor (i = 0; i < numParticles; i++) {\n\t\t\tsourceSubGeometries = <Array<TriangleSubGeometry>> geometries[i].subGeometries;\n\t\t\tnumSubGeometries = sourceSubGeometries.length;\n\t\t\tfor (var srcIndex:number /*int*/ = 0; srcIndex < numSubGeometries; srcIndex++) {\n\t\t\t\t//create a different particle subgeometry group for each source subgeometry in a particle.\n\t\t\t\tif (sub2SubMap.length <= srcIndex) {\n\t\t\t\t\tsub2SubMap.push(subGeometries.length);\n\t\t\t\t\tindicesVector.push(new Array<number>() /*uint*/);\n\t\t\t\t\tpositionsVector.push(new Array<number>());\n\t\t\t\t\tnormalsVector.push(new Array<number>());\n\t\t\t\t\ttangentsVector.push(new Array<number>());\n\t\t\t\t\tuvsVector.push(new Array<number>());\n\t\t\t\t\tsubGeometries.push(new TriangleSubGeometry(true));\n\t\t\t\t\tvertexCounters.push(0);\n\t\t\t\t}\n\n\t\t\t\tsourceSubGeometry = sourceSubGeometries[srcIndex];\n\n\t\t\t\t//add a new particle subgeometry if this source subgeometry will take us over the maxvertex limit\n\t\t\t\tif (sourceSubGeometry.numVertices + vertexCounters[sub2SubMap[srcIndex]] > ParticleGeometryHelper.MAX_VERTEX) {\n\t\t\t\t\t//update submap and add new subgeom vectors\n\t\t\t\t\tsub2SubMap[srcIndex] = subGeometries.length;\n\t\t\t\t\tindicesVector.push(new Array<number>() /*uint*/);\n\t\t\t\t\tpositionsVector.push(new Array<number>());\n\t\t\t\t\tnormalsVector.push(new Array<number>());\n\t\t\t\t\ttangentsVector.push(new Array<number>());\n\t\t\t\t\tuvsVector.push(new Array<number>());\n\t\t\t\t\tsubGeometries.push(new TriangleSubGeometry(true));\n\t\t\t\t\tvertexCounters.push(0);\n\t\t\t\t}\n\n\t\t\t\tj = sub2SubMap[srcIndex];\n\n\t\t\t\t//select the correct vector\n\t\t\t\tindices = indicesVector[j];\n\t\t\t\tpositions = positionsVector[j];\n\t\t\t\tnormals = normalsVector[j];\n\t\t\t\ttangents = tangentsVector[j];\n\t\t\t\tuvs = uvsVector[j];\n\t\t\t\tvertexCounter = vertexCounters[j];\n\t\t\t\tsubGeometry = subGeometries[j];\n\n\t\t\t\tvar particleData:ParticleData = new ParticleData();\n\t\t\t\tparticleData.numVertices = sourceSubGeometry.numVertices;\n\t\t\t\tparticleData.startVertexIndex = vertexCounter;\n\t\t\t\tparticleData.particleIndex = i;\n\t\t\t\tparticleData.subGeometry = subGeometry;\n\t\t\t\tparticles.push(particleData);\n\n\t\t\t\tvertexCounters[j] += sourceSubGeometry.numVertices;\n\n\t\t\t\tvar k:number /*int*/;\n\t\t\t\tvar tempLen:number /*int*/;\n\t\t\t\tvar compact:TriangleSubGeometry = sourceSubGeometry;\n\t\t\t\tvar product:number /*uint*/;\n\t\t\t\tvar sourcePositions:Array<number>;\n\t\t\t\tvar sourceNormals:Array<number>;\n\t\t\t\tvar sourceTangents:Array<number>;\n\t\t\t\tvar sourceUVs:Array<number>;\n\n\t\t\t\tif (compact) {\n\t\t\t\t\ttempLen = compact.numVertices;\n\t\t\t\t\tcompact.numTriangles;\n\t\t\t\t\tsourcePositions = compact.positions;\n\t\t\t\t\tsourceNormals = compact.vertexNormals;\n\t\t\t\t\tsourceTangents = compact.vertexTangents;\n\t\t\t\t\tsourceUVs = compact.uvs;\n\n\t\t\t\t\tif (transforms) {\n\t\t\t\t\t\tvar particleGeometryTransform:ParticleGeometryTransform = transforms[i];\n\t\t\t\t\t\tvar vertexTransform:Matrix3D = particleGeometryTransform.vertexTransform;\n\t\t\t\t\t\tvar invVertexTransform:Matrix3D = particleGeometryTransform.invVertexTransform;\n\t\t\t\t\t\tvar UVTransform:Matrix = particleGeometryTransform.UVTransform;\n\n\t\t\t\t\t\tfor (k = 0; k < tempLen; k++) {\n\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\t * 0 - 2: vertex position X, Y, Z\n\t\t\t\t\t\t\t * 3 - 5: normal X, Y, Z\n\t\t\t\t\t\t\t * 6 - 8: tangent X, Y, Z\n\t\t\t\t\t\t\t * 9 - 10: U V\n\t\t\t\t\t\t\t * 11 - 12: Secondary U V*/\n\t\t\t\t\t\t\tproduct = k*3;\n\t\t\t\t\t\t\ttempVertex.x = sourcePositions[product];\n\t\t\t\t\t\t\ttempVertex.y = sourcePositions[product + 1];\n\t\t\t\t\t\t\ttempVertex.z = sourcePositions[product + 2];\n\t\t\t\t\t\t\ttempNormal.x = sourceNormals[product];\n\t\t\t\t\t\t\ttempNormal.y = sourceNormals[product + 1];\n\t\t\t\t\t\t\ttempNormal.z = sourceNormals[product + 2];\n\t\t\t\t\t\t\ttempTangents.x = sourceTangents[product];\n\t\t\t\t\t\t\ttempTangents.y = sourceTangents[product + 1];\n\t\t\t\t\t\t\ttempTangents.z = sourceTangents[product + 2];\n\t\t\t\t\t\t\ttempUV.x = sourceUVs[k*2];\n\t\t\t\t\t\t\ttempUV.y = sourceUVs[k*2 + 1];\n\t\t\t\t\t\t\tif (vertexTransform) {\n\t\t\t\t\t\t\t\ttempVertex = vertexTransform.transformVector(tempVertex);\n\t\t\t\t\t\t\t\ttempNormal = invVertexTransform.deltaTransformVector(tempNormal);\n\t\t\t\t\t\t\t\ttempTangents = invVertexTransform.deltaTransformVector(tempNormal);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (UVTransform)\n\t\t\t\t\t\t\t\ttempUV = UVTransform.transformPoint(tempUV);\n\t\t\t\t\t\t\t//this is faster than that only push one data\n\t\t\t\t\t\t\tsourcePositions.push(tempVertex.x, tempVertex.y, tempVertex.z);\n\t\t\t\t\t\t\tsourceNormals.push(tempNormal.x, tempNormal.y, tempNormal.z);\n\t\t\t\t\t\t\tsourceTangents.push(tempTangents.x, tempTangents.y, tempTangents.z);\n\t\t\t\t\t\t\tsourceUVs.push(tempUV.x, tempUV.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (k = 0; k < tempLen; k++) {\n\t\t\t\t\t\t\tproduct = k*3;\n\t\t\t\t\t\t\t//this is faster than that only push one data\n\t\t\t\t\t\t\tpositions.push(sourcePositions[product], sourcePositions[product + 1], sourcePositions[product + 2]);\n\t\t\t\t\t\t\tnormals.push(sourceNormals[product], sourceNormals[product + 1], sourceNormals[product + 2]);\n\t\t\t\t\t\t\ttangents.push(sourceTangents[product], sourceTangents[product + 1], sourceTangents[product + 2]);\n\t\t\t\t\t\t\tuvs.push(sourceUVs[k*2], sourceUVs[k*2 + 1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//Todo\n\t\t\t\t}\n\n\t\t\t\tvar sourceIndices:Array<number> /*uint*/ = sourceSubGeometry.indices;\n\t\t\t\ttempLen = sourceSubGeometry.numTriangles;\n\t\t\t\tfor (k = 0; k < tempLen; k++) {\n\t\t\t\t\tproduct = k*3;\n\t\t\t\t\tindices.push(sourceIndices[product] + vertexCounter, sourceIndices[product + 1] + vertexCounter, sourceIndices[product + 2] + vertexCounter);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar particleGeometry:ParticleGeometry = new ParticleGeometry();\n\t\tparticleGeometry.particles = particles;\n\t\tparticleGeometry.numParticles = numParticles;\n\n\t\tnumParticles = subGeometries.length;\n\t\tfor (i = 0; i < numParticles; i++) {\n\t\t\tsubGeometry = subGeometries[i];\n\t\t\tsubGeometry.autoDeriveNormals = false;\n\t\t\tsubGeometry.autoDeriveTangents = false;\n\t\t\tsubGeometry.updateIndices(indicesVector[i]);\n\t\t\tsubGeometry.updatePositions(positionsVector[i]);\n\t\t\tsubGeometry.updateVertexNormals(normalsVector[i]);\n\t\t\tsubGeometry.updateVertexTangents(tangentsVector[i]);\n\t\t\tsubGeometry.updateUVs(uvsVector[i]);\n\t\t\tparticleGeometry.addSubGeometry(subGeometry);\n\t\t}\n\n\t\treturn particleGeometry;\n\t}\n}\n\nexport = ParticleGeometryHelper;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\n/**\n *\n */\nclass PerspectiveMatrix3D extends Matrix3D\n{\n\tconstructor(v:Array<number> = null)\n\t{\n\t\tsuper(v);\n\t}\n\n\tpublic perspectiveFieldOfViewLH(fieldOfViewY:number, aspectRatio:number, zNear:number, zFar:number)\n\t{\n\t\tvar yScale:number = 1/Math.tan(fieldOfViewY/2);\n\t\tvar xScale:number = yScale/aspectRatio;\n\n\t\tthis.copyRawDataFrom([xScale, 0.0, 0.0, 0.0, 0.0, yScale, 0.0, 0.0, 0.0, 0.0, zFar/(zFar - zNear), 1.0, 0.0, 0.0, (zNear*zFar)/(zNear - zFar), 0.0]);\n\t}\n}\n\nexport = PerspectiveMatrix3D;"
  ],
  "sourceRoot": ""
}