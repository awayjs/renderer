{
  "version": 3,
  "sources": [
    "node_modules/browserify/node_modules/browser-pack/_prelude.js",
    "awayjs-renderergl.js",
    "awayjs-renderergl/lib/DefaultRenderer.ts",
    "awayjs-renderergl/lib/DepthRenderer.ts",
    "awayjs-renderergl/lib/DistanceRenderer.ts",
    "awayjs-renderergl/lib/Filter3DRenderer.ts",
    "awayjs-renderergl/lib/RendererBase.ts",
    "awayjs-renderergl/lib/animators/AnimationSetBase.ts",
    "awayjs-renderergl/lib/animators/AnimatorBase.ts",
    "awayjs-renderergl/lib/animators/ParticleAnimationSet.ts",
    "awayjs-renderergl/lib/animators/ParticleAnimator.ts",
    "awayjs-renderergl/lib/animators/SkeletonAnimationSet.ts",
    "awayjs-renderergl/lib/animators/SkeletonAnimator.ts",
    "awayjs-renderergl/lib/animators/VertexAnimationSet.ts",
    "awayjs-renderergl/lib/animators/VertexAnimator.ts",
    "awayjs-renderergl/lib/animators/data/AnimationRegisterCache.ts",
    "awayjs-renderergl/lib/animators/data/AnimationSubGeometry.ts",
    "awayjs-renderergl/lib/animators/data/ColorSegmentPoint.ts",
    "awayjs-renderergl/lib/animators/data/JointPose.ts",
    "awayjs-renderergl/lib/animators/data/ParticleAnimationData.ts",
    "awayjs-renderergl/lib/animators/data/ParticleData.ts",
    "awayjs-renderergl/lib/animators/data/ParticlePropertiesMode.ts",
    "awayjs-renderergl/lib/animators/data/ParticleProperties.ts",
    "awayjs-renderergl/lib/animators/data/SkeletonJoint.ts",
    "awayjs-renderergl/lib/animators/data/SkeletonPose.ts",
    "awayjs-renderergl/lib/animators/data/Skeleton.ts",
    "awayjs-renderergl/lib/animators/data/VertexAnimationMode.ts",
    "awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleColorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleFollowNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleNodeBase.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticlePositionNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleScaleNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleTimeNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleUVNode.ts",
    "awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonClipNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode.ts",
    "awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode.ts",
    "awayjs-renderergl/lib/animators/nodes/VertexClipNode.ts",
    "awayjs-renderergl/lib/animators/states/AnimationClipState.ts",
    "awayjs-renderergl/lib/animators/states/AnimationStateBase.ts",
    "awayjs-renderergl/lib/animators/states/ParticleAccelerationState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleBezierCurveState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleBillboardState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleColorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleFollowState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleInitialColorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleOrbitState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleOscillatorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticlePositionState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleScaleState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleStateBase.ts",
    "awayjs-renderergl/lib/animators/states/ParticleTimeState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleUVState.ts",
    "awayjs-renderergl/lib/animators/states/ParticleVelocityState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonClipState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonDifferenceState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonDirectionalState.ts",
    "awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState.ts",
    "awayjs-renderergl/lib/animators/states/VertexClipState.ts",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode.ts",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState.ts",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransition.ts",
    "awayjs-renderergl/lib/base/ParticleGeometry.ts",
    "awayjs-renderergl/lib/errors/AnimationSetError.ts",
    "awayjs-renderergl/lib/events/AnimationStateEvent.ts",
    "awayjs-renderergl/lib/events/AnimatorEvent.ts",
    "awayjs-renderergl/lib/events/ShadingMethodEvent.ts",
    "awayjs-renderergl/lib/filters/Filter3DBase.ts",
    "awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase.ts",
    "awayjs-renderergl/lib/managers/RTTBufferManager.ts",
    "awayjs-renderergl/lib/pick/ShaderPicker.ts",
    "awayjs-renderergl/lib/render/BasicMaterialRender.ts",
    "awayjs-renderergl/lib/render/DepthRender.ts",
    "awayjs-renderergl/lib/render/DistanceRender.ts",
    "awayjs-renderergl/lib/render/RenderBase.ts",
    "awayjs-renderergl/lib/render/RenderPassBase.ts",
    "awayjs-renderergl/lib/render/RenderPool.ts",
    "awayjs-renderergl/lib/render/SkyboxRender.ts",
    "awayjs-renderergl/lib/render/passes/BasicMaterialPass.ts",
    "awayjs-renderergl/lib/render/passes/PassBase.ts",
    "awayjs-renderergl/lib/renderables/BillboardRenderable.ts",
    "awayjs-renderergl/lib/renderables/CurveSubMeshRenderable.ts",
    "awayjs-renderergl/lib/renderables/LineSegmentRenderable.ts",
    "awayjs-renderergl/lib/renderables/LineSubMeshRenderable.ts",
    "awayjs-renderergl/lib/renderables/RenderableBase.ts",
    "awayjs-renderergl/lib/renderables/RenderablePool.ts",
    "awayjs-renderergl/lib/renderables/SkyboxRenderable.ts",
    "awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable.ts",
    "awayjs-renderergl/lib/shaders/LightingShader.ts",
    "awayjs-renderergl/lib/shaders/RegisterPool.ts",
    "awayjs-renderergl/lib/shaders/ShaderBase.ts",
    "awayjs-renderergl/lib/shaders/ShaderRegisterCache.ts",
    "awayjs-renderergl/lib/shaders/ShaderRegisterData.ts",
    "awayjs-renderergl/lib/shaders/ShaderRegisterElement.ts",
    "awayjs-renderergl/lib/shaders/compilers/CompilerBase.ts",
    "awayjs-renderergl/lib/shaders/compilers/LightingCompiler.ts",
    "awayjs-renderergl/lib/tools/commands/Merge.ts",
    "awayjs-renderergl/lib/tools/data/ParticleGeometryTransform.ts",
    "awayjs-renderergl/lib/utils/ParticleGeometryHelper.ts",
    "awayjs-renderergl/lib/utils/PerspectiveMatrix3D.ts",
    "awayjs-renderergl/lib/vos/CurveSubGeometryVO.ts",
    "awayjs-renderergl/lib/vos/LineSubGeometryVO.ts",
    "awayjs-renderergl/lib/vos/Sampler2DVO.ts",
    "awayjs-renderergl/lib/vos/SamplerCubeVO.ts",
    "awayjs-renderergl/lib/vos/SamplerVOBase.ts",
    "awayjs-renderergl/lib/vos/Single2DTextureVO.ts",
    "awayjs-renderergl/lib/vos/SingleCubeTextureVO.ts",
    "awayjs-renderergl/lib/vos/SubGeometryVOBase.ts",
    "awayjs-renderergl/lib/vos/SubGeometryVOPool.ts",
    "awayjs-renderergl/lib/vos/TextureVOBase.ts",
    "awayjs-renderergl/lib/vos/TextureVOPool.ts",
    "awayjs-renderergl/lib/vos/TriangleSubGeometryVO.ts"
  ],
  "names": [
    "require",
    "e",
    "t",
    "n",
    "r",
    "s",
    "o",
    "u",
    "a",
    "i",
    "f",
    "Error",
    "code",
    "l",
    "exports",
    "call",
    "length",
    "awayjs-renderergl/lib/DefaultRenderer",
    "module",
    "__extends",
    "this",
    "d",
    "b",
    "p",
    "hasOwnProperty",
    "__",
    "constructor",
    "prototype",
    "BitmapImage2D",
    "Matrix3D",
    "Vector3D",
    "ContextGLCompareMode",
    "ContextGLClearMask",
    "RendererBase",
    "DepthRenderer",
    "DistanceRenderer",
    "Filter3DRenderer",
    "RenderablePool",
    "RTTBufferManager",
    "DefaultRenderer",
    "_super",
    "stage",
    "_skyboxProjection",
    "_pRenderablePool",
    "_pStage",
    "_shareContext",
    "_pRttBufferManager",
    "getInstance",
    "_pDepthRenderer",
    "_pDistanceRenderer",
    "_width",
    "width",
    "window",
    "innerWidth",
    "viewWidth",
    "_height",
    "height",
    "innerHeight",
    "viewHeight",
    "Object",
    "defineProperty",
    "get",
    "_antiAlias",
    "set",
    "value",
    "_pBackBufferInvalid",
    "enumerable",
    "configurable",
    "_depthPrepass",
    "_pFilter3DRenderer",
    "filters",
    "dispose",
    "_pRequireDepthRender",
    "requireDepthRender",
    "_pDepthRender",
    "render",
    "entityCollector",
    "recoverFromDisposal",
    "pUpdateBackBuffer",
    "_pContext",
    "clear",
    "DEPTH",
    "textureRatioX",
    "textureRatioY",
    "pRenderSceneDepthToTexture",
    "pRenderDepthPrepass",
    "_iRender",
    "_pScissorRect",
    "present",
    "bufferClear",
    "pExecuteRender",
    "target",
    "scissorRect",
    "surfaceSelector",
    "updateLights",
    "dirLights",
    "directionalLights",
    "pointLights",
    "len",
    "light",
    "shadowMapper",
    "castsShadows",
    "autoUpdateShadows",
    "_iShadowsInvalid",
    "iRenderDepthMap",
    "pDraw",
    "skyBox",
    "setDepthTest",
    "ALWAYS",
    "drawSkybox",
    "renderable",
    "getItem",
    "camera",
    "updateSkyboxProjection",
    "getRenderPool",
    "renderableOwner",
    "renderOwner",
    "pass",
    "passes",
    "activatePass",
    "deactivatePass",
    "near",
    "copyFrom",
    "_pRttViewProjectionMatrix",
    "copyRowTo",
    "camPos",
    "scenePosition",
    "cx",
    "x",
    "cy",
    "y",
    "cz",
    "z",
    "cw",
    "Math",
    "sqrt",
    "signX",
    "signY",
    "inverse",
    "clone",
    "invert",
    "q",
    "transformVector",
    "w",
    "copyRowFrom",
    "disableColor",
    "_pDepthTextureInvalid",
    "initDepthTexture",
    "context",
    "configureBackBuffer",
    "textureWidth",
    "textureHeight",
    "awayjs-core/lib/data/BitmapImage2D",
    "undefined",
    "awayjs-core/lib/geom/Matrix3D",
    "awayjs-core/lib/geom/Vector3D",
    "awayjs-renderergl/lib/DepthRenderer",
    "awayjs-renderergl/lib/DistanceRenderer",
    "awayjs-renderergl/lib/Filter3DRenderer",
    "awayjs-renderergl/lib/RendererBase",
    "awayjs-renderergl/lib/managers/RTTBufferManager",
    "awayjs-renderergl/lib/renderables/RenderablePool",
    "awayjs-stagegl/lib/base/ContextGLClearMask",
    "awayjs-stagegl/lib/base/ContextGLCompareMode",
    "DepthRender",
    "_iBackgroundR",
    "_iBackgroundG",
    "_iBackgroundB",
    "awayjs-renderergl/lib/render/DepthRender",
    "DistanceRender",
    "awayjs-renderergl/lib/render/DistanceRender",
    "Event",
    "ContextGLDrawMode",
    "ContextGLBlendFactor",
    "ContextGLVertexBufferFormat",
    "_this",
    "_filterSizesInvalid",
    "_onRTTResizeDelegate",
    "event",
    "onRTTResize",
    "_stage",
    "_rttManager",
    "addEventListener",
    "RESIZE",
    "_requireDepthRender",
    "getMainInputTexture",
    "_filterTasksInvalid",
    "updateFilterTasks",
    "_mainInputTexture",
    "_filters",
    "updateFilterSizes",
    "_tasks",
    "Array",
    "filter",
    "setRenderTargets",
    "concat",
    "tasks",
    "depthTexture",
    "task",
    "indexBuffer",
    "vertexBuffer",
    "renderToTextureVertexBuffer",
    "update",
    "setVertexBufferAt",
    "FLOAT_2",
    "renderToScreenVertexBuffer",
    "setTextureAt",
    "setProgram",
    "getProgram",
    "activate",
    "setBlendFactors",
    "ONE",
    "ZERO",
    "drawIndices",
    "TRIANGLES",
    "deactivate",
    "removeEventListener",
    "awayjs-core/lib/events/Event",
    "awayjs-stagegl/lib/base/ContextGLBlendFactor",
    "awayjs-stagegl/lib/base/ContextGLDrawMode",
    "awayjs-stagegl/lib/base/ContextGLVertexBufferFormat",
    "Point",
    "Rectangle",
    "EventDispatcher",
    "RenderableMergeSort",
    "RendererEvent",
    "EntityCollector",
    "DefaultMaterialManager",
    "AGALMiniAssembler",
    "StageEvent",
    "StageManager",
    "_numUsedStreams",
    "_numUsedTextures",
    "_viewPort",
    "_backgroundR",
    "_backgroundG",
    "_backgroundB",
    "_backgroundAlpha",
    "_localPos",
    "_globalPos",
    "_pNumElements",
    "_disableColor",
    "_renderBlended",
    "_onViewportUpdatedDelegate",
    "onViewportUpdated",
    "_onContextUpdateDelegate",
    "onContextUpdate",
    "renderableSorter",
    "getFreeStage",
    "CONTEXT_CREATED",
    "CONTEXT_RECREATED",
    "VIEWPORT_UPDATED",
    "updateGlobalPos",
    "notifyScissorUpdate",
    "shader",
    "numUsedStreams",
    "numUsedTextures",
    "programData",
    "program",
    "createProgram",
    "vertexByteCode",
    "assemble",
    "vertexString",
    "data",
    "fragmentByteCode",
    "fragmentString",
    "upload",
    "_iActivate",
    "_iDeactivate",
    "_iCreateEntityCollector",
    "_viewportDirty",
    "_scissorDirty",
    "viewProjection",
    "appendScale",
    "_iRenderCascades",
    "numCascades",
    "scissorRects",
    "cameras",
    "_applyCollector",
    "setRenderTarget",
    "LESS",
    "head",
    "_pOpaqueRenderableHead",
    "first",
    "LESS_EQUAL",
    "_pBlendedRenderableHead",
    "item",
    "entityHead",
    "_pCamera",
    "_iEntryPoint",
    "_pCameraForward",
    "transform",
    "forwardVector",
    "entity",
    "_applyRenderer",
    "next",
    "sortOpaqueRenderables",
    "sortBlendedRenderables",
    "_snapshotRequired",
    "_snapshotBitmapImage2D",
    "drawToBitmapImage2D",
    "queueSnapshot",
    "bmd",
    "setColorMask",
    "drawRenderables",
    "renderable2",
    "_renderOwner",
    "alphaThreshold",
    "_scissorUpdated",
    "SCISSOR_UPDATED",
    "dispatchEvent",
    "notifyViewportUpdate",
    "_viewPortUpdated",
    "viewPort",
    "_iApplyRenderableOwner",
    "getDefaultMaterial",
    "renderId",
    "renderOrderId",
    "cascaded",
    "sourceEntity",
    "position",
    "subtract",
    "zIndex",
    "zOffset",
    "dotProduct",
    "renderSceneTransform",
    "getRenderSceneTransform",
    "requiresBlending",
    "subGeometryVO",
    "subGeometry",
    "numElements",
    "awayjs-core/lib/events/EventDispatcher",
    "awayjs-core/lib/geom/Point",
    "awayjs-core/lib/geom/Rectangle",
    "awayjs-display/lib/events/RendererEvent",
    "awayjs-display/lib/managers/DefaultMaterialManager",
    "awayjs-display/lib/sort/RenderableMergeSort",
    "awayjs-display/lib/traverse/EntityCollector",
    "awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler",
    "awayjs-stagegl/lib/events/StageEvent",
    "awayjs-stagegl/lib/managers/StageManager",
    "awayjs-renderergl/lib/animators/AnimationSetBase",
    "AssetBase",
    "AbstractMethodError",
    "AnimationSetError",
    "AnimationSetBase",
    "_animations",
    "_animationNames",
    "_animationDictionary",
    "_pFindTempReg",
    "exclude",
    "excludeAnother",
    "reg",
    "indexOf",
    "_usesCPU",
    "resetGPUCompatibility",
    "cancelGPUCompatibility",
    "getAGALVertexCode",
    "getAGALFragmentCode",
    "shadedTarget",
    "getAGALUVCode",
    "doneAGALCode",
    "assetType",
    "hasAnimation",
    "name",
    "getAnimation",
    "addAnimation",
    "node",
    "push",
    "awayjs-core/lib/errors/AbstractMethodError",
    "awayjs-core/lib/library/AssetBase",
    "awayjs-renderergl/lib/errors/AnimationSetError",
    "awayjs-renderergl/lib/animators/AnimatorBase",
    "RequestAnimationFrame",
    "getTimer",
    "AnimatorEvent",
    "AnimatorBase",
    "animationSet",
    "_autoUpdate",
    "_time",
    "_playbackSpeed",
    "_pOwners",
    "_pAbsoluteTime",
    "_animationStates",
    "updatePosition",
    "_pAnimationSet",
    "_broadcaster",
    "onEnterFrame",
    "getAnimationState",
    "className",
    "stateClass",
    "uID",
    "id",
    "getAnimationStateByName",
    "_pActiveState",
    "_pActiveAnimationName",
    "start",
    "stop",
    "phase",
    "setRenderState",
    "vertexConstantOffset",
    "vertexStreamOffset",
    "_isPlaying",
    "hasEventListener",
    "START",
    "_startEvent",
    "STOP",
    "_stopEvent",
    "time",
    "dt",
    "playbackSpeed",
    "_pUpdateDeltaTime",
    "reset",
    "offset",
    "addOwner",
    "mesh",
    "removeOwner",
    "splice",
    "applyPositionDelta",
    "delta",
    "positionDelta",
    "dist",
    "translateLocal",
    "dispatchCycleEvent",
    "CYCLE_COMPLETE",
    "_cycleEvent",
    "testGPUCompatibility",
    "getRenderableSubGeometry",
    "sourceSubGeometry",
    "awayjs-core/lib/utils/RequestAnimationFrame",
    "awayjs-core/lib/utils/getTimer",
    "awayjs-renderergl/lib/events/AnimatorEvent",
    "awayjs-renderergl/lib/animators/ParticleAnimationSet",
    "AnimationRegisterCache",
    "AnimationSubGeometry",
    "ParticleAnimationData",
    "ParticleProperties",
    "ParticlePropertiesMode",
    "ParticleTimeNode",
    "ParticleAnimationSet",
    "usesDuration",
    "usesLooping",
    "usesDelay",
    "_animationSubGeometries",
    "_particleNodes",
    "_localDynamicNodes",
    "_localStaticNodes",
    "_totalLenOfOneVertex",
    "_timeNode",
    "_iProcessAnimationSetting",
    "mode",
    "LOCAL_STATIC",
    "_iDataOffset",
    "dataLength",
    "LOCAL_DYNAMIC",
    "priority",
    "_iAnimationRegisterCache",
    "animationRegisterCache",
    "profile",
    "numUsedVertexConstants",
    "vertexAttributesOffset",
    "varyingsOffset",
    "numUsedVaryings",
    "fragmentConstantOffset",
    "numUsedFragmentConstants",
    "hasUVNode",
    "needVelocity",
    "hasBillboard",
    "sourceRegisters",
    "animatableAttributes",
    "targetRegisters",
    "animationTargetRegisters",
    "needFragmentAnimation",
    "usesFragmentAnimation",
    "needUVAnimation",
    "usesUVTransform",
    "hasColorAddNode",
    "hasColorMulNode",
    "getInitCode",
    "POST_PRIORITY",
    "getCombinationCode",
    "COLOR_PRIORITY",
    "initColorRegisters",
    "getColorPassCode",
    "setUVSourceAndTarget",
    "uvSource",
    "uvTarget",
    "uvAttribute",
    "toString",
    "uvVar",
    "getColorCombinationCode",
    "setDataLength",
    "setVertexConst",
    "vertexZeroConst",
    "index",
    "key",
    "getAnimationSubGeometry",
    "subMesh",
    "parentMesh",
    "animationSubGeometry",
    "_iGenerateAnimationSubGeometries",
    "initParticleFunc",
    "geometry",
    "j",
    "k",
    "newAnimationSubGeometry",
    "localNode",
    "subMeshes",
    "shareAnimationGeometry",
    "createVertexData",
    "numVertices",
    "particles",
    "particlesLength",
    "numParticles",
    "particleProperties",
    "particle",
    "oneDataLen",
    "oneDataOffset",
    "counterForVertex",
    "counterForOneData",
    "oneData",
    "vertexData",
    "vertexLength",
    "startingOffset",
    "vertexOffset",
    "total",
    "startTime",
    "duration",
    "delay",
    "initParticleScope",
    "_iGeneratePropertyOfOneParticle",
    "particleIndex",
    "numProcessedVertices",
    "animationParticles",
    "awayjs-renderergl/lib/animators/data/AnimationRegisterCache",
    "awayjs-renderergl/lib/animators/data/AnimationSubGeometry",
    "awayjs-renderergl/lib/animators/data/ParticleAnimationData",
    "awayjs-renderergl/lib/animators/data/ParticleProperties",
    "awayjs-renderergl/lib/animators/data/ParticlePropertiesMode",
    "awayjs-renderergl/lib/animators/nodes/ParticleTimeNode",
    "awayjs-renderergl/lib/animators/ParticleAnimator",
    "ContextGLProgramType",
    "ParticleAnimator",
    "particleAnimationSet",
    "_animationParticleStates",
    "_animatorParticleStates",
    "_timeParticleStates",
    "_animatorSubGeometries",
    "_particleAnimationSet",
    "state",
    "particleNodes",
    "needUpdateTime",
    "animatorSubGeometry",
    "getAnimatorSubGeometry",
    "setProgramConstantsFromArray",
    "VERTEX",
    "vertexConstantData",
    "numVertexConstant",
    "numFragmentConstant",
    "FRAGMENT",
    "fragmentConstantData",
    "resetTime",
    "awayjs-stagegl/lib/base/ContextGLProgramType",
    "awayjs-renderergl/lib/animators/SkeletonAnimationSet",
    "SkeletonAnimationSet",
    "jointsPerVertex",
    "_jointsPerVertex",
    "indexOffset0",
    "indexOffset1",
    "indexOffset2",
    "indexStream",
    "weightStream",
    "indices",
    "weights",
    "temp1",
    "temp2",
    "dot",
    "src",
    "awayjs-renderergl/lib/animators/SkeletonAnimator",
    "SubGeometryEvent",
    "JointPose",
    "SkeletonPose",
    "AnimationStateEvent",
    "SkeletonAnimator",
    "skeleton",
    "forceCPU",
    "_globalPose",
    "_morphedSubGeometry",
    "_morphedSubGeometryDirty",
    "_skeleton",
    "_forceCPU",
    "_numJoints",
    "numJoints",
    "_globalMatrices",
    "_onTransitionCompleteDelegate",
    "onTransitionComplete",
    "_onIndicesUpdateDelegate",
    "onIndicesUpdate",
    "_onVerticesUpdateDelegate",
    "onVerticesUpdate",
    "_globalPropertiesDirty",
    "updateGlobalProperties",
    "_useCondensedIndices",
    "play",
    "transition",
    "NaN",
    "_pActiveNode",
    "getAnimationNode",
    "TRANSITION_COMPLETE",
    "_activeSkeletonState",
    "isNaN",
    "useCondensedIndices",
    "updateCondensedMatrices",
    "condensedIndexLookUp",
    "_condensedMatrices",
    "usesCPU",
    "morphSubGeometry",
    "jointIndexIndex",
    "jointWeightIndex",
    "srcIndex",
    "localToGlobalPose",
    "getSkeletonPose",
    "mtxOffset",
    "globalPoses",
    "jointPoses",
    "raw",
    "ox",
    "oy",
    "oz",
    "ow",
    "xy2",
    "xz2",
    "xw2",
    "yz2",
    "yw2",
    "zw2",
    "n11",
    "n12",
    "n13",
    "n21",
    "n22",
    "n23",
    "n31",
    "n32",
    "n33",
    "m11",
    "m12",
    "m13",
    "m14",
    "m21",
    "m22",
    "m23",
    "m24",
    "m31",
    "m32",
    "m33",
    "m34",
    "joints",
    "pose",
    "quat",
    "vec",
    "orientation",
    "translation",
    "inverseBindPose",
    "targetSubGeometry",
    "autoDeriveNormals",
    "autoDeriveTangents",
    "autoDeriveUVs",
    "INDICES_UPDATED",
    "VERTICES_UPDATED",
    "sourcePositions",
    "positions",
    "sourceNormals",
    "normals",
    "sourceTangents",
    "tangents",
    "jointIndices",
    "jointWeights",
    "targetPositions",
    "targetNormals",
    "targetTangents",
    "vx",
    "vy",
    "vz",
    "nx",
    "ny",
    "nz",
    "tx",
    "ty",
    "tz",
    "weight",
    "vertX",
    "vertY",
    "vertZ",
    "normX",
    "normY",
    "normZ",
    "tangX",
    "tangY",
    "tangZ",
    "setPositions",
    "setNormals",
    "setTangents",
    "sourcePose",
    "targetPose",
    "globalJointPose",
    "numJointPoses",
    "parentIndex",
    "joint",
    "parentPose",
    "or",
    "tr",
    "x1",
    "y1",
    "z1",
    "w1",
    "x2",
    "y2",
    "z2",
    "w2",
    "x3",
    "y3",
    "z3",
    "type",
    "animationNode",
    "animationState",
    "setIndices",
    "morphGeometry",
    "attributesView",
    "uvs",
    "setUVs",
    "secondaryUVs",
    "setSecondaryUVs",
    "awayjs-display/lib/events/SubGeometryEvent",
    "awayjs-renderergl/lib/animators/data/JointPose",
    "awayjs-renderergl/lib/animators/data/SkeletonPose",
    "awayjs-renderergl/lib/events/AnimationStateEvent",
    "awayjs-renderergl/lib/animators/VertexAnimationSet",
    "VertexAnimationMode",
    "VertexAnimationSet",
    "numPoses",
    "blendMode",
    "_numPoses",
    "_blendMode",
    "ABSOLUTE",
    "getAbsoluteAGALCode",
    "getAdditiveAGALCode",
    "regs",
    "constantReg",
    "streamIndex",
    "tangentDependencies",
    "outputsNormals",
    "normalDependencies",
    "awayjs-renderergl/lib/animators/data/VertexAnimationMode",
    "awayjs-renderergl/lib/animators/VertexAnimator",
    "SubGeometryVOPool",
    "VertexAnimator",
    "vertexAnimationSet",
    "_poses",
    "_weights",
    "_vertexAnimationSet",
    "_subGeometryVOPool",
    "getPool",
    "_activeVertexState",
    "geometryFlag",
    "currentGeometry",
    "nextGeometry",
    "blendWeight",
    "_iInvalidateRenderableGeometries",
    "subGeom",
    "setNullPose",
    "subGeometries",
    "_iIndex",
    "_indexMappings",
    "indexMappings",
    "activateVertexBufferVO",
    "awayjs-renderergl/lib/vos/SubGeometryVOPool",
    "ShaderRegisterCache",
    "ShaderRegisterElement",
    "indexDictionary",
    "rotationRegisters",
    "positionAttribute",
    "getRegisterFromString",
    "scaleAndRotateTarget",
    "addVertexTempUsages",
    "regName",
    "getFreeVertexConstant",
    "vertexOneConst",
    "vertexTwoConst",
    "positionTarget",
    "getFreeVertexVectorTemp",
    "velocityTarget",
    "vertexTime",
    "vertexLife",
    "tempTime",
    "UVAttribute",
    "UVVaring",
    "setRegisterIndex",
    "parameterIndex",
    "registerIndex",
    "getRegisterIndex",
    "colorMulTarget",
    "colorMulVary",
    "getFreeVarying",
    "colorAddTarget",
    "colorAddVary",
    "colorTarget",
    "addFragmentTempUsages",
    "temp",
    "split",
    "parseInt",
    "_numVertexConstant",
    "_numFragmentConstant",
    "_index",
    "setVertexConstFromArray",
    "setVertexConstFromMatrix",
    "matrix",
    "rawData",
    "setFragmentConst",
    "awayjs-renderergl/lib/shaders/ShaderRegisterCache",
    "awayjs-renderergl/lib/shaders/ShaderRegisterElement",
    "_pVertexBuffer",
    "_pBufferContext",
    "_pBufferDirty",
    "previousTime",
    "Number",
    "NEGATIVE_INFINITY",
    "_iUniqueId",
    "SUBGEOM_ID_COUNT",
    "totalLenOfOneVertex",
    "_numVertices",
    "_pVertexData",
    "activateVertexBuffer",
    "bufferOffset",
    "format",
    "contextIndex",
    "stageIndex",
    "buffer",
    "createVertexBuffer",
    "uploadFromArray",
    "pop",
    "invalidateBuffer",
    "awayjs-renderergl/lib/animators/data/ColorSegmentPoint",
    "ColorSegmentPoint",
    "life",
    "color",
    "_life",
    "_color",
    "Quaternion",
    "toMatrix3D",
    "appendTranslation",
    "awayjs-core/lib/geom/Quaternion",
    "totalTime",
    "startVertexIndex",
    "awayjs-renderergl/lib/animators/data/ParticleData",
    "ParticleData",
    "GLOBAL",
    "awayjs-renderergl/lib/animators/data/SkeletonJoint",
    "SkeletonJoint",
    "jointPoseFromName",
    "jointName",
    "jointPoseIndex",
    "jointPoseIndexFromName",
    "jointPose",
    "cloneJointPose",
    "thisJointPose",
    "awayjs-renderergl/lib/animators/data/Skeleton",
    "Skeleton",
    "jointFromName",
    "jointIndex",
    "jointIndexFromName",
    "ADDITIVE",
    "awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase",
    "AnimationNodeBase",
    "AnimationClipNodeBase",
    "_pLooping",
    "_pTotalDuration",
    "_pStitchDirty",
    "_pStitchFinalFrame",
    "_pNumFrames",
    "_pDurations",
    "_pTotalDelta",
    "fixedFrameRate",
    "_pUpdateStitch",
    "_pLastFrame",
    "awayjs-display/lib/animators/nodes/AnimationNodeBase",
    "awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode",
    "ParticleNodeBase",
    "ParticleAccelerationState",
    "ParticleAccelerationNode",
    "acceleration",
    "_pStateClass",
    "_acceleration",
    "pGetAGALVertexCode",
    "accelerationValue",
    "_pMode",
    "getFreeVertexAttribute",
    "ACCELERATION_INDEX",
    "removeVertexTempUsage",
    "animator",
    "param",
    "tempAcceleration",
    "ACCELERATION_VECTOR3D",
    "_pOneData",
    "awayjs-renderergl/lib/animators/nodes/ParticleNodeBase",
    "awayjs-renderergl/lib/animators/states/ParticleAccelerationState",
    "awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode",
    "ParticleBezierCurveState",
    "ParticleBezierCurveNode",
    "controlPoint",
    "endPoint",
    "_iControlPoint",
    "_iEndPoint",
    "controlValue",
    "BEZIER_CONTROL_INDEX",
    "endValue",
    "BEZIER_END_INDEX",
    "rev_time",
    "time_2",
    "time_temp",
    "distance",
    "bezierControl",
    "BEZIER_CONTROL_VECTOR3D",
    "bezierEnd",
    "BEZIER_END_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleBezierCurveState",
    "awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode",
    "ParticleBillboardState",
    "ParticleBillboardNode",
    "billboardAxis",
    "_iBillboardAxis",
    "rotationMatrixRegister",
    "MATRIX_INDEX",
    "shaderRegisterElement",
    "awayjs-renderergl/lib/animators/states/ParticleBillboardState",
    "awayjs-renderergl/lib/animators/nodes/ParticleColorNode",
    "ColorTransform",
    "ParticleColorState",
    "ParticleColorNode",
    "usesMultiplier",
    "usesOffset",
    "usesCycle",
    "usesPhase",
    "startColor",
    "endColor",
    "cycleDuration",
    "cyclePhase",
    "_iUsesMultiplier",
    "_iUsesOffset",
    "_iUsesCycle",
    "_iUsesPhase",
    "_iStartColor",
    "_iEndColor",
    "_iCycleDuration",
    "_iCyclePhase",
    "cycleConst",
    "CYCLE_INDEX",
    "sin",
    "getFreeVertexSingleTemp",
    "startMultiplierValue",
    "deltaMultiplierValue",
    "START_MULTIPLIER_INDEX",
    "DELTA_MULTIPLIER_INDEX",
    "startOffsetValue",
    "deltaOffsetValue",
    "START_OFFSET_INDEX",
    "DELTA_OFFSET_INDEX",
    "COLOR_START_COLORTRANSFORM",
    "COLOR_END_COLORTRANSFORM",
    "redMultiplier",
    "greenMultiplier",
    "blueMultiplier",
    "alphaMultiplier",
    "redOffset",
    "greenOffset",
    "blueOffset",
    "alphaOffset",
    "awayjs-core/lib/geom/ColorTransform",
    "awayjs-renderergl/lib/animators/states/ParticleColorState",
    "awayjs-renderergl/lib/animators/nodes/ParticleFollowNode",
    "ParticleFollowState",
    "ParticleFollowNode",
    "usesPosition",
    "usesRotation",
    "smooth",
    "_iUsesPosition",
    "_iUsesRotation",
    "_iSmooth",
    "rotationAttribute",
    "FOLLOW_ROTATION_INDEX",
    "temp3",
    "temp4",
    "FOLLOW_POSITION_INDEX",
    "awayjs-renderergl/lib/animators/states/ParticleFollowState",
    "awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode",
    "ParticleInitialColorState",
    "ParticleInitialColorNode",
    "initialColor",
    "_iInitialColor",
    "multiplierValue",
    "MULTIPLIER_INDEX",
    "offsetValue",
    "OFFSET_INDEX",
    "COLOR_INITIAL_COLORTRANSFORM",
    "awayjs-renderergl/lib/animators/states/ParticleInitialColorState",
    "_pDataLength",
    "MODES",
    "_priority",
    1,
    2,
    "awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode",
    "ParticleOrbitState",
    "ParticleOrbitNode",
    "usesEulers",
    "radius",
    "eulers",
    "_iUsesEulers",
    "_iRadius",
    "_iEulers",
    "orbitRegister",
    "ORBIT_INDEX",
    "eulersMatrixRegister",
    "EULERS_INDEX",
    "cos",
    "degree",
    "orbit",
    "ORBIT_VECTOR3D",
    "PI",
    "awayjs-renderergl/lib/animators/states/ParticleOrbitState",
    "awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode",
    "ParticleOscillatorState",
    "ParticleOscillatorNode",
    "oscillator",
    "_iOscillator",
    "oscillatorRegister",
    "OSCILLATOR_INDEX",
    "dgree",
    "drift",
    "OSCILLATOR_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleOscillatorState",
    "awayjs-renderergl/lib/animators/nodes/ParticlePositionNode",
    "ParticlePositionState",
    "ParticlePositionNode",
    "_iPosition",
    "POSITION_INDEX",
    "POSITION_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticlePositionState",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode",
    "ParticleRotateToHeadingState",
    "ParticleRotateToHeadingNode",
    "nrmVel",
    "xAxis",
    "R",
    "R_rev",
    "cos2",
    "tempSingle",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode",
    "ParticleRotateToPositionState",
    "ParticleRotateToPositionNode",
    "nrmDirection",
    "o_temp",
    "awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState",
    "awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode",
    "ParticleRotationalVelocityState",
    "ParticleRotationalVelocityNode",
    "rotationalVelocity",
    "_iRotationalVelocity",
    "rotationRegister",
    "ROTATIONALVELOCITY_INDEX",
    "Rtemp",
    "rotate",
    "ROTATIONALVELOCITY_VECTOR3D",
    "normalize",
    "awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState",
    "awayjs-renderergl/lib/animators/nodes/ParticleScaleNode",
    "ParticleScaleState",
    "ParticleScaleNode",
    "minScale",
    "maxScale",
    "_iMinScale",
    "_iMaxScale",
    "scaleRegister",
    "SCALE_INDEX",
    "scale",
    "SCALE_VECTOR3D",
    "abs",
    "awayjs-renderergl/lib/animators/states/ParticleScaleState",
    "awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode",
    "ParticleSegmentedColorState",
    "ParticleSegmentedColorNode",
    "numSegmentPoint",
    "segmentPoints",
    "_iNumSegmentPoint",
    "_iSegmentPoints",
    "accMultiplierColor",
    "tempColor",
    "accTime",
    "lifeTimeRegister",
    "TIME_DATA_INDEX",
    "startMulValue",
    "deltaMulValues",
    "deltaOffsetValues",
    "awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState",
    "awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode",
    "ParticleSpriteSheetState",
    "ParticleSpriteSheetNode",
    "numColumns",
    "numRows",
    "totalFrames",
    "MAX_VALUE",
    "_iNumColumns",
    "_iNumRows",
    "_iTotalFrames",
    "min",
    "uvParamConst1",
    "uvParamConst2",
    "UV_INDEX_0",
    "UV_INDEX_1",
    "uTotal",
    "uStep",
    "vStep",
    "uSpeed",
    "cycle",
    "phaseTime",
    "vOffset",
    "v",
    "uvCycle",
    "UV_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState",
    "ParticleTimeState",
    "_iUsesDuration",
    "_iUsesLooping",
    "_iUsesDelay",
    "timeStreamRegister",
    "TIME_STREAM_INDEX",
    "timeConst",
    "TIME_CONSTANT_INDEX",
    "div",
    "sge",
    "awayjs-renderergl/lib/animators/states/ParticleTimeState",
    "awayjs-renderergl/lib/animators/nodes/ParticleUVNode",
    "ParticleUVState",
    "ParticleUVNode",
    "axis",
    "_cycle",
    "_scale",
    "_axis",
    "updateUVData",
    "uvConst",
    "UV_INDEX",
    "axisIndex",
    "_iUvData",
    "U_AXIS",
    "V_AXIS",
    "awayjs-renderergl/lib/animators/states/ParticleUVState",
    "awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode",
    "ParticleVelocityState",
    "ParticleVelocityNode",
    "velocity",
    "_iVelocity",
    "velocityValue",
    "VELOCITY_INDEX",
    "_tempVelocity",
    "VELOCITY_VECTOR3D",
    "awayjs-renderergl/lib/animators/states/ParticleVelocityState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode",
    "SkeletonBinaryLERPState",
    "SkeletonBinaryLERPNode",
    "awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonClipNode",
    "SkeletonClipState",
    "SkeletonClipNode",
    "_frames",
    "highQuality",
    "addFrame",
    "skeletonPose",
    "p1",
    "p2",
    "awayjs-renderergl/lib/animators/states/SkeletonClipState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode",
    "SkeletonDifferenceState",
    "SkeletonDifferenceNode",
    "awayjs-renderergl/lib/animators/states/SkeletonDifferenceState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode",
    "SkeletonDirectionalState",
    "SkeletonDirectionalNode",
    "awayjs-renderergl/lib/animators/states/SkeletonDirectionalState",
    "awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode",
    "SkeletonNaryLERPState",
    "SkeletonNaryLERPNode",
    "_iInputs",
    "_numInputs",
    "getInputIndex",
    "input",
    "getInputAt",
    "addInput",
    "awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState",
    "awayjs-renderergl/lib/animators/nodes/VertexClipNode",
    "VertexClipState",
    "VertexClipNode",
    "_translations",
    "awayjs-renderergl/lib/animators/states/VertexClipState",
    "awayjs-renderergl/lib/animators/states/AnimationClipState",
    "AnimationStateBase",
    "AnimationClipState",
    "animationClipNode",
    "_pFramesDirty",
    "_animationClipNode",
    "_pUpdateFrames",
    "_pBlendWeight",
    "_pCurrentFrame",
    "_pNextFrame",
    "looping",
    "_pStartTime",
    "totalDuration",
    "_pTime",
    "_pUpdateTime",
    "_pTimeDir",
    "lastFrame",
    "notifyPlaybackComplete",
    "floor",
    "dur",
    "frameTime",
    "durations",
    "_animationStatePlaybackComplete",
    "PLAYBACK_COMPLETE",
    "_pAnimator",
    "awayjs-renderergl/lib/animators/states/AnimationStateBase",
    "_pRootDelta",
    "_pPositionDeltaDirty",
    "_pAnimationNode",
    "_pUpdatePositionDelta",
    "awayjs-renderergl/lib/animators/states/IAnimationState",
    "awayjs-renderergl/lib/animators/states/ISkeletonAnimationState",
    "awayjs-renderergl/lib/animators/states/IVertexAnimationState",
    "ParticleStateBase",
    "particleAccelerationNode",
    "_particleAccelerationNode",
    "updateAccelerationData",
    "FLOAT_3",
    "_halfAcceleration",
    "awayjs-renderergl/lib/animators/states/ParticleStateBase",
    "particleBezierCurveNode",
    "_particleBezierCurveNode",
    "_controlPoint",
    "_endPoint",
    "controlIndex",
    "endIndex",
    "MathConsts",
    "Orientation3D",
    "particleNode",
    "_matrix",
    "_billboardAxis",
    "comps",
    "pos",
    "sceneTransform",
    "look",
    "right",
    "crossProduct",
    "decompose",
    "AXIS_ANGLE",
    "copyColumnFrom",
    "appendRotation",
    "RADIANS_TO_DEGREES",
    "append",
    "inverseSceneTransform",
    "identity",
    "awayjs-core/lib/geom/MathConsts",
    "awayjs-core/lib/geom/Orientation3D",
    "particleColorNode",
    "_particleColorNode",
    "_usesMultiplier",
    "_usesOffset",
    "_usesCycle",
    "_usesPhase",
    "_startColor",
    "_endColor",
    "_cycleDuration",
    "_cyclePhase",
    "updateColorData",
    "dataOffset",
    "_cycleData",
    "FLOAT_4",
    "_startMultiplierData",
    "_deltaMultiplierData",
    "_startOffsetData",
    "_deltaOffsetData",
    "particleFollowNode",
    "_targetPos",
    "_targetEuler",
    "_temp",
    "_particleFollowNode",
    "_smooth",
    "_followTarget",
    "scaleX",
    "scaleY",
    "scaleZ",
    "rotationX",
    "rotationY",
    "rotationZ",
    "scaleBy",
    "DEGREES_TO_RADIANS",
    "_prePos",
    "_preEuler",
    "currentTime",
    "deltaTime",
    "needProcess",
    "processPositionAndRotation",
    "processPosition",
    "precessRotation",
    "changed",
    "interpolatedPos",
    "posVelocity",
    "inc",
    "add",
    "interpolatedRotation",
    "rotationVelocity",
    "particleInitialColorNode",
    "_particleInitialColorNode",
    "_initialColor",
    "_multiplierData",
    "_offsetData",
    "particleOrbitNode",
    "_particleOrbitNode",
    "_usesEulers",
    "_eulers",
    "_radius",
    "updateOrbitData",
    "_orbitData",
    "_eulersMatrix",
    "X_AXIS",
    "Y_AXIS",
    "Z_AXIS",
    "particleOscillatorNode",
    "_particleOscillatorNode",
    "_oscillator",
    "updateOscillatorData",
    "_oscillatorData",
    "particlePositionNode",
    "_particlePositionNode",
    "_position",
    "getPositions",
    "_pDynamicProperties",
    "_pDynamicPropertiesDirty",
    "_pUpdateDynamicProperties",
    "particleRotateToPositionNode",
    "_particleRotateToPositionNode",
    "_offset",
    "particleRotationNode",
    "_particleRotationalVelocityNode",
    "_rotationalVelocity",
    "updateRotationalVelocityData",
    "getRotationalVelocities",
    "setRotationalVelocities",
    "_rotationalVelocityData",
    "rotation",
    "particleScaleNode",
    "_particleScaleNode",
    "_minScale",
    "_maxScale",
    "updateScaleData",
    "_scaleData",
    "particleSegmentedColorNode",
    "_segmentPoints",
    "_numSegmentPoint",
    "_timeLifeData",
    "particleSpriteSheetNode",
    "_particleSpriteSheetNode",
    "_totalFrames",
    "_numColumns",
    "_numRows",
    "updateSpriteSheetData",
    "_spriteSheetData",
    "_particleNode",
    "_pNeedUpdateTime",
    "animationParticle",
    "particleTimeNode",
    "_particleTimeNode",
    "particleTime",
    "particleUVNode",
    "_particleUVNode",
    "particleVelocityNode",
    "_particleVelocityNode",
    "_velocity",
    "getVelocities",
    "setVelocities",
    "skeletonAnimationNode",
    "_blendWeight",
    "_skeletonPose",
    "_skeletonPoseDirty",
    "_skeletonAnimationNode",
    "_inputA",
    "inputA",
    "_inputB",
    "inputB",
    "updateSkeletonPose",
    "deltA",
    "deltB",
    "endPose",
    "endPoses",
    "poses1",
    "poses2",
    "pose1",
    "pose2",
    "lerp",
    "skeletonClipNode",
    "_rootPos",
    "_skeletonClipNode",
    "frames",
    "_currentPose",
    "_nextPose",
    "currentPose",
    "nextPose",
    "slerp",
    "p3",
    "totalDelta",
    "_pOldFrame",
    "dx",
    "dy",
    "dz",
    "stitchFinalFrame",
    "_baseInput",
    "baseInput",
    "_differenceInput",
    "differenceInput",
    "basePoses",
    "diffPoses",
    "base",
    "diff",
    "basePos",
    "diffPos",
    "_tempQuat",
    "multiply",
    "_direction",
    "_blendDirty",
    "_forward",
    "forward",
    "_backward",
    "backward",
    "_left",
    "left",
    "_right",
    "updateBlend",
    "_pUdateTime",
    "_blendWeights",
    "_inputs",
    "numInputs",
    "getBlendWeightAt",
    "setBlendWeightAt",
    "poses",
    "endTr",
    "endQuat",
    "firstPose",
    "w0",
    "x0",
    "y0",
    "z0",
    "vertexClipNode",
    "_vertexClipNode",
    "_currentGeometry",
    "_nextGeometry",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode",
    "CrossfadeTransitionState",
    "CrossfadeTransitionNode",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState",
    "_crossfadeTransitionNode",
    "startBlend",
    "blendSpeed",
    "_animationStateTransitionComplete",
    "awayjs-renderergl/lib/animators/transitions/CrossfadeTransition",
    "CrossfadeTransition",
    "startNode",
    "endNode",
    "crossFadeTransitionNode",
    "awayjs-renderergl/lib/animators/transitions/IAnimationTransition",
    "awayjs-renderergl/lib/base/ParticleGeometry",
    "Geometry",
    "ParticleGeometry",
    "apply",
    "arguments",
    "awayjs-display/lib/base/Geometry",
    "message",
    "awayjs-core/lib/errors/Error",
    "_animator",
    "_animationState",
    "_animationNode",
    "awayjs-renderergl/lib/events/ShadingMethodEvent",
    "ShadingMethodEvent",
    "SHADER_INVALIDATED",
    "awayjs-renderergl/lib/filters/Filter3DBase",
    "Filter3DBase",
    "pAddTask",
    "_textureWidth",
    "_textureHeight",
    "mainTarget",
    "awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase",
    "ContextGLTextureFormat",
    "Filter3DTaskBase",
    "_scaledTextureWidth",
    "_scaledTextureHeight",
    "_textureDimensionsInvalid",
    "_program3DInvalid",
    "_textureScale",
    "_target",
    "pUpdateTextures",
    "_program3D",
    "pInvalidateProgram",
    "pUpdateProgram",
    "pGetVertexCode",
    "pGetFragmentCode",
    "createTexture",
    "BGRA",
    "awayjs-stagegl/lib/base/ContextGLTextureFormat",
    "ImageUtils",
    "_viewWidth",
    "_viewHeight",
    "_buffersInvalid",
    "_renderToTextureRect",
    "_instances",
    "rttBufferManager",
    "getRTTBufferManagerFromStage",
    "vo",
    "RTTBufferManagerVO",
    "stage3d",
    "rttbfm",
    "c",
    "deleteRTTBufferManager",
    "updateRTTBuffers",
    "_textureRatioX",
    "_textureRatioY",
    "getBestPowerOf2",
    "_renderToTextureVertexBuffer",
    "_renderToScreenVertexBuffer",
    "_indexBuffer",
    "textureVerts",
    "screenVerts",
    "createIndexBuffer",
    "u1",
    "u2",
    "v1",
    "v2",
    "awayjs-core/lib/utils/ImageUtils",
    "awayjs-renderergl/lib/pick/ShaderPicker",
    "Debug",
    "Matrix3DUtils",
    "ContextGLTriangleFace",
    "ShaderPicker",
    "shaderPickingDetails",
    "_onlyMouseEnabled",
    "_interactives",
    "_localHitPosition",
    "_hitUV",
    "_localHitNormal",
    "_rayPos",
    "_rayDir",
    "_shaderPickingDetails",
    "_id",
    "_viewportData",
    "_boundOffsetScale",
    "getViewCollision",
    "view",
    "collector",
    "iEntityCollector",
    "renderer",
    "_context",
    "_projX",
    "_projY",
    "_potentialFound",
    "_blendedRenderableHead",
    "_opaqueRenderableHead",
    "_bitmapImage2D",
    "_hitColor",
    "getPixel",
    "_hitRenderable",
    "_hitEntity",
    "_iIsMouseEnabled",
    "_collisionVO",
    "_iPickingCollisionVO",
    "getHitDetails",
    "localPosition",
    "localNormal",
    "uv",
    "_faceIndex",
    "getSceneCollision",
    "direction",
    "scene",
    "MOUSE_SCISSOR_RECT",
    "_interactiveId",
    "_objectProgram",
    "initObjectProgram",
    "CALCULATION_MATRIX",
    "setCulling",
    "bothSides",
    "NONE",
    "BACK",
    "projection",
    "coordinateSystem",
    "setProgramConstantsFromMatrix",
    "getIndexBufferVO",
    "draw",
    "numIndices",
    "updateRay",
    "getRay",
    "vertexCode",
    "fragmentCode",
    "throwPIR",
    "initTriangleProgram",
    "_triangleProgram",
    "getApproximatePosition",
    "getPreciseDetails",
    "bounds",
    "getBox",
    "col",
    "scX",
    "scY",
    "scZ",
    "offsX",
    "offsY",
    "offsZ",
    "localViewProjection",
    "depth",
    "setScissorRectangle",
    "t1",
    "t2",
    "t3",
    "v0x",
    "v0y",
    "v0z",
    "v1x",
    "v1y",
    "v1z",
    "v2x",
    "v2y",
    "v2z",
    "ni1",
    "ni2",
    "ni3",
    "n1",
    "n2",
    "n3",
    "nLength",
    "dot00",
    "dot01",
    "dot02",
    "dot11",
    "dot12",
    "invDenom",
    "ui1",
    "ui2",
    "ui3",
    "s0x",
    "s0y",
    "s0z",
    "s1x",
    "s1y",
    "s1z",
    "nl",
    "_pGetSubGeometry",
    "posDim",
    "dimensions",
    "uvDim",
    "normalDim",
    "getPrecisePosition",
    "invSceneTransform",
    "px",
    "py",
    "pz",
    "rx",
    "ry",
    "rz",
    "RAW_DATA_CONTAINER",
    "copyRawDataTo",
    "awayjs-core/lib/geom/Matrix3DUtils",
    "awayjs-core/lib/utils/Debug",
    "awayjs-stagegl/lib/base/ContextGLTriangleFace",
    "awayjs-renderergl/lib/render/BasicMaterialRender",
    "BlendMode",
    "BasicMaterialPass",
    "RenderBase",
    "BasicMaterialRender",
    "pool",
    "material",
    "renderableClass",
    "_material",
    "_pAddPass",
    "_pass",
    "_pUpdateRender",
    "_pRequiresBlending",
    "NORMAL",
    "alphaBlending",
    "colorTransform",
    "preserveAlpha",
    "setBlendMode",
    "LAYER",
    "awayjs-core/lib/data/BlendMode",
    "awayjs-renderergl/lib/render/RenderBase",
    "awayjs-renderergl/lib/render/passes/BasicMaterialPass",
    "RenderPassBase",
    "ShaderBase",
    "_shader",
    "_iIncludeDependencies",
    "projectionDependencies",
    "uvDependencies",
    "_iInitConstantData",
    "_fragmentConstantsIndex",
    "_iGetFragmentCode",
    "registerCache",
    "sharedRegisters",
    "targetReg",
    "dataReg1",
    "getFreeFragmentConstant",
    "dataReg2",
    "getFreeFragmentVectorTemp",
    "projectionFragment",
    "texture",
    "_iInitRegisters",
    "albedo",
    "uvVarying",
    "cutOffReg",
    "removeFragmentTempUsage",
    "awayjs-renderergl/lib/render/RenderPassBase",
    "awayjs-renderergl/lib/shaders/ShaderBase",
    "viewDirDependencies",
    "globalPosDependencies",
    "viewDirVarying",
    "far",
    "awayjs-renderergl/lib/render/IRenderClass",
    "MaterialBase",
    "_forceSeparateMVP",
    "_invalidAnimation",
    "_invalidRender",
    "_passes",
    "_pool",
    "_renderableClass",
    "_onPassChangeDelegate",
    "onPassChange",
    "_updateAnimation",
    "_renderOrderId",
    "useMipmapping",
    "mipmap",
    "useSmoothTextures",
    "useAlphaPremultiplied",
    "alphaPremultiplied",
    "useBothSides",
    "repeatTextures",
    "repeat",
    "animateUVs",
    "usesColorTransform",
    "useColorTransform",
    "getTextureVO",
    "_pClearPasses",
    "disposeItem",
    "invalidateRender",
    "invalidatePasses",
    "invalidatePass",
    "invalidateAnimation",
    "enabledGPUAnimation",
    "_getEnabledGPUAnimation",
    "mult",
    "usesAnimation",
    "invalidateProgram",
    "_pRemovePass",
    "CHANGE",
    "owners",
    "iOwners",
    "numOwners",
    "awayjs-display/lib/materials/MaterialBase",
    "invalidateShader",
    "_iGetPreLightingVertexCode",
    "_iGetPreLightingFragmentCode",
    "_iGetVertexCode",
    "_iGetNormalVertexCode",
    "_iGetNormalFragmentCode",
    "awayjs-renderergl/lib/render/RenderPool",
    "BasicMaterial",
    "Skybox",
    "SkyboxRender",
    "RenderPool",
    "renderClass",
    "_renderClass",
    "_iAddRender",
    "getClass",
    "_iRemoveRender",
    "registerClass",
    "assetClass",
    "_classPool",
    "addDefaults",
    "main",
    "awayjs-display/lib/entities/Skybox",
    "awayjs-display/lib/materials/BasicMaterial",
    "awayjs-renderergl/lib/render/SkyboxRender",
    "skybox",
    "_skybox",
    "_cubeTexture",
    "cubeMap",
    "usesLocalPosFragment",
    "localPositionVarying",
    "PassBase",
    "_diffuseR",
    "_diffuseG",
    "_diffuseB",
    "_diffuseA",
    "regCache",
    "sharedReg",
    "alphaReg",
    "getFreeFragmentSingleTemp",
    "colorBufferIndex",
    "colorVarying",
    "diffuseInputReg",
    "awayjs-renderergl/lib/render/passes/PassBase",
    "awayjs-renderergl/lib/render/passes/ILightingPass",
    "awayjs-renderergl/lib/render/passes/IPass",
    "_preserveAlpha",
    "_render",
    "awayjs-renderergl/lib/renderables/BillboardRenderable",
    "AttributesBuffer",
    "TriangleSubGeometry",
    "Billboard",
    "RenderableBase",
    "BillboardRenderable",
    "billboard",
    "_billboard",
    "billboardRect",
    "_materialGeometry",
    "globalPositionVertex",
    "viewMatrixReg",
    "viewMatrixIndex",
    "_setRenderState",
    "sceneMatrixIndex",
    "matrix3D",
    "awayjs-core/lib/attributes/AttributesBuffer",
    "awayjs-display/lib/base/TriangleSubGeometry",
    "awayjs-display/lib/entities/Billboard",
    "awayjs-renderergl/lib/renderables/RenderableBase",
    "awayjs-renderergl/lib/renderables/CurveSubMeshRenderable",
    "CurveSubMesh",
    "CurveSubMeshRenderable",
    "_constants",
    "sd",
    "standardDerivatives",
    "out",
    "curve",
    "curvex",
    "curvey",
    "curvez",
    "free",
    "free1",
    "free2",
    "d2",
    "fixa",
    "fixb",
    "_aa",
    "_0",
    "_1",
    "applyAA",
    "join",
    "awayjs-display/lib/base/CurveSubMesh",
    "awayjs-renderergl/lib/renderables/IRenderableClass",
    "awayjs-renderergl/lib/renderables/LineSegmentRenderable",
    "LineSubGeometry",
    "LineSegment",
    "LineSegmentRenderable",
    "lineSegment",
    "_thickness",
    "_lineSegment",
    "_calcMatrix",
    "_lineGeometry",
    "startPostion",
    "end",
    "endPosition",
    "thickness",
    "Float32Array",
    "setThickness",
    "colorDependencies",
    "pONE_VECTOR",
    "pFRONT_VECTOR",
    "_pGetOverflowRenderable",
    "indexOffset",
    "awayjs-display/lib/base/LineSubGeometry",
    "awayjs-display/lib/entities/LineSegment",
    "awayjs-renderergl/lib/renderables/LineSubMeshRenderable",
    "LineSubMesh",
    "LineSubMeshRenderable",
    "awayjs-display/lib/base/LineSubMesh",
    "RenderableOwnerEvent",
    "_geometryDirty",
    "_onRenderOwnerUpdatedDelegate",
    "_onRenderOwnerUpdated",
    "RENDER_OWNER_UPDATED",
    "_updateGeometry",
    "_subGeometryVO",
    "invalidateGeometry",
    "awayjs-display/lib/events/RenderableOwnerEvent",
    "SkyboxRenderable",
    "TriangleSubMeshRenderable",
    "_objectPools",
    "_iAddRenderable",
    "_iRemoveRenderable",
    "awayjs-renderergl/lib/renderables/SkyboxRenderable",
    "awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable",
    "_vertexArray",
    "_geometry",
    "TriangleSubMesh",
    "awayjs-display/lib/base/TriangleSubMesh",
    "awayjs-renderergl/lib/shaders/LightingShader",
    "LightSources",
    "ContextGLProfile",
    "LightingCompiler",
    "LightingShader",
    "lightingPass",
    "_includeCasters",
    "_lightingPass",
    "numPointLights",
    "numDirectionalLights",
    "numLightProbes",
    "numAllLights",
    "diffuseLightSources",
    "_iUsesDiffuse",
    "specularLightSources",
    "_iUsesSpecular",
    "combinedLightSources",
    "usesLightFallOff",
    "enableLightFallOff",
    "BASELINE_CONSTRAINED",
    "numLights",
    "usesLights",
    "LIGHTS",
    "usesProbes",
    "PROBES",
    "usesLightsForSpecular",
    "usesProbesForSpecular",
    "usesLightsForDiffuse",
    "usesProbesForDiffuse",
    "usesShadows",
    "_iUsesShadows",
    "createCompiler",
    "lightPicker",
    "collectLights",
    "updateProbes",
    "dirLight",
    "pointLight",
    "dirPos",
    "numLightTypes",
    "ambientR",
    "ambientG",
    "ambientB",
    "lightVertexConstantIndex",
    "lightFragmentConstantIndex",
    "cast",
    "directionalLightsOffset",
    "castingDirectionalLights",
    "sceneDirection",
    "_iAmbientR",
    "_iAmbientG",
    "_iAmbientB",
    "usesTangentSpace",
    "_pInverseSceneMatrix",
    "_iDiffuseR",
    "_iDiffuseG",
    "_iDiffuseB",
    "_iSpecularR",
    "_iSpecularG",
    "_iSpecularB",
    "pointLightsOffset",
    "castingPointLights",
    "usesGlobalPosFragment",
    "_pRadius",
    "_pFallOffFactor",
    "probe",
    "lightProbes",
    "lightProbeWeights",
    "lightProbesOffset",
    "addDiff",
    "addSpec",
    "getImageObject",
    "diffuseMap",
    "lightProbeDiffuseIndices",
    "specularMap",
    "lightProbeSpecularIndices",
    "probeWeightsIndex",
    "awayjs-display/lib/materials/LightSources",
    "awayjs-renderergl/lib/shaders/compilers/LightingCompiler",
    "awayjs-stagegl/lib/base/ContextGLProfile",
    "awayjs-renderergl/lib/shaders/RegisterPool",
    "RegisterPool",
    "regCount",
    "persistent",
    "_regName",
    "_regCount",
    "_persistent",
    "initRegisters",
    "requestFreeVectorReg",
    "isRegisterUsed",
    "_usedVectorCount",
    "_vectorRegisters",
    "requestFreeRegComponent",
    "_usedSingleCount",
    "_registerComponents",
    "addUsage",
    "register",
    "usageCount",
    "_component",
    "removeUsage",
    "hasRegisteredRegs",
    "hash",
    "_initPool",
    "_regPool",
    "_regCompsPool",
    "_initArray",
    "vectorRegisters",
    "registerComponents",
    "val",
    "ArgumentError",
    "CompilerBase",
    "TextureVOPool",
    "_blendFactorSource",
    "_blendFactorDest",
    "_invalidShader",
    "_invalidProgram",
    "_animationVertexCode",
    "_animationFragmentCode",
    "usesBlending",
    "depthCompareMode",
    "writeDepth",
    "_defaultCulling",
    "_textureVOPool",
    "_updateProgram",
    "_programData",
    "secondaryUVDependencies",
    "outputsTangentNormals",
    "pInitRegisterIndices",
    "commonsDataIndex",
    "cameraPositionIndex",
    "uvBufferIndex",
    "uvTransformIndex",
    "colorTransformIndex",
    "secondaryUVBufferIndex",
    "normalBufferIndex",
    "tangentBufferIndex",
    "sceneNormalMatrixIndex",
    "initConstantData",
    "SOURCE_ALPHA",
    "ONE_MINUS_SOURCE_ALPHA",
    "MULTIPLY",
    "SOURCE_COLOR",
    "ADD",
    "ALPHA",
    "uvTransform",
    "compiler",
    "compile",
    "_calcAnimationCode",
    "getProgramData",
    "postAnimationFragmentCode",
    "usages",
    "awayjs-core/lib/errors/ArgumentError",
    "awayjs-renderergl/lib/shaders/compilers/CompilerBase",
    "awayjs-renderergl/lib/vos/TextureVOPool",
    "_numUsedVertexConstants",
    "_numUsedFragmentConstants",
    "_numUsedVaryings",
    "_profile",
    "_fragmentTempCache",
    "_vertexTempCache",
    "_varyingCache",
    "_textureCache",
    "_vertexAttributesCache",
    "_fragmentConstantsCache",
    "_vertexConstantsCache",
    "_fragmentOutputRegister",
    "_vertexOutputRegister",
    "_vertexAttributesOffset",
    "_vertexConstantOffset",
    "_varyingsOffset",
    "_fragmentConstantOffset",
    "getFreeTextureReg",
    "awayjs-renderergl/lib/shaders/ShaderRegisterData",
    "ShaderRegisterData",
    "component",
    "_toStr",
    "COMPONENTS",
    "_pVertexCode",
    "_pFragmentCode",
    "_pPostAnimationFragmentCode",
    "_pRenderableClass",
    "_pRenderPass",
    "_pShader",
    "_pSharedRegisters",
    "_pRegisterCache",
    "pCompileDependencies",
    "console",
    "log",
    "compileColorTransformCode",
    "fragmentOutputRegister",
    "_pAnimatableAttributes",
    "_pAnimationTargetRegisters",
    "_uvSource",
    "_uvTarget",
    "ct1",
    "ct2",
    "compileGlobalPositionCode",
    "compileLocalPositionCode",
    "compileUVCode",
    "compileSecondaryUVCode",
    "compileNormalCode",
    "compileViewDirCode",
    "sceneMatrixReg",
    "globalPositionVarying",
    "uvAttributeReg",
    "varying",
    "uvTransform1",
    "uvTransform2",
    "secondaryUVVarying",
    "cameraPositionReg",
    "viewDirFragment",
    "animatedTangent",
    "normalFragment",
    "normalMatrix",
    "normalVarying",
    "animatedNormal",
    "bitangent",
    "tangentVarying",
    "bitangentVarying",
    "normalInput",
    "commons",
    "tangentInput",
    "colorInput",
    "shaderLightingObject",
    "_shaderLightingObject",
    "pCompileShadowCode",
    "initLightRegisters",
    "compileLightCode",
    "compileLightProbeCode",
    "_iGetPostLightingVertexCode",
    "_iGetPostLightingFragmentCode",
    "shadowTarget",
    "_dirLightVertexConstants",
    "_pointLightVertexConstants",
    "_dirLightFragmentConstants",
    "_pointLightFragmentConstants",
    "diffuseColorReg",
    "specularColorReg",
    "lightPosReg",
    "lightDirReg",
    "vertexRegIndex",
    "fragmentRegIndex",
    "lightVarying",
    "_iGetPerLightDiffuseFragmentCode",
    "_iGetPerLightSpecularFragmentCode",
    "weightReg",
    "weightComponents",
    "weightRegisters",
    "texReg",
    "_pNumProbeRegisters",
    "_iGetPerProbeDiffuseFragmentCode",
    "_iGetPerProbeSpecularFragmentCode",
    "ceil",
    "awayjs-renderergl/lib/tools/commands/Merge",
    "Mesh",
    "Merge",
    "keepMaterial",
    "disposeSources",
    "objectSpace",
    "_keepMaterial",
    "_disposeSources",
    "_objectSpace",
    "applyToContainer",
    "receiver",
    "objectContainer",
    "parseContainer",
    "collect",
    "merge",
    "applyToMeshes",
    "meshes",
    "_toDispose",
    "_geomVOs",
    "destMesh",
    "subIdx",
    "oldGeom",
    "destGeom",
    "useSubMaterials",
    "sub",
    "vertices",
    "addSubGeometry",
    "m",
    "calc",
    "iIdx",
    "vIdx",
    "nIdx",
    "tIdx",
    "uIdx",
    "ind",
    "pd",
    "nd",
    "td",
    "ud",
    "getSubGeomData",
    "transformVectors",
    "deltaTransformVectors",
    "GeometryVO",
    "object",
    "child",
    "numChildren",
    "getChildAt",
    "awayjs-display/lib/entities/Mesh",
    "awayjs-renderergl/lib/tools/data/ParticleGeometryTransform",
    "ParticleGeometryTransform",
    "_defaultVertexTransform",
    "_defaultInvVertexTransform",
    "transpose",
    "_defaultUVTransform",
    "awayjs-renderergl/lib/utils/ParticleGeometryHelper",
    "ParticleGeometryHelper",
    "generateGeometry",
    "geometries",
    "transforms",
    "indicesVector",
    "positionsVector",
    "normalsVector",
    "tangentsVector",
    "uvsVector",
    "vertexCounters",
    "sourceSubGeometries",
    "numSubGeometries",
    "vertexCounter",
    "sub2SubMap",
    "tempVertex",
    "tempNormal",
    "tempTangents",
    "tempUV",
    "MAX_VERTEX",
    "particleData",
    "tempLen",
    "compact",
    "product",
    "sourceUVs",
    "particleGeometryTransform",
    "vertexTransform",
    "invVertexTransform",
    "UVTransform",
    "deltaTransformVector",
    "transformPoint",
    "sourceIndices",
    "particleGeometry",
    "awayjs-renderergl/lib/utils/PerspectiveMatrix3D",
    "PerspectiveMatrix3D",
    "perspectiveFieldOfViewLH",
    "fieldOfViewY",
    "aspectRatio",
    "zNear",
    "zFar",
    "yScale",
    "tan",
    "xScale",
    "copyRawDataFrom",
    "awayjs-renderergl/lib/vos/CurveSubGeometryVO",
    "CurveSubGeometry",
    "SubGeometryVOBase",
    "CurveSubGeometryVO",
    "curveSubGeometry",
    "_curveSubGeometry",
    "invalidateVertices",
    "curves",
    "_drawElements",
    "firstIndex",
    "_drawArrays",
    "firstVertex",
    "drawVertices",
    "_pGetOverflowSubGeometry",
    "awayjs-display/lib/base/CurveSubGeometry",
    "awayjs-renderergl/lib/vos/SubGeometryVOBase",
    "awayjs-renderergl/lib/vos/ISubGeometryVOClass",
    "awayjs-renderergl/lib/vos/ITextureVOClass",
    "awayjs-renderergl/lib/vos/LineSubGeometryVO",
    "LineSubGeometryVO",
    "lineSubGeometry",
    "_lineSubGeometry",
    "colors",
    "awayjs-renderergl/lib/vos/Sampler2DVO",
    "SamplerVOBase",
    "Sampler2DVO",
    "initProperties",
    "sampler2D",
    "samplerReg",
    "samplerIndex",
    "imageRect",
    "fragmentReg",
    "fragmentIndex",
    "getFragmentCode",
    "inputReg",
    "wrap",
    "getFormatString",
    "image2D",
    "offsetX",
    "offsetY",
    "awayjs-renderergl/lib/vos/SamplerVOBase",
    "awayjs-renderergl/lib/vos/SamplerCubeVO",
    "SamplerCubeVO",
    "samplerCube",
    "imageCube",
    "bitmap",
    "COMPRESSED",
    "COMPRESSED_ALPHA",
    "awayjs-renderergl/lib/vos/Single2DTextureVO",
    "Single2DTexture",
    "TextureVOBase",
    "Single2DTextureVO",
    "single2DTexture",
    "_single2DTexture",
    "_sampler2DVO",
    "awayjs-display/lib/textures/Single2DTexture",
    "awayjs-renderergl/lib/vos/TextureVOBase",
    "awayjs-renderergl/lib/vos/SingleCubeTextureVO",
    "SingleCubeTexture",
    "SingleCubeTextureVO",
    "singleCubeTexture",
    "_singleCubeTexture",
    "_samplerCubeVO",
    "includeInput",
    "awayjs-display/lib/textures/SingleCubeTexture",
    "SubGeometryUtils",
    "_vertices",
    "_verticesDirty",
    "_subGeometry",
    "_onIndicesUpdatedDelegate",
    "_onIndicesUpdated",
    "_onIndicesDisposedDelegate",
    "_onIndicesDisposed",
    "_onVerticesUpdatedDelegate",
    "_onVerticesUpdated",
    "_onVerticesDisposedDelegate",
    "_onVerticesDisposed",
    "INDICES_DISPOSED",
    "VERTICES_DISPOSED",
    "invalidateIndices",
    "_numIndices",
    "_indicesDirty",
    "_updateIndices",
    "getAttributesBufferVO",
    "_indices",
    "getVertexBufferVO",
    "bufferId",
    "_updateVertices",
    "size",
    "disposeIndices",
    "disposeVertices",
    "_overflow",
    "invalidate",
    "invalid",
    "getSubIndices",
    "count",
    "getSubVertices",
    "awayjs-display/lib/utils/SubGeometryUtils",
    "TriangleSubGeometryVO",
    "_iAddSubGeometryVO",
    "_iRemoveSubGeometryVO",
    "subGeometryVOClass",
    "classPool",
    "awayjs-renderergl/lib/vos/TriangleSubGeometryVO",
    "_texture",
    "_iAddTextureVO",
    "_iRemoveTextureVO",
    "textureVOClass",
    "triangleSubGeometry",
    "_triangleSubGeometry"
  ],
  "mappings": "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",
  "file": "awayjs-renderergl.min.js",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    null,
    "import ImageBase\t\t\t\t\t= require(\"awayjs-core/lib/data/ImageBase\");\nimport BitmapImage2D\t\t\t\t= require(\"awayjs-core/lib/data/BitmapImage2D\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport CollectorBase\t\t\t\t= require(\"awayjs-display/lib/traverse/CollectorBase\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport ShadowMapperBase\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase\");\n\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLClearMask\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport DepthRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/DepthRenderer\");\nimport DistanceRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/DistanceRenderer\");\nimport Filter3DRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/Filter3DRenderer\");\nimport Filter3DBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/filters/Filter3DBase\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport SkyboxRenderable\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/SkyboxRenderable\");\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\n\n/**\n * The DefaultRenderer class provides the default rendering method. It renders the scene graph objects using the\n * materials assigned to them.\n *\n * @class away.render.DefaultRenderer\n */\nclass DefaultRenderer extends RendererBase\n{\n\tpublic _pRequireDepthRender:boolean;\n\n\tprivate _pDistanceRenderer:DepthRenderer;\n\tprivate _pDepthRenderer:DepthRenderer;\n\tprivate _skyboxProjection:Matrix3D = new Matrix3D();\n\tpublic _pFilter3DRenderer:Filter3DRenderer;\n\n\tpublic _pDepthRender:BitmapImage2D;\n\n\tprivate _antiAlias:number;\n\n\tpublic get antiAlias():number\n\t{\n\t\treturn this._antiAlias;\n\t}\n\n\tpublic set antiAlias(value:number)\n\t{\n\t\tif (this._antiAlias == value)\n\t\t\treturn;\n\n\t\tthis._antiAlias = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get depthPrepass():boolean\n\t{\n\t\treturn this._depthPrepass;\n\t}\n\n\tpublic set depthPrepass(value:boolean)\n\t{\n\t\tthis._depthPrepass = value;\n\t}\n\n\t/**\n\t *\n\t * @returns {*}\n\t */\n\tpublic get filters3d():Array<Filter3DBase>\n\t{\n\t\treturn this._pFilter3DRenderer? this._pFilter3DRenderer.filters : null;\n\t}\n\tpublic set filters3d(value:Array<Filter3DBase>)\n\t{\n\t\tif (value && value.length == 0)\n\t\t\tvalue = null;\n\n\t\tif (this._pFilter3DRenderer && !value) {\n\t\t\tthis._pFilter3DRenderer.dispose();\n\t\t\tthis._pFilter3DRenderer = null;\n\t\t} else if (!this._pFilter3DRenderer && value) {\n\t\t\tthis._pFilter3DRenderer = new Filter3DRenderer(this._pStage);\n\t\t\tthis._pFilter3DRenderer.filters = value;\n\t\t}\n\n\t\tif (this._pFilter3DRenderer) {\n\t\t\tthis._pFilter3DRenderer.filters = value;\n\t\t\tthis._pRequireDepthRender = this._pFilter3DRenderer.requireDepthRender;\n\t\t} else {\n\t\t\tthis._pRequireDepthRender = false;\n\n\t\t\tif (this._pDepthRender) {\n\t\t\t\tthis._pDepthRender.dispose();\n\t\t\t\tthis._pDepthRender = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Creates a new DefaultRenderer object.\n\t *\n\t * @param antiAlias The amount of anti-aliasing to use.\n\t * @param renderMode The render mode to use.\n\t */\n\tconstructor(stage:Stage = null)\n\t{\n\t\tsuper(stage);\n\n\t\tthis._pRenderablePool = new RenderablePool(this._pStage);\n\t\t\n\t\tif (stage)\n\t\t\tthis._shareContext = true;\n\n\t\tthis._pRttBufferManager = RTTBufferManager.getInstance(this._pStage);\n\n\t\tthis._pDepthRenderer = new DepthRenderer(this._pStage);\n\t\tthis._pDistanceRenderer = new DistanceRenderer(this._pStage);\n\n\t\tif (this._width == 0)\n\t\t\tthis.width = window.innerWidth;\n\t\telse\n\t\t\tthis._pRttBufferManager.viewWidth = this._width;\n\n\t\tif (this._height == 0)\n\t\t\tthis.height = window.innerHeight;\n\t\telse\n\t\t\tthis._pRttBufferManager.viewHeight = this._height;\n\t}\n\n\tpublic render(entityCollector:CollectorBase)\n\t{\n\t\tsuper.render(entityCollector);\n\n\t\tif (!this._pStage.recoverFromDisposal()) {//if context has Disposed by the OS,don't render at this frame\n\t\t\tthis._pBackBufferInvalid = true;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._pBackBufferInvalid)// reset or update render settings\n\t\t\tthis.pUpdateBackBuffer();\n\n\t\tif (this._shareContext && this._pContext)\n\t\t\tthis._pContext.clear(0, 0, 0, 1, 1, 0, ContextGLClearMask.DEPTH);\n\n\t\tif (this._pFilter3DRenderer) {\n\t\t\tthis.textureRatioX = this._pRttBufferManager.textureRatioX;\n\t\t\tthis.textureRatioY = this._pRttBufferManager.textureRatioY;\n\t\t} else {\n\t\t\tthis.textureRatioX = 1;\n\t\t\tthis.textureRatioY = 1;\n\t\t}\n\n\t\tif (this._pRequireDepthRender)\n\t\t\tthis.pRenderSceneDepthToTexture(<EntityCollector> entityCollector);\n\n\t\tif (this._depthPrepass)\n\t\t\tthis.pRenderDepthPrepass(<EntityCollector> entityCollector);\n\n\t\tif (this._pFilter3DRenderer && this._pContext) { //TODO\n\t\t\t//this._iRender(entityCollector, this._pFilter3DRenderer.getMainInputTexture(this._pStage), this._pRttBufferManager.renderToTextureRect);\n\t\t\t//this._pFilter3DRenderer.render(this._pStage, entityCollector.camera, this._pDepthRender);\n\n\t\t} else {\n\n\t\t\tif (this._shareContext)\n\t\t\t\tthis._iRender(entityCollector, null, this._pScissorRect);\n\t\t\telse\n\t\t\t\tthis._iRender(entityCollector);\n\t\t}\n\n\t\tsuper.render(entityCollector);\n\n\t\tif (!this._shareContext && this._pContext)\n\t\t\tthis._pContext.present();\n\n\t\t// register that a view has been rendered\n\t\tthis._pStage.bufferClear = false;\n\t}\n\n\tpublic pExecuteRender(entityCollector:EntityCollector, target:ImageBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\tthis.updateLights(entityCollector);\n\n\t\tsuper.pExecuteRender(entityCollector, target, scissorRect, surfaceSelector);\n\t}\n\n\tprivate updateLights(entityCollector:EntityCollector)\n\t{\n\t\tvar dirLights:Array<DirectionalLight> = entityCollector.directionalLights;\n\t\tvar pointLights:Array<PointLight> = entityCollector.pointLights;\n\t\tvar len:number, i:number;\n\t\tvar light:LightBase;\n\t\tvar shadowMapper:ShadowMapperBase;\n\n\t\tlen = dirLights.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tlight = dirLights[i];\n\n\t\t\tshadowMapper = light.shadowMapper;\n\n\t\t\tif (light.castsShadows && (shadowMapper.autoUpdateShadows || shadowMapper._iShadowsInvalid ))\n\t\t\t\tshadowMapper.iRenderDepthMap(entityCollector, this._pDepthRenderer);\n\t\t}\n\n\t\tlen = pointLights.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tlight = pointLights[i];\n\n\t\t\tshadowMapper = light.shadowMapper;\n\n\t\t\tif (light.castsShadows && (shadowMapper.autoUpdateShadows || shadowMapper._iShadowsInvalid))\n\t\t\t\tshadowMapper.iRenderDepthMap(entityCollector, this._pDistanceRenderer);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pDraw(entityCollector:EntityCollector)\n\t{\n\t\tif (entityCollector.skyBox) {\n\t\t\tthis._pContext.setDepthTest(false, ContextGLCompareMode.ALWAYS);\n\n\t\t\tthis.drawSkybox(entityCollector);\n\t\t}\n\n\t\tsuper.pDraw(entityCollector);\n\t}\n\n\t/**\n\t * Draw the skybox if present.\n\t *\n\t * @param entityCollector The EntityCollector containing all potentially visible information.\n\t */\n\tprivate drawSkybox(entityCollector:EntityCollector)\n\t{\n\t\tvar renderable:RenderableBase = this._pRenderablePool.getItem(entityCollector.skyBox);\n\n\t\tvar camera:Camera = entityCollector.camera;\n\n\t\tthis.updateSkyboxProjection(camera);\n\n\t\tvar render:RenderBase = this._pRenderablePool.getRenderPool(renderable.renderableOwner).getItem(renderable.renderOwner);\n\n\t\tvar pass:IPass = render.passes[0];\n\n\t\tthis.activatePass(renderable, pass, camera);\n\t\trenderable._iRender(pass, camera, this._skyboxProjection);\n\t\tthis.deactivatePass(renderable, pass);\n\t}\n\n\tprivate updateSkyboxProjection(camera:Camera)\n\t{\n\t\tvar near:Vector3D = new Vector3D();\n\n\t\tthis._skyboxProjection.copyFrom(this._pRttViewProjectionMatrix);\n\t\tthis._skyboxProjection.copyRowTo(2, near);\n\n\t\tvar camPos:Vector3D = camera.scenePosition;\n\n\t\tvar cx:number = near.x;\n\t\tvar cy:number = near.y;\n\t\tvar cz:number = near.z;\n\t\tvar cw:number = -(near.x*camPos.x + near.y*camPos.y + near.z*camPos.z + Math.sqrt(cx*cx + cy*cy + cz*cz));\n\n\t\tvar signX:number = cx >= 0? 1 : -1;\n\t\tvar signY:number = cy >= 0? 1 : -1;\n\n\t\tvar p:Vector3D = new Vector3D(signX, signY, 1, 1);\n\n\t\tvar inverse:Matrix3D = this._skyboxProjection.clone();\n\t\tinverse.invert();\n\n\t\tvar q:Vector3D = inverse.transformVector(p);\n\n\t\tthis._skyboxProjection.copyRowTo(3, p);\n\n\t\tvar a:number = (q.x*p.x + q.y*p.y + q.z*p.z + q.w*p.w)/(cx*q.x + cy*q.y + cz*q.z + cw*q.w);\n\n\t\tthis._skyboxProjection.copyRowFrom(2, new Vector3D(cx*a, cy*a, cz*a, cw*a));\n\t}\n\n\tpublic dispose()\n\t{\n\t\tif (!this._shareContext)\n\t\t\tthis._pStage.dispose();\n\n\t\tthis._pRttBufferManager.dispose();\n\t\tthis._pRttBufferManager = null;\n\n\t\tthis._pDepthRenderer.dispose();\n\t\tthis._pDistanceRenderer.dispose();\n\t\tthis._pDepthRenderer = null;\n\t\tthis._pDistanceRenderer = null;\n\n\t\tthis._pDepthRender = null;\n\n\t\tsuper.dispose();\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic pRenderDepthPrepass(entityCollector:EntityCollector)\n\t{\n\t\tthis._pDepthRenderer.disableColor = true;\n\n\t\tif (this._pFilter3DRenderer) { //TODO\n//\t\t\t\tthis._pDepthRenderer.textureRatioX = this._pRttBufferManager.textureRatioX;\n//\t\t\t\tthis._pDepthRenderer.textureRatioY = this._pRttBufferManager.textureRatioY;\n//\t\t\t\tthis._pDepthRenderer._iRender(entityCollector, this._pFilter3DRenderer.getMainInputTexture(this._pStage), this._pRttBufferManager.renderToTextureRect);\n\t\t} else {\n\t\t\tthis._pDepthRenderer.textureRatioX = 1;\n\t\t\tthis._pDepthRenderer.textureRatioY = 1;\n\t\t\tthis._pDepthRenderer._iRender(entityCollector);\n\t\t}\n\n\t\tthis._pDepthRenderer.disableColor = false;\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic pRenderSceneDepthToTexture(entityCollector:EntityCollector)\n\t{\n\t\tif (this._pDepthTextureInvalid || !this._pDepthRender)\n\t\t\tthis.initDepthTexture(<IContextGL> this._pStage.context);\n\n\t\tthis._pDepthRenderer.textureRatioX = this._pRttBufferManager.textureRatioX;\n\t\tthis._pDepthRenderer.textureRatioY = this._pRttBufferManager.textureRatioY;\n\t\tthis._pDepthRenderer._iRender(entityCollector, this._pDepthRender);\n\t}\n\n\n\t/**\n\t * Updates the backbuffer dimensions.\n\t */\n\tpublic pUpdateBackBuffer()\n\t{\n\t\t// No reason trying to configure back buffer if there is no context available.\n\t\t// Doing this anyway (and relying on _stage to cache width/height for\n\t\t// context does get available) means usesSoftwareRendering won't be reliable.\n\t\tif (this._pStage.context && !this._shareContext) {\n\t\t\tif (this._width && this._height) {\n\t\t\t\tthis._pStage.configureBackBuffer(this._width, this._height, this._antiAlias, true);\n\t\t\t\tthis._pBackBufferInvalid = false;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initDepthTexture(context:IContextGL):void\n\t{\n\t\tthis._pDepthTextureInvalid = false;\n\n\t\tif (this._pDepthRender)\n\t\t\tthis._pDepthRender.dispose();\n\n\t\tthis._pDepthRender = new BitmapImage2D(this._pRttBufferManager.textureWidth, this._pRttBufferManager.textureHeight);\n\t}\n}\n\nexport = DefaultRenderer;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport DepthRender\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/DepthRender\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\n\n/**\n * The DepthRenderer class renders 32-bit depth information encoded as RGBA\n *\n * @class away.render.DepthRenderer\n */\nclass DepthRenderer extends RendererBase\n{\n\t/**\n\t * Creates a new DepthRenderer object.\n\t * @param renderBlended Indicates whether semi-transparent objects should be rendered.\n\t * @param distanceBased Indicates whether the written depth value is distance-based or projected depth-based\n\t */\n\tconstructor(stage:Stage = null)\n\t{\n\t\tsuper(stage);\n\n\t\tthis._pRenderablePool = new RenderablePool(this._pStage, DepthRender);\n\n\t\tthis._iBackgroundR = 1;\n\t\tthis._iBackgroundG = 1;\n\t\tthis._iBackgroundB = 1;\n\n\t}\n}\n\nexport = DepthRenderer;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport DistanceRender\t\t\t\t= require(\"awayjs-renderergl/lib/render/DistanceRender\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\n\n\n/**\n * The DistanceRenderer class renders 32-bit depth information encoded as RGBA\n *\n * @class away.render.DistanceRenderer\n */\nclass DistanceRenderer extends RendererBase\n{\n\t/**\n\t * Creates a new DistanceRenderer object.\n\t * @param renderBlended Indicates whether semi-transparent objects should be rendered.\n\t * @param distanceBased Indicates whether the written depth value is distance-based or projected depth-based\n\t */\n\tconstructor(stage:Stage = null)\n\t{\n\t\tsuper(stage);\n\t\t\n\t\tthis._pRenderablePool = new RenderablePool(this._pStage, DistanceRender);\n\t\t\n\t\tthis._iBackgroundR = 1;\n\t\tthis._iBackgroundG = 1;\n\t\tthis._iBackgroundB = 1;\n\n\t}\n}\n\nexport = DistanceRenderer;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLDrawMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLDrawMode\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport Filter3DBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/filters/Filter3DBase\");\nimport Filter3DTaskBase\t\t\t\t= require(\"awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase\");\n\n/**\n * @class away.render.Filter3DRenderer\n */\nclass Filter3DRenderer\n{\n\tprivate _filters:Array<Filter3DBase>;\n\tprivate _tasks:Array<Filter3DTaskBase>;\n\tprivate _filterTasksInvalid:boolean;\n\tprivate _mainInputTexture:ITexture;\n\tprivate _requireDepthRender:boolean;\n\tprivate _rttManager:RTTBufferManager;\n\tprivate _stage:Stage;\n\tprivate _filterSizesInvalid:boolean = true;\n\tprivate _onRTTResizeDelegate:(event:Event) => void;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._onRTTResizeDelegate = (event:Event) => this.onRTTResize(event);\n\n\t\tthis._stage = stage;\n\t\tthis._rttManager = RTTBufferManager.getInstance(stage);\n\t\tthis._rttManager.addEventListener(Event.RESIZE, this._onRTTResizeDelegate);\n\n\t}\n\n\tprivate onRTTResize(event:Event)\n\t{\n\t\tthis._filterSizesInvalid = true;\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\tif (this._filterTasksInvalid) {\n\n\t\t\tthis.updateFilterTasks(stage);\n\n\t\t}\n\n\t\treturn this._mainInputTexture;\n\t}\n\n\tpublic get filters():Filter3DBase[]\n\t{\n\t\treturn this._filters;\n\t}\n\n\tpublic set filters(value:Filter3DBase[])\n\t{\n\t\tthis._filters = value;\n\n\t\tthis._filterTasksInvalid = true;\n\n\t\tthis._requireDepthRender = false;\n\n\t\tif (!this._filters) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tfor (var i:number = 0; i < this._filters.length; ++i) {\n\n\t\t\t// TODO: check logic:\n\t\t\t// this._requireDepthRender ||=  Boolean ( this._filters[i].requireDepthRender )\n\n\t\t\tvar s:any = this._filters[i];\n\t\t\tvar b:boolean = <boolean> ( s.requireDepthRender == null )? false : s.requireDepthRender;\n\n\t\t\tthis._requireDepthRender = this._requireDepthRender || b;\n\n\t\t}\n\n\t\tthis._filterSizesInvalid = true;\n\n\t}\n\n\tprivate updateFilterTasks(stage:Stage)\n\t{\n\t\tvar len:number;\n\n\t\tif (this._filterSizesInvalid) {\n\n\t\t\tthis.updateFilterSizes();\n\n\t\t}\n\n\t\tif (!this._filters) {\n\t\t\tthis._tasks = null;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tasks = new Array<Filter3DTaskBase>();\n\n\t\tlen = this._filters.length - 1;\n\n\t\tvar filter:Filter3DBase;\n\n\t\tfor (var i:number = 0; i <= len; ++i) {\n\n\t\t\t// make sure all internal tasks are linked together\n\t\t\tfilter = this._filters[i];\n\n\t\t\t// TODO: check logic\n\t\t\t// filter.setRenderTargets(i == len? null : Filter3DBase(_filters[i + 1]).getMainInputTexture(stage), stage);\n\n\t\t\tfilter.setRenderTargets(i == len? null : this._filters[i + 1].getMainInputTexture(stage), stage);\n\n\t\t\tthis._tasks = this._tasks.concat(filter.tasks);\n\n\t\t}\n\n\t\tthis._mainInputTexture = this._filters[0].getMainInputTexture(stage);\n\n\t}\n\n\tpublic render(stage:Stage, camera:Camera, depthTexture:ITexture)\n\t{\n\t\tvar len:number;\n\t\tvar i:number;\n\t\tvar task:Filter3DTaskBase;\n\t\tvar context:IContextGL = <IContextGL> stage.context;\n\n\t\tvar indexBuffer:IIndexBuffer = this._rttManager.indexBuffer;\n\n\t\tvar vertexBuffer:IVertexBuffer = this._rttManager.renderToTextureVertexBuffer;\n\n\t\tif (!this._filters) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterSizesInvalid) {\n\t\t\tthis.updateFilterSizes();\n\t\t}\n\n\t\tif (this._filterTasksInvalid) {\n\t\t\tthis.updateFilterTasks(stage);\n\t\t}\n\n\t\tlen = this._filters.length;\n\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._filters[i].update(stage, camera);\n\t\t}\n\n\t\tlen = this._tasks.length;\n\n\t\tif (len > 1) {\n\t\t\tcontext.setVertexBufferAt(0, vertexBuffer, 0, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\tcontext.setVertexBufferAt(1, vertexBuffer, 2, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t}\n\n\t\tfor (i = 0; i < len; ++i) {\n\n\t\t\ttask = this._tasks[i];\n\n\t\t\t//stage.setRenderTarget(task.target); //TODO\n\n\t\t\tif (!task.target) {\n\n\t\t\t\tstage.scissorRect = null;\n\t\t\t\tvertexBuffer = this._rttManager.renderToScreenVertexBuffer;\n\t\t\t\tcontext.setVertexBufferAt(0, vertexBuffer, 0, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\t\tcontext.setVertexBufferAt(1, vertexBuffer, 2, ContextGLVertexBufferFormat.FLOAT_2);\n\n\t\t\t}\n\n\t\t\tcontext.setTextureAt(0, task.getMainInputTexture(stage));\n\t\t\tcontext.setProgram(task.getProgram(stage));\n\t\t\tcontext.clear(0.0, 0.0, 0.0, 0.0);\n\n\t\t\ttask.activate(stage, camera, depthTexture);\n\n\t\t\tcontext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\t\tcontext.drawIndices(ContextGLDrawMode.TRIANGLES, indexBuffer, 0, 2);\n\n\t\t\ttask.deactivate(stage);\n\t\t}\n\n\t\tcontext.setTextureAt(0, null);\n\t\tcontext.setVertexBufferAt(0, null);\n\t\tcontext.setVertexBufferAt(1, null);\n\t}\n\n\tprivate updateFilterSizes()\n\t{\n\t\tfor (var i:number = 0; i < this._filters.length; ++i) {\n\t\t\tthis._filters[i].textureWidth = this._rttManager.textureWidth;\n\t\t\tthis._filters[i].textureHeight = this._rttManager.textureHeight;\n\t\t}\n\n\t\tthis._filterSizesInvalid = true;\n\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._rttManager.removeEventListener(Event.RESIZE, this._onRTTResizeDelegate);\n\t\tthis._rttManager = null;\n\t\tthis._stage = null;\n\t}\n}\n\nexport = Filter3DRenderer;",
    "import ImageBase\t\t\t\t\t= require(\"awayjs-core/lib/data/ImageBase\");\nimport BitmapImage2D\t\t\t\t= require(\"awayjs-core/lib/data/BitmapImage2D\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Point\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport EntityListItem\t\t\t\t= require(\"awayjs-display/lib/pool/EntityListItem\");\nimport IEntitySorter\t\t\t\t= require(\"awayjs-display/lib/sort/IEntitySorter\");\nimport RenderableMergeSort\t\t\t= require(\"awayjs-display/lib/sort/RenderableMergeSort\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/IRenderer\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport RendererEvent\t\t\t\t= require(\"awayjs-display/lib/events/RendererEvent\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport CollectorBase\t\t\t\t= require(\"awayjs-display/lib/traverse/CollectorBase\");\nimport ShadowCasterCollector\t\t= require(\"awayjs-display/lib/traverse/ShadowCasterCollector\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\nimport AGALMiniAssembler\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport StageEvent\t\t\t\t\t= require(\"awayjs-stagegl/lib/events/StageEvent\");\nimport StageManager\t\t\t\t\t= require(\"awayjs-stagegl/lib/managers/StageManager\");\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\n\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\n\n\n/**\n * RendererBase forms an abstract base class for classes that are used in the rendering pipeline to render the\n * contents of a partition\n *\n * @class away.render.RendererBase\n */\nclass RendererBase extends EventDispatcher implements IRenderer\n{\n\tprivate _numUsedStreams:number = 0;\n\tprivate _numUsedTextures:number = 0;\n\n\tpublic _pRenderablePool:RenderablePool;\n\n\tpublic _pContext:IContextGL;\n\tpublic _pStage:Stage;\n\n\tpublic _pCamera:Camera;\n\tpublic _iEntryPoint:Vector3D;\n\tpublic _pCameraForward:Vector3D;\n\n\tpublic _pRttBufferManager:RTTBufferManager;\n\tprivate _viewPort:Rectangle = new Rectangle();\n\tprivate _viewportDirty:boolean;\n\tprivate _scissorDirty:boolean;\n\n\tpublic _pBackBufferInvalid:boolean = true;\n\tpublic _pDepthTextureInvalid:boolean = true;\n\tpublic _depthPrepass:boolean = false;\n\tprivate _backgroundR:number = 0;\n\tprivate _backgroundG:number = 0;\n\tprivate _backgroundB:number = 0;\n\tprivate _backgroundAlpha:number = 1;\n\tpublic _shareContext:boolean;\n\n\t// only used by renderers that need to render geometry to textures\n\tpublic _width:number;\n\tpublic _height:number;\n\n\tpublic textureRatioX:number = 1;\n\tpublic textureRatioY:number = 1;\n\n\tprivate _snapshotBitmapImage2D:BitmapImage2D;\n\tprivate _snapshotRequired:boolean;\n\n\tpublic _pRttViewProjectionMatrix:Matrix3D = new Matrix3D();\n\n\tprivate _localPos:Point = new Point();\n\tprivate _globalPos:Point = new Point();\n\tpublic _pScissorRect:Rectangle = new Rectangle();\n\n\tprivate _scissorUpdated:RendererEvent;\n\tprivate _viewPortUpdated:RendererEvent;\n\n\tprivate _onContextUpdateDelegate:Function;\n\tprivate _onViewportUpdatedDelegate;\n\n\tpublic _pNumElements:number = 0;\n\n\tpublic _pOpaqueRenderableHead:RenderableBase;\n\tpublic _pBlendedRenderableHead:RenderableBase;\n\tpublic _disableColor:boolean = false;\n\tpublic _renderBlended:boolean = true;\n\n\n\tpublic get renderBlended():boolean\n\t{\n\t\treturn this._renderBlended;\n\t}\n\n\tpublic set renderBlended(value:boolean)\n\t{\n\t\tthis._renderBlended = value;\n\t}\n\n\n\tpublic get disableColor():boolean\n\t{\n\t\treturn this._disableColor;\n\t}\n\n\tpublic set disableColor(value:boolean)\n\t{\n\t\tthis._disableColor = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get numElements():number\n\t{\n\t\treturn this._pNumElements;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic renderableSorter:IEntitySorter;\n\n\n\t/**\n\t * A viewPort rectangle equivalent of the Stage size and position.\n\t */\n\tpublic get viewPort():Rectangle\n\t{\n\t\treturn this._viewPort;\n\t}\n\n\t/**\n\t * A scissor rectangle equivalent of the view size and position.\n\t */\n\tpublic get scissorRect():Rectangle\n\t{\n\t\treturn this._pScissorRect;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get x():number\n\t{\n\t\treturn this._localPos.x;\n\t}\n\n\tpublic set x(value:number)\n\t{\n\t\tif (this.x == value)\n\t\t\treturn;\n\n\t\tthis._globalPos.x = this._localPos.x = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get y():number\n\t{\n\t\treturn this._localPos.y;\n\t}\n\n\tpublic set y(value:number)\n\t{\n\t\tif (this.y == value)\n\t\t\treturn;\n\n\t\tthis._globalPos.y = this._localPos.y = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic set width(value:number)\n\t{\n\t\tif (this._width == value)\n\t\t\treturn;\n\n\t\tthis._width = value;\n\t\tthis._pScissorRect.width = value;\n\n\t\tif (this._pRttBufferManager)\n\t\t\tthis._pRttBufferManager.viewWidth = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t\tthis._pDepthTextureInvalid = true;\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic set height(value:number)\n\t{\n\t\tif (this._height == value)\n\t\t\treturn;\n\n\t\tthis._height = value;\n\t\tthis._pScissorRect.height = value;\n\n\t\tif (this._pRttBufferManager)\n\t\t\tthis._pRttBufferManager.viewHeight = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t\tthis._pDepthTextureInvalid = true;\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\t/**\n\t * Creates a new RendererBase object.\n\t */\n\tconstructor(stage:Stage = null)\n\t{\n\t\tsuper();\n\n\t\tthis._onViewportUpdatedDelegate = (event:StageEvent) => this.onViewportUpdated(event);\n\t\tthis._onContextUpdateDelegate = (event:Event) => this.onContextUpdate(event);\n\n\t\t//default sorting algorithm\n\t\tthis.renderableSorter = new RenderableMergeSort();\n\n\t\t//set stage\n\t\tthis._pStage = stage || StageManager.getInstance().getFreeStage();\n\n\t\tthis._pStage.addEventListener(StageEvent.CONTEXT_CREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.addEventListener(StageEvent.CONTEXT_RECREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.addEventListener(StageEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\n\t\t/*\n\t\t if (_backgroundImageRenderer)\n\t\t _backgroundImageRenderer.stage = value;\n\t\t */\n\t\tif (this._pStage.context)\n\t\t\tthis._pContext = <IContextGL> this._pStage.context;\n\t}\n\n\tpublic activatePass(renderable:RenderableBase, pass:IPass, camera:Camera)\n\t{\n\t\t//clear unused vertex streams\n\t\tfor (var i = pass.shader.numUsedStreams; i < this._numUsedStreams; i++)\n\t\t\tthis._pContext.setVertexBufferAt(i, null);\n\n\t\t//clear unused texture streams\n\t\tfor (var i = pass.shader.numUsedTextures; i < this._numUsedTextures; i++)\n\t\t\tthis._pContext.setTextureAt(i, null);\n\n\t\t//check program data is uploaded\n\t\tvar programData:ProgramData = pass.shader.programData;\n\n\t\tif (!programData.program) {\n\t\t\tprogramData.program = this._pContext.createProgram();\n\t\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + programData.vertexString + \"endpart\"))['vertex'].data;\n\t\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + programData.fragmentString + \"endpart\"))['fragment'].data;\n\t\t\tprogramData.program.upload(vertexByteCode, fragmentByteCode);\n\t\t}\n\n\t\t//set program data\n\t\tthis._pContext.setProgram(programData.program);\n\n\t\t//activate shader object through renderable\n\t\trenderable._iActivate(pass, camera);\n\t}\n\n\tpublic deactivatePass(renderable:RenderableBase, pass:IPass)\n\t{\n\t\t//deactivate shader object\n\t\trenderable._iDeactivate(pass);\n\n\t\tthis._numUsedStreams = pass.shader.numUsedStreams;\n\t\tthis._numUsedTextures = pass.shader.numUsedTextures;\n\t}\n\n\tpublic _iCreateEntityCollector():CollectorBase\n\t{\n\t\treturn new EntityCollector();\n\t}\n\n\t/**\n\t * The background color's red component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundR():number\n\t{\n\t\treturn this._backgroundR;\n\t}\n\n\tpublic set _iBackgroundR(value:number)\n\t{\n\t\tif (this._backgroundR == value)\n\t\t\treturn;\n\n\t\tthis._backgroundR = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t * The background color's green component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundG():number\n\t{\n\t\treturn this._backgroundG;\n\t}\n\n\tpublic set _iBackgroundG(value:number)\n\t{\n\t\tif (this._backgroundG == value)\n\t\t\treturn;\n\n\t\tthis._backgroundG = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t * The background color's blue component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundB():number\n\t{\n\t\treturn this._backgroundB;\n\t}\n\n\tpublic set _iBackgroundB(value:number)\n\t{\n\t\tif (this._backgroundB == value)\n\t\t\treturn;\n\n\t\tthis._backgroundB = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\tpublic get context():IContextGL\n\t{\n\t\treturn this._pContext;\n\t}\n\n\t/**\n\t * The Stage that will provide the ContextGL used for rendering.\n\t */\n\tpublic get stage():Stage\n\t{\n\t\treturn this._pStage;\n\t}\n\n\t/**\n\t * Defers control of ContextGL clear() and present() calls to Stage, enabling multiple Stage frameworks\n\t * to share the same ContextGL object.\n\t */\n\tpublic get shareContext():boolean\n\t{\n\t\treturn this._shareContext;\n\t}\n\n\tpublic get renderablePool():RenderablePool\n\t{\n\t\treturn this._pRenderablePool;\n\t}\n\n\t/**\n\t * Disposes the resources used by the RendererBase.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pRenderablePool.dispose();\n\n\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_CREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_RECREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.removeEventListener(StageEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\n\t\tthis._pStage = null;\n\t\tthis._pContext = null;\n\t\t/*\n\t\t if (_backgroundImageRenderer) {\n\t\t _backgroundImageRenderer.dispose();\n\t\t _backgroundImageRenderer = null;\n\t\t }\n\t\t */\n\t}\n\n\tpublic render(entityCollector:CollectorBase)\n\t{\n\t\tthis._viewportDirty = false;\n\t\tthis._scissorDirty = false;\n\t}\n\n\t/**\n\t * Renders the potentially visible geometry to the back buffer or texture.\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t * @param target An option target texture to render to.\n\t * @param surfaceSelector The index of a CubeTexture's face to render to.\n\t * @param additionalClearMask Additional clear mask information, in case extra clear channels are to be omitted.\n\t */\n\tpublic _iRender(entityCollector:CollectorBase, target:ImageBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\t//TODO refactor setTarget so that rendertextures are created before this check\n\t\tif (!this._pStage || !this._pContext)\n\t\t\treturn;\n\n\t\tthis._pRttViewProjectionMatrix.copyFrom(entityCollector.camera.viewProjection);\n\t\tthis._pRttViewProjectionMatrix.appendScale(this.textureRatioX, this.textureRatioY, 1);\n\n\t\tthis.pExecuteRender(entityCollector, target, scissorRect, surfaceSelector);\n\n\t\t// generate mip maps on target (if target exists) //TODO\n\t\t//if (target)\n\t\t//\t(<Texture>target).generateMipmaps();\n\n\t\t// clear buffers\n\t\tfor (var i:number = 0; i < 8; ++i) {\n\t\t\tthis._pContext.setVertexBufferAt(i, null);\n\t\t\tthis._pContext.setTextureAt(i, null);\n\t\t}\n\t}\n\n\tpublic _iRenderCascades(entityCollector:ShadowCasterCollector, target:ImageBase, numCascades:number, scissorRects:Array<Rectangle>, cameras:Array<Camera>)\n\t{\n\t\tthis._applyCollector(entityCollector);\n\n\t\tthis._pStage.setRenderTarget(target, true, 0);\n\t\tthis._pContext.clear(1, 1, 1, 1, 1, 0);\n\n\t\tthis._pContext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\tthis._pContext.setDepthTest(true, ContextGLCompareMode.LESS);\n\n\t\tvar head:RenderableBase = this._pOpaqueRenderableHead;\n\n\t\tvar first:boolean = true;\n\n\t\t//TODO cascades must have separate collectors, rather than separate draw commands\n\t\tfor (var i:number = numCascades - 1; i >= 0; --i) {\n\t\t\tthis._pStage.scissorRect = scissorRects[i];\n\t\t\t//this.drawCascadeRenderables(head, cameras[i], first? null : cameras[i].frustumPlanes);\n\t\t\tfirst = false;\n\t\t}\n\n\t\t//line required for correct rendering when using away3d with starling. DO NOT REMOVE UNLESS STARLING INTEGRATION IS RETESTED!\n\t\tthis._pContext.setDepthTest(false, ContextGLCompareMode.LESS_EQUAL);\n\n\t\tthis._pStage.scissorRect = null;\n\t}\n\n\tprivate _applyCollector(entityCollector:CollectorBase)\n\t{\n\t\t//reset head values\n\t\tthis._pBlendedRenderableHead = null;\n\t\tthis._pOpaqueRenderableHead = null;\n\t\tthis._pNumElements = 0;\n\n\t\t//grab entity head\n\t\tvar item:EntityListItem = entityCollector.entityHead;\n\n\t\t//set temp values for entry point and camera forward vector\n\t\tthis._pCamera = entityCollector.camera;\n\t\tthis._iEntryPoint = this._pCamera.scenePosition;\n\t\tthis._pCameraForward = this._pCamera.transform.forwardVector;\n\n\t\t//iterate through all entities\n\t\twhile (item) {\n\t\t\titem.entity._applyRenderer(this);\n\t\t\titem = item.next;\n\t\t}\n\n\t\t//sort the resulting renderables\n\t\tthis._pOpaqueRenderableHead = <RenderableBase> this.renderableSorter.sortOpaqueRenderables(this._pOpaqueRenderableHead);\n\t\tthis._pBlendedRenderableHead = <RenderableBase> this.renderableSorter.sortBlendedRenderables(this._pBlendedRenderableHead);\n\t}\n\n\t/**\n\t * Renders the potentially visible geometry to the back buffer or texture. Only executed if everything is set up.\n\t *\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t * @param target An option target texture to render to.\n\t * @param surfaceSelector The index of a CubeTexture's face to render to.\n\t * @param additionalClearMask Additional clear mask information, in case extra clear channels are to be omitted.\n\t */\n\tpublic pExecuteRender(entityCollector:CollectorBase, target:ImageBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\tthis._pStage.setRenderTarget(target, true, surfaceSelector);\n\n\t\tif ((target || !this._shareContext) && !this._depthPrepass)\n\t\t\tthis._pContext.clear(this._backgroundR, this._backgroundG, this._backgroundB, this._backgroundAlpha, 1, 0);\n\n\t\tthis._pStage.scissorRect = scissorRect;\n\n\t\t/*\n\t\t if (_backgroundImageRenderer)\n\t\t _backgroundImageRenderer.render();\n\t\t */\n\t\tthis._applyCollector(entityCollector);\n\n\t\tthis._pContext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\n\t\tthis.pDraw(entityCollector);\n\n\t\t//line required for correct rendering when using away3d with starling. DO NOT REMOVE UNLESS STARLING INTEGRATION IS RETESTED!\n\t\t//this._pContext.setDepthTest(false, ContextGLCompareMode.LESS_EQUAL); //oopsie\n\n\t\tif (!this._shareContext) {\n\t\t\tif (this._snapshotRequired && this._snapshotBitmapImage2D) {\n\t\t\t\tthis._pContext.drawToBitmapImage2D(this._snapshotBitmapImage2D);\n\t\t\t\tthis._snapshotRequired = false;\n\t\t\t}\n\t\t}\n\n\t\tthis._pStage.scissorRect = null;\n\t}\n\n\t/*\n\t * Will draw the renderer's output on next render to the provided bitmap data.\n\t * */\n\tpublic queueSnapshot(bmd:BitmapImage2D)\n\t{\n\t\tthis._snapshotRequired = true;\n\t\tthis._snapshotBitmapImage2D = bmd;\n\t}\n\n\t/**\n\t * Performs the actual drawing of geometry to the target.\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t */\n\tpublic pDraw(entityCollector:CollectorBase)\n\t{\n\t\tthis._pContext.setDepthTest(true, ContextGLCompareMode.LESS_EQUAL);\n\n\t\tif (this._disableColor)\n\t\t\tthis._pContext.setColorMask(false, false, false, false);\n\n\t\tthis.drawRenderables(this._pOpaqueRenderableHead, entityCollector);\n\n\t\tif (this._renderBlended)\n\t\t\tthis.drawRenderables(this._pBlendedRenderableHead, entityCollector);\n\n\t\tif (this._disableColor)\n\t\t\tthis._pContext.setColorMask(true, true, true, true);\n\t}\n\n\t//private drawCascadeRenderables(renderable:RenderableBase, camera:Camera, cullPlanes:Array<Plane3D>)\n\t//{\n\t//\tvar renderable2:RenderableBase;\n\t//\tvar render:RenderBase;\n\t//\tvar pass:IPass;\n\t//\n\t//\twhile (renderable) {\n\t//\t\trenderable2 = renderable;\n\t//\t\trender = renderable.render;\n\t//\t\tpass = render.passes[0] //assuming only one pass per material\n\t//\n\t//\t\tthis.activatePass(renderable, pass, camera);\n\t//\n\t//\t\tdo {\n\t//\t\t\t// if completely in front, it will fall in a different cascade\n\t//\t\t\t// do not use near and far planes\n\t//\t\t\tif (!cullPlanes || renderable2.sourceEntity.worldBounds.isInFrustum(cullPlanes, 4)) {\n\t//\t\t\t\trenderable2._iRender(pass, camera, this._pRttViewProjectionMatrix);\n\t//\t\t\t} else {\n\t//\t\t\t\trenderable2.cascaded = true;\n\t//\t\t\t}\n\t//\n\t//\t\t\trenderable2 = renderable2.next;\n\t//\n\t//\t\t} while (renderable2 && renderable2.render == render && !renderable2.cascaded);\n\t//\n\t//\t\tthis.deactivatePass(renderable, pass);\n\t//\n\t//\t\trenderable = renderable2;\n\t//\t}\n\t//}\n\n\t/**\n\t * Draw a list of renderables.\n\t *\n\t * @param renderables The renderables to draw.\n\t * @param entityCollector The EntityCollector containing all potentially visible information.\n\t */\n\tpublic drawRenderables(renderable:RenderableBase, entityCollector:CollectorBase)\n\t{\n\t\tvar i:number;\n\t\tvar len:number;\n\t\tvar renderable2:RenderableBase;\n\t\tvar render:RenderBase;\n\t\tvar passes:Array<IPass>;\n\t\tvar pass:IPass;\n\t\tvar camera:Camera = entityCollector.camera;\n\n\n\t\twhile (renderable) {\n\t\t\trender = renderable.render;\n\t\t\tpasses = render.passes;\n\n\t\t\t// otherwise this would result in depth rendered anyway because fragment shader kil is ignored\n\t\t\tif (this._disableColor && render._renderOwner.alphaThreshold != 0) {\n\t\t\t\trenderable2 = renderable;\n\t\t\t\t// fast forward\n\t\t\t\tdo {\n\t\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t\t} while (renderable2 && renderable2.render == render);\n\t\t\t} else {\n\t\t\t\t//iterate through each shader object\n\t\t\t\tlen = passes.length;\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\trenderable2 = renderable;\n\t\t\t\t\tpass = passes[i];\n\n\t\t\t\t\tthis.activatePass(renderable, pass, camera);\n\n\t\t\t\t\tdo {\n\t\t\t\t\t\trenderable2._iRender(pass, camera, this._pRttViewProjectionMatrix);\n\n\t\t\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t\t\t} while (renderable2 && renderable2.render == render);\n\n\t\t\t\t\tthis.deactivatePass(renderable, pass);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trenderable = renderable2;\n\t\t}\n\t}\n\n\t/**\n\t * Assign the context once retrieved\n\t */\n\tprivate onContextUpdate(event:Event)\n\t{\n\t\tthis._pContext = <IContextGL> this._pStage.context;\n\t}\n\n\tpublic get _iBackgroundAlpha():number\n\t{\n\t\treturn this._backgroundAlpha;\n\t}\n\n\tpublic set _iBackgroundAlpha(value:number)\n\t{\n\t\tif (this._backgroundAlpha == value)\n\t\t\treturn;\n\n\t\tthis._backgroundAlpha = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/*\n\t public get iBackground():Texture2DBase\n\t {\n\t return this._background;\n\t }\n\t */\n\n\t/*\n\t public set iBackground(value:Texture2DBase)\n\t {\n\t if (this._backgroundImageRenderer && !value) {\n\t this._backgroundImageRenderer.dispose();\n\t this._backgroundImageRenderer = null;\n\t }\n\n\t if (!this._backgroundImageRenderer && value)\n\t {\n\n\t this._backgroundImageRenderer = new BackgroundImageRenderer(this._pStage);\n\n\t }\n\n\n\t this._background = value;\n\n\t if (this._backgroundImageRenderer)\n\t this._backgroundImageRenderer.texture = value;\n\t }\n\t */\n\t/*\n\t public get backgroundImageRenderer():BackgroundImageRenderer\n\t {\n\t return _backgroundImageRenderer;\n\t }\n\t */\n\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyScissorUpdate()\n\t{\n\t\tif (this._scissorDirty)\n\t\t\treturn;\n\n\t\tthis._scissorDirty = true;\n\n\t\tif (!this._scissorUpdated)\n\t\t\tthis._scissorUpdated = new RendererEvent(RendererEvent.SCISSOR_UPDATED);\n\n\t\tthis.dispatchEvent(this._scissorUpdated);\n\t}\n\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyViewportUpdate()\n\t{\n\t\tif (this._viewportDirty)\n\t\t\treturn;\n\n\t\tthis._viewportDirty = true;\n\n\t\tif (!this._viewPortUpdated)\n\t\t\tthis._viewPortUpdated = new RendererEvent(RendererEvent.VIEWPORT_UPDATED);\n\n\t\tthis.dispatchEvent(this._viewPortUpdated);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onViewportUpdated(event:StageEvent)\n\t{\n\t\tthis._viewPort = this._pStage.viewPort;\n\t\t//TODO stop firing viewport updated for every stagegl viewport change\n\n\t\tif (this._shareContext) {\n\t\t\tthis._pScissorRect.x = this._globalPos.x - this._pStage.x;\n\t\t\tthis._pScissorRect.y = this._globalPos.y - this._pStage.y;\n\t\t\tthis.notifyScissorUpdate();\n\t\t}\n\n\t\tthis.notifyViewportUpdate();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic updateGlobalPos()\n\t{\n\t\tif (this._shareContext) {\n\t\t\tthis._pScissorRect.x = this._globalPos.x - this._viewPort.x;\n\t\t\tthis._pScissorRect.y = this._globalPos.y - this._viewPort.y;\n\t\t} else {\n\t\t\tthis._pScissorRect.x = 0;\n\t\t\tthis._pScissorRect.y = 0;\n\t\t\tthis._viewPort.x = this._globalPos.x;\n\t\t\tthis._viewPort.y = this._globalPos.y;\n\t\t}\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\tpublic _iApplyRenderableOwner(renderableOwner:IRenderableOwner)\n\t{\n\t\tvar renderable:RenderableBase = this._pRenderablePool.getItem(renderableOwner);\n\n\t\t//set local vars for faster referencing\n\t\tvar render:RenderBase = this._pRenderablePool.getRenderPool(renderableOwner).getItem(renderable.renderOwner || DefaultMaterialManager.getDefaultMaterial(renderableOwner));\n\t\t\n\t\trenderable.render = render;\n\t\trenderable.renderId = render.renderId;\n\t\trenderable.renderOrderId = render.renderOrderId;\n\n\t\trenderable.cascaded = false;\n\n\t\tvar entity:IEntity = renderable.sourceEntity;\n\t\tvar position:Vector3D = entity.scenePosition;\n\n\t\t// project onto camera's z-axis\n\t\tposition = this._iEntryPoint.subtract(position);\n\t\trenderable.zIndex = entity.zOffset + position.dotProduct(this._pCameraForward);\n\n\t\t//store reference to scene transform\n\t\trenderable.renderSceneTransform = renderable.sourceEntity.getRenderSceneTransform(this._pCamera);\n\n\t\tif (render.requiresBlending) {\n\t\t\trenderable.next = this._pBlendedRenderableHead;\n\t\t\tthis._pBlendedRenderableHead = renderable;\n\t\t} else {\n\t\t\trenderable.next = this._pOpaqueRenderableHead;\n\t\t\tthis._pOpaqueRenderableHead = renderable;\n\t\t}\n\n\t\tthis._pNumElements += renderable.subGeometryVO.subGeometry.numElements;\n\t}\n}\n\nexport = RendererBase;",
    "import IAsset\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport AnimationNodeBase\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetError\t\t\t= require(\"awayjs-renderergl/lib/errors/AnimationSetError\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * Provides an abstract base class for data set classes that hold animation data for use in animator classes.\n *\n * @see away.animators.AnimatorBase\n */\nclass AnimationSetBase extends AssetBase implements IAsset\n{\n\tpublic static assetType:string = \"[asset AnimationSet]\";\n\n\tprivate _usesCPU:boolean;\n\tprivate _animations:Array<AnimationNodeBase> = new Array<AnimationNodeBase>();\n\tprivate _animationNames:Array<string> = new Array<string>();\n\tprivate _animationDictionary:Object = new Object();\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Retrieves a temporary GPU register that's still free.\n\t *\n\t * @param exclude An array of non-free temporary registers.\n\t * @param excludeAnother An additional register that's not free.\n\t * @return A temporary register that can be used.\n\t */\n\tpublic _pFindTempReg(exclude:Array<string>, excludeAnother:string = null):string\n\t{\n\t\tvar i:number /*uint*/ = 0;\n\t\tvar reg:string;\n\n\t\twhile (true) {\n\t\t\treg = \"vt\" + i;\n\t\t\tif (exclude.indexOf(reg) == -1 && excludeAnother != reg)\n\t\t\t\treturn reg;\n\t\t\t++i;\n\t\t}\n\n\t\t// can't be reached\n\t\treturn null;\n\t}\n\n\t/**\n\t * Indicates whether the properties of the animation data contained within the set combined with\n\t * the vertex registers already in use on shading materials allows the animation data to utilise\n\t * GPU calls.\n\t */\n\tpublic get usesCPU():boolean\n\t{\n\t\treturn this._usesCPU;\n\t}\n\n\t/**\n\t * Called by the material to reset the GPU indicator before testing whether register space in the shader\n\t * is available for running GPU-based animation code.\n\t *\n\t * @private\n\t */\n\tpublic resetGPUCompatibility()\n\t{\n\t\tthis._usesCPU = false;\n\t}\n\n\tpublic cancelGPUCompatibility()\n\t{\n\t\tthis._usesCPU = true;\n\t}\n\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shader:ShaderBase, stage:Stage)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shader:ShaderBase, stage:Stage)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, shadedTarget:string):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shader:ShaderBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AnimationSetBase.assetType;\n\t}\n\n\t/**\n\t * Returns a vector of animation state objects that make up the contents of the animation data set.\n\t */\n\tpublic get animations():Array<AnimationNodeBase>\n\t{\n\t\treturn this._animations;\n\t}\n\n\t/**\n\t * Returns a vector of animation state objects that make up the contents of the animation data set.\n\t */\n\tpublic get animationNames():Array<string>\n\t{\n\t\treturn this._animationNames;\n\t}\n\n\t/**\n\t * Check to determine whether a state is registered in the animation set under the given name.\n\t *\n\t * @param stateName The name of the animation state object to be checked.\n\t */\n\tpublic hasAnimation(name:string):boolean\n\t{\n\t\treturn this._animationDictionary[name] != null;\n\t}\n\n\t/**\n\t * Retrieves the animation state object registered in the animation data set under the given name.\n\t *\n\t * @param stateName The name of the animation state object to be retrieved.\n\t */\n\tpublic getAnimation(name:string):AnimationNodeBase\n\t{\n\t\treturn this._animationDictionary[name];\n\t}\n\n\t/**\n\t * Adds an animation state object to the aniamtion data set under the given name.\n\t *\n\t * @param stateName The name under which the animation state object will be stored.\n\t * @param animationState The animation state object to be staored in the set.\n\t */\n\tpublic addAnimation(node:AnimationNodeBase)\n\t{\n\t\tif (this._animationDictionary[node.name])\n\t\t\tthrow new AnimationSetError(\"root node name '\" + node.name + \"' already exists in the set\");\n\n\t\tthis._animationDictionary[node.name] = node;\n\n\t\tthis._animations.push(node);\n\n\t\tthis._animationNames.push(node.name);\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t */\n\tpublic dispose()\n\t{\n\t}\n}\n\nexport = AnimationSetBase;",
    "import Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport RequestAnimationFrame\t\t= require(\"awayjs-core/lib/utils/RequestAnimationFrame\");\nimport getTimer\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/getTimer\");\n\nimport IAnimationSet\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\nimport IAnimator\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimator\");\nimport AnimationNodeBase\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Mesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IAnimationState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IAnimationState\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport TriangleSubMeshRenderable\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\nimport AnimatorEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimatorEvent\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\n/**\n * Dispatched when playback of an animation inside the animator object starts.\n *\n * @eventType away3d.events.AnimatorEvent\n */\n//[Event(name=\"start\", type=\"away3d.events.AnimatorEvent\")]\n\n/**\n * Dispatched when playback of an animation inside the animator object stops.\n *\n * @eventType away3d.events.AnimatorEvent\n */\n//[Event(name=\"stop\", type=\"away3d.events.AnimatorEvent\")]\n\n/**\n * Dispatched when playback of an animation reaches the end of an animation.\n *\n * @eventType away3d.events.AnimatorEvent\n */\n//[Event(name=\"cycle_complete\", type=\"away3d.events.AnimatorEvent\")]\n\n/**\n * Provides an abstract base class for animator classes that control animation output from a data set subtype of <code>AnimationSetBase</code>.\n *\n * @see away.animators.AnimationSetBase\n */\nclass AnimatorBase extends AssetBase implements IAnimator\n{\n\tpublic static assetType:string = \"[asset Animator]\";\n\n\tprivate _broadcaster:RequestAnimationFrame;\n\tprivate _isPlaying:boolean;\n\tprivate _autoUpdate:boolean = true;\n\tprivate _startEvent:AnimatorEvent;\n\tprivate _stopEvent:AnimatorEvent;\n\tprivate _cycleEvent:AnimatorEvent;\n\tprivate _time:number /*int*/ = 0;\n\tprivate _playbackSpeed:number = 1;\n\n\tpublic _pAnimationSet:IAnimationSet;\n\tpublic _pOwners:Array<Mesh> = new Array<Mesh>();\n\tpublic _pActiveNode:AnimationNodeBase;\n\tpublic _pActiveState:IAnimationState;\n\tpublic _pActiveAnimationName:string;\n\tpublic _pAbsoluteTime:number = 0;\n\n\tprivate _animationStates:Object = new Object();\n\n\t/**\n\t * Enables translation of the animated mesh from data returned per frame via the positionDelta property of the active animation node. Defaults to true.\n\t *\n\t * @see away.animators.IAnimationState#positionDelta\n\t */\n\tpublic updatePosition:boolean = true;\n\n\tpublic getAnimationState(node:AnimationNodeBase):IAnimationState\n\t{\n\t\tvar className:any = node.stateClass;\n\t\tvar uID:number = node.id;\n\n\t\tif (this._animationStates[uID] == null)\n\t\t\tthis._animationStates[uID] = new className(this, node);\n\n\t\treturn this._animationStates[uID];\n\t}\n\n\tpublic getAnimationStateByName(name:string):IAnimationState\n\t{\n\t\treturn this.getAnimationState(this._pAnimationSet.getAnimation(name));\n\t}\n\n\t/**\n\t * Returns the internal absolute time of the animator, calculated by the current time and the playback speed.\n\t *\n\t * @see #time\n\t * @see #playbackSpeed\n\t */\n\tpublic get absoluteTime():number\n\t{\n\t\treturn this._pAbsoluteTime;\n\t}\n\n\t/**\n\t * Returns the animation data set in use by the animator.\n\t */\n\tpublic get animationSet():IAnimationSet\n\t{\n\t\treturn this._pAnimationSet;\n\t}\n\n\t/**\n\t * Returns the current active animation state.\n\t */\n\tpublic get activeState():IAnimationState\n\t{\n\t\treturn this._pActiveState;\n\t}\n\n\t/**\n\t * Returns the current active animation node.\n\t */\n\tpublic get activeAnimation():AnimationNodeBase\n\t{\n\t\treturn this._pAnimationSet.getAnimation(this._pActiveAnimationName);\n\t}\n\n\t/**\n\t * Returns the current active animation node.\n\t */\n\tpublic get activeAnimationName():string\n\t{\n\t\treturn this._pActiveAnimationName;\n\t}\n\n\t/**\n\t * Determines whether the animators internal update mechanisms are active. Used in cases\n\t * where manual updates are required either via the <code>time</code> property or <code>update()</code> method.\n\t * Defaults to true.\n\t *\n\t * @see #time\n\t * @see #update()\n\t */\n\tpublic get autoUpdate():boolean\n\t{\n\t\treturn this._autoUpdate;\n\t}\n\n\tpublic set autoUpdate(value:boolean)\n\t{\n\t\tif (this._autoUpdate == value)\n\t\t\treturn;\n\n\t\tthis._autoUpdate = value;\n\n\t\tif (this._autoUpdate)\n\t\t\tthis.start(); else\n\t\t\tthis.stop();\n\t}\n\n\t/**\n\t * Gets and sets the internal time clock of the animator.\n\t */\n\tpublic get time():number /*int*/\n\t{\n\t\treturn this._time;\n\t}\n\n\tpublic set time(value:number /*int*/)\n\t{\n\t\tif (this._time == value)\n\t\t\treturn;\n\n\t\tthis.update(value);\n\t}\n\n\t/**\n\t * Sets the animation phase of the current active state's animation clip(s).\n\t *\n\t * @param value The phase value to use. 0 represents the beginning of an animation clip, 1 represents the end.\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._pActiveState.phase(value);\n\t}\n\n\t/**\n\t * Creates a new <code>AnimatorBase</code> object.\n\t *\n\t * @param animationSet The animation data set to be used by the animator object.\n\t */\n\tconstructor(animationSet:IAnimationSet)\n\t{\n\t\tsuper();\n\n\t\tthis._pAnimationSet = animationSet;\n\n\t\tthis._broadcaster = new RequestAnimationFrame(this.onEnterFrame, this);\n\t}\n\n\t/**\n\t * The amount by which passed time should be scaled. Used to slow down or speed up animations. Defaults to 1.\n\t */\n\tpublic get playbackSpeed():number\n\t{\n\t\treturn this._playbackSpeed;\n\t}\n\n\tpublic set playbackSpeed(value:number)\n\t{\n\t\tthis._playbackSpeed = value;\n\t}\n\n\tpublic setRenderState(shader:ShaderBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * Resumes the automatic playback clock controling the active state of the animator.\n\t */\n\tpublic start()\n\t{\n\t\tif (this._isPlaying || !this._autoUpdate)\n\t\t\treturn;\n\n\t\tthis._time = this._pAbsoluteTime = getTimer();\n\n\t\tthis._isPlaying = true;\n\n\t\tthis._broadcaster.start();\n\n\t\tif (!this.hasEventListener(AnimatorEvent.START))\n\t\t\treturn;\n\n\t\tif (this._startEvent == null)\n\t\t\tthis._startEvent = new AnimatorEvent(AnimatorEvent.START, this);\n\n\t\tthis.dispatchEvent(this._startEvent);\n\t}\n\n\t/**\n\t * Pauses the automatic playback clock of the animator, in case manual updates are required via the\n\t * <code>time</code> property or <code>update()</code> method.\n\t *\n\t * @see #time\n\t * @see #update()\n\t */\n\tpublic stop()\n\t{\n\t\tif (!this._isPlaying)\n\t\t\treturn;\n\n\t\tthis._isPlaying = false;\n\n\t\tthis._broadcaster.stop();\n\n\t\tif (!this.hasEventListener(AnimatorEvent.STOP))\n\t\t\treturn;\n\n\t\tif (this._stopEvent == null)\n\t\t\tthis._stopEvent = new AnimatorEvent(AnimatorEvent.STOP, this);\n\n\t\tthis.dispatchEvent(this._stopEvent);\n\t}\n\n\t/**\n\t * Provides a way to manually update the active state of the animator when automatic\n\t * updates are disabled.\n\t *\n\t * @see #stop()\n\t * @see #autoUpdate\n\t */\n\tpublic update(time:number /*int*/)\n\t{\n\t\tvar dt:number = (time - this._time)*this.playbackSpeed;\n\n\t\tthis._pUpdateDeltaTime(dt);\n\n\t\tthis._time = time;\n\t}\n\n\tpublic reset(name:string, offset:number = 0)\n\t{\n\t\tthis.getAnimationState(this._pAnimationSet.getAnimation(name)).offset(offset + this._pAbsoluteTime);\n\t}\n\n\t/**\n\t * Used by the mesh object to which the animator is applied, registers the owner for internal use.\n\t *\n\t * @private\n\t */\n\tpublic addOwner(mesh:Mesh)\n\t{\n\t\tthis._pOwners.push(mesh);\n\t}\n\n\t/**\n\t * Used by the mesh object from which the animator is removed, unregisters the owner for internal use.\n\t *\n\t * @private\n\t */\n\tpublic removeOwner(mesh:Mesh)\n\t{\n\t\tthis._pOwners.splice(this._pOwners.indexOf(mesh), 1);\n\t}\n\n\t/**\n\t * Internal abstract method called when the time delta property of the animator's contents requires updating.\n\t *\n\t * @private\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tthis._pAbsoluteTime += dt;\n\n\t\tthis._pActiveState.update(this._pAbsoluteTime);\n\n\t\tif (this.updatePosition)\n\t\t\tthis.applyPositionDelta();\n\t}\n\n\t/**\n\t * Enter frame event handler for automatically updating the active state of the animator.\n\t */\n\tprivate onEnterFrame(event:Event = null)\n\t{\n\t\tthis.update(getTimer());\n\t}\n\n\tprivate applyPositionDelta()\n\t{\n\t\tvar delta:Vector3D = this._pActiveState.positionDelta;\n\t\tvar dist:number = delta.length;\n\t\tvar len:number /*uint*/;\n\t\tif (dist > 0) {\n\t\t\tlen = this._pOwners.length;\n\t\t\tfor (var i:number /*uint*/ = 0; i < len; ++i)\n\t\t\t\tthis._pOwners[i].translateLocal(delta, dist);\n\t\t}\n\t}\n\n\t/**\n\t *  for internal use.\n\t *\n\t * @private\n\t */\n\tpublic dispatchCycleEvent()\n\t{\n\t\tif (this.hasEventListener(AnimatorEvent.CYCLE_COMPLETE)) {\n\t\t\tif (this._cycleEvent == null)\n\t\t\t\tthis._cycleEvent = new AnimatorEvent(AnimatorEvent.CYCLE_COMPLETE, this);\n\n\t\t\tthis.dispatchEvent(this._cycleEvent);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic testGPUCompatibility(shader:ShaderBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AnimatorBase.assetType;\n\t}\n\n\n\tpublic getRenderableSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry):TriangleSubGeometry\n\t{\n\t\t//nothing to do here\n\t\treturn sourceSubGeometry;\n\t}\n}\n\nexport = AnimatorBase;",
    "import SubGeometryBase\t\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport IAnimationSet\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\nimport ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleTimeNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode\");\nimport ParticleGeometry\t\t\t\t\t= require(\"awayjs-renderergl/lib/base/ParticleGeometry\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\n\n/**\n * The animation data set used by particle-based animators, containing particle animation data.\n *\n * @see away.animators.ParticleAnimator\n */\nclass ParticleAnimationSet extends AnimationSetBase implements IAnimationSet\n{\n\t/** @private */\n\tpublic _iAnimationRegisterCache:AnimationRegisterCache;\n\n\t//all other nodes dependent on it\n\tprivate _timeNode:ParticleTimeNode;\n\n\t/**\n\t * Property used by particle nodes that require compilers at the end of the shader\n\t */\n\tpublic static POST_PRIORITY:number /*int*/ = 9;\n\n\t/**\n\t * Property used by particle nodes that require color compilers\n\t */\n\tpublic static COLOR_PRIORITY:number /*int*/ = 18;\n\n\tprivate _animationSubGeometries:Object = new Object();\n\tprivate _particleNodes:Array<ParticleNodeBase> = new Array<ParticleNodeBase>();\n\tprivate _localDynamicNodes:Array<ParticleNodeBase> = new Array<ParticleNodeBase>();\n\tprivate _localStaticNodes:Array<ParticleNodeBase> = new Array<ParticleNodeBase>();\n\tprivate _totalLenOfOneVertex:number /*int*/ = 0;\n\n\t//set true if has an node which will change UV\n\tpublic hasUVNode:boolean;\n\t//set if the other nodes need to access the velocity\n\tpublic needVelocity:boolean;\n\t//set if has a billboard node.\n\tpublic hasBillboard:boolean;\n\t//set if has an node which will apply color multiple operation\n\tpublic hasColorMulNode:boolean;\n\t//set if has an node which will apply color add operation\n\tpublic hasColorAddNode:boolean;\n\n\t/**\n\t * Initialiser function for static particle properties. Needs to reference a with the following format\n\t *\n\t * <code>\n\t * initParticleFunc(prop:ParticleProperties)\n\t * {\n\t * \t\t//code for settings local properties\n\t * }\n\t * </code>\n\t *\n\t * Aside from setting any properties required in particle animation nodes using local static properties, the initParticleFunc function\n\t * is required to time node requirements as they may be needed. These properties on the ParticleProperties object can include\n\t * <code>startTime</code>, <code>duration</code> and <code>delay</code>. The use of these properties is determined by the setting\n\t * arguments passed in the constructor of the particle animation set. By default, only the <code>startTime</code> property is required.\n\t */\n\tpublic initParticleFunc:Function;\n\n\t/**\n\t * Initialiser function scope for static particle properties\n\t */\n\tpublic initParticleScope:Object;\n\n\t/**\n\t * Creates a new <code>ParticleAnimationSet</code>\n\t *\n\t * @param    [optional] usesDuration    Defines whether the animation set uses the <code>duration</code> data in its static properties to determine how long a particle is visible for. Defaults to false.\n\t * @param    [optional] usesLooping     Defines whether the animation set uses a looping timeframe for each particle determined by the <code>startTime</code>, <code>duration</code> and <code>delay</code> data in its static properties function. Defaults to false. Requires <code>usesDuration</code> to be true.\n\t * @param    [optional] usesDelay       Defines whether the animation set uses the <code>delay</code> data in its static properties to determine how long a particle is hidden for. Defaults to false. Requires <code>usesLooping</code> to be true.\n\t */\n\tconstructor(usesDuration:boolean = false, usesLooping:boolean = false, usesDelay:boolean = false)\n\t{\n\t\tsuper();\n\n\t\t//automatically add a particle time node to the set\n\t\tthis.addAnimation(this._timeNode = new ParticleTimeNode(usesDuration, usesLooping, usesDelay));\n\t}\n\n\t/**\n\t * Returns a vector of the particle animation nodes contained within the set.\n\t */\n\tpublic get particleNodes():Array<ParticleNodeBase>\n\t{\n\t\treturn this._particleNodes;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic addAnimation(node:AnimationNodeBase)\n\t{\n\t\tvar i:number /*int*/;\n\t\tvar n:ParticleNodeBase = <ParticleNodeBase> node;\n\t\tn._iProcessAnimationSetting(this);\n\t\tif (n.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tn._iDataOffset = this._totalLenOfOneVertex;\n\t\t\tthis._totalLenOfOneVertex += n.dataLength;\n\t\t\tthis._localStaticNodes.push(n);\n\t\t} else if (n.mode == ParticlePropertiesMode.LOCAL_DYNAMIC)\n\t\t\tthis._localDynamicNodes.push(n);\n\n\t\tfor (i = this._particleNodes.length - 1; i >= 0; i--) {\n\t\t\tif (this._particleNodes[i].priority <= n.priority)\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._particleNodes.splice(i + 1, 0, n);\n\n\t\tsuper.addAnimation(node);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tthis._iAnimationRegisterCache = pass.animationRegisterCache;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tvar context:IContextGL = <IContextGL> stage.context;\n//\t\t\tvar offset:number /*int*/ = this._iAnimationRegisterCache.vertexAttributesOffset;\n//\t\t\tvar used:number /*int*/ = this._iAnimationRegisterCache.numUsedStreams;\n//\t\t\tfor (var i:number /*int*/ = offset; i < used; i++)\n//\t\t\t\tcontext.setVertexBufferAt(i, null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase):string\n\t{\n\t\t//grab animationRegisterCache from the materialpassbase or create a new one if the first time\n\t\tthis._iAnimationRegisterCache = shader.animationRegisterCache;\n\n\t\tif (this._iAnimationRegisterCache == null)\n\t\t\tthis._iAnimationRegisterCache = shader.animationRegisterCache = new AnimationRegisterCache(shader.profile);\n\n\t\t//reset animationRegisterCache\n\t\tthis._iAnimationRegisterCache.vertexConstantOffset = shader.numUsedVertexConstants;\n\t\tthis._iAnimationRegisterCache.vertexAttributesOffset = shader.numUsedStreams;\n\t\tthis._iAnimationRegisterCache.varyingsOffset = shader.numUsedVaryings;\n\t\tthis._iAnimationRegisterCache.fragmentConstantOffset = shader.numUsedFragmentConstants;\n\t\tthis._iAnimationRegisterCache.hasUVNode = this.hasUVNode;\n\t\tthis._iAnimationRegisterCache.needVelocity = this.needVelocity;\n\t\tthis._iAnimationRegisterCache.hasBillboard = this.hasBillboard;\n\t\tthis._iAnimationRegisterCache.sourceRegisters = shader.animatableAttributes;\n\t\tthis._iAnimationRegisterCache.targetRegisters = shader.animationTargetRegisters;\n\t\tthis._iAnimationRegisterCache.needFragmentAnimation = shader.usesFragmentAnimation;\n\t\tthis._iAnimationRegisterCache.needUVAnimation = !shader.usesUVTransform;\n\t\tthis._iAnimationRegisterCache.hasColorAddNode = this.hasColorAddNode;\n\t\tthis._iAnimationRegisterCache.hasColorMulNode = this.hasColorMulNode;\n\t\tthis._iAnimationRegisterCache.reset();\n\n\t\tvar code:string = \"\";\n\n\t\tcode += this._iAnimationRegisterCache.getInitCode();\n\n\t\tvar node:ParticleNodeBase;\n\t\tvar i:number /*int*/;\n\n\t\tfor (i = 0; i < this._particleNodes.length; i++) {\n\t\t\tnode = this._particleNodes[i];\n\t\t\tif (node.priority < ParticleAnimationSet.POST_PRIORITY)\n\t\t\t\tcode += node.getAGALVertexCode(shader, this._iAnimationRegisterCache);\n\t\t}\n\n\t\tcode += this._iAnimationRegisterCache.getCombinationCode();\n\n\t\tfor (i = 0; i < this._particleNodes.length; i++) {\n\t\t\tnode = this._particleNodes[i];\n\t\t\tif (node.priority >= ParticleAnimationSet.POST_PRIORITY && node.priority < ParticleAnimationSet.COLOR_PRIORITY)\n\t\t\t\tcode += node.getAGALVertexCode(shader, this._iAnimationRegisterCache);\n\t\t}\n\n\t\tcode += this._iAnimationRegisterCache.initColorRegisters();\n\n\t\tfor (i = 0; i < this._particleNodes.length; i++) {\n\t\t\tnode = this._particleNodes[i];\n\t\t\tif (node.priority >= ParticleAnimationSet.COLOR_PRIORITY)\n\t\t\t\tcode += node.getAGALVertexCode(shader, this._iAnimationRegisterCache);\n\t\t}\n\t\tcode += this._iAnimationRegisterCache.getColorPassCode();\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.hasUVNode) {\n\t\t\tthis._iAnimationRegisterCache.setUVSourceAndTarget(shader.uvSource, shader.uvTarget);\n\t\t\tcode += \"mov \" + this._iAnimationRegisterCache.uvTarget + \".xy,\" + this._iAnimationRegisterCache.uvAttribute.toString() + \"\\n\";\n\t\t\tvar node:ParticleNodeBase;\n\t\t\tfor (var i:number /*uint*/ = 0; i < this._particleNodes.length; i++)\n\t\t\t\tnode = this._particleNodes[i];\n\t\t\t\tcode += node.getAGALUVCode(shader, this._iAnimationRegisterCache);\n\t\t\tcode += \"mov \" + this._iAnimationRegisterCache.uvVar.toString() + \",\" + this._iAnimationRegisterCache.uvTarget + \".xy\\n\";\n\t\t} else\n\t\t\tcode += \"mov \" + shader.uvTarget + \",\" + shader.uvSource + \"\\n\";\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, shadedTarget:string):string\n\t{\n\t\treturn this._iAnimationRegisterCache.getColorCombinationCode(shadedTarget);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shader:ShaderBase)\n\t{\n\t\tthis._iAnimationRegisterCache.setDataLength();\n\n\t\t//set vertexZeroConst,vertexOneConst,vertexTwoConst\n\t\tthis._iAnimationRegisterCache.setVertexConst(this._iAnimationRegisterCache.vertexZeroConst.index, 0, 1, 2, 0);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get usesCPU():boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic cancelGPUCompatibility()\n\t{\n\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var key in this._animationSubGeometries)\n\t\t\t(<AnimationSubGeometry> this._animationSubGeometries[key]).dispose();\n\n\t\tsuper.dispose();\n\t}\n\n\tpublic getAnimationSubGeometry(subMesh:ISubMesh)\n\t{\n\t\tvar mesh:Mesh = subMesh.parentMesh;\n\t\tvar animationSubGeometry:AnimationSubGeometry = (mesh.shareAnimationGeometry)? this._animationSubGeometries[subMesh.subGeometry.id] : this._animationSubGeometries[subMesh.id];\n\n\t\tif (animationSubGeometry)\n\t\t\treturn animationSubGeometry;\n\n\t\tthis._iGenerateAnimationSubGeometries(mesh);\n\n\t\treturn (mesh.shareAnimationGeometry)? this._animationSubGeometries[subMesh.subGeometry.id] : this._animationSubGeometries[subMesh.id];\n\t}\n\n\n\t/** @private */\n\tpublic _iGenerateAnimationSubGeometries(mesh:Mesh)\n\t{\n\t\tif (this.initParticleFunc == null)\n\t\t\tthrow(new Error(\"no initParticleFunc set\"));\n\n\t\tvar geometry:ParticleGeometry = <ParticleGeometry> mesh.geometry;\n\n\t\tif (!geometry)\n\t\t\tthrow(new Error(\"Particle animation can only be performed on a ParticleGeometry object\"));\n\n\t\tvar i:number /*int*/, j:number /*int*/, k:number /*int*/;\n\t\tvar animationSubGeometry:AnimationSubGeometry;\n\t\tvar newAnimationSubGeometry:boolean = false;\n\t\tvar subGeometry:SubGeometryBase;\n\t\tvar subMesh:ISubMesh;\n\t\tvar localNode:ParticleNodeBase;\n\n\t\tfor (i = 0; i < mesh.subMeshes.length; i++) {\n\t\t\tsubMesh = mesh.subMeshes[i];\n\t\t\tsubGeometry = subMesh.subGeometry;\n\t\t\tif (mesh.shareAnimationGeometry) {\n\t\t\t\tanimationSubGeometry = this._animationSubGeometries[subGeometry.id];\n\n\t\t\t\tif (animationSubGeometry)\n\t\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tanimationSubGeometry = new AnimationSubGeometry();\n\n\t\t\tif (mesh.shareAnimationGeometry)\n\t\t\t\tthis._animationSubGeometries[subGeometry.id] = animationSubGeometry;\n\t\t\telse\n\t\t\t\tthis._animationSubGeometries[subMesh.id] = animationSubGeometry;\n\n\t\t\tnewAnimationSubGeometry = true;\n\n\t\t\t//create the vertexData vector that will be used for local node data\n\t\t\tanimationSubGeometry.createVertexData(subGeometry.numVertices, this._totalLenOfOneVertex);\n\t\t}\n\n\t\tif (!newAnimationSubGeometry)\n\t\t\treturn;\n\n\t\tvar particles:Array<ParticleData> = geometry.particles;\n\t\tvar particlesLength:number /*uint*/ = particles.length;\n\t\tvar numParticles:number /*uint*/ = geometry.numParticles;\n\t\tvar particleProperties:ParticleProperties = new ParticleProperties();\n\t\tvar particle:ParticleData;\n\n\t\tvar oneDataLen:number /*int*/;\n\t\tvar oneDataOffset:number /*int*/;\n\t\tvar counterForVertex:number /*int*/;\n\t\tvar counterForOneData:number /*int*/;\n\t\tvar oneData:Array<number>;\n\t\tvar numVertices:number /*uint*/;\n\t\tvar vertexData:Array<number>;\n\t\tvar vertexLength:number /*uint*/;\n\t\tvar startingOffset:number /*uint*/;\n\t\tvar vertexOffset:number /*uint*/;\n\n\t\t//default values for particle param\n\t\tparticleProperties.total = numParticles;\n\t\tparticleProperties.startTime = 0;\n\t\tparticleProperties.duration = 1000;\n\t\tparticleProperties.delay = 0.1;\n\n\t\ti = 0;\n\t\tj = 0;\n\t\twhile (i < numParticles) {\n\t\t\tparticleProperties.index = i;\n\n\t\t\t//call the init on the particle parameters\n\t\t\tthis.initParticleFunc.call(this.initParticleScope, particleProperties);\n\n\t\t\t//create the next set of node properties for the particle\n\t\t\tfor (k = 0; k < this._localStaticNodes.length; k++)\n\t\t\t\tthis._localStaticNodes[k]._iGeneratePropertyOfOneParticle(particleProperties);\n\n\t\t\t//loop through all particle data for the curent particle\n\t\t\twhile (j < particlesLength && (particle = particles[j]).particleIndex == i) {\n\t\t\t\t//find the target animationSubGeometry\n\t\t\t\tfor (k = 0; k < mesh.subMeshes.length; k++) {\n\t\t\t\t\tsubMesh = mesh.subMeshes[k];\n\t\t\t\t\tif (subMesh.subGeometry == particle.subGeometry) {\n\t\t\t\t\t\tanimationSubGeometry = (mesh.shareAnimationGeometry)? this._animationSubGeometries[subMesh.subGeometry.id] : this._animationSubGeometries[subMesh.id];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnumVertices = particle.numVertices;\n\t\t\t\tvertexData = animationSubGeometry.vertexData;\n\t\t\t\tvertexLength = numVertices*this._totalLenOfOneVertex;\n\t\t\t\tstartingOffset = animationSubGeometry.numProcessedVertices*this._totalLenOfOneVertex;\n\n\t\t\t\t//loop through each static local node in the animation set\n\t\t\t\tfor (k = 0; k < this._localStaticNodes.length; k++) {\n\t\t\t\t\tlocalNode = this._localStaticNodes[k];\n\t\t\t\t\toneData = localNode.oneData;\n\t\t\t\t\toneDataLen = localNode.dataLength;\n\t\t\t\t\toneDataOffset = startingOffset + localNode._iDataOffset;\n\n\t\t\t\t\t//loop through each vertex set in the vertex data\n\t\t\t\t\tfor (counterForVertex = 0; counterForVertex < vertexLength; counterForVertex += this._totalLenOfOneVertex) {\n\t\t\t\t\t\tvertexOffset = oneDataOffset + counterForVertex;\n\n\t\t\t\t\t\t//add the data for the local node to the vertex data\n\t\t\t\t\t\tfor (counterForOneData = 0; counterForOneData < oneDataLen; counterForOneData++)\n\t\t\t\t\t\t\tvertexData[vertexOffset + counterForOneData] = oneData[counterForOneData];\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t//store particle properties if they need to be retreived for dynamic local nodes\n\t\t\t\tif (this._localDynamicNodes.length)\n\t\t\t\t\tanimationSubGeometry.animationParticles.push(new ParticleAnimationData(i, particleProperties.startTime, particleProperties.duration, particleProperties.delay, particle));\n\n\t\t\t\tanimationSubGeometry.numProcessedVertices += numVertices;\n\n\t\t\t\t//next index\n\t\t\t\tj++;\n\t\t\t}\n\n\t\t\t//next particle\n\t\t\ti++;\n\t\t}\n\t}\n}\n\nexport = ParticleAnimationSet;",
    "import ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport SubGeometryBase\t\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\n\n/**\n * Provides an interface for assigning paricle-based animation data sets to mesh-based entity objects\n * and controlling the various available states of animation through an interative playhead that can be\n * automatically updated or manually triggered.\n *\n * Requires that the containing geometry of the parent mesh is particle geometry\n *\n * @see away.base.ParticleGeometry\n */\nclass ParticleAnimator extends AnimatorBase\n{\n\n\tprivate _particleAnimationSet:ParticleAnimationSet;\n\tprivate _animationParticleStates:Array<ParticleStateBase> = new Array<ParticleStateBase>();\n\tprivate _animatorParticleStates:Array<ParticleStateBase> = new Array<ParticleStateBase>();\n\tprivate _timeParticleStates:Array<ParticleStateBase> = new Array<ParticleStateBase>();\n\tprivate _totalLenOfOneVertex:number /*uint*/ = 0;\n\tprivate _animatorSubGeometries:Object = new Object();\n\n\t/**\n\t * Creates a new <code>ParticleAnimator</code> object.\n\t *\n\t * @param particleAnimationSet The animation data set containing the particle animations used by the animator.\n\t */\n\tconstructor(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tsuper(particleAnimationSet);\n\t\tthis._particleAnimationSet = particleAnimationSet;\n\n\t\tvar state:ParticleStateBase;\n\t\tvar node:ParticleNodeBase;\n\n\t\tfor (var i:number = 0; i < this._particleAnimationSet.particleNodes.length; i++) {\n\t\t\tnode = this._particleAnimationSet.particleNodes[i];\n\t\t\tstate = <ParticleStateBase> this.getAnimationState(node);\n\t\t\tif (node.mode == ParticlePropertiesMode.LOCAL_DYNAMIC) {\n\t\t\t\tthis._animatorParticleStates.push(state);\n\t\t\t\tnode._iDataOffset = this._totalLenOfOneVertex;\n\t\t\t\tthis._totalLenOfOneVertex += node.dataLength;\n\t\t\t} else {\n\t\t\t\tthis._animationParticleStates.push(state);\n\t\t\t}\n\t\t\tif (state.needUpdateTime)\n\t\t\t\tthis._timeParticleStates.push(state);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\treturn new ParticleAnimator(this._particleAnimationSet);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(shader:ShaderBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\tvar animationRegisterCache:AnimationRegisterCache = this._particleAnimationSet._iAnimationRegisterCache;\n\n\t\tvar subMesh:ISubMesh = (<TriangleSubMeshRenderable> renderable).subMesh;\n\t\tvar state:ParticleStateBase;\n\t\tvar i:number;\n\n\t\tif (!subMesh)\n\t\t\tthrow(new Error(\"Must be subMesh\"));\n\n\t\t//process animation sub geometries\n\t\tvar animationSubGeometry:AnimationSubGeometry = this._particleAnimationSet.getAnimationSubGeometry(subMesh);\n\n\t\tfor (i = 0; i < this._animationParticleStates.length; i++)\n\t\t\tthis._animationParticleStates[i].setRenderState(stage, renderable, animationSubGeometry, animationRegisterCache, camera);\n\n\t\t//process animator subgeometries\n\t\tvar animatorSubGeometry:AnimationSubGeometry = this.getAnimatorSubGeometry(subMesh);\n\n\t\tfor (i = 0; i < this._animatorParticleStates.length; i++)\n\t\t\tthis._animatorParticleStates[i].setRenderState(stage, renderable, animatorSubGeometry, animationRegisterCache, camera);\n\n\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, animationRegisterCache.vertexConstantOffset, animationRegisterCache.vertexConstantData, animationRegisterCache.numVertexConstant);\n\n\t\tif (animationRegisterCache.numFragmentConstant > 0)\n\t\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, animationRegisterCache.fragmentConstantOffset, animationRegisterCache.fragmentConstantData, animationRegisterCache.numFragmentConstant);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic testGPUCompatibility(shader:ShaderBase)\n\t{\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic start()\n\t{\n\t\tsuper.start();\n\n\t\tfor (var i:number = 0; i < this._timeParticleStates.length; i++)\n\t\t\tthis._timeParticleStates[i].offset(this._pAbsoluteTime);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tthis._pAbsoluteTime += dt;\n\n\t\tfor (var i:number = 0; i < this._timeParticleStates.length; i++)\n\t\t\tthis._timeParticleStates[i].update(this._pAbsoluteTime);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic resetTime(offset:number /*int*/ = 0)\n\t{\n\t\tfor (var i:number = 0; i < this._timeParticleStates.length; i++)\n\t\t\tthis._timeParticleStates[i].offset(this._pAbsoluteTime + offset);\n\t\tthis.update(this.time);\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var key in this._animatorSubGeometries)\n\t\t\t(<AnimationSubGeometry> this._animatorSubGeometries[key]).dispose();\n\t}\n\n\tprivate getAnimatorSubGeometry(subMesh:ISubMesh):AnimationSubGeometry\n\t{\n\t\tif (!this._animatorParticleStates.length)\n\t\t\treturn;\n\n\t\tvar subGeometry:SubGeometryBase = subMesh.subGeometry;\n\t\tvar animatorSubGeometry:AnimationSubGeometry = this._animatorSubGeometries[subGeometry.id] = new AnimationSubGeometry();\n\n\t\t//create the vertexData vector that will be used for local state data\n\t\tanimatorSubGeometry.createVertexData(subGeometry.numVertices, this._totalLenOfOneVertex);\n\n\t\t//pass the particles data to the animator subGeometry\n\t\tanimatorSubGeometry.animationParticles = this._particleAnimationSet.getAnimationSubGeometry(subMesh).animationParticles;\n\t}\n}\n\nexport = ParticleAnimator;",
    "import IAnimationSet\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\n/**\n * The animation data set used by skeleton-based animators, containing skeleton animation data.\n *\n * @see away.animators.SkeletonAnimator\n */\nclass SkeletonAnimationSet extends AnimationSetBase implements IAnimationSet\n{\n\tprivate _jointsPerVertex:number /*uint*/;\n\n\t/**\n\t * Returns the amount of skeleton joints that can be linked to a single vertex via skinned weight values. For GPU-base animation, the\n\t * maximum allowed value is 4.\n\t */\n\tpublic get jointsPerVertex():number /*uint*/\n\t{\n\t\treturn this._jointsPerVertex;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonAnimationSet</code> object.\n\t *\n\t * @param jointsPerVertex Sets the amount of skeleton joints that can be linked to a single vertex via skinned weight values. For GPU-base animation, the maximum allowed value is 4. Defaults to 4.\n\t */\n\tconstructor(jointsPerVertex:number /*uint*/ = 4)\n\t{\n\t\tsuper();\n\n\t\tthis._jointsPerVertex = jointsPerVertex;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase):string\n\t{\n\t\tvar len:number /*uint*/ = shader.animatableAttributes.length;\n\n\t\tvar indexOffset0:number /*uint*/ = shader.numUsedVertexConstants;\n\t\tvar indexOffset1:number /*uint*/ = indexOffset0 + 1;\n\t\tvar indexOffset2:number /*uint*/ = indexOffset0 + 2;\n\t\tvar indexStream:string = \"va\" + shader.numUsedStreams;\n\t\tvar weightStream:string = \"va\" + (shader.numUsedStreams + 1);\n\t\tvar indices:Array<string> = [ indexStream + \".x\", indexStream + \".y\", indexStream + \".z\", indexStream + \".w\" ];\n\t\tvar weights:Array<string> = [ weightStream + \".x\", weightStream + \".y\", weightStream + \".z\", weightStream + \".w\" ];\n\t\tvar temp1:string = this._pFindTempReg(shader.animationTargetRegisters);\n\t\tvar temp2:string = this._pFindTempReg(shader.animationTargetRegisters, temp1);\n\t\tvar dot:string = \"dp4\";\n\t\tvar code:string = \"\";\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\n\t\t\tvar src:string = shader.animatableAttributes[i];\n\n\t\t\tfor (var j:number /*uint*/ = 0; j < this._jointsPerVertex; ++j) {\n\t\t\t\tcode += dot + \" \" + temp1 + \".x, \" + src + \", vc[\" + indices[j] + \"+\" + indexOffset0 + \"]\\n\" +\n\t\t\t\t\tdot + \" \" + temp1 + \".y, \" + src + \", vc[\" + indices[j] + \"+\" + indexOffset1 + \"]\\n\" +\n\t\t\t\t\tdot + \" \" + temp1 + \".z, \" + src + \", vc[\" + indices[j] + \"+\" + indexOffset2 + \"]\\n\" +\n\t\t\t\t\t\"mov \" + temp1 + \".w, \" + src + \".w\\n\" +\n\t\t\t\t\t\"mul \" + temp1 + \", \" + temp1 + \", \" + weights[j] + \"\\n\"; // apply weight\n\n\t\t\t\t// add or mov to target. Need to write to a temp reg first, because an output can be a target\n\t\t\t\tif (j == 0)\n\t\t\t\t\tcode += \"mov \" + temp2 + \", \" + temp1 + \"\\n\"; else\n\t\t\t\t\tcode += \"add \" + temp2 + \", \" + temp2 + \", \" + temp1 + \"\\n\";\n\t\t\t}\n\t\t\t// switch to dp3 once positions have been transformed, from now on, it should only be vectors instead of points\n\t\t\tdot = \"dp3\";\n\t\t\tcode += \"mov \" + shader.animationTargetRegisters[i] + \", \" + temp2 + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shader:ShaderBase, stage:Stage)\n\t{\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tvar streamOffset:number /*uint*/ = pass.numUsedStreams;\n//\t\t\tvar context:IContextGL = <IContextGL> stage.context;\n//\t\t\tcontext.setVertexBufferAt(streamOffset, null);\n//\t\t\tcontext.setVertexBufferAt(streamOffset + 1, null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, shadedTarget:string):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase):string\n\t{\n\t\treturn \"mov \" + shader.uvTarget + \",\" + shader.uvSource + \"\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shader:ShaderBase)\n\t{\n\n\t}\n}\n\nexport = SkeletonAnimationSet;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport ISubMesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport TriangleSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport SubGeometryEvent\t\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\n\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport SkeletonAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimationSet\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonJoint\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonJoint\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\nimport IAnimationTransition\t\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/IAnimationTransition\");\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\n\n/**\n * Provides an interface for assigning skeleton-based animation data sets to mesh-based entity objects\n * and controlling the various available states of animation through an interative playhead that can be\n * automatically updated or manually triggered.\n */\nclass SkeletonAnimator extends AnimatorBase\n{\n\tprivate _globalMatrices:Array<number>;\n\tprivate _globalPose:SkeletonPose = new SkeletonPose();\n\tprivate _globalPropertiesDirty:boolean;\n\tprivate _numJoints:number /*uint*/;\n\tprivate _morphedSubGeometry:Object = new Object();\n\tprivate _morphedSubGeometryDirty:Object = new Object();\n\tprivate _condensedMatrices:Array<number>;\n\n\tprivate _skeleton:Skeleton;\n\tprivate _forceCPU:boolean;\n\tprivate _useCondensedIndices:boolean;\n\tprivate _jointsPerVertex:number /*uint*/;\n\tprivate _activeSkeletonState:ISkeletonAnimationState;\n\tprivate _onTransitionCompleteDelegate:(event:AnimationStateEvent) => void;\n\n\tprivate _onIndicesUpdateDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onVerticesUpdateDelegate:(event:SubGeometryEvent) => void;\n\n\t/**\n\t * returns the calculated global matrices of the current skeleton pose.\n\t *\n\t * @see #globalPose\n\t */\n\tpublic get globalMatrices():Array<number>\n\t{\n\t\tif (this._globalPropertiesDirty)\n\t\t\tthis.updateGlobalProperties();\n\n\t\treturn this._globalMatrices;\n\t}\n\n\t/**\n\t * returns the current skeleton pose output from the animator.\n\t *\n\t * @see away.animators.data.SkeletonPose\n\t */\n\tpublic get globalPose():SkeletonPose\n\t{\n\t\tif (this._globalPropertiesDirty)\n\t\t\tthis.updateGlobalProperties();\n\n\t\treturn this._globalPose;\n\t}\n\n\t/**\n\t * Returns the skeleton object in use by the animator - this defines the number and heirarchy of joints used by the\n\t * skinned geoemtry to which skeleon animator is applied.\n\t */\n\tpublic get skeleton():Skeleton\n\t{\n\t\treturn this._skeleton;\n\t}\n\n\t/**\n\t * Indicates whether the skeleton animator is disabled by default for GPU rendering, something that allows the animator to perform calculation on the GPU.\n\t * Defaults to false.\n\t */\n\tpublic get forceCPU():boolean\n\t{\n\t\treturn this._forceCPU;\n\t}\n\n\t/**\n\t * Offers the option of enabling GPU accelerated animation on skeletons larger than 32 joints\n\t * by condensing the number of joint index values required per mesh. Only applicable to\n\t * skeleton animations that utilise more than one mesh object. Defaults to false.\n\t */\n\tpublic get useCondensedIndices():boolean\n\t{\n\t\treturn this._useCondensedIndices;\n\t}\n\n\tpublic set useCondensedIndices(value:boolean)\n\t{\n\t\tthis._useCondensedIndices = value;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonAnimator</code> object.\n\t *\n\t * @param skeletonAnimationSet The animation data set containing the skeleton animations used by the animator.\n\t * @param skeleton The skeleton object used for calculating the resulting global matrices for transforming skinned mesh data.\n\t * @param forceCPU Optional value that only allows the animator to perform calculation on the CPU. Defaults to false.\n\t */\n\tconstructor(animationSet:SkeletonAnimationSet, skeleton:Skeleton, forceCPU:boolean = false)\n\t{\n\t\tsuper(animationSet);\n\n\t\tthis._skeleton = skeleton;\n\t\tthis._forceCPU = forceCPU;\n\t\tthis._jointsPerVertex = animationSet.jointsPerVertex;\n\n\t\tthis._numJoints = this._skeleton.numJoints;\n\t\tthis._globalMatrices = new Array<number>(this._numJoints*12);\n\n\t\tvar j:number /*int*/ = 0;\n\t\tfor (var i:number /*uint*/ = 0; i < this._numJoints; ++i) {\n\t\t\tthis._globalMatrices[j++] = 1;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 1;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t\tthis._globalMatrices[j++] = 1;\n\t\t\tthis._globalMatrices[j++] = 0;\n\t\t}\n\n\t\tthis._onTransitionCompleteDelegate = (event:AnimationStateEvent) => this.onTransitionComplete(event);\n\t\tthis._onIndicesUpdateDelegate = (event:SubGeometryEvent) => this.onIndicesUpdate(event);\n\t\tthis._onVerticesUpdateDelegate = (event:SubGeometryEvent) => this.onVerticesUpdate(event);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\t/* The cast to SkeletonAnimationSet should never fail, as _animationSet can only be set\n\t\t through the constructor, which will only accept a SkeletonAnimationSet. */\n\t\treturn new SkeletonAnimator(<SkeletonAnimationSet> this._pAnimationSet, this._skeleton, this._forceCPU);\n\t}\n\n\t/**\n\t * Plays an animation state registered with the given name in the animation data set.\n\t *\n\t * @param name The data set name of the animation state to be played.\n\t * @param transition An optional transition object that determines how the animator will transition from the currently active animation state.\n\t * @param offset An option offset time (in milliseconds) that resets the state's internal clock to the absolute time of the animator plus the offset value. Required for non-looping animation states.\n\t */\n\tpublic play(name:string, transition:IAnimationTransition = null, offset:number = NaN)\n\t{\n\t\tif (this._pActiveAnimationName == name)\n\t\t\treturn;\n\n\t\tthis._pActiveAnimationName = name;\n\n\t\tif (!this._pAnimationSet.hasAnimation(name))\n\t\t\tthrow new Error(\"Animation root node \" + name + \" not found!\");\n\n\t\tif (transition && this._pActiveNode) {\n\t\t\t//setup the transition\n\t\t\tthis._pActiveNode = transition.getAnimationNode(this, this._pActiveNode, this._pAnimationSet.getAnimation(name), this._pAbsoluteTime);\n\t\t\tthis._pActiveNode.addEventListener(AnimationStateEvent.TRANSITION_COMPLETE, this._onTransitionCompleteDelegate);\n\t\t} else\n\t\t\tthis._pActiveNode = this._pAnimationSet.getAnimation(name);\n\n\t\tthis._pActiveState = this.getAnimationState(this._pActiveNode);\n\n\t\tif (this.updatePosition) {\n\t\t\t//update straight away to reset position deltas\n\t\t\tthis._pActiveState.update(this._pAbsoluteTime);\n\t\t\tthis._pActiveState.positionDelta;\n\t\t}\n\n\t\tthis._activeSkeletonState = <ISkeletonAnimationState> this._pActiveState;\n\n\t\tthis.start();\n\n\t\t//apply a time offset if specified\n\t\tif (!isNaN(offset))\n\t\t\tthis.reset(name, offset);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(shader:ShaderBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\t// do on request of globalProperties\n\t\tif (this._globalPropertiesDirty)\n\t\t\tthis.updateGlobalProperties();\n\n\t\tvar subGeometry:TriangleSubGeometry = <TriangleSubGeometry> (<TriangleSubMesh> (<TriangleSubMeshRenderable> renderable).subMesh).subGeometry;\n\n\t\tsubGeometry.useCondensedIndices = this._useCondensedIndices;\n\n\t\tif (this._useCondensedIndices) {\n\t\t\t// using a condensed data set\n\t\t\tthis.updateCondensedMatrices(subGeometry.condensedIndexLookUp);\n\t\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._condensedMatrices, this._condensedMatrices.length/4);\n\t\t} else {\n\t\t\tif (this._pAnimationSet.usesCPU) {\n\t\t\t\tif (this._morphedSubGeometryDirty[subGeometry.id])\n\t\t\t\t\tthis.morphSubGeometry(<TriangleSubMeshRenderable> renderable, subGeometry);\n\n\t\t\t\treturn\n\t\t\t}\n\t\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._globalMatrices, this._numJoints*3);\n\t\t}\n\n\t\tshader.jointIndexIndex = vertexStreamOffset++;\n\t\tshader.jointWeightIndex = vertexStreamOffset++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic testGPUCompatibility(shader:ShaderBase)\n\t{\n\t\tif (!this._useCondensedIndices && (this._forceCPU || this._jointsPerVertex > 4 || shader.numUsedVertexConstants + this._numJoints*3 > 128))\n\t\t\tthis._pAnimationSet.cancelGPUCompatibility();\n\t}\n\n\t/**\n\t * Applies the calculated time delta to the active animation state node or state transition object.\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tsuper._pUpdateDeltaTime(dt);\n\n\t\t//invalidate pose matrices\n\t\tthis._globalPropertiesDirty = true;\n\n\t\t//trigger geometry invalidation if using CPU animation\n\t\tif (this._pAnimationSet.usesCPU)\n\t\t\tfor (var key in this._morphedSubGeometryDirty)\n\t\t\t\tthis._morphedSubGeometryDirty[key] = true;\n\t}\n\n\tprivate updateCondensedMatrices(condensedIndexLookUp:Array<number>)\n\t{\n\t\tvar j:number = 0, k:number = 0;\n\t\tvar srcIndex:number /*uint*/;\n\n\t\tthis._condensedMatrices = new Array<number>();\n\n\t\tvar len:number = condensedIndexLookUp.length;\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tsrcIndex = condensedIndexLookUp[i]*12; //12 required for the three 4-component vectors that store the matrix\n\t\t\tk = 12;\n\t\t\t// copy into condensed\n\t\t\twhile (k--)\n\t\t\t\tthis._condensedMatrices[j++] = this._globalMatrices[srcIndex++];\n\t\t}\n\t}\n\n\tprivate updateGlobalProperties()\n\t{\n\t\tthis._globalPropertiesDirty = false;\n\n\t\t//get global pose\n\t\tthis.localToGlobalPose(this._activeSkeletonState.getSkeletonPose(this._skeleton), this._globalPose, this._skeleton);\n\n\t\t// convert pose to matrix\n\t\tvar mtxOffset:number /*uint*/ = 0;\n\t\tvar globalPoses:Array<JointPose> = this._globalPose.jointPoses;\n\t\tvar raw:Array<number>;\n\t\tvar ox:number, oy:number, oz:number, ow:number;\n\t\tvar xy2:number, xz2:number, xw2:number;\n\t\tvar yz2:number, yw2:number, zw2:number;\n\t\tvar n11:number, n12:number, n13:number;\n\t\tvar n21:number, n22:number, n23:number;\n\t\tvar n31:number, n32:number, n33:number;\n\t\tvar m11:number, m12:number, m13:number, m14:number;\n\t\tvar m21:number, m22:number, m23:number, m24:number;\n\t\tvar m31:number, m32:number, m33:number, m34:number;\n\t\tvar joints:Array<SkeletonJoint> = this._skeleton.joints;\n\t\tvar pose:JointPose;\n\t\tvar quat:Quaternion;\n\t\tvar vec:Vector3D;\n\t\tvar t:number;\n\n\t\tfor (var i:number /*uint*/ = 0; i < this._numJoints; ++i) {\n\t\t\tpose = globalPoses[i];\n\t\t\tquat = pose.orientation;\n\t\t\tvec = pose.translation;\n\t\t\tox = quat.x;\n\t\t\toy = quat.y;\n\t\t\toz = quat.z;\n\t\t\tow = quat.w;\n\n\t\t\txy2 = (t = 2.0*ox)*oy;\n\t\t\txz2 = t*oz;\n\t\t\txw2 = t*ow;\n\t\t\tyz2 = (t = 2.0*oy)*oz;\n\t\t\tyw2 = t*ow;\n\t\t\tzw2 = 2.0*oz*ow;\n\n\t\t\tyz2 = 2.0*oy*oz;\n\t\t\tyw2 = 2.0*oy*ow;\n\t\t\tzw2 = 2.0*oz*ow;\n\t\t\tox *= ox;\n\t\t\toy *= oy;\n\t\t\toz *= oz;\n\t\t\tow *= ow;\n\n\t\t\tn11 = (t = ox - oy) - oz + ow;\n\t\t\tn12 = xy2 - zw2;\n\t\t\tn13 = xz2 + yw2;\n\t\t\tn21 = xy2 + zw2;\n\t\t\tn22 = -t - oz + ow;\n\t\t\tn23 = yz2 - xw2;\n\t\t\tn31 = xz2 - yw2;\n\t\t\tn32 = yz2 + xw2;\n\t\t\tn33 = -ox - oy + oz + ow;\n\n\t\t\t// prepend inverse bind pose\n\t\t\traw = joints[i].inverseBindPose;\n\t\t\tm11 = raw[0];\n\t\t\tm12 = raw[4];\n\t\t\tm13 = raw[8];\n\t\t\tm14 = raw[12];\n\t\t\tm21 = raw[1];\n\t\t\tm22 = raw[5];\n\t\t\tm23 = raw[9];\n\t\t\tm24 = raw[13];\n\t\t\tm31 = raw[2];\n\t\t\tm32 = raw[6];\n\t\t\tm33 = raw[10];\n\t\t\tm34 = raw[14];\n\n\t\t\tthis._globalMatrices[mtxOffset] = n11*m11 + n12*m21 + n13*m31;\n\t\t\tthis._globalMatrices[mtxOffset + 1] = n11*m12 + n12*m22 + n13*m32;\n\t\t\tthis._globalMatrices[mtxOffset + 2] = n11*m13 + n12*m23 + n13*m33;\n\t\t\tthis._globalMatrices[mtxOffset + 3] = n11*m14 + n12*m24 + n13*m34 + vec.x;\n\t\t\tthis._globalMatrices[mtxOffset + 4] = n21*m11 + n22*m21 + n23*m31;\n\t\t\tthis._globalMatrices[mtxOffset + 5] = n21*m12 + n22*m22 + n23*m32;\n\t\t\tthis._globalMatrices[mtxOffset + 6] = n21*m13 + n22*m23 + n23*m33;\n\t\t\tthis._globalMatrices[mtxOffset + 7] = n21*m14 + n22*m24 + n23*m34 + vec.y;\n\t\t\tthis._globalMatrices[mtxOffset + 8] = n31*m11 + n32*m21 + n33*m31;\n\t\t\tthis._globalMatrices[mtxOffset + 9] = n31*m12 + n32*m22 + n33*m32;\n\t\t\tthis._globalMatrices[mtxOffset + 10] = n31*m13 + n32*m23 + n33*m33;\n\t\t\tthis._globalMatrices[mtxOffset + 11] = n31*m14 + n32*m24 + n33*m34 + vec.z;\n\n\t\t\tmtxOffset = mtxOffset + 12;\n\t\t}\n\t}\n\n\n\tpublic getRenderableSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry):TriangleSubGeometry\n\t{\n\t\tthis._morphedSubGeometryDirty[sourceSubGeometry.id] = true;\n\n\t\t//early out for GPU animations\n\t\tif (!this._pAnimationSet.usesCPU)\n\t\t\treturn sourceSubGeometry;\n\n\t\tvar targetSubGeometry:TriangleSubGeometry;\n\n\t\tif (!(targetSubGeometry = this._morphedSubGeometry[sourceSubGeometry.id])) {\n\t\t\t//not yet stored\n\t\t\ttargetSubGeometry = this._morphedSubGeometry[sourceSubGeometry.id] = sourceSubGeometry.clone();\n\t\t\t//turn off auto calculations on the morphed geometry\n\t\t\ttargetSubGeometry.autoDeriveNormals = false;\n\t\t\ttargetSubGeometry.autoDeriveTangents = false;\n\t\t\ttargetSubGeometry.autoDeriveUVs = false;\n\t\t\t//add event listeners for any changes in UV values on the source geometry\n\t\t\tsourceSubGeometry.addEventListener(SubGeometryEvent.INDICES_UPDATED, this._onIndicesUpdateDelegate);\n\t\t\tsourceSubGeometry.addEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdateDelegate);\n\t\t}\n\n\t\treturn targetSubGeometry;\n\t}\n\n\t/**\n\t * If the animation can't be performed on GPU, transform vertices manually\n\t * @param subGeom The subgeometry containing the weights and joint index data per vertex.\n\t * @param pass The material pass for which we need to transform the vertices\n\t */\n\tpublic morphSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry)\n\t{\n\t\tthis._morphedSubGeometryDirty[sourceSubGeometry.id] = false;\n\n\t\tvar numVertices:number = sourceSubGeometry.numVertices;\n\t\tvar sourcePositions:Float32Array = sourceSubGeometry.positions.get(numVertices);\n\t\tvar sourceNormals:Float32Array = sourceSubGeometry.normals.get(numVertices);\n\t\tvar sourceTangents:Float32Array = sourceSubGeometry.tangents.get(numVertices);\n\n\t\tvar jointIndices:Float32Array = <Float32Array> sourceSubGeometry.jointIndices.get(numVertices);\n\t\tvar jointWeights:Float32Array = <Float32Array> sourceSubGeometry.jointWeights.get(numVertices);\n\n\t\tvar targetSubGeometry:TriangleSubGeometry = this._morphedSubGeometry[sourceSubGeometry.id];\n\n\t\tvar targetPositions:Float32Array = targetSubGeometry.positions.get(numVertices);\n\t\tvar targetNormals:Float32Array = targetSubGeometry.normals.get(numVertices);\n\t\tvar targetTangents:Float32Array = targetSubGeometry.tangents.get(numVertices);\n\n\t\tvar index:number /*uint*/ = 0;\n\t\tvar j:number /*uint*/ = 0;\n\t\tvar k:number /*uint*/;\n\t\tvar vx:number, vy:number, vz:number;\n\t\tvar nx:number, ny:number, nz:number;\n\t\tvar tx:number, ty:number, tz:number;\n\t\tvar len:number /*int*/ = sourcePositions.length;\n\t\tvar weight:number;\n\t\tvar vertX:number, vertY:number, vertZ:number;\n\t\tvar normX:number, normY:number, normZ:number;\n\t\tvar tangX:number, tangY:number, tangZ:number;\n\t\tvar m11:number, m12:number, m13:number, m14:number;\n\t\tvar m21:number, m22:number, m23:number, m24:number;\n\t\tvar m31:number, m32:number, m33:number, m34:number;\n\n\t\twhile (index < len) {\n\t\t\tvertX = sourcePositions[index];\n\t\t\tvertY = sourcePositions[index + 1];\n\t\t\tvertZ = sourcePositions[index + 2];\n\t\t\tnormX = sourceNormals[index];\n\t\t\tnormY = sourceNormals[index + 1];\n\t\t\tnormZ = sourceNormals[index + 2];\n\t\t\ttangX = sourceTangents[index];\n\t\t\ttangY = sourceTangents[index + 1];\n\t\t\ttangZ = sourceTangents[index + 2];\n\t\t\tvx = 0;\n\t\t\tvy = 0;\n\t\t\tvz = 0;\n\t\t\tnx = 0;\n\t\t\tny = 0;\n\t\t\tnz = 0;\n\t\t\ttx = 0;\n\t\t\tty = 0;\n\t\t\ttz = 0;\n\t\t\tk = 0;\n\t\t\twhile (k < this._jointsPerVertex) {\n\t\t\t\tweight = jointWeights[j];\n\t\t\t\tif (weight > 0) {\n\t\t\t\t\t// implicit /3*12 (/3 because indices are multiplied by 3 for gpu matrix access, *12 because it's the matrix size)\n\t\t\t\t\tvar mtxOffset:number /*uint*/ = jointIndices[j++] << 2;\n\t\t\t\t\tm11 = this._globalMatrices[mtxOffset];\n\t\t\t\t\tm12 = this._globalMatrices[mtxOffset + 1];\n\t\t\t\t\tm13 = this._globalMatrices[mtxOffset + 2];\n\t\t\t\t\tm14 = this._globalMatrices[mtxOffset + 3];\n\t\t\t\t\tm21 = this._globalMatrices[mtxOffset + 4];\n\t\t\t\t\tm22 = this._globalMatrices[mtxOffset + 5];\n\t\t\t\t\tm23 = this._globalMatrices[mtxOffset + 6];\n\t\t\t\t\tm24 = this._globalMatrices[mtxOffset + 7];\n\t\t\t\t\tm31 = this._globalMatrices[mtxOffset + 8];\n\t\t\t\t\tm32 = this._globalMatrices[mtxOffset + 9];\n\t\t\t\t\tm33 = this._globalMatrices[mtxOffset + 10];\n\t\t\t\t\tm34 = this._globalMatrices[mtxOffset + 11];\n\t\t\t\t\tvx += weight*(m11*vertX + m12*vertY + m13*vertZ + m14);\n\t\t\t\t\tvy += weight*(m21*vertX + m22*vertY + m23*vertZ + m24);\n\t\t\t\t\tvz += weight*(m31*vertX + m32*vertY + m33*vertZ + m34);\n\t\t\t\t\tnx += weight*(m11*normX + m12*normY + m13*normZ);\n\t\t\t\t\tny += weight*(m21*normX + m22*normY + m23*normZ);\n\t\t\t\t\tnz += weight*(m31*normX + m32*normY + m33*normZ);\n\t\t\t\t\ttx += weight*(m11*tangX + m12*tangY + m13*tangZ);\n\t\t\t\t\tty += weight*(m21*tangX + m22*tangY + m23*tangZ);\n\t\t\t\t\ttz += weight*(m31*tangX + m32*tangY + m33*tangZ);\n\t\t\t\t\t++k;\n\t\t\t\t} else {\n\t\t\t\t\tj += (this._jointsPerVertex - k);\n\t\t\t\t\tk = this._jointsPerVertex;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttargetPositions[index] = vx;\n\t\t\ttargetPositions[index + 1] = vy;\n\t\t\ttargetPositions[index + 2] = vz;\n\t\t\ttargetNormals[index] = nx;\n\t\t\ttargetNormals[index + 1] = ny;\n\t\t\ttargetNormals[index + 2] = nz;\n\t\t\ttargetTangents[index] = tx;\n\t\t\ttargetTangents[index + 1] = ty;\n\t\t\ttargetTangents[index + 2] = tz;\n\n\t\t\tindex += 3;\n\t\t}\n\n\t\ttargetSubGeometry.setPositions(targetPositions);\n\t\ttargetSubGeometry.setNormals(targetNormals);\n\t\ttargetSubGeometry.setTangents(targetTangents);\n\t}\n\n\t/**\n\t * Converts a local hierarchical skeleton pose to a global pose\n\t * @param targetPose The SkeletonPose object that will contain the global pose.\n\t * @param skeleton The skeleton containing the joints, and as such, the hierarchical data to transform to global poses.\n\t */\n\tprivate localToGlobalPose(sourcePose:SkeletonPose, targetPose:SkeletonPose, skeleton:Skeleton)\n\t{\n\t\tvar globalPoses:Array<JointPose> = targetPose.jointPoses;\n\t\tvar globalJointPose:JointPose;\n\t\tvar joints:Array<SkeletonJoint> = skeleton.joints;\n\t\tvar len:number /*uint*/ = sourcePose.numJointPoses;\n\t\tvar jointPoses:Array<JointPose> = sourcePose.jointPoses;\n\t\tvar parentIndex:number /*int*/;\n\t\tvar joint:SkeletonJoint;\n\t\tvar parentPose:JointPose;\n\t\tvar pose:JointPose;\n\t\tvar or:Quaternion;\n\t\tvar tr:Vector3D;\n\t\tvar t:Vector3D;\n\t\tvar q:Quaternion;\n\n\t\tvar x1:number, y1:number, z1:number, w1:number;\n\t\tvar x2:number, y2:number, z2:number, w2:number;\n\t\tvar x3:number, y3:number, z3:number;\n\n\t\t// :s\n\t\tif (globalPoses.length != len)\n\t\t\tglobalPoses.length = len;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tglobalJointPose = globalPoses[i];\n\n\t\t\tif (globalJointPose == null)\n\t\t\t\tglobalJointPose = globalPoses[i] = new JointPose();\n\n\t\t\tjoint = joints[i];\n\t\t\tparentIndex = joint.parentIndex;\n\t\t\tpose = jointPoses[i];\n\n\t\t\tq = globalJointPose.orientation;\n\t\t\tt = globalJointPose.translation;\n\n\t\t\tif (parentIndex < 0) {\n\t\t\t\ttr = pose.translation;\n\t\t\t\tor = pose.orientation;\n\t\t\t\tq.x = or.x;\n\t\t\t\tq.y = or.y;\n\t\t\t\tq.z = or.z;\n\t\t\t\tq.w = or.w;\n\t\t\t\tt.x = tr.x;\n\t\t\t\tt.y = tr.y;\n\t\t\t\tt.z = tr.z;\n\t\t\t} else {\n\t\t\t\t// append parent pose\n\t\t\t\tparentPose = globalPoses[parentIndex];\n\n\t\t\t\t// rotate point\n\t\t\t\tor = parentPose.orientation;\n\t\t\t\ttr = pose.translation;\n\t\t\t\tx2 = or.x;\n\t\t\t\ty2 = or.y;\n\t\t\t\tz2 = or.z;\n\t\t\t\tw2 = or.w;\n\t\t\t\tx3 = tr.x;\n\t\t\t\ty3 = tr.y;\n\t\t\t\tz3 = tr.z;\n\n\t\t\t\tw1 = -x2*x3 - y2*y3 - z2*z3;\n\t\t\t\tx1 = w2*x3 + y2*z3 - z2*y3;\n\t\t\t\ty1 = w2*y3 - x2*z3 + z2*x3;\n\t\t\t\tz1 = w2*z3 + x2*y3 - y2*x3;\n\n\t\t\t\t// append parent translation\n\t\t\t\ttr = parentPose.translation;\n\t\t\t\tt.x = -w1*x2 + x1*w2 - y1*z2 + z1*y2 + tr.x;\n\t\t\t\tt.y = -w1*y2 + x1*z2 + y1*w2 - z1*x2 + tr.y;\n\t\t\t\tt.z = -w1*z2 - x1*y2 + y1*x2 + z1*w2 + tr.z;\n\n\t\t\t\t// append parent orientation\n\t\t\t\tx1 = or.x;\n\t\t\t\ty1 = or.y;\n\t\t\t\tz1 = or.z;\n\t\t\t\tw1 = or.w;\n\t\t\t\tor = pose.orientation;\n\t\t\t\tx2 = or.x;\n\t\t\t\ty2 = or.y;\n\t\t\t\tz2 = or.z;\n\t\t\t\tw2 = or.w;\n\n\t\t\t\tq.w = w1*w2 - x1*x2 - y1*y2 - z1*z2;\n\t\t\t\tq.x = w1*x2 + x1*w2 + y1*z2 - z1*y2;\n\t\t\t\tq.y = w1*y2 - x1*z2 + y1*w2 + z1*x2;\n\t\t\t\tq.z = w1*z2 + x1*y2 - y1*x2 + z1*w2;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onTransitionComplete(event:AnimationStateEvent)\n\t{\n\t\tif (event.type == AnimationStateEvent.TRANSITION_COMPLETE) {\n\t\t\tevent.animationNode.removeEventListener(AnimationStateEvent.TRANSITION_COMPLETE, this._onTransitionCompleteDelegate);\n\t\t\t//if this is the current active state transition, revert control to the active node\n\t\t\tif (this._pActiveState == event.animationState) {\n\t\t\t\tthis._pActiveNode = this._pAnimationSet.getAnimation(this._pActiveAnimationName);\n\t\t\t\tthis._pActiveState = this.getAnimationState(this._pActiveNode);\n\t\t\t\tthis._activeSkeletonState = <ISkeletonAnimationState> this._pActiveState;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onIndicesUpdate(event:SubGeometryEvent)\n\t{\n\t\tvar subGeometry:TriangleSubGeometry = <TriangleSubGeometry> event.target;\n\n\t\t(<TriangleSubGeometry> this._morphedSubGeometry[subGeometry.id]).setIndices(subGeometry.indices);\n\t}\n\n\tprivate onVerticesUpdate(event:SubGeometryEvent)\n\t{\n\t\tvar subGeometry:TriangleSubGeometry = <TriangleSubGeometry> event.target;\n\t\tvar morphGeometry:TriangleSubGeometry = <TriangleSubGeometry> this._morphedSubGeometry[subGeometry.id];\n\n\t\tswitch(event.attributesView) {\n\t\t\tcase subGeometry.uvs:\n\t\t\t\tmorphGeometry.setUVs(subGeometry.uvs.get(subGeometry.numVertices));\n\t\t\t\tbreak;\n\t\t\tcase subGeometry.secondaryUVs:\n\t\t\t\tmorphGeometry.setSecondaryUVs(subGeometry.secondaryUVs.get(subGeometry.numVertices));\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport = SkeletonAnimator;",
    "import IAnimationSet\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport VertexAnimationMode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/VertexAnimationMode\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\n/**\n * The animation data set used by vertex-based animators, containing vertex animation state data.\n *\n * @see VertexAnimator\n */\nclass VertexAnimationSet extends AnimationSetBase implements IAnimationSet\n{\n\tprivate _numPoses:number /*uint*/;\n\tprivate _blendMode:string;\n\n\t/**\n\t * Returns the number of poses made available at once to the GPU animation code.\n\t */\n\tpublic get numPoses():number /*uint*/\n\t{\n\t\treturn this._numPoses;\n\t}\n\n\t/**\n\t * Returns the active blend mode of the vertex animator object.\n\t */\n\tpublic get blendMode():string\n\t{\n\t\treturn this._blendMode;\n\t}\n\n\t/**\n\t * Returns whether or not normal data is used in last set GPU pass of the vertex shader.\n\t */\n//\t\tpublic get useNormals():boolean\n//\t\t{\n//\t\t\treturn this._uploadNormals;\n//\t\t}\n\n\t/**\n\t * Creates a new <code>VertexAnimationSet</code> object.\n\t *\n\t * @param numPoses The number of poses made available at once to the GPU animation code.\n\t * @param blendMode Optional value for setting the animation mode of the vertex animator object.\n\t *\n\t * @see away3d.animators.data.VertexAnimationMode\n\t */\n\tconstructor(numPoses:number /*uint*/ = 2, blendMode:string = \"absolute\")\n\t{\n\t\tsuper();\n\t\tthis._numPoses = numPoses;\n\t\tthis._blendMode = blendMode;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase):string\n\t{\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE)\n\t\t\treturn this.getAbsoluteAGALCode(shader);\n\t\telse\n\t\t\treturn this.getAdditiveAGALCode(shader);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic activate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tvar uID:number = pass._iUniqueId;\n//\t\t\tthis._uploadNormals = <boolean> this._useNormals[uID];\n//\t\t\tthis._uploadTangents = <boolean> this._useTangents[uID];\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic deactivate(shader:ShaderBase, stage:Stage)\n\t{\n//\t\t\tvar uID:number = pass._iUniqueId;\n//\t\t\tvar index:number /*uint*/ = this._streamIndices[uID];\n//\t\t\tvar context:IContextGL = <IContextGL> stage.context;\n//\t\t\tcontext.setVertexBufferAt(index, null);\n//\t\t\tif (this._uploadNormals)\n//\t\t\t\tcontext.setVertexBufferAt(index + 1, null);\n//\t\t\tif (this._uploadTangents)\n//\t\t\t\tcontext.setVertexBufferAt(index + 2, null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, shadedTarget:string):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase):string\n\t{\n\t\treturn \"mov \" + shader.uvTarget + \",\" + shader.uvSource + \"\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic doneAGALCode(shader:ShaderBase)\n\t{\n\n\t}\n\n\t/**\n\t * Generates the vertex AGAL code for absolute blending.\n\t */\n\tprivate getAbsoluteAGALCode(shader:ShaderBase):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar temp1:string = this._pFindTempReg(shader.animationTargetRegisters);\n\t\tvar temp2:string = this._pFindTempReg(shader.animationTargetRegisters, temp1);\n\t\tvar regs:Array<string> = new Array<string>(\"x\", \"y\", \"z\", \"w\");\n\t\tvar len:number /*uint*/ = shader.animatableAttributes.length;\n\t\tvar constantReg:string = \"vc\" + shader.numUsedVertexConstants;\n\n\t\tif (len > 2)\n\t\t\tlen = 2;\n\t\tvar streamIndex:number /*uint*/ = shader.numUsedStreams;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tcode += \"mul \" + temp1 + \", \" + shader.animatableAttributes[i] + \", \" + constantReg + \".\" + regs[0] + \"\\n\";\n\n\t\t\tfor (var j:number /*uint*/ = 1; j < this._numPoses; ++j) {\n\t\t\t\tcode += \"mul \" + temp2 + \", va\" + streamIndex + \", \" + constantReg + \".\" + regs[j] + \"\\n\";\n\n\t\t\t\tif (j < this._numPoses - 1)\n\t\t\t\t\tcode += \"add \" + temp1 + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\t\t\t++streamIndex;\n\t\t\t}\n\n\t\t\tcode += \"add \" + shader.animationTargetRegisters[i] + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\t\t}\n\n\t\t// add code for bitangents if tangents are used\n\t\tif (shader.tangentDependencies > 0 || shader.outputsNormals) {\n\t\t\tcode += \"dp3 \" + temp1 + \".x, \" + shader.animatableAttributes[2] + \", \" + shader.animationTargetRegisters[1] + \"\\n\" +\n\t\t\t\t\"mul \" + temp1 + \", \" + shader.animationTargetRegisters[1] + \", \" + temp1 + \".x\\n\" +\n\t\t\t\t\"sub \" + shader.animationTargetRegisters[2] + \", \" + shader.animationTargetRegisters[2] + \", \" + temp1 + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * Generates the vertex AGAL code for additive blending.\n\t */\n\tprivate getAdditiveAGALCode(shader:ShaderBase):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar len:number /*uint*/ = shader.animatableAttributes.length;\n\t\tvar regs:Array<string> = [\"x\", \"y\", \"z\", \"w\"];\n\t\tvar temp1:string = this._pFindTempReg(shader.animationTargetRegisters);\n\t\tvar k:number /*uint*/;\n\n\t\tvar streamIndex:number /*uint*/ = shader.numUsedStreams;\n\n\t\tif (len > 2)\n\t\t\tlen = 2;\n\n\t\tcode += \"mov  \" + shader.animationTargetRegisters[0] + \", \" + shader.animatableAttributes[0] + \"\\n\";\n\t\tif (shader.normalDependencies > 0)\n\t\t\tcode += \"mov \" + shader.animationTargetRegisters[1] + \", \" + shader.animatableAttributes[1] + \"\\n\";\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tfor (var j:number /*uint*/ = 0; j < this._numPoses; ++j) {\n\t\t\t\tcode += \"mul \" + temp1 + \", va\" + (streamIndex + k) + \", vc\" + shader.numUsedVertexConstants + \".\" + regs[j] + \"\\n\" +\n\t\t\t\t\t\"add \" + shader.animationTargetRegisters[i] + \", \" + shader.animationTargetRegisters[i] + \", \" + temp1 + \"\\n\";\n\t\t\t\tk++;\n\t\t\t}\n\t\t}\n\n\t\tif (shader.tangentDependencies > 0 || shader.outputsNormals) {\n\t\t\tcode += \"dp3 \" + temp1 + \".x, \" + shader.animatableAttributes[2] + \", \" + shader.animationTargetRegisters[1] + \"\\n\" +\n\t\t\t\t\"mul \" + temp1 + \", \" + shader.animationTargetRegisters[1] + \", \" + temp1 + \".x\\n\" +\n\t\t\t\t\"sub \" + shader.animationTargetRegisters[2] + \", \" + shader.animatableAttributes[2] + \", \" + temp1 + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n}\n\nexport = VertexAnimationSet;",
    "import Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport SubGeometryBase\t\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport TriangleSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport VertexAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimationSet\");\nimport VertexAnimationMode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/VertexAnimationMode\");\nimport IVertexAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IVertexAnimationState\");\nimport IAnimationTransition\t\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/IAnimationTransition\");\nimport TriangleSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport SubGeometryVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\nimport SubGeometryVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\n\n/**\n * Provides an interface for assigning vertex-based animation data sets to mesh-based entity objects\n * and controlling the various available states of animation through an interative playhead that can be\n * automatically updated or manually triggered.\n */\nclass VertexAnimator extends AnimatorBase\n{\n\tprivate _subGeometryVOPool:SubGeometryVOPool;\n\tprivate _vertexAnimationSet:VertexAnimationSet;\n\tprivate _poses:Array<Geometry> = new Array<Geometry>();\n\tprivate _weights:Array<number> = Array<number>(1, 0, 0, 0);\n\tprivate _numPoses:number /*uint*/;\n\tprivate _blendMode:string;\n\tprivate _activeVertexState:IVertexAnimationState;\n\n\t/**\n\t * Creates a new <code>VertexAnimator</code> object.\n\t *\n\t * @param vertexAnimationSet The animation data set containing the vertex animations used by the animator.\n\t */\n\tconstructor(vertexAnimationSet:VertexAnimationSet)\n\t{\n\t\tsuper(vertexAnimationSet);\n\n\t\tthis._vertexAnimationSet = vertexAnimationSet;\n\t\tthis._numPoses = vertexAnimationSet.numPoses;\n\t\tthis._blendMode = vertexAnimationSet.blendMode;\n\t\tthis._subGeometryVOPool = SubGeometryVOPool.getPool();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():AnimatorBase\n\t{\n\t\treturn new VertexAnimator(this._vertexAnimationSet);\n\t}\n\n\t/**\n\t * Plays a sequence with a given name. If the sequence is not found, it may not be loaded yet, and it will retry every frame.\n\t * @param sequenceName The name of the clip to be played.\n\t */\n\tpublic play(name:string, transition:IAnimationTransition = null, offset:number = NaN)\n\t{\n\t\tif (this._pActiveAnimationName == name)\n\t\t\treturn;\n\n\t\tthis._pActiveAnimationName = name;\n\n\t\t//TODO: implement transitions in vertex animator\n\n\t\tif (!this._pAnimationSet.hasAnimation(name))\n\t\t\tthrow new Error(\"Animation root node \" + name + \" not found!\");\n\n\t\tthis._pActiveNode = this._pAnimationSet.getAnimation(name);\n\n\t\tthis._pActiveState = this.getAnimationState(this._pActiveNode);\n\n\t\tif (this.updatePosition) {\n\t\t\t//update straight away to reset position deltas\n\t\t\tthis._pActiveState.update(this._pAbsoluteTime);\n\t\t\tthis._pActiveState.positionDelta;\n\t\t}\n\n\t\tthis._activeVertexState = <IVertexAnimationState> this._pActiveState;\n\n\t\tthis.start();\n\n\t\t//apply a time offset if specified\n\t\tif (!isNaN(offset))\n\t\t\tthis.reset(name, offset);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateDeltaTime(dt:number)\n\t{\n\t\tsuper._pUpdateDeltaTime(dt);\n\n\t\tvar geometryFlag:boolean = false;\n\n\t\tif (this._poses[0] != this._activeVertexState.currentGeometry) {\n\t\t\tthis._poses[0] = this._activeVertexState.currentGeometry;\n\t\t\tgeometryFlag = true;\n\t\t}\n\n\t\tif (this._poses[1] != this._activeVertexState.nextGeometry) {\n\t\t\tthis._poses[1] = this._activeVertexState.nextGeometry;\n\t\t\tgeometryFlag = true;\n\t\t}\n\n\t\tthis._weights[0] = 1 - (this._weights[1] = this._activeVertexState.blendWeight);\n\n\t\tif (geometryFlag) {\n\t\t\t//invalidate meshes\n\t\t\tvar mesh:Mesh;\n\t\t\tvar len:number = this._pOwners.length;\n\t\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\t\tmesh = this._pOwners[i];\n\t\t\t\tmesh._iInvalidateRenderableGeometries();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(shader:ShaderBase, renderable:RenderableBase, stage:Stage, camera:Camera, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\t// todo: add code for when running on cpu\n\t\t// this type of animation can only be SubMesh\n\t\tvar subMesh:TriangleSubMesh = <TriangleSubMesh> (<TriangleSubMeshRenderable> renderable).subMesh;\n\t\tvar subGeom:TriangleSubGeometry = subMesh.subGeometry;\n\n\t\t// if no poses defined, set temp data\n\t\tif (!this._poses.length) {\n\t\t\tthis.setNullPose(shader, subGeom, stage, vertexConstantOffset, vertexStreamOffset);\n\t\t\treturn;\n\t\t}\n\n\n\t\tvar i:number /*uint*/;\n\t\tvar len:number /*uint*/ = this._numPoses;\n\n\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._weights, 1);\n\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE)\n\t\t\ti = 1;\n\t\telse\n\t\t\ti = 0;\n\n\t\tvar subGeometryVO:SubGeometryVOBase;\n\n\t\tfor (; i < len; ++i) {\n\t\t\tsubGeom = <TriangleSubGeometry> this._poses[i].subGeometries[subMesh._iIndex] || subMesh.subGeometry;\n\n\t\t\tsubGeometryVO = this._subGeometryVOPool.getItem(subGeom);\n\t\t\tsubGeometryVO._indexMappings = this._subGeometryVOPool.getItem(subMesh.subGeometry).indexMappings;\n\n\t\t\tsubGeometryVO.activateVertexBufferVO(vertexStreamOffset++, subGeom.positions, stage);\n\n\t\t\tif (shader.normalDependencies > 0)\n\t\t\t\tsubGeometryVO.activateVertexBufferVO(vertexStreamOffset++, subGeom.normals, stage);\n\t\t}\n\t}\n\n\tprivate setNullPose(shader:ShaderBase, subGeometry:TriangleSubGeometry, stage:Stage, vertexConstantOffset:number /*int*/, vertexStreamOffset:number /*int*/)\n\t{\n\t\tstage.context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, vertexConstantOffset, this._weights, 1);\n\n\t\tvar subGeometryVO:SubGeometryVOBase = this._subGeometryVOPool.getItem(subGeometry);\n\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE) {\n\t\t\tvar len:number /*uint*/ = this._numPoses;\n\t\t\tfor (var i:number /*uint*/ = 1; i < len; ++i) {\n\t\t\t\tsubGeometryVO.activateVertexBufferVO(vertexStreamOffset++, subGeometry.positions, stage);\n\n\t\t\t\tif (shader.normalDependencies > 0)\n\t\t\t\t\tsubGeometryVO.activateVertexBufferVO(vertexStreamOffset++, subGeometry.normals, stage);\n\t\t\t}\n\t\t}\n\t\t// todo: set temp data for additive?\n\t}\n\n\t/**\n\t * Verifies if the animation will be used on cpu. Needs to be true for all passes for a material to be able to use it on gpu.\n\t * Needs to be called if gpu code is potentially required.\n\t */\n\tpublic testGPUCompatibility(shader:ShaderBase)\n\t{\n\t}\n\n\tpublic getRenderableSubGeometry(renderable:TriangleSubMeshRenderable, sourceSubGeometry:TriangleSubGeometry):TriangleSubGeometry\n\t{\n\t\tif (this._blendMode == VertexAnimationMode.ABSOLUTE && this._poses.length)\n\t\t\treturn <TriangleSubGeometry> this._poses[0].subGeometries[renderable.subMesh._iIndex] || sourceSubGeometry;\n\n\t\t//nothing to do here\n\t\treturn sourceSubGeometry;\n\t}\n}\n\nexport = VertexAnimator;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nimport AnimationNodeBase\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n\n/**\n * ...\n */\nclass AnimationRegisterCache extends ShaderRegisterCache\n{\n\t//vertex\n\tpublic positionAttribute:ShaderRegisterElement;\n\tpublic uvAttribute:ShaderRegisterElement;\n\tpublic positionTarget:ShaderRegisterElement;\n\tpublic scaleAndRotateTarget:ShaderRegisterElement;\n\tpublic velocityTarget:ShaderRegisterElement;\n\tpublic vertexTime:ShaderRegisterElement;\n\tpublic vertexLife:ShaderRegisterElement;\n\tpublic vertexZeroConst:ShaderRegisterElement;\n\tpublic vertexOneConst:ShaderRegisterElement;\n\tpublic vertexTwoConst:ShaderRegisterElement;\n\tpublic uvTarget:ShaderRegisterElement;\n\tpublic colorAddTarget:ShaderRegisterElement;\n\tpublic colorMulTarget:ShaderRegisterElement;\n\t//vary\n\tpublic colorAddVary:ShaderRegisterElement;\n\tpublic colorMulVary:ShaderRegisterElement;\n\n\t//fragment\n\n\tpublic uvVar:ShaderRegisterElement;\n\n\t//these are targets only need to rotate ( normal and tangent )\n\tpublic rotationRegisters:Array<ShaderRegisterElement>;\n\n\tpublic needFragmentAnimation:boolean;\n\tpublic needUVAnimation:boolean;\n\n\tpublic sourceRegisters:Array<string>;\n\tpublic targetRegisters:Array<string>;\n\n\tprivate indexDictionary:Object = new Object();\n\n\t//set true if has an node which will change UV\n\tpublic hasUVNode:boolean;\n\t//set if the other nodes need to access the velocity\n\tpublic needVelocity:boolean;\n\t//set if has a billboard node.\n\tpublic hasBillboard:boolean;\n\t//set if has an node which will apply color multiple operation\n\tpublic hasColorMulNode:boolean;\n\t//set if has an node which will apply color add operation\n\tpublic hasColorAddNode:boolean;\n\n\tconstructor(profile:string)\n\t{\n\t\tsuper(profile);\n\t}\n\n\tpublic reset()\n\t{\n\t\tsuper.reset();\n\n\t\tthis.rotationRegisters = new Array<ShaderRegisterElement>();\n\t\tthis.positionAttribute = this.getRegisterFromString(this.sourceRegisters[0]);\n\t\tthis.scaleAndRotateTarget = this.getRegisterFromString(this.targetRegisters[0]);\n\t\tthis.addVertexTempUsages(this.scaleAndRotateTarget, 1);\n\n\t\tfor (var i:number /*int*/ = 1; i < this.targetRegisters.length; i++) {\n\t\t\tthis.rotationRegisters.push(this.getRegisterFromString(this.targetRegisters[i]));\n\t\t\tthis.addVertexTempUsages(this.rotationRegisters[i - 1], 1);\n\t\t}\n\n\t\tthis.scaleAndRotateTarget = new ShaderRegisterElement(this.scaleAndRotateTarget.regName, this.scaleAndRotateTarget.index); //only use xyz, w is used as vertexLife\n\n\t\t//allot const register\n\n\t\tthis.vertexZeroConst = this.getFreeVertexConstant();\n\t\tthis.vertexZeroConst = new ShaderRegisterElement(this.vertexZeroConst.regName, this.vertexZeroConst.index, 0);\n\t\tthis.vertexOneConst = new ShaderRegisterElement(this.vertexZeroConst.regName, this.vertexZeroConst.index, 1);\n\t\tthis.vertexTwoConst = new ShaderRegisterElement(this.vertexZeroConst.regName, this.vertexZeroConst.index, 2);\n\n\t\t//allot temp register\n\t\tthis.positionTarget = this.getFreeVertexVectorTemp();\n\t\tthis.addVertexTempUsages(this.positionTarget, 1);\n\t\tthis.positionTarget = new ShaderRegisterElement(this.positionTarget.regName, this.positionTarget.index);\n\n\t\tif (this.needVelocity) {\n\t\t\tthis.velocityTarget = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(this.velocityTarget, 1);\n\t\t\tthis.velocityTarget = new ShaderRegisterElement(this.velocityTarget.regName, this.velocityTarget.index);\n\t\t\tthis.vertexTime = new ShaderRegisterElement(this.velocityTarget.regName, this.velocityTarget.index, 3);\n\t\t\tthis.vertexLife = new ShaderRegisterElement(this.positionTarget.regName, this.positionTarget.index, 3);\n\t\t} else {\n\t\t\tvar tempTime:ShaderRegisterElement = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(tempTime, 1);\n\t\t\tthis.vertexTime = new ShaderRegisterElement(tempTime.regName, tempTime.index, 0);\n\t\t\tthis.vertexLife = new ShaderRegisterElement(tempTime.regName, tempTime.index, 1);\n\t\t}\n\n\t}\n\n\tpublic setUVSourceAndTarget(UVAttribute:string, UVVaring:string)\n\t{\n\t\tthis.uvVar = this.getRegisterFromString(UVVaring);\n\t\tthis.uvAttribute = this.getRegisterFromString(UVAttribute);\n\t\t//uv action is processed after normal actions,so use offsetTarget as uvTarget\n\t\tthis.uvTarget = new ShaderRegisterElement(this.positionTarget.regName, this.positionTarget.index);\n\t}\n\n\tpublic setRegisterIndex(node:AnimationNodeBase, parameterIndex:number /*int*/, registerIndex:number /*int*/)\n\t{\n\t\t//8 should be enough for any node.\n\t\tvar t:Array<number> /*int*/ = this.indexDictionary[node.id];\n\n\t\tif (t == null)\n\t\t\tt = this.indexDictionary[node.id] = new Array<number>(8) /*int*/;\n\n\t\tt[parameterIndex] = registerIndex;\n\t}\n\n\tpublic getRegisterIndex(node:AnimationNodeBase, parameterIndex:number /*int*/):number /*int*/\n\t{\n\t\treturn (<Array<number>> this.indexDictionary[node.id])[parameterIndex];\n\t}\n\n\tpublic getInitCode():string\n\t{\n\t\tvar len:number /*int*/ = this.sourceRegisters.length;\n\t\tvar code:string = \"\";\n\t\tfor (var i:number /*int*/ = 0; i < len; i++)\n\t\t\tcode += \"mov \" + this.targetRegisters[i] + \",\" + this.sourceRegisters[i] + \"\\n\";\n\n\t\tcode += \"mov \" + this.positionTarget + \".xyz,\" + this.vertexZeroConst.toString() + \"\\n\";\n\n\t\tif (this.needVelocity)\n\t\t\tcode += \"mov \" + this.velocityTarget + \".xyz,\" + this.vertexZeroConst.toString() + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\tpublic getCombinationCode():string\n\t{\n\t\treturn \"add \" + this.scaleAndRotateTarget + \".xyz,\" + this.scaleAndRotateTarget + \".xyz,\" + this.positionTarget + \".xyz\\n\";\n\t}\n\n\tpublic initColorRegisters():string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.hasColorMulNode) {\n\t\t\tthis.colorMulTarget = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(this.colorMulTarget, 1);\n\t\t\tthis.colorMulVary = this.getFreeVarying();\n\t\t\tcode += \"mov \" + this.colorMulTarget + \",\" + this.vertexOneConst + \"\\n\";\n\t\t}\n\t\tif (this.hasColorAddNode) {\n\t\t\tthis.colorAddTarget = this.getFreeVertexVectorTemp();\n\t\t\tthis.addVertexTempUsages(this.colorAddTarget, 1);\n\t\t\tthis.colorAddVary = this.getFreeVarying();\n\t\t\tcode += \"mov \" + this.colorAddTarget + \",\" + this.vertexZeroConst + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\tpublic getColorPassCode():string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.needFragmentAnimation && (this.hasColorAddNode || this.hasColorMulNode)) {\n\t\t\tif (this.hasColorMulNode)\n\t\t\t\tcode += \"mov \" + this.colorMulVary + \",\" + this.colorMulTarget + \"\\n\";\n\t\t\tif (this.hasColorAddNode)\n\t\t\t\tcode += \"mov \" + this.colorAddVary + \",\" + this.colorAddTarget + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\tpublic getColorCombinationCode(shadedTarget:string):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (this.needFragmentAnimation && (this.hasColorAddNode || this.hasColorMulNode)) {\n\t\t\tvar colorTarget:ShaderRegisterElement = this.getRegisterFromString(shadedTarget);\n\t\t\tthis.addFragmentTempUsages(colorTarget, 1);\n\t\t\tif (this.hasColorMulNode)\n\t\t\t\tcode += \"mul \" + colorTarget + \",\" + colorTarget + \",\" + this.colorMulVary + \"\\n\";\n\t\t\tif (this.hasColorAddNode)\n\t\t\t\tcode += \"add \" + colorTarget + \",\" + colorTarget + \",\" + this.colorAddVary + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\tprivate getRegisterFromString(code:string):ShaderRegisterElement\n\t{\n\t\tvar temp:Array<string> = code.split(/(\\d+)/);\n\t\treturn new ShaderRegisterElement(temp[0], parseInt(temp[1]));\n\t}\n\n\tpublic vertexConstantData:Array<number> = new Array<number>();\n\tpublic fragmentConstantData:Array<number> = new Array<number>();\n\n\tprivate _numVertexConstant:number /*int*/;\n\tprivate _numFragmentConstant:number /*int*/;\n\n\tpublic get numVertexConstant():number /*int*/\n\t{\n\t\treturn this._numVertexConstant;\n\t}\n\n\tpublic get numFragmentConstant():number /*int*/\n\t{\n\t\treturn this._numFragmentConstant;\n\t}\n\n\tpublic setDataLength()\n\t{\n\t\tthis._numVertexConstant = this.numUsedVertexConstants - this.vertexConstantOffset;\n\t\tthis._numFragmentConstant = this.numUsedFragmentConstants - this.fragmentConstantOffset;\n\t\tthis.vertexConstantData.length = this._numVertexConstant*4;\n\t\tthis.fragmentConstantData.length = this._numFragmentConstant*4;\n\t}\n\n\tpublic setVertexConst(index:number /*int*/, x:number = 0, y:number = 0, z:number = 0, w:number = 0)\n\t{\n\t\tvar _index:number /*int*/ = (index - this.vertexConstantOffset)*4;\n\t\tthis.vertexConstantData[_index++] = x;\n\t\tthis.vertexConstantData[_index++] = y;\n\t\tthis.vertexConstantData[_index++] = z;\n\t\tthis.vertexConstantData[_index] = w;\n\t}\n\n\tpublic setVertexConstFromArray(index:number /*int*/, data:Array<number>)\n\t{\n\t\tvar _index:number /*int*/ = (index - this.vertexConstantOffset)*4;\n\t\tfor (var i:number /*int*/ = 0; i < data.length; i++)\n\t\t\tthis.vertexConstantData[_index++] = data[i];\n\t}\n\n\tpublic setVertexConstFromMatrix(index:number /*int*/, matrix:Matrix3D)\n\t{\n\t\tvar rawData:Array<number> = matrix.rawData;\n\t\tvar _index:number /*int*/ = (index - this.vertexConstantOffset)*4;\n\t\tthis.vertexConstantData[_index++] = rawData[0];\n\t\tthis.vertexConstantData[_index++] = rawData[4];\n\t\tthis.vertexConstantData[_index++] = rawData[8];\n\t\tthis.vertexConstantData[_index++] = rawData[12];\n\t\tthis.vertexConstantData[_index++] = rawData[1];\n\t\tthis.vertexConstantData[_index++] = rawData[5];\n\t\tthis.vertexConstantData[_index++] = rawData[9];\n\t\tthis.vertexConstantData[_index++] = rawData[13];\n\t\tthis.vertexConstantData[_index++] = rawData[2];\n\t\tthis.vertexConstantData[_index++] = rawData[6];\n\t\tthis.vertexConstantData[_index++] = rawData[10];\n\t\tthis.vertexConstantData[_index++] = rawData[14];\n\t\tthis.vertexConstantData[_index++] = rawData[3];\n\t\tthis.vertexConstantData[_index++] = rawData[7];\n\t\tthis.vertexConstantData[_index++] = rawData[11];\n\t\tthis.vertexConstantData[_index] = rawData[15];\n\n\t}\n\n\tpublic setFragmentConst(index:number /*int*/, x:number = 0, y:number = 0, z:number = 0, w:number = 0)\n\t{\n\t\tvar _index:number /*int*/ = (index - this.fragmentConstantOffset)*4;\n\t\tthis.fragmentConstantData[_index++] = x;\n\t\tthis.fragmentConstantData[_index++] = y;\n\t\tthis.fragmentConstantData[_index++] = z;\n\t\tthis.fragmentConstantData[_index] = w;\n\t}\n}\n\nexport = AnimationRegisterCache;",
    "import Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IVertexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\n\n/**\n * ...\n */\nclass AnimationSubGeometry\n{\n\tpublic static SUBGEOM_ID_COUNT:number = 0;\n\n\tpublic _pVertexData:Array<number>;\n\n\tpublic _pVertexBuffer:Array<IVertexBuffer> = new Array<IVertexBuffer>(8);\n\tpublic _pBufferContext:Array<IContextGL> = new Array<IContextGL>(8);\n\tpublic _pBufferDirty:Array<boolean> = new Array<boolean>(8);\n\n\tprivate _numVertices:number /*uint*/;\n\n\tprivate _totalLenOfOneVertex:number /*uint*/;\n\n\tpublic numProcessedVertices:number /*int*/ = 0;\n\n\tpublic previousTime:number = Number.NEGATIVE_INFINITY;\n\n\tpublic animationParticles:Array<ParticleAnimationData> = new Array<ParticleAnimationData>();\n\n\t/**\n\t * An id for this animation subgeometry, used to identify animation subgeometries when using animation sets.\n\t *\n\t * @private\n\t */\n\tpublic _iUniqueId:number;//Arcane\n\n\tconstructor()\n\t{\n\t\tfor (var i:number /*int*/ = 0; i < 8; i++)\n\t\t\tthis._pBufferDirty[i] = true;\n\n\t\tthis._iUniqueId = AnimationSubGeometry.SUBGEOM_ID_COUNT++;\n\t}\n\n\tpublic createVertexData(numVertices:number /*uint*/, totalLenOfOneVertex:number /*uint*/)\n\t{\n\t\tthis._numVertices = numVertices;\n\t\tthis._totalLenOfOneVertex = totalLenOfOneVertex;\n\t\tthis._pVertexData = new Array<number>(numVertices*totalLenOfOneVertex);\n\t}\n\n\tpublic activateVertexBuffer(index:number /*int*/, bufferOffset:number /*int*/, stage:Stage, format:string)\n\t{\n\t\tvar contextIndex:number /*int*/ = stage.stageIndex;\n\t\tvar context:IContextGL = <IContextGL> stage.context;\n\n\t\tvar buffer:IVertexBuffer = this._pVertexBuffer[contextIndex];\n\t\tif (!buffer || this._pBufferContext[contextIndex] != context) {\n\t\t\tbuffer = this._pVertexBuffer[contextIndex] = context.createVertexBuffer(this._numVertices, this._totalLenOfOneVertex*4);\n\t\t\tthis._pBufferContext[contextIndex] = context;\n\t\t\tthis._pBufferDirty[contextIndex] = true;\n\t\t}\n\t\tif (this._pBufferDirty[contextIndex]) {\n\t\t\tbuffer.uploadFromArray(this._pVertexData, 0, this._numVertices);\n\t\t\tthis._pBufferDirty[contextIndex] = false;\n\t\t}\n\t\tcontext.setVertexBufferAt(index, buffer, bufferOffset*4, format);\n\t}\n\n\tpublic dispose()\n\t{\n\t\twhile (this._pVertexBuffer.length) {\n\t\t\tvar vertexBuffer:IVertexBuffer = this._pVertexBuffer.pop()\n\n\t\t\tif (vertexBuffer)\n\t\t\t\tvertexBuffer.dispose();\n\t\t}\n\t}\n\n\tpublic invalidateBuffer()\n\t{\n\t\tfor (var i:number /*int*/ = 0; i < 8; i++)\n\t\t\tthis._pBufferDirty[i] = true;\n\t}\n\n\tpublic get vertexData():Array<number>\n\t{\n\t\treturn this._pVertexData;\n\t}\n\n\tpublic get numVertices():number /*uint*/\n\t{\n\t\treturn this._numVertices;\n\t}\n\n\tpublic get totalLenOfOneVertex():number /*uint*/\n\t{\n\t\treturn this._totalLenOfOneVertex;\n\t}\n}\n\nexport = AnimationSubGeometry;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\n\nclass ColorSegmentPoint\n{\n\tprivate _color:ColorTransform;\n\tprivate _life:number;\n\n\tconstructor(life:number, color:ColorTransform)\n\t{\n\t\t//0<life<1\n\t\tif (life <= 0 || life >= 1)\n\t\t\tthrow(new Error(\"life exceeds range (0,1)\"));\n\t\tthis._life = life;\n\t\tthis._color = color;\n\t}\n\n\tpublic get color():ColorTransform\n\t{\n\t\treturn this._color;\n\t}\n\n\tpublic get life():number\n\t{\n\t\treturn this._life;\n\t}\n\n}\n\nexport = ColorSegmentPoint;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\n/**\n * Contains transformation data for a skeleton joint, used for skeleton animation.\n *\n * @see away.animation.Skeleton\n * @see away.animation.SkeletonJoint\n *\n * todo: support (uniform) scale\n */\nclass JointPose\n{\n\t/**\n\t * The name of the joint to which the pose is associated\n\t */\n\tpublic name:string; // intention is that this should be used only at load time, not in the main loop\n\n\t/**\n\t * The rotation of the pose stored as a quaternion\n\t */\n\tpublic orientation:Quaternion = new Quaternion();\n\n\t/**\n\t * The translation of the pose\n\t */\n\tpublic translation:Vector3D = new Vector3D();\n\n\tconstructor()\n\t{\n\n\t}\n\n\t/**\n\t * Converts the transformation to a Matrix3D representation.\n\t *\n\t * @param target An optional target matrix to store the transformation. If not provided, it will create a new instance.\n\t * @return The transformation matrix of the pose.\n\t */\n\tpublic toMatrix3D(target:Matrix3D = null):Matrix3D\n\t{\n\t\tif (target == null)\n\t\t\ttarget = new Matrix3D();\n\n\t\tthis.orientation.toMatrix3D(target);\n\t\ttarget.appendTranslation(this.translation.x, this.translation.y, this.translation.z);\n\t\treturn target;\n\t}\n\n\t/**\n\t * Copies the transformation data from a source pose object into the existing pose object.\n\t *\n\t * @param pose The source pose to copy from.\n\t */\n\tpublic copyFrom(pose:JointPose)\n\t{\n\t\tvar or:Quaternion = pose.orientation;\n\t\tvar tr:Vector3D = pose.translation;\n\t\tthis.orientation.x = or.x;\n\t\tthis.orientation.y = or.y;\n\t\tthis.orientation.z = or.z;\n\t\tthis.orientation.w = or.w;\n\t\tthis.translation.x = tr.x;\n\t\tthis.translation.y = tr.y;\n\t\tthis.translation.z = tr.z;\n\t}\n}\n\nexport = JointPose;",
    "import ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\n\n/**\n * ...\n */\nclass ParticleAnimationData\n{\n\tpublic index:number /*uint*/;\n\tpublic startTime:number;\n\tpublic totalTime:number;\n\tpublic duration:number;\n\tpublic delay:number;\n\tpublic startVertexIndex:number /*uint*/;\n\tpublic numVertices:number /*uint*/;\n\n\tconstructor(index:number /*uint*/, startTime:number, duration:number, delay:number, particle:ParticleData)\n\t{\n\t\tthis.index = index;\n\t\tthis.startTime = startTime;\n\t\tthis.totalTime = duration + delay;\n\t\tthis.duration = duration;\n\t\tthis.delay = delay;\n\t\tthis.startVertexIndex = particle.startVertexIndex;\n\t\tthis.numVertices = particle.numVertices;\n\t}\n}\n\nexport = ParticleAnimationData;",
    "import TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\n\nclass ParticleData\n{\n\tpublic particleIndex:number /*uint*/;\n\tpublic numVertices:number /*uint*/;\n\tpublic startVertexIndex:number /*uint*/;\n\tpublic subGeometry:TriangleSubGeometry;\n}\n\nexport = ParticleData",
    "/**\n * Options for setting the properties mode of a particle animation node.\n */\nclass ParticlePropertiesMode\n{\n\t/**\n\t * Mode that defines the particle node as acting on global properties (ie. the properties set in the node constructor or the corresponding animation state).\n\t */\n\tpublic static GLOBAL:number /*uint*/ = 0;\n\n\t/**\n\t * Mode that defines the particle node as acting on local static properties (ie. the properties of particles set in the initialising on the animation set).\n\t */\n\tpublic static LOCAL_STATIC:number /*uint*/ = 1;\n\n\t/**\n\t * Mode that defines the particle node as acting on local dynamic properties (ie. the properties of the particles set in the corresponding animation state).\n\t */\n\tpublic static LOCAL_DYNAMIC:number /*uint*/ = 2;\n}\n\nexport = ParticlePropertiesMode;",
    "/**\n * Dynamic class for holding the local properties of a particle, used for processing the static properties\n * of particles in the particle animation set before beginning upload to the GPU.\n */\nclass ParticleProperties\n{\n\t/**\n\t * The index of the current particle being set.\n\t */\n\tpublic index:number /*uint*/;\n\n\t/**\n\t * The total number of particles being processed by the particle animation set.\n\t */\n\tpublic total:number /*uint*/;\n\n\t/**\n\t * The start time of the particle.\n\t */\n\tpublic startTime:number;\n\n\t/**\n\t * The duration of the particle, an optional value used when the particle aniamtion set settings for <code>useDuration</code> are enabled in the constructor.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t */\n\tpublic duration:number;\n\n\t/**\n\t * The delay between cycles of the particle, an optional value used when the particle aniamtion set settings for <code>useLooping</code> and  <code>useDelay</code> are enabled in the constructor.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t */\n\tpublic delay:number;\n}\n\nexport = ParticleProperties;",
    "/**\n * A value obect representing a single joint in a skeleton object.\n *\n * @see away.animators.Skeleton\n */\nclass SkeletonJoint\n{\n\t/**\n\t * The index of the parent joint in the skeleton's joints vector.\n\t *\n\t * @see away.animators.Skeleton#joints\n\t */\n\tpublic parentIndex:number /*int*/ = -1;\n\n\t/**\n\t * The name of the joint\n\t */\n\tpublic name:string; // intention is that this should be used only at load time, not in the main loop\n\n\t/**\n\t * The inverse bind pose matrix, as raw data, used to transform vertices to bind joint space in preparation for transformation using the joint matrix.\n\t */\n\tpublic inverseBindPose:Array<number>;\n\n\t/**\n\t * Creates a new <code>SkeletonJoint</code> object\n\t */\n\tconstructor()\n\t{\n\t}\n}\n\nexport = SkeletonJoint;",
    "import IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AssetBase\t\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\n\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\n\n\n/**\n * A collection of pose objects, determining the pose for an entire skeleton.\n * The <code>jointPoses</code> vector object corresponds to a skeleton's <code>joints</code> vector object, however, there is no\n * reference to a skeleton's instance, since several skeletons can be influenced by the same pose (eg: animation\n * clips are added to any animator with a valid skeleton)\n *\n * @see away.animators.Skeleton\n * @see away.animators.JointPose\n */\nclass SkeletonPose extends AssetBase implements IAsset\n{\n\tpublic static assetType:string = \"[asset SkeletonPose]\";\n\n\t/**\n\t * A flat list of pose objects that comprise the skeleton pose. The pose indices correspond to the target skeleton's joint indices.\n\t *\n\t * @see away.animators.Skeleton#joints\n\t */\n\tpublic jointPoses:Array<JointPose>;\n\n\t/**\n\t * The total number of joint poses in the skeleton pose.\n\t */\n\tpublic get numJointPoses():number /*uint*/\n\t{\n\t\treturn this.jointPoses.length;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonPose</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.jointPoses = new Array<JointPose>();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn SkeletonPose.assetType;\n\t}\n\n\t/**\n\t * Returns the joint pose object with the given joint name, otherwise returns a null object.\n\t *\n\t * @param jointName The name of the joint object whose pose is to be found.\n\t * @return The pose object with the given joint name.\n\t */\n\tpublic jointPoseFromName(jointName:string):JointPose\n\t{\n\t\tvar jointPoseIndex:number /*int*/ = this.jointPoseIndexFromName(jointName);\n\t\tif (jointPoseIndex != -1)\n\t\t\treturn this.jointPoses[jointPoseIndex]; else\n\t\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the pose index, given the joint name. -1 is returned if the joint name is not found in the pose.\n\t *\n\t * @param The name of the joint object whose pose is to be found.\n\t * @return The index of the pose object in the jointPoses Array\n\t *\n\t * @see #jointPoses\n\t */\n\tpublic jointPoseIndexFromName(jointName:string):number /*int*/\n\t{\n\t\t// this is implemented as a linear search, rather than a possibly\n\t\t// more optimal method (Dictionary lookup, for example) because:\n\t\t// a) it is assumed that it will be called once for each joint\n\t\t// b) it is assumed that it will be called only during load, and not during main loop\n\t\t// c) maintaining a dictionary (for safety) would dictate an interface to access JointPoses,\n\t\t//    rather than direct array access.  this would be sub-optimal.\n\t\tvar jointPoseIndex:number /*int*/;\n\t\tvar jointPose:JointPose;\n\t\tfor (var i:number /*uint*/; i < this.jointPoses.length; i++) {\n\t\t\tjointPose = this.jointPoses[i];\n\t\t\tif (jointPose.name == jointName)\n\t\t\t\treturn jointPoseIndex;\n\t\t\tjointPoseIndex++;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\t/**\n\t * Creates a copy of the <code>SkeletonPose</code> object, with a dulpicate of its component joint poses.\n\t *\n\t * @return SkeletonPose\n\t */\n\tpublic clone():SkeletonPose\n\t{\n\t\tvar clone:SkeletonPose = new SkeletonPose();\n\t\tvar numJointPoses:number /*uint*/ = this.jointPoses.length;\n\t\tfor (var i:number /*uint*/ = 0; i < numJointPoses; i++) {\n\t\t\tvar cloneJointPose:JointPose = new JointPose();\n\t\t\tvar thisJointPose:JointPose = this.jointPoses[i];\n\t\t\tcloneJointPose.name = thisJointPose.name;\n\t\t\tcloneJointPose.copyFrom(thisJointPose);\n\t\t\tclone.jointPoses[i] = cloneJointPose;\n\t\t}\n\t\treturn clone;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tthis.jointPoses.length = 0;\n\t}\n}\n\nexport = SkeletonPose;",
    "import SkeletonJoint\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonJoint\");\n\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AssetBase\t\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\n\n/**\n * A Skeleton object is a hierarchical grouping of joint objects that can be used for skeletal animation.\n *\n * @see away.animators.SkeletonJoint\n */\nclass Skeleton extends AssetBase implements IAsset\n{\n\tpublic static assetType:string = \"[asset Skeleton]\";\n\n\t/**\n\t * A flat list of joint objects that comprise the skeleton. Every joint except for the root has a parentIndex\n\t * property that is an index into this list.\n\t * A child joint should always have a higher index than its parent.\n\t */\n\tpublic joints:Array<SkeletonJoint>;\n\n\t/**\n\t * The total number of joints in the skeleton.\n\t */\n\tpublic get numJoints():number /*uint*/\n\t{\n\t\treturn this.joints.length;\n\t}\n\n\t/**\n\t * Creates a new <code>Skeleton</code> object\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\t// in the long run, it might be a better idea to not store Joint objects, but keep all data in Vectors, that we can upload easily?\n\t\tthis.joints = new Array<SkeletonJoint>();\n\t}\n\n\t/**\n\t * Returns the joint object in the skeleton with the given name, otherwise returns a null object.\n\t *\n\t * @param jointName The name of the joint object to be found.\n\t * @return The joint object with the given name.\n\t *\n\t * @see #joints\n\t */\n\tpublic jointFromName(jointName:string):SkeletonJoint\n\t{\n\t\tvar jointIndex:number /*int*/ = this.jointIndexFromName(jointName);\n\t\tif (jointIndex != -1)\n\t\t\treturn this.joints[jointIndex]; else\n\t\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the joint index, given the joint name. -1 is returned if the joint name is not found.\n\t *\n\t * @param jointName The name of the joint object to be found.\n\t * @return The index of the joint object in the joints Array\n\t *\n\t * @see #joints\n\t */\n\tpublic jointIndexFromName(jointName:string):number /*int*/\n\t{\n\t\t// this is implemented as a linear search, rather than a possibly\n\t\t// more optimal method (Dictionary lookup, for example) because:\n\t\t// a) it is assumed that it will be called once for each joint\n\t\t// b) it is assumed that it will be called only during load, and not during main loop\n\t\t// c) maintaining a dictionary (for safety) would dictate an interface to access SkeletonJoints,\n\t\t//    rather than direct array access.  this would be sub-optimal.\n\t\tvar jointIndex:number /*int*/;\n\t\tvar joint:SkeletonJoint;\n\t\tfor (var i:number /*int*/; i < this.joints.length; i++) {\n\t\t\tjoint = this.joints[i];\n\t\t\tif (joint.name == jointName)\n\t\t\t\treturn jointIndex;\n\t\t\tjointIndex++;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tthis.joints.length = 0;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn Skeleton.assetType;\n\t}\n}\n\nexport = Skeleton;",
    "/**\n * Options for setting the animation mode of a vertex animator object.\n *\n * @see away.animators.VertexAnimator\n */\nclass VertexAnimationMode\n{\n\t/**\n\t * Animation mode that adds all outputs from active vertex animation state to form the current vertex animation pose.\n\t */\n\tpublic static ADDITIVE:string = \"additive\";\n\n\t/**\n\t * Animation mode that picks the output from a single vertex animation state to form the current vertex animation pose.\n\t */\n\tpublic static ABSOLUTE:string = \"absolute\";\n}\n\nexport = VertexAnimationMode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\n/**\n * Provides an abstract base class for nodes with time-based animation data in an animation blend tree.\n */\nclass AnimationClipNodeBase extends AnimationNodeBase\n{\n\tpublic _pLooping:boolean = true;\n\tpublic _pTotalDuration:number /*uint*/ = 0;\n\tpublic _pLastFrame:number /*uint*/;\n\n\tpublic _pStitchDirty:boolean = true;\n\tpublic _pStitchFinalFrame:boolean = false;\n\tpublic _pNumFrames:number /*uint*/ = 0;\n\n\tpublic _pDurations:Array<number> = new Array<number>();\n\t/*uint*/\n\tpublic _pTotalDelta:Vector3D = new Vector3D();\n\n\tpublic fixedFrameRate:boolean = true;\n\n\t/**\n\t * Determines whether the contents of the animation node have looping characteristics enabled.\n\t */\n\tpublic get looping():boolean\n\t{\n\t\treturn this._pLooping;\n\t}\n\n\tpublic set looping(value:boolean)\n\t{\n\t\tif (this._pLooping == value)\n\t\t\treturn;\n\n\t\tthis._pLooping = value;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\t/**\n\t * Defines if looping content blends the final frame of animation data with the first (true) or works on the\n\t * assumption that both first and last frames are identical (false). Defaults to false.\n\t */\n\tpublic get stitchFinalFrame():boolean\n\t{\n\t\treturn this._pStitchFinalFrame;\n\t}\n\n\tpublic set stitchFinalFrame(value:boolean)\n\t{\n\t\tif (this._pStitchFinalFrame == value)\n\t\t\treturn;\n\n\t\tthis._pStitchFinalFrame = value;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\tpublic get totalDuration():number /*uint*/\n\t{\n\t\tif (this._pStitchDirty)\n\t\t\tthis._pUpdateStitch();\n\n\t\treturn this._pTotalDuration;\n\t}\n\n\tpublic get totalDelta():Vector3D\n\t{\n\t\tif (this._pStitchDirty)\n\t\t\tthis._pUpdateStitch();\n\n\t\treturn this._pTotalDelta;\n\t}\n\n\tpublic get lastFrame():number /*uint*/\n\t{\n\t\tif (this._pStitchDirty)\n\t\t\tthis._pUpdateStitch();\n\n\t\treturn this._pLastFrame;\n\t}\n\n\t/**\n\t * Returns a vector of time values representing the duration (in milliseconds) of each animation frame in the clip.\n\t */\n\tpublic get durations():Array<number> /*uint*/\n\t{\n\t\treturn this._pDurations;\n\t}\n\n\t/**\n\t * Creates a new <code>AnimationClipNodeBase</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Updates the node's final frame stitch state.\n\t *\n\t * @see #stitchFinalFrame\n\t */\n\tpublic _pUpdateStitch()\n\t{\n\t\tthis._pStitchDirty = false;\n\n\t\tthis._pLastFrame = (this._pStitchFinalFrame)? this._pNumFrames : this._pNumFrames - 1;\n\n\t\tthis._pTotalDuration = 0;\n\t\tthis._pTotalDelta.x = 0;\n\t\tthis._pTotalDelta.y = 0;\n\t\tthis._pTotalDelta.z = 0;\n\t}\n}\n\nexport = AnimationClipNodeBase;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleAccelerationState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleAccelerationState\");\n\n/**\n * A particle animation node used to apply a constant acceleration vector to the motion of a particle.\n */\nclass ParticleAccelerationNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _acceleration:Vector3D;\n\n\t/**\n\t * Reference for acceleration node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the direction of acceleration on the particle.\n\t */\n\tpublic static ACCELERATION_VECTOR3D:string = \"AccelerationVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleAccelerationNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] acceleration    Defines the default acceleration vector of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, acceleration:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleAcceleration\", mode, 3);\n\n\t\tthis._pStateClass = ParticleAccelerationState;\n\n\t\tthis._acceleration = acceleration || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pGetAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar accelerationValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleAccelerationState.ACCELERATION_INDEX, accelerationValue.index);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\n\t\tvar code:string = \"mul \" + temp + \",\" + animationRegisterCache.vertexTime + \",\" + accelerationValue + \"\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"mul \" + temp2 + \",\" + temp + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + temp2 + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t}\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tcode += \"mul \" + temp + \",\" + temp + \",\" + animationRegisterCache.vertexTime + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + temp + \",\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleAccelerationState\n\t{\n\t\treturn <ParticleAccelerationState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar tempAcceleration:Vector3D = param[ParticleAccelerationNode.ACCELERATION_VECTOR3D];\n\t\tif (!tempAcceleration)\n\t\t\tthrow new Error(\"there is no \" + ParticleAccelerationNode.ACCELERATION_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = tempAcceleration.x/2;\n\t\tthis._pOneData[1] = tempAcceleration.y/2;\n\t\tthis._pOneData[2] = tempAcceleration.z/2;\n\t}\n}\n\nexport = ParticleAccelerationNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleBezierCurveState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleBezierCurveState\");\n\n/**\n * A particle animation node used to control the position of a particle over time along a bezier curve.\n */\nclass ParticleBezierCurveNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iControlPoint:Vector3D;\n\t/** @private */\n\tpublic _iEndPoint:Vector3D;\n\n\t/**\n\t * Reference for bezier curve node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the control point position (0, 1, 2) of the curve.\n\t */\n\tpublic static BEZIER_CONTROL_VECTOR3D:string = \"BezierControlVector3D\";\n\n\t/**\n\t * Reference for bezier curve node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the end point position (0, 1, 2) of the curve.\n\t */\n\tpublic static BEZIER_END_VECTOR3D:string = \"BezierEndVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleBezierCurveNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] controlPoint    Defines the default control point of the node, used when in global mode.\n\t * @param    [optional] endPoint        Defines the default end point of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, controlPoint:Vector3D = null, endPoint:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleBezierCurve\", mode, 6);\n\n\t\tthis._pStateClass = ParticleBezierCurveState;\n\n\t\tthis._iControlPoint = controlPoint || new Vector3D();\n\t\tthis._iEndPoint = endPoint || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar controlValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleBezierCurveState.BEZIER_CONTROL_INDEX, controlValue.index);\n\n\t\tvar endValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleBezierCurveState.BEZIER_END_INDEX, endValue.index);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar rev_time:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\tvar time_2:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\tvar time_temp:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar distance:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"sub \" + rev_time + \",\" + animationRegisterCache.vertexOneConst + \",\" + animationRegisterCache.vertexLife + \"\\n\";\n\t\tcode += \"mul \" + time_2 + \",\" + animationRegisterCache.vertexLife + \",\" + animationRegisterCache.vertexLife + \"\\n\";\n\n\t\tcode += \"mul \" + time_temp + \",\" + animationRegisterCache.vertexLife + \",\" + rev_time + \"\\n\";\n\t\tcode += \"mul \" + time_temp + \",\" + time_temp + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\tcode += \"mul \" + distance + \".xyz,\" + time_temp + \",\" + controlValue + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\tcode += \"mul \" + distance + \".xyz,\" + time_2 + \",\" + endValue + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tcode += \"mul \" + time_2 + \",\" + animationRegisterCache.vertexLife + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"sub \" + time_temp + \",\" + animationRegisterCache.vertexOneConst + \",\" + time_2 + \"\\n\";\n\t\t\tcode += \"mul \" + time_temp + \",\" + animationRegisterCache.vertexTwoConst + \",\" + time_temp + \"\\n\";\n\t\t\tcode += \"mul \" + distance + \".xyz,\" + controlValue + \",\" + time_temp + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t\tcode += \"mul \" + distance + \".xyz,\" + endValue + \",\" + time_2 + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleBezierCurveState\n\t{\n\t\treturn <ParticleBezierCurveState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar bezierControl:Vector3D = param[ParticleBezierCurveNode.BEZIER_CONTROL_VECTOR3D];\n\t\tif (!bezierControl)\n\t\t\tthrow new Error(\"there is no \" + ParticleBezierCurveNode.BEZIER_CONTROL_VECTOR3D + \" in param!\");\n\n\t\tvar bezierEnd:Vector3D = param[ParticleBezierCurveNode.BEZIER_END_VECTOR3D];\n\t\tif (!bezierEnd)\n\t\t\tthrow new Error(\"there is no \" + ParticleBezierCurveNode.BEZIER_END_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = bezierControl.x;\n\t\tthis._pOneData[1] = bezierControl.y;\n\t\tthis._pOneData[2] = bezierControl.z;\n\t\tthis._pOneData[3] = bezierEnd.x;\n\t\tthis._pOneData[4] = bezierEnd.y;\n\t\tthis._pOneData[5] = bezierEnd.z;\n\t}\n}\n\nexport = ParticleBezierCurveNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleBillboardState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleBillboardState\");\n\n/**\n * A particle animation node that controls the rotation of a particle to always face the camera.\n */\nclass ParticleBillboardNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iBillboardAxis:Vector3D;\n\n\t/**\n\t * Creates a new <code>ParticleBillboardNode</code>\n\t */\n\tconstructor(billboardAxis:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleBillboard\", ParticlePropertiesMode.GLOBAL, 0, 4);\n\n\t\tthis._pStateClass = ParticleBillboardState;\n\n\t\tthis._iBillboardAxis = billboardAxis;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar rotationMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleBillboardState.MATRIX_INDEX, rotationMatrixRegister.index);\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\tvar code:string = \"m33 \" + temp + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \",\" + rotationMatrixRegister + \"\\n\" +\n\t\t\t\t\t\t  \"mov \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp + \"\\n\";\n\n\t\tvar shaderRegisterElement:ShaderRegisterElement;\n\t\tfor (var i:number /*uint*/ = 0; i < animationRegisterCache.rotationRegisters.length; i++) {\n\t\t\tshaderRegisterElement = animationRegisterCache.rotationRegisters[i];\n\t\t\tcode += \"m33 \" + temp + \".xyz,\" + shaderRegisterElement + \",\" + rotationMatrixRegister + \"\\n\" +\n\t\t\t\t\t\"mov \" + shaderRegisterElement + \".xyz,\" + shaderRegisterElement + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleBillboardState\n\t{\n\t\treturn <ParticleBillboardState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.hasBillboard = true;\n\t}\n}\n\nexport = ParticleBillboardNode;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleColorState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleColorState\");\n\n/**\n * A particle animation node used to control the color variation of a particle over time.\n */\nclass ParticleColorNode extends ParticleNodeBase\n{\n\t//default values used when creating states\n\t/** @private */\n\tpublic _iUsesMultiplier:boolean;\n\t/** @private */\n\tpublic _iUsesOffset:boolean;\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\t/** @private */\n\tpublic _iStartColor:ColorTransform;\n\t/** @private */\n\tpublic _iEndColor:ColorTransform;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\n\t/**\n\t * Reference for color node properties on a single particle (when in local property mode).\n\t * Expects a <code>ColorTransform</code> object representing the start color transform applied to the particle.\n\t */\n\tpublic static COLOR_START_COLORTRANSFORM:string = \"ColorStartColorTransform\";\n\n\t/**\n\t * Reference for color node properties on a single particle (when in local property mode).\n\t * Expects a <code>ColorTransform</code> object representing the end color transform applied to the particle.\n\t */\n\tpublic static COLOR_END_COLORTRANSFORM:string = \"ColorEndColorTransform\";\n\n\t/**\n\t * Creates a new <code>ParticleColorNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] usesMultiplier  Defines whether the node uses multiplier data in the shader for its color transformations. Defaults to true.\n\t * @param    [optional] usesOffset      Defines whether the node uses offset data in the shader for its color transformations. Defaults to true.\n\t * @param    [optional] usesCycle       Defines whether the node uses the <code>cycleDuration</code> property in the shader to calculate the period of the animation independent of particle duration. Defaults to false.\n\t * @param    [optional] usesPhase       Defines whether the node uses the <code>cyclePhase</code> property in the shader to calculate a starting offset to the cycle rotation of the particle. Defaults to false.\n\t * @param    [optional] startColor      Defines the default start color transform of the node, when in global mode.\n\t * @param    [optional] endColor        Defines the default end color transform of the node, when in global mode.\n\t * @param    [optional] cycleDuration   Defines the duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tconstructor(mode:number /*uint*/, usesMultiplier:boolean = true, usesOffset:boolean = true, usesCycle:boolean = false, usesPhase:boolean = false, startColor:ColorTransform = null, endColor:ColorTransform = null, cycleDuration:number = 1, cyclePhase:number = 0)\n\t{\n\t\tsuper(\"ParticleColor\", mode, (usesMultiplier && usesOffset)? 16 : 8, ParticleAnimationSet.COLOR_PRIORITY);\n\n\t\tthis._pStateClass = ParticleColorState;\n\n\t\tthis._iUsesMultiplier = usesMultiplier;\n\t\tthis._iUsesOffset = usesOffset;\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iStartColor = startColor || new ColorTransform();\n\t\tthis._iEndColor = endColor || new ColorTransform();\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iCyclePhase = cyclePhase;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tif (this._iUsesCycle) {\n\t\t\t\tvar cycleConst:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.CYCLE_INDEX, cycleConst.index);\n\n\t\t\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\t\t\tvar sin:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\t\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\t\t\tcode += \"mul \" + sin + \",\" + animationRegisterCache.vertexTime + \",\" + cycleConst + \".x\\n\";\n\n\t\t\t\tif (this._iUsesPhase)\n\t\t\t\t\tcode += \"add \" + sin + \",\" + sin + \",\" + cycleConst + \".y\\n\";\n\n\t\t\t\tcode += \"sin \" + sin + \",\" + sin + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tvar startMultiplierValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\t\t\tvar deltaMultiplierValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.START_MULTIPLIER_INDEX, startMultiplierValue.index);\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.DELTA_MULTIPLIER_INDEX, deltaMultiplierValue.index);\n\n\t\t\t\tcode += \"mul \" + temp + \",\" + deltaMultiplierValue + \",\" + (this._iUsesCycle? sin : animationRegisterCache.vertexLife) + \"\\n\";\n\t\t\t\tcode += \"add \" + temp + \",\" + temp + \",\" + startMultiplierValue + \"\\n\";\n\t\t\t\tcode += \"mul \" + animationRegisterCache.colorMulTarget + \",\" + temp + \",\" + animationRegisterCache.colorMulTarget + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tvar startOffsetValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.LOCAL_STATIC)? animationRegisterCache.getFreeVertexAttribute() : animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tvar deltaOffsetValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.LOCAL_STATIC)? animationRegisterCache.getFreeVertexAttribute() : animationRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.START_OFFSET_INDEX, startOffsetValue.index);\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleColorState.DELTA_OFFSET_INDEX, deltaOffsetValue.index);\n\n\t\t\t\tcode += \"mul \" + temp + \",\" + deltaOffsetValue + \",\" + (this._iUsesCycle? sin : animationRegisterCache.vertexLife) + \"\\n\";\n\t\t\t\tcode += \"add \" + temp + \",\" + temp + \",\" + startOffsetValue + \"\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + temp + \",\" + animationRegisterCache.colorAddTarget + \"\\n\";\n\t\t\t}\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleColorState\n\t{\n\t\treturn <ParticleColorState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tif (this._iUsesMultiplier)\n\t\t\tparticleAnimationSet.hasColorMulNode = true;\n\t\tif (this._iUsesOffset)\n\t\t\tparticleAnimationSet.hasColorAddNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar startColor:ColorTransform = param[ParticleColorNode.COLOR_START_COLORTRANSFORM];\n\t\tif (!startColor)\n\t\t\tthrow(new Error(\"there is no \" + ParticleColorNode.COLOR_START_COLORTRANSFORM + \" in param!\"));\n\n\t\tvar endColor:ColorTransform = param[ParticleColorNode.COLOR_END_COLORTRANSFORM];\n\t\tif (!endColor)\n\t\t\tthrow(new Error(\"there is no \" + ParticleColorNode.COLOR_END_COLORTRANSFORM + \" in param!\"));\n\n\t\tvar i:number /*uint*/ = 0;\n\n\t\tif (!this._iUsesCycle) {\n\t\t\t//multiplier\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tthis._pOneData[i++] = startColor.redMultiplier;\n\t\t\t\tthis._pOneData[i++] = startColor.greenMultiplier;\n\t\t\t\tthis._pOneData[i++] = startColor.blueMultiplier;\n\t\t\t\tthis._pOneData[i++] = startColor.alphaMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.redMultiplier - startColor.redMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.greenMultiplier - startColor.greenMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.blueMultiplier - startColor.blueMultiplier;\n\t\t\t\tthis._pOneData[i++] = endColor.alphaMultiplier - startColor.alphaMultiplier;\n\t\t\t}\n\n\t\t\t//offset\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tthis._pOneData[i++] = startColor.redOffset/255;\n\t\t\t\tthis._pOneData[i++] = startColor.greenOffset/255;\n\t\t\t\tthis._pOneData[i++] = startColor.blueOffset/255;\n\t\t\t\tthis._pOneData[i++] = startColor.alphaOffset/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.redOffset - startColor.redOffset)/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.greenOffset - startColor.greenOffset)/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.blueOffset - startColor.blueOffset)/255;\n\t\t\t\tthis._pOneData[i++] = (endColor.alphaOffset - startColor.alphaOffset)/255;\n\t\t\t}\n\t\t} else {\n\t\t\t//multiplier\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tthis._pOneData[i++] = (startColor.redMultiplier + endColor.redMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.greenMultiplier + endColor.greenMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.blueMultiplier + endColor.blueMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaMultiplier + endColor.alphaMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.redMultiplier - endColor.redMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.greenMultiplier - endColor.greenMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.blueMultiplier - endColor.blueMultiplier)/2;\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaMultiplier - endColor.alphaMultiplier)/2;\n\t\t\t}\n\n\t\t\t//offset\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tthis._pOneData[i++] = (startColor.redOffset + endColor.redOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.greenOffset + endColor.greenOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.blueOffset + endColor.blueOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaOffset + endColor.alphaOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.redOffset - endColor.redOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.greenOffset - endColor.greenOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.blueOffset - endColor.blueOffset)/(255*2);\n\t\t\t\tthis._pOneData[i++] = (startColor.alphaOffset - endColor.alphaOffset)/(255*2);\n\t\t\t}\n\t\t}\n\n\t}\n}\n\nexport = ParticleColorNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleFollowState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleFollowState\");\n\n/**\n * A particle animation node used to create a follow behaviour on a particle system.\n */\nclass ParticleFollowNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesPosition:boolean;\n\n\t/** @private */\n\tpublic _iUsesRotation:boolean;\n\n\t/** @private */\n\tpublic _iSmooth:boolean;\n\n\t/**\n\t * Creates a new <code>ParticleFollowNode</code>\n\t *\n\t * @param    [optional] usesPosition     Defines wehether the individual particle reacts to the position of the target.\n\t * @param    [optional] usesRotation     Defines wehether the individual particle reacts to the rotation of the target.\n\t * @param    [optional] smooth     Defines wehether the state calculate the interpolated value.\n\t */\n\tconstructor(usesPosition:boolean = true, usesRotation:boolean = true, smooth:boolean = false)\n\t{\n\t\tsuper(\"ParticleFollow\", ParticlePropertiesMode.LOCAL_DYNAMIC, (usesPosition && usesRotation)? 6 : 3, ParticleAnimationSet.POST_PRIORITY);\n\n\t\tthis._pStateClass = ParticleFollowState;\n\n\t\tthis._iUsesPosition = usesPosition;\n\t\tthis._iUsesRotation = usesRotation;\n\t\tthis._iSmooth = smooth;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\t//TODO: use Quaternion to implement this function\n\t\tvar code:string = \"\";\n\t\tif (this._iUsesRotation) {\n\t\t\tvar rotationAttribute:ShaderRegisterElement = animationRegisterCache.getFreeVertexAttribute();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleFollowState.FOLLOW_ROTATION_INDEX, rotationAttribute.index);\n\n\t\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp2, 1);\n\t\t\tvar temp3:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tvar temp4:ShaderRegisterElement;\n\t\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\t\tanimationRegisterCache.addVertexTempUsages(temp3, 1);\n\t\t\t\ttemp4 = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\t}\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp2);\n\t\t\tif (animationRegisterCache.hasBillboard)\n\t\t\t\tanimationRegisterCache.removeVertexTempUsage(temp3);\n\n\t\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\t\tvar i:number /*int*/;\n\n\t\t\t//x axis\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"sin \" + temp3 + \".y,\" + rotationAttribute + \".x\\n\";\n\t\t\tcode += \"cos \" + temp3 + \".z,\" + rotationAttribute + \".x\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".x,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + temp3 + \".z\\n\";\n\t\t\tcode += \"neg \" + temp2 + \".z,\" + temp3 + \".y\\n\";\n\n\t\t\tif (animationRegisterCache.hasBillboard)\n\t\t\t\tcode += \"m33 \" + temp4 + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\telse {\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t\t}\n\n\t\t\t//y axis\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"cos \" + temp1 + \".x,\" + rotationAttribute + \".y\\n\";\n\t\t\tcode += \"sin \" + temp1 + \".z,\" + rotationAttribute + \".y\\n\";\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"neg \" + temp3 + \".x,\" + temp1 + \".z\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + temp1 + \".x\\n\";\n\n\t\t\tif (animationRegisterCache.hasBillboard)\n\t\t\t\tcode += \"m33 \" + temp4 + \".xyz,\" + temp4 + \".xyz,\" + temp1 + \"\\n\";\n\t\t\telse {\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t\t}\n\n\t\t\t//z axis\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"sin \" + temp2 + \".x,\" + rotationAttribute + \".z\\n\";\n\t\t\tcode += \"cos \" + temp2 + \".y,\" + rotationAttribute + \".z\\n\";\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + temp2 + \".y\\n\";\n\t\t\tcode += \"neg \" + temp1 + \".y,\" + temp2 + \".x\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\n\t\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\t\tcode += \"m33 \" + temp4 + \".xyz,\" + temp4 + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tcode += \"sub \" + temp4 + \".xyz,\" + temp4 + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp4 + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t\t} else {\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t\t}\n\n\t\t}\n\n\t\tif (this._iUsesPosition) {\n\t\t\tvar positionAttribute:ShaderRegisterElement = animationRegisterCache.getFreeVertexAttribute();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleFollowState.FOLLOW_POSITION_INDEX, positionAttribute.index);\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + positionAttribute + \",\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleFollowState\n\t{\n\t\treturn <ParticleFollowState> animator.getAnimationState(this);\n\t}\n}\n\nexport = ParticleFollowNode;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleInitialColorState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleInitialColorState\");\n\n/**\n *\n */\nclass ParticleInitialColorNode extends ParticleNodeBase\n{\n\t//default values used when creating states\n\t/** @private */\n\tpublic _iUsesMultiplier:boolean;\n\t/** @private */\n\tpublic _iUsesOffset:boolean;\n\t/** @private */\n\tpublic _iInitialColor:ColorTransform;\n\n\t/**\n\t * Reference for color node properties on a single particle (when in local property mode).\n\t * Expects a <code>ColorTransform</code> object representing the color transform applied to the particle.\n\t */\n\tpublic static COLOR_INITIAL_COLORTRANSFORM:string = \"ColorInitialColorTransform\";\n\n\tconstructor(mode:number /*uint*/, usesMultiplier:boolean = true, usesOffset:boolean = false, initialColor:ColorTransform = null)\n\t{\n\t\tsuper(\"ParticleInitialColor\", mode, (usesMultiplier && usesOffset)? 8 : 4, ParticleAnimationSet.COLOR_PRIORITY);\n\n\t\tthis._pStateClass = ParticleInitialColorState;\n\n\t\tthis._iUsesMultiplier = usesMultiplier;\n\t\tthis._iUsesOffset = usesOffset;\n\t\tthis._iInitialColor = initialColor || new ColorTransform();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tvar multiplierValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleInitialColorState.MULTIPLIER_INDEX, multiplierValue.index);\n\n\t\t\t\tcode += \"mul \" + animationRegisterCache.colorMulTarget + \",\" + multiplierValue + \",\" + animationRegisterCache.colorMulTarget + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tvar offsetValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.LOCAL_STATIC)? animationRegisterCache.getFreeVertexAttribute() : animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleInitialColorState.OFFSET_INDEX, offsetValue.index);\n\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + offsetValue + \",\" + animationRegisterCache.colorAddTarget + \"\\n\";\n\t\t\t}\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tif (this._iUsesMultiplier)\n\t\t\tparticleAnimationSet.hasColorMulNode = true;\n\t\tif (this._iUsesOffset)\n\t\t\tparticleAnimationSet.hasColorAddNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar initialColor:ColorTransform = param[ParticleInitialColorNode.COLOR_INITIAL_COLORTRANSFORM];\n\t\tif (!initialColor)\n\t\t\tthrow(new Error(\"there is no \" + ParticleInitialColorNode.COLOR_INITIAL_COLORTRANSFORM + \" in param!\"));\n\n\t\tvar i:number /*uint*/ = 0;\n\n\t\t//multiplier\n\t\tif (this._iUsesMultiplier) {\n\t\t\tthis._pOneData[i++] = initialColor.redMultiplier;\n\t\t\tthis._pOneData[i++] = initialColor.greenMultiplier;\n\t\t\tthis._pOneData[i++] = initialColor.blueMultiplier;\n\t\t\tthis._pOneData[i++] = initialColor.alphaMultiplier;\n\t\t}\n\t\t//offset\n\t\tif (this._iUsesOffset) {\n\t\t\tthis._pOneData[i++] = initialColor.redOffset/255;\n\t\t\tthis._pOneData[i++] = initialColor.greenOffset/255;\n\t\t\tthis._pOneData[i++] = initialColor.blueOffset/255;\n\t\t\tthis._pOneData[i++] = initialColor.alphaOffset/255;\n\t\t}\n\n\t}\n\n}\n\nexport = ParticleInitialColorNode;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\n\n/**\n * Provides an abstract base class for particle animation nodes.\n */\nclass ParticleNodeBase extends AnimationNodeBase\n{\n\tprivate _priority:number /*int*/;\n\n\tpublic _pMode:number /*uint*/;\n\tpublic _pDataLength:number /*uint*/ = 3;\n\tpublic _pOneData:Array<number>;\n\n\tpublic _iDataOffset:number /*uint*/;\n\n\t//modes alias\n\tprivate static GLOBAL:string = 'Global';\n\tprivate static LOCAL_STATIC:string = 'LocalStatic';\n\tprivate static LOCAL_DYNAMIC:string = 'LocalDynamic';\n\n\t//modes list\n\tprivate static MODES:Object =\n\t{\n\t\t0:ParticleNodeBase.GLOBAL,\n\t\t1:ParticleNodeBase.LOCAL_STATIC,\n\t\t2:ParticleNodeBase.LOCAL_DYNAMIC\n\t};\n\n\t/**\n\t * Returns the property mode of the particle animation node. Typically set in the node constructor\n\t *\n\t * @see away.animators.ParticlePropertiesMode\n\t */\n\tpublic get mode():number /*uint*/\n\t{\n\t\treturn this._pMode;\n\t}\n\n\t/**\n\t * Returns the priority of the particle animation node, used to order the agal generated in a particle animation set. Set automatically on instantiation.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t * @see #getAGALVertexCode\n\t */\n\tpublic get priority():number /*int*/\n\t{\n\t\treturn this._priority;\n\t}\n\n\t/**\n\t * Returns the length of the data used by the node when in <code>LOCAL_STATIC</code> mode. Used to generate the local static data of the particle animation set.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t * @see #getAGALVertexCode\n\t */\n\tpublic get dataLength():number /*int*/\n\t{\n\t\treturn this._pDataLength;\n\t}\n\n\t/**\n\t * Returns the generated data vector of the node after one particle pass during the generation of all local static data of the particle animation set.\n\t *\n\t * @see away.animators.ParticleAnimationSet\n\t * @see #generatePropertyOfOneParticle\n\t */\n\tpublic get oneData():Array<number>\n\t{\n\t\treturn this._pOneData;\n\t}\n\n\t/**\n\t * Creates a new <code>ParticleNodeBase</code> object.\n\t *\n\t * @param               name            Defines the generic name of the particle animation node.\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param               dataLength      Defines the length of the data used by the node when in <code>LOCAL_STATIC</code> mode.\n\t * @param    [optional] priority        the priority of the particle animation node, used to order the agal generated in a particle animation set. Defaults to 1.\n\t */\n\tconstructor(name:string, mode:number /*uint*/, dataLength:number /*uint*/, priority:number /*int*/ = 1)\n\t{\n\t\tsuper();\n\n\t\tname = name + ParticleNodeBase.MODES[mode];\n\n\t\tthis.name = name;\n\t\tthis._pMode = mode;\n\t\tthis._priority = priority;\n\t\tthis._pDataLength = dataLength;\n\n\t\tthis._pOneData = new Array<number>(this._pDataLength);\n\t}\n\n\t/**\n\t * Returns the AGAL code of the particle animation node for use in the vertex shader.\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Returns the AGAL code of the particle animation node for use in the fragment shader.\n\t */\n\tpublic getAGALFragmentCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Returns the AGAL code of the particle animation node for use in the fragment shader when UV coordinates are required.\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Called internally by the particle animation set when assigning the set of static properties originally defined by the initParticleFunc of the set.\n\t *\n\t * @see away.animators.ParticleAnimationSet#initParticleFunc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\n\t}\n\n\t/**\n\t * Called internally by the particle animation set when determining the requirements of the particle animation node AGAL.\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\n\t}\n}\n\nexport = ParticleNodeBase;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleOrbitState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleOrbitState\");\n\n/**\n * A particle animation node used to control the position of a particle over time around a circular orbit.\n */\nclass ParticleOrbitNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesEulers:boolean;\n\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\n\t/** @private */\n\tpublic _iRadius:number;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\t/** @private */\n\tpublic _iEulers:Vector3D;\n\n\t/**\n\t * Reference for orbit node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the radius (x), cycle speed (y) and cycle phase (z) of the motion on the particle.\n\t */\n\tpublic static ORBIT_VECTOR3D:string = \"OrbitVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleOrbitNode</code> object.\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] usesEulers      Defines whether the node uses the <code>eulers</code> property in the shader to calculate a rotation on the orbit. Defaults to true.\n\t * @param    [optional] usesCycle       Defines whether the node uses the <code>cycleDuration</code> property in the shader to calculate the period of the orbit independent of particle duration. Defaults to false.\n\t * @param    [optional] usesPhase       Defines whether the node uses the <code>cyclePhase</code> property in the shader to calculate a starting offset to the cycle rotation of the particle. Defaults to false.\n\t * @param    [optional] radius          Defines the radius of the orbit when in global mode. Defaults to 100.\n\t * @param    [optional] cycleDuration   Defines the duration of the orbit in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the phase of the orbit in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t * @param    [optional] eulers          Defines the euler rotation in degrees, applied to the orientation of the orbit when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, usesEulers:boolean = true, usesCycle:boolean = false, usesPhase:boolean = false, radius:number = 100, cycleDuration:number = 1, cyclePhase:number = 0, eulers:Vector3D = null)\n\t{\n\t\tvar len:number /*int*/ = 3;\n\t\tif (usesPhase)\n\t\t\tlen++;\n\t\tsuper(\"ParticleOrbit\", mode, len);\n\n\t\tthis._pStateClass = ParticleOrbitState;\n\n\t\tthis._iUsesEulers = usesEulers;\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iRadius = radius;\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iCyclePhase = cyclePhase;\n\t\tthis._iEulers = eulers || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar orbitRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleOrbitState.ORBIT_INDEX, orbitRegister.index);\n\n\t\tvar eulersMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleOrbitState.EULERS_INDEX, eulersMatrixRegister.index);\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\tvar distance:ShaderRegisterElement = new ShaderRegisterElement(temp1.regName, temp1.index);\n\n\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index, 0);\n\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index, 1);\n\t\tvar degree:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index, 2);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\n\t\tvar code:string = \"\";\n\n\t\tif (this._iUsesCycle) {\n\t\t\tcode += \"mul \" + degree + \",\" + animationRegisterCache.vertexTime + \",\" + orbitRegister + \".y\\n\";\n\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tcode += \"add \" + degree + \",\" + degree + \",\" + orbitRegister + \".w\\n\";\n\t\t} else\n\t\t\tcode += \"mul \" + degree + \",\" + animationRegisterCache.vertexLife + \",\" + orbitRegister + \".y\\n\";\n\n\t\tcode += \"cos \" + cos + \",\" + degree + \"\\n\";\n\t\tcode += \"sin \" + sin + \",\" + degree + \"\\n\";\n\t\tcode += \"mul \" + distance + \".x,\" + cos + \",\" + orbitRegister + \".x\\n\";\n\t\tcode += \"mul \" + distance + \".y,\" + sin + \",\" + orbitRegister + \".x\\n\";\n\t\tcode += \"mov \" + distance + \".wz\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\tif (this._iUsesEulers)\n\t\t\tcode += \"m44 \" + distance + \",\" + distance + \",\" + eulersMatrixRegister + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tcode += \"neg \" + distance + \".x,\" + sin + \"\\n\";\n\t\t\tcode += \"mov \" + distance + \".y,\" + cos + \"\\n\";\n\t\t\tcode += \"mov \" + distance + \".zw,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tif (this._iUsesEulers)\n\t\t\t\tcode += \"m44 \" + distance + \",\" + distance + \",\" + eulersMatrixRegister + \"\\n\";\n\t\t\tcode += \"mul \" + distance + \",\" + distance + \",\" + orbitRegister + \".z\\n\";\n\t\t\tcode += \"div \" + distance + \",\" + distance + \",\" + orbitRegister + \".y\\n\";\n\t\t\tif (!this._iUsesCycle)\n\t\t\t\tcode += \"div \" + distance + \",\" + distance + \",\" + animationRegisterCache.vertexLife + \"\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleOrbitState\n\t{\n\t\treturn <ParticleOrbitState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\t//Vector3D.x is radius, Vector3D.y is cycle duration, Vector3D.z is phase\n\t\tvar orbit:Vector3D = param[ParticleOrbitNode.ORBIT_VECTOR3D];\n\t\tif (!orbit)\n\t\t\tthrow new Error(\"there is no \" + ParticleOrbitNode.ORBIT_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = orbit.x;\n\t\tif (this._iUsesCycle && orbit.y <= 0)\n\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\tthis._pOneData[1] = Math.PI*2/(!this._iUsesCycle? 1 : orbit.y);\n\t\tthis._pOneData[2] = orbit.x*Math.PI*2;\n\t\tif (this._iUsesPhase)\n\t\t\tthis._pOneData[3] = orbit.z*Math.PI/180;\n\t}\n}\n\nexport = ParticleOrbitNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleOscillatorState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleOscillatorState\");\n\n/**\n * A particle animation node used to control the position of a particle over time using simple harmonic motion.\n */\nclass ParticleOscillatorNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iOscillator:Vector3D;\n\n\t/**\n\t * Reference for ocsillator node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the axis (x,y,z) and cycle speed (w) of the motion on the particle.\n\t */\n\tpublic static OSCILLATOR_VECTOR3D:string = \"OscillatorVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleOscillatorNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] oscillator      Defines the default oscillator axis (x, y, z) and cycleDuration (w) of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, oscillator:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleOscillator\", mode, 4);\n\n\t\tthis._pStateClass = ParticleOscillatorState;\n\n\t\tthis._iOscillator = oscillator || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar oscillatorRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleOscillatorState.OSCILLATOR_INDEX, oscillatorRegister.index);\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar dgree:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar distance:ShaderRegisterElement = new ShaderRegisterElement(temp2.regName, temp2.index);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"mul \" + dgree + \",\" + animationRegisterCache.vertexTime + \",\" + oscillatorRegister + \".w\\n\";\n\t\tcode += \"sin \" + sin + \",\" + dgree + \"\\n\";\n\t\tcode += \"mul \" + distance + \".xyz,\" + sin + \",\" + oscillatorRegister + \".xyz\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity) {\n\t\t\tcode += \"cos \" + cos + \",\" + dgree + \"\\n\";\n\t\t\tcode += \"mul \" + distance + \".xyz,\" + cos + \",\" + oscillatorRegister + \".xyz\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + distance + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleOscillatorState\n\t{\n\t\treturn <ParticleOscillatorState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\t//(Vector3D.x,Vector3D.y,Vector3D.z) is oscillator axis, Vector3D.w is oscillator cycle duration\n\t\tvar drift:Vector3D = param[ParticleOscillatorNode.OSCILLATOR_VECTOR3D];\n\t\tif (!drift)\n\t\t\tthrow(new Error(\"there is no \" + ParticleOscillatorNode.OSCILLATOR_VECTOR3D + \" in param!\"));\n\n\t\tthis._pOneData[0] = drift.x;\n\t\tthis._pOneData[1] = drift.y;\n\t\tthis._pOneData[2] = drift.z;\n\t\tif (drift.w <= 0)\n\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\t\tthis._pOneData[3] = Math.PI*2/drift.w;\n\t}\n}\n\nexport = ParticleOscillatorNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticlePositionState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticlePositionState\");\n\n/**\n * A particle animation node used to set the starting position of a particle.\n */\nclass ParticlePositionNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iPosition:Vector3D;\n\n\t/**\n\t * Reference for position node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing position of the particle.\n\t */\n\tpublic static POSITION_VECTOR3D:string = \"PositionVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticlePositionNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] position        Defines the default position of the particle when in global mode. Defaults to 0,0,0.\n\t */\n\tconstructor(mode:number /*uint*/, position:Vector3D = null)\n\t{\n\t\tsuper(\"ParticlePosition\", mode, 3);\n\n\t\tthis._pStateClass = ParticlePositionState;\n\n\t\tthis._iPosition = position || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar positionAttribute:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticlePositionState.POSITION_INDEX, positionAttribute.index);\n\n\t\treturn \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticlePositionState\n\t{\n\t\treturn <ParticlePositionState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar offset:Vector3D = param[ParticlePositionNode.POSITION_VECTOR3D];\n\t\tif (!offset)\n\t\t\tthrow(new Error(\"there is no \" + ParticlePositionNode.POSITION_VECTOR3D + \" in param!\"));\n\n\t\tthis._pOneData[0] = offset.x;\n\t\tthis._pOneData[1] = offset.y;\n\t\tthis._pOneData[2] = offset.z;\n\t}\n}\n\nexport = ParticlePositionNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotateToHeadingState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState\");\n\n/**\n * A particle animation node used to control the rotation of a particle to match its heading vector.\n */\nclass ParticleRotateToHeadingNode extends ParticleNodeBase\n{\n\t/**\n\t * Creates a new <code>ParticleBillboardNode</code>\n\t */\n\tconstructor()\n\t{\n\t\tsuper(\"ParticleRotateToHeading\", ParticlePropertiesMode.GLOBAL, 0, 3);\n\n\t\tthis._pStateClass = ParticleRotateToHeadingState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\tvar i:number /*int*/;\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp2, 1);\n\t\t\tvar temp3:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tvar rotationMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotateToHeadingState.MATRIX_INDEX, rotationMatrixRegister.index);\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp2);\n\n\t\t\t//process the velocity\n\t\t\tcode += \"m33 \" + temp1 + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz,\" + rotationMatrixRegister + \"\\n\";\n\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".xy,\" + temp1 + \".xy\\n\";\n\t\t\tcode += \"nrm \" + temp3 + \".xyz,\" + temp3 + \".xyz\\n\";\n\n\t\t\t//temp3.x=cos,temp3.y=sin\n\t\t\t//only process z axis\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".x,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"neg \" + temp1 + \".y,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t} else {\n\t\t\tvar nrmVel:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(nrmVel, 1);\n\n\t\t\tvar xAxis:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(xAxis, 1);\n\n\t\t\tvar R:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(R, 1);\n\t\t\tvar R_rev:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(R.regName, R.index, 3);\n\t\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(R_rev.regName, R_rev.index, 3);\n\t\t\tvar cos2:ShaderRegisterElement = new ShaderRegisterElement(nrmVel.regName, nrmVel.index, 3);\n\t\t\tvar tempSingle:ShaderRegisterElement = sin;\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(nrmVel);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(xAxis);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(R);\n\n\t\t\tcode += \"mov \" + xAxis + \".x,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mov \" + xAxis + \".yz,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\n\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t\tcode += \"dp3 \" + cos2 + \",\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + xAxis + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t//use R as temp to judge if nrm is (0,0,0).\n\t\t\t//if nrm is (0,0,0) ,change it to (0,0,1).\n\t\t\tcode += \"dp3 \" + R + \".x,\" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"sge \" + R + \".x,\" + animationRegisterCache.vertexZeroConst + \",\" + R + \".x\\n\";\n\t\t\tcode += \"add \" + nrmVel + \".z,\" + R + \".x,\" + nrmVel + \".z\\n\";\n\n\t\t\tcode += \"add \" + tempSingle + \",\" + cos2 + \",\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"sqt \" + cos + \",\" + tempSingle + \"\\n\";\n\n\t\t\tcode += \"sub \" + tempSingle + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos2 + \"\\n\";\n\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\tcode += \"sqt \" + sin + \",\" + tempSingle + \"\\n\";\n\n\t\t\tcode += \"mul \" + R + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\n\t\t\t//use cos as R.w\n\n\t\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\n\t\t\t//use cos as R_rev.w\n\n\t\t\t//nrmVel and xAxis are used as temp register\n\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + R + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\n\t\t\t//use cos as R.w\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"dp3 \" + xAxis + \".w,\" + R + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\n\t\t\tcode += \"crs \" + R + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\t//code += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" +R_rev + \".w\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\t\tcode += \"add \" + R + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t//just repeat the calculate above\n\t\t\t\t//because of the limited registers, no need to optimise\n\t\t\t\tcode += \"mov \" + xAxis + \".x,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\t\tcode += \"mov \" + xAxis + \".yz,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\t\t\t\tcode += \"dp3 \" + cos2 + \",\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + xAxis + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"nrm \" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"dp3 \" + R + \".x,\" + nrmVel + \".xyz,\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"sge \" + R + \".x,\" + animationRegisterCache.vertexZeroConst + \",\" + R + \".x\\n\";\n\t\t\t\tcode += \"add \" + nrmVel + \".z,\" + R + \".x,\" + nrmVel + \".z\\n\";\n\t\t\t\tcode += \"add \" + tempSingle + \",\" + cos2 + \",\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\t\tcode += \"sqt \" + cos + \",\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"sub \" + tempSingle + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos2 + \"\\n\";\n\t\t\t\tcode += \"div \" + tempSingle + \",\" + tempSingle + \",\" + animationRegisterCache.vertexTwoConst + \"\\n\";\n\t\t\t\tcode += \"sqt \" + sin + \",\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + R + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t\tcode += \"dp3 \" + xAxis + \".w,\" + R + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\t\t\t\tcode += \"crs \" + R + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\t\t\tcode += \"add \" + R + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + R + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\t}\n\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleRotateToHeadingState\n\t{\n\t\treturn <ParticleRotateToHeadingState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.needVelocity = true;\n\t}\n}\n\nexport = ParticleRotateToHeadingNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotateToPositionState\t= require(\"awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState\");\n\n/**\n * A particle animation node used to control the rotation of a particle to face to a position\n */\nclass ParticleRotateToPositionNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iPosition:Vector3D;\n\n\t/**\n\t * Reference for the position the particle will rotate to face for a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the position that the particle must face.\n\t */\n\tpublic static POSITION_VECTOR3D:string = \"RotateToPositionVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleRotateToPositionNode</code>\n\t */\n\tconstructor(mode:number /*uint*/, position:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleRotateToPosition\", mode, 3, 3);\n\n\t\tthis._pStateClass = ParticleRotateToPositionState;\n\n\t\tthis._iPosition = position || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar positionAttribute:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotateToPositionState.POSITION_INDEX, positionAttribute.index);\n\n\t\tvar code:string = \"\";\n\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\tvar i:number /*int*/;\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tvar temp1:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp1, 1);\n\t\t\tvar temp2:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp2, 1);\n\t\t\tvar temp3:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\tvar rotationMatrixRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotateToPositionState.MATRIX_INDEX, rotationMatrixRegister.index);\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.getFreeVertexConstant();\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp1);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp2);\n\n\t\t\t//process the position\n\t\t\tcode += \"sub \" + temp1 + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\tcode += \"m33 \" + temp1 + \".xyz,\" + temp1 + \".xyz,\" + rotationMatrixRegister + \"\\n\";\n\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".xy,\" + temp1 + \".xy\\n\";\n\t\t\tcode += \"nrm \" + temp3 + \".xyz,\" + temp3 + \".xyz\\n\";\n\n\t\t\t//temp3.x=cos,temp3.y=sin\n\t\t\t//only process z axis\n\t\t\tcode += \"mov \" + temp2 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".x,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp2 + \".y,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"mov \" + temp1 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp1 + \".x,\" + temp3 + \".x\\n\";\n\t\t\tcode += \"neg \" + temp1 + \".y,\" + temp3 + \".y\\n\";\n\t\t\tcode += \"mov \" + temp3 + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mov \" + temp3 + \".z,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"m33 \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp1 + \"\\n\";\n\t\t\tfor (i = 0; i < len; i++)\n\t\t\t\tcode += \"m33 \" + animationRegisterCache.rotationRegisters[i] + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \",\" + temp1 + \"\\n\";\n\t\t} else {\n\t\t\tvar nrmDirection:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(nrmDirection, 1);\n\n\t\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\t\tvar o_temp:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\t\tvar tempSingle:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 3);\n\n\t\t\tvar R:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(R, 1);\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(nrmDirection);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\t\t\tanimationRegisterCache.removeVertexTempUsage(R);\n\n\t\t\tcode += \"sub \" + nrmDirection + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\n\t\t\tcode += \"mov \" + sin + \",\" + nrmDirection + \".y\\n\";\n\t\t\tcode += \"mul \" + cos + \",\" + sin + \",\" + sin + \"\\n\";\n\t\t\tcode += \"sub \" + cos + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\tcode += \"sqt \" + cos + \",\" + cos + \"\\n\";\n\n\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".y\\n\";\n\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".y\\n\";\n\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\n\t\t\tcode += \"sub \" + animationRegisterCache.scaleAndRotateTarget + \".y,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\n\t\t\tcode += \"abs \" + R + \".y,\" + nrmDirection + \".y\\n\";\n\t\t\tcode += \"sge \" + R + \".z,\" + R + \".y,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\tcode += \"mul \" + R + \".x,\" + R + \".y,\" + nrmDirection + \".y\\n\";\n\n\t\t\t//judgu if nrmDirection=(0,1,0);\n\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"dp3 \" + sin + \",\" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\tcode += \"sge \" + tempSingle + \",\" + animationRegisterCache.vertexZeroConst + \",\" + sin + \"\\n\";\n\n\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\n\t\t\tcode += \"sub \" + sin + \",\" + animationRegisterCache.vertexOneConst + \",\" + tempSingle + \"\\n\";\n\t\t\tcode += \"mul \" + sin + \",\" + sin + \",\" + nrmDirection + \".x\\n\";\n\n\t\t\tcode += \"mov \" + cos + \",\" + nrmDirection + \".z\\n\";\n\t\t\tcode += \"neg \" + cos + \",\" + cos + \"\\n\";\n\t\t\tcode += \"sub \" + o_temp + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\tcode += \"mul \" + o_temp + \",\" + R + \".x,\" + tempSingle + \"\\n\";\n\t\t\tcode += \"add \" + cos + \",\" + cos + \",\" + o_temp + \"\\n\";\n\n\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".x\\n\";\n\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.scaleAndRotateTarget + \".x\\n\";\n\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".z\\n\";\n\n\t\t\tcode += \"sub \" + animationRegisterCache.scaleAndRotateTarget + \".x,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t//just repeat the calculate above\n\t\t\t\t//because of the limited registers, no need to optimise\n\t\t\t\tcode += \"sub \" + nrmDirection + \".xyz,\" + positionAttribute + \".xyz,\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\t\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\t\tcode += \"mov \" + sin + \",\" + nrmDirection + \".y\\n\";\n\t\t\t\tcode += \"mul \" + cos + \",\" + sin + \",\" + sin + \"\\n\";\n\t\t\t\tcode += \"sub \" + cos + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"sqt \" + cos + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".y\\n\";\n\t\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".y\\n\";\n\t\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"sub \" + animationRegisterCache.rotationRegisters[i] + \".y,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\t\t\t\tcode += \"abs \" + R + \".y,\" + nrmDirection + \".y\\n\";\n\t\t\t\tcode += \"sge \" + R + \".z,\" + R + \".y,\" + animationRegisterCache.vertexOneConst + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".x,\" + R + \".y,\" + nrmDirection + \".y\\n\";\n\t\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\tcode += \"dp3 \" + sin + \",\" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\t\tcode += \"sge \" + tempSingle + \",\" + animationRegisterCache.vertexZeroConst + \",\" + sin + \"\\n\";\n\t\t\t\tcode += \"mov \" + nrmDirection + \".y,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\tcode += \"nrm \" + nrmDirection + \".xyz,\" + nrmDirection + \".xyz\\n\";\n\t\t\t\tcode += \"sub \" + sin + \",\" + animationRegisterCache.vertexOneConst + \",\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"mul \" + sin + \",\" + sin + \",\" + nrmDirection + \".x\\n\";\n\t\t\t\tcode += \"mov \" + cos + \",\" + nrmDirection + \".z\\n\";\n\t\t\t\tcode += \"neg \" + cos + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"sub \" + o_temp + \",\" + animationRegisterCache.vertexOneConst + \",\" + cos + \"\\n\";\n\t\t\t\tcode += \"mul \" + o_temp + \",\" + R + \".x,\" + tempSingle + \"\\n\";\n\t\t\t\tcode += \"add \" + cos + \",\" + cos + \",\" + o_temp + \"\\n\";\n\t\t\t\tcode += \"mul \" + R + \".x,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".x\\n\";\n\t\t\t\tcode += \"mul \" + R + \".y,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"mul \" + R + \".z,\" + sin + \",\" + animationRegisterCache.rotationRegisters[i] + \".x\\n\";\n\t\t\t\tcode += \"mul \" + R + \".w,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \".z\\n\";\n\t\t\t\tcode += \"sub \" + animationRegisterCache.rotationRegisters[i] + \".x,\" + R + \".x,\" + R + \".y\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \".z,\" + R + \".z,\" + R + \".w\\n\";\n\t\t\t}\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleRotateToPositionState\n\t{\n\t\treturn <ParticleRotateToPositionState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar offset:Vector3D = param[ParticleRotateToPositionNode.POSITION_VECTOR3D];\n\t\tif (!offset)\n\t\t\tthrow(new Error(\"there is no \" + ParticleRotateToPositionNode.POSITION_VECTOR3D + \" in param!\"));\n\n\t\tthis._pOneData[0] = offset.x;\n\t\tthis._pOneData[1] = offset.y;\n\t\tthis._pOneData[2] = offset.z;\n\t}\n}\n\nexport = ParticleRotateToPositionNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotationalVelocityState\t= require(\"awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState\");\n\n/**\n * A particle animation node used to set the starting rotational velocity of a particle.\n */\nclass ParticleRotationalVelocityNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iRotationalVelocity:Vector3D;\n\n\t/**\n\t * Reference for rotational velocity node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the rotational velocity around an axis of the particle.\n\t */\n\tpublic static ROTATIONALVELOCITY_VECTOR3D:string = \"RotationalVelocityVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleRotationalVelocityNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t */\n\tconstructor(mode:number /*uint*/, rotationalVelocity:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleRotationalVelocity\", mode, 4);\n\n\t\tthis._pStateClass = ParticleRotationalVelocityState;\n\n\t\tthis._iRotationalVelocity = rotationalVelocity || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar rotationRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX, rotationRegister.index);\n\n\t\tvar nrmVel:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(nrmVel, 1);\n\n\t\tvar xAxis:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(xAxis, 1);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tanimationRegisterCache.addVertexTempUsages(temp, 1);\n\t\tvar Rtemp:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index);\n\t\tvar R_rev:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tR_rev = new ShaderRegisterElement(R_rev.regName, R_rev.index);\n\n\t\tvar cos:ShaderRegisterElement = new ShaderRegisterElement(Rtemp.regName, Rtemp.index, 3);\n\t\tvar sin:ShaderRegisterElement = new ShaderRegisterElement(R_rev.regName, R_rev.index, 3);\n\n\t\tanimationRegisterCache.removeVertexTempUsage(nrmVel);\n\t\tanimationRegisterCache.removeVertexTempUsage(xAxis);\n\t\tanimationRegisterCache.removeVertexTempUsage(temp);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"mov \" + nrmVel + \".xyz,\" + rotationRegister + \".xyz\\n\";\n\t\tcode += \"mov \" + nrmVel + \".w,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\n\t\tcode += \"mul \" + cos + \",\" + animationRegisterCache.vertexTime + \",\" + rotationRegister + \".w\\n\";\n\n\t\tcode += \"sin \" + sin + \",\" + cos + \"\\n\";\n\t\tcode += \"cos \" + cos + \",\" + cos + \"\\n\";\n\n\t\tcode += \"mul \" + Rtemp + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\n\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\n\t\t//nrmVel and xAxis are used as temp register\n\t\tcode += \"crs \" + nrmVel + \".xyz,\" + Rtemp + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\n\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\tcode += \"dp3 \" + xAxis + \".w,\" + Rtemp + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz\\n\";\n\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\n\t\tcode += \"crs \" + Rtemp + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\n\t\t//use cos as R_rev.w\n\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\tcode += \"add \" + Rtemp + \".xyz,\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\n\t\tcode += \"add \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\n\t\tvar len:number /*int*/ = animationRegisterCache.rotationRegisters.length;\n\t\tfor (var i:number /*int*/ = 0; i < len; i++) {\n\t\t\tcode += \"mov \" + nrmVel + \".xyz,\" + rotationRegister + \".xyz\\n\";\n\t\t\tcode += \"mov \" + nrmVel + \".w,\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\tcode += \"mul \" + cos + \",\" + animationRegisterCache.vertexTime + \",\" + rotationRegister + \".w\\n\";\n\t\t\tcode += \"sin \" + sin + \",\" + cos + \"\\n\";\n\t\t\tcode += \"cos \" + cos + \",\" + cos + \"\\n\";\n\t\t\tcode += \"mul \" + Rtemp + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"mul \" + R_rev + \".xyz,\" + sin + \",\" + nrmVel + \".xyz\\n\";\n\t\t\tcode += \"neg \" + R_rev + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\tcode += \"crs \" + nrmVel + \".xyz,\" + Rtemp + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + cos + \",\" + animationRegisterCache.rotationRegisters[i] + \"\\n\";\n\t\t\tcode += \"add \" + nrmVel + \".xyz,\" + nrmVel + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"dp3 \" + xAxis + \".w,\" + Rtemp + \".xyz,\" + animationRegisterCache.rotationRegisters[i] + \"\\n\";\n\t\t\tcode += \"neg \" + nrmVel + \".w,\" + xAxis + \".w\\n\";\n\t\t\tcode += \"crs \" + Rtemp + \".xyz,\" + nrmVel + \".xyz,\" + R_rev + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyzw,\" + nrmVel + \".xyzw,\" + cos + \"\\n\";\n\t\t\tcode += \"add \" + Rtemp + \".xyz,\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t\tcode += \"mul \" + xAxis + \".xyz,\" + nrmVel + \".w,\" + R_rev + \".xyz\\n\";\n\t\t\tcode += \"add \" + animationRegisterCache.rotationRegisters[i] + \",\" + Rtemp + \".xyz,\" + xAxis + \".xyz\\n\";\n\t\t}\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleRotationalVelocityState\n\t{\n\t\treturn <ParticleRotationalVelocityState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\t//(Vector3d.x,Vector3d.y,Vector3d.z) is rotation axis,Vector3d.w is cycle duration\n\t\tvar rotate:Vector3D = param[ParticleRotationalVelocityNode.ROTATIONALVELOCITY_VECTOR3D];\n\t\tif (!rotate)\n\t\t\tthrow(new Error(\"there is no \" + ParticleRotationalVelocityNode.ROTATIONALVELOCITY_VECTOR3D + \" in param!\"));\n\n\t\tif (rotate.length <= 0)\n\t\t\trotate.z = 1; //set the default direction\n\t\telse\n\t\t\trotate.normalize();\n\n\t\tthis._pOneData[0] = rotate.x;\n\t\tthis._pOneData[1] = rotate.y;\n\t\tthis._pOneData[2] = rotate.z;\n\t\tif (rotate.w <= 0)\n\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\t\t// it's used as angle/2 in agal\n\t\tthis._pOneData[3] = Math.PI/rotate.w;\n\t}\n}\n\nexport = ParticleRotationalVelocityNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleScaleState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleScaleState\");\n\n/**\n * A particle animation node used to control the scale variation of a particle over time.\n */\nclass ParticleScaleNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\n\t/** @private */\n\tpublic _iMinScale:number;\n\t/** @private */\n\tpublic _iMaxScale:number;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\n\t/**\n\t * Reference for scale node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> representing the min scale (x), max scale(y), optional cycle speed (z) and phase offset (w) applied to the particle.\n\t */\n\tpublic static SCALE_VECTOR3D:string = \"ScaleVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleScaleNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] usesCycle       Defines whether the node uses the <code>cycleDuration</code> property in the shader to calculate the period of animation independent of particle duration. Defaults to false.\n\t * @param    [optional] usesPhase       Defines whether the node uses the <code>cyclePhase</code> property in the shader to calculate a starting offset to the animation cycle. Defaults to false.\n\t * @param    [optional] minScale        Defines the default min scale transform of the node, when in global mode. Defaults to 1.\n\t * @param    [optional] maxScale        Defines the default max color transform of the node, when in global mode. Defaults to 1.\n\t * @param    [optional] cycleDuration   Defines the default duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the default phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tconstructor(mode:number /*uint*/, usesCycle:boolean, usesPhase:boolean, minScale:number = 1, maxScale:number = 1, cycleDuration:number = 1, cyclePhase:number = 0)\n\t{\n\t\tsuper(\"ParticleScale\", mode, (usesCycle && usesPhase)? 4 : ((usesCycle || usesPhase)? 3 : 2), 3);\n\n\t\tthis._pStateClass = ParticleScaleState;\n\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iMinScale = minScale;\n\t\tthis._iMaxScale = maxScale;\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iCyclePhase = cyclePhase;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\n\t\tvar scaleRegister:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleScaleState.SCALE_INDEX, scaleRegister.index);\n\n\t\tif (this._iUsesCycle) {\n\t\t\tcode += \"mul \" + temp + \",\" + animationRegisterCache.vertexTime + \",\" + scaleRegister + \".z\\n\";\n\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tcode += \"add \" + temp + \",\" + temp + \",\" + scaleRegister + \".w\\n\";\n\n\t\t\tcode += \"sin \" + temp + \",\" + temp + \"\\n\";\n\t\t}\n\n\t\tcode += \"mul \" + temp + \",\" + scaleRegister + \".y,\" + ((this._iUsesCycle)? temp : animationRegisterCache.vertexLife) + \"\\n\";\n\t\tcode += \"add \" + temp + \",\" + scaleRegister + \".x,\" + temp + \"\\n\";\n\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleScaleState\n\t{\n\t\treturn <ParticleScaleState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar scale:Vector3D = param[ParticleScaleNode.SCALE_VECTOR3D];\n\t\tif (!scale)\n\t\t\tthrow(new Error(\"there is no \" + ParticleScaleNode.SCALE_VECTOR3D + \" in param!\"));\n\n\t\tif (this._iUsesCycle) {\n\t\t\tthis._pOneData[0] = (scale.x + scale.y)/2;\n\t\t\tthis._pOneData[1] = Math.abs(scale.x - scale.y)/2;\n\t\t\tif (scale.z <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tthis._pOneData[2] = Math.PI*2/scale.z;\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tthis._pOneData[3] = scale.w*Math.PI/180;\n\t\t} else {\n\t\t\tthis._pOneData[0] = scale.x;\n\t\t\tthis._pOneData[1] = scale.y - scale.x;\n\t\t}\n\t}\n}\n\nexport = ParticleScaleNode;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ColorSegmentPoint\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ColorSegmentPoint\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleSegmentedColorState\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState\");\n\n/**\n *\n */\nclass ParticleSegmentedColorNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesMultiplier:boolean;\n\t/** @private */\n\tpublic _iUsesOffset:boolean;\n\t/** @private */\n\tpublic _iStartColor:ColorTransform;\n\t/** @private */\n\tpublic _iEndColor:ColorTransform;\n\t/** @private */\n\tpublic _iNumSegmentPoint:number /*int*/;\n\t/** @private */\n\tpublic _iSegmentPoints:Array<ColorSegmentPoint>;\n\n\tconstructor(usesMultiplier:boolean, usesOffset:boolean, numSegmentPoint:number /*int*/, startColor:ColorTransform, endColor:ColorTransform, segmentPoints:Array<ColorSegmentPoint>)\n\t{\n\t\t//because of the stage3d register limitation, it only support the global mode\n\t\tsuper(\"ParticleSegmentedColor\", ParticlePropertiesMode.GLOBAL, 0, ParticleAnimationSet.COLOR_PRIORITY);\n\n\t\tthis._pStateClass = ParticleSegmentedColorState;\n\n\t\tif (numSegmentPoint > 4)\n\t\t\tthrow(new Error(\"the numSegmentPoint must be less or equal 4\"));\n\t\tthis._iUsesMultiplier = usesMultiplier;\n\t\tthis._iUsesOffset = usesOffset;\n\t\tthis._iNumSegmentPoint = numSegmentPoint;\n\t\tthis._iStartColor = startColor;\n\t\tthis._iEndColor = endColor;\n\t\tthis._iSegmentPoints = segmentPoints;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tif (this._iUsesMultiplier)\n\t\t\tparticleAnimationSet.hasColorMulNode = true;\n\t\tif (this._iUsesOffset)\n\t\t\tparticleAnimationSet.hasColorAddNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tvar accMultiplierColor:ShaderRegisterElement;\n\t\t\t//var accOffsetColor:ShaderRegisterElement;\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\taccMultiplierColor = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tanimationRegisterCache.addVertexTempUsages(accMultiplierColor, 1);\n\t\t\t}\n\n\t\t\tvar tempColor:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tanimationRegisterCache.addVertexTempUsages(tempColor, 1);\n\n\t\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\t\tvar accTime:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\t\tvar tempTime:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\n\t\t\tif (this._iUsesMultiplier)\n\t\t\t\tanimationRegisterCache.removeVertexTempUsage(accMultiplierColor);\n\n\t\t\tanimationRegisterCache.removeVertexTempUsage(tempColor);\n\n\t\t\t//for saving all the life values (at most 4)\n\t\t\tvar lifeTimeRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSegmentedColorState.TIME_DATA_INDEX, lifeTimeRegister.index);\n\n\t\t\tvar i:number /*int*/;\n\n\t\t\tvar startMulValue:ShaderRegisterElement;\n\t\t\tvar deltaMulValues:Array<ShaderRegisterElement>;\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tstartMulValue = animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSegmentedColorState.START_MULTIPLIER_INDEX, startMulValue.index);\n\t\t\t\tdeltaMulValues = new Array<ShaderRegisterElement>();\n\t\t\t\tfor (i = 0; i < this._iNumSegmentPoint + 1; i++)\n\t\t\t\t\tdeltaMulValues.push(animationRegisterCache.getFreeVertexConstant());\n\t\t\t}\n\n\t\t\tvar startOffsetValue:ShaderRegisterElement;\n\t\t\tvar deltaOffsetValues:Array<ShaderRegisterElement>;\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tstartOffsetValue = animationRegisterCache.getFreeVertexConstant();\n\t\t\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSegmentedColorState.START_OFFSET_INDEX, startOffsetValue.index);\n\t\t\t\tdeltaOffsetValues = new Array<ShaderRegisterElement>();\n\t\t\t\tfor (i = 0; i < this._iNumSegmentPoint + 1; i++)\n\t\t\t\t\tdeltaOffsetValues.push(animationRegisterCache.getFreeVertexConstant());\n\t\t\t}\n\n\t\t\tif (this._iUsesMultiplier)\n\t\t\t\tcode += \"mov \" + accMultiplierColor + \",\" + startMulValue + \"\\n\";\n\t\t\tif (this._iUsesOffset)\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + animationRegisterCache.colorAddTarget + \",\" + startOffsetValue + \"\\n\";\n\n\t\t\tfor (i = 0; i < this._iNumSegmentPoint; i++) {\n\t\t\t\tswitch (i) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + animationRegisterCache.vertexLife + \",\" + lifeTimeRegister + \".x\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + animationRegisterCache.vertexLife + \",\" + lifeTimeRegister + \".x\\n\";\n\t\t\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + tempTime + \",\" + lifeTimeRegister + \".y\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".y\\n\";\n\t\t\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + tempTime + \",\" + lifeTimeRegister + \".z\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".z\\n\";\n\t\t\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t\t\t\tcode += \"min \" + tempTime + \",\" + tempTime + \",\" + lifeTimeRegister + \".w\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaMulValues[i] + \"\\n\";\n\t\t\t\t\tcode += \"add \" + accMultiplierColor + \",\" + accMultiplierColor + \",\" + tempColor + \"\\n\";\n\t\t\t\t}\n\t\t\t\tif (this._iUsesOffset) {\n\t\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaOffsetValues[i] + \"\\n\";\n\t\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + animationRegisterCache.colorAddTarget + \",\" + tempColor + \"\\n\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//for the last segment:\n\t\t\tif (this._iNumSegmentPoint == 0)\n\t\t\t\ttempTime = animationRegisterCache.vertexLife;\n\t\t\telse {\n\t\t\t\tswitch (this._iNumSegmentPoint) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + animationRegisterCache.vertexLife + \",\" + lifeTimeRegister + \".x\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".y\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".z\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\tcode += \"sub \" + accTime + \",\" + accTime + \",\" + lifeTimeRegister + \".w\\n\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcode += \"max \" + tempTime + \",\" + accTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\t\t}\n\t\t\tif (this._iUsesMultiplier) {\n\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaMulValues[this._iNumSegmentPoint] + \"\\n\";\n\t\t\t\tcode += \"add \" + accMultiplierColor + \",\" + accMultiplierColor + \",\" + tempColor + \"\\n\";\n\t\t\t\tcode += \"mul \" + animationRegisterCache.colorMulTarget + \",\" + animationRegisterCache.colorMulTarget + \",\" + accMultiplierColor + \"\\n\";\n\t\t\t}\n\t\t\tif (this._iUsesOffset) {\n\t\t\t\tcode += \"mul \" + tempColor + \",\" + tempTime + \",\" + deltaOffsetValues[this._iNumSegmentPoint] + \"\\n\";\n\t\t\t\tcode += \"add \" + animationRegisterCache.colorAddTarget + \",\" + animationRegisterCache.colorAddTarget + \",\" + tempColor + \"\\n\";\n\t\t\t}\n\n\t\t}\n\t\treturn code;\n\t}\n\n}\n\nexport = ParticleSegmentedColorNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleSpriteSheetState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState\");\n\n/**\n * A particle animation node used when a spritesheet texture is required to animate the particle.\n * NB: to enable use of this node, the <code>repeat</code> property on the material has to be set to true.\n */\nclass ParticleSpriteSheetNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesCycle:boolean;\n\n\t/** @private */\n\tpublic _iUsesPhase:boolean;\n\n\t/** @private */\n\tpublic _iTotalFrames:number /*int*/;\n\t/** @private */\n\tpublic _iNumColumns:number /*int*/;\n\t/** @private */\n\tpublic _iNumRows:number /*int*/;\n\t/** @private */\n\tpublic _iCycleDuration:number;\n\t/** @private */\n\tpublic _iCyclePhase:number;\n\n\t/**\n\t * Reference for spritesheet node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> representing the cycleDuration (x), optional phaseTime (y).\n\t */\n\tpublic static UV_VECTOR3D:string = \"UVVector3D\";\n\n\t/**\n\t * Defines the number of columns in the spritesheet, when in global mode. Defaults to 1. Read only.\n\t */\n\tpublic get numColumns():number\n\t{\n\t\treturn this._iNumColumns;\n\t}\n\n\t/**\n\t * Defines the number of rows in the spritesheet, when in global mode. Defaults to 1. Read only.\n\t */\n\tpublic get numRows():number\n\t{\n\t\treturn this._iNumRows;\n\t}\n\n\t/**\n\t * Defines the total number of frames used by the spritesheet, when in global mode. Defaults to the number defined by numColumns and numRows. Read only.\n\t */\n\tpublic get totalFrames():number\n\t{\n\t\treturn this._iTotalFrames;\n\t}\n\n\t/**\n\t * Creates a new <code>ParticleSpriteSheetNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] numColumns      Defines the number of columns in the spritesheet, when in global mode. Defaults to 1.\n\t * @param    [optional] numRows         Defines the number of rows in the spritesheet, when in global mode. Defaults to 1.\n\t * @param    [optional] cycleDuration   Defines the default cycle duration in seconds, when in global mode. Defaults to 1.\n\t * @param    [optional] cyclePhase      Defines the default cycle phase, when in global mode. Defaults to 0.\n\t * @param    [optional] totalFrames     Defines the total number of frames used by the spritesheet, when in global mode. Defaults to the number defined by numColumns and numRows.\n\t * @param    [optional] looping         Defines whether the spritesheet animation is set to loop indefinitely. Defaults to true.\n\t */\n\tconstructor(mode:number /*uint*/, usesCycle:boolean, usesPhase:boolean, numColumns:number /*int*/ = 1, numRows:number /*uint*/ = 1, cycleDuration:number = 1, cyclePhase:number = 0, totalFrames:number /*uint*/ = Number.MAX_VALUE)\n\t{\n\t\tsuper(\"ParticleSpriteSheet\", mode, usesCycle? (usesPhase? 3 : 2) : 1, ParticleAnimationSet.POST_PRIORITY + 1);\n\n\t\tthis._pStateClass = ParticleSpriteSheetState;\n\n\t\tthis._iUsesCycle = usesCycle;\n\t\tthis._iUsesPhase = usesPhase;\n\n\t\tthis._iNumColumns = numColumns;\n\t\tthis._iNumRows = numRows;\n\t\tthis._iCyclePhase = cyclePhase;\n\t\tthis._iCycleDuration = cycleDuration;\n\t\tthis._iTotalFrames = Math.min(totalFrames, numColumns*numRows);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\t//get 2 vc\n\t\tvar uvParamConst1:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tvar uvParamConst2:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSpriteSheetState.UV_INDEX_0, uvParamConst1.index);\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleSpriteSheetState.UV_INDEX_1, uvParamConst2.index);\n\n\t\tvar uTotal:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst1.regName, uvParamConst1.index, 0);\n\t\tvar uStep:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst1.regName, uvParamConst1.index, 1);\n\t\tvar vStep:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst1.regName, uvParamConst1.index, 2);\n\n\t\tvar uSpeed:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst2.regName, uvParamConst2.index, 0);\n\t\tvar cycle:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst2.regName, uvParamConst2.index, 1);\n\t\tvar phaseTime:ShaderRegisterElement = new ShaderRegisterElement(uvParamConst2.regName, uvParamConst2.index, 2);\n\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar time:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 0);\n\t\tvar vOffset:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 1);\n\t\ttemp = new ShaderRegisterElement(temp.regName, temp.index, 2);\n\t\tvar temp2:ShaderRegisterElement = new ShaderRegisterElement(temp.regName, temp.index, 3);\n\n\t\tvar u:ShaderRegisterElement = new ShaderRegisterElement(animationRegisterCache.uvTarget.regName, animationRegisterCache.uvTarget.index, 0);\n\t\tvar v:ShaderRegisterElement = new ShaderRegisterElement(animationRegisterCache.uvTarget.regName, animationRegisterCache.uvTarget.index, 1);\n\n\t\tvar code:string = \"\";\n\t\t//scale uv\n\t\tcode += \"mul \" + u + \",\" + u + \",\" + uStep + \"\\n\";\n\t\tif (this._iNumRows > 1)\n\t\t\tcode += \"mul \" + v + \",\" + v + \",\" + vStep + \"\\n\";\n\n\t\tif (this._iUsesCycle) {\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tcode += \"add \" + time + \",\" + animationRegisterCache.vertexTime + \",\" + phaseTime + \"\\n\";\n\t\t\telse\n\t\t\t\tcode += \"mov \" + time + \",\" + animationRegisterCache.vertexTime + \"\\n\";\n\t\t\tcode += \"div \" + time + \",\" + time + \",\" + cycle + \"\\n\";\n\t\t\tcode += \"frc \" + time + \",\" + time + \"\\n\";\n\t\t\tcode += \"mul \" + time + \",\" + time + \",\" + cycle + \"\\n\";\n\t\t\tcode += \"mul \" + temp + \",\" + time + \",\" + uSpeed + \"\\n\";\n\t\t} else\n\t\t\tcode += \"mul \" + temp.toString() + \",\" + animationRegisterCache.vertexLife + \",\" + uTotal + \"\\n\";\n\n\t\tif (this._iNumRows > 1) {\n\t\t\tcode += \"frc \" + temp2 + \",\" + temp + \"\\n\";\n\t\t\tcode += \"sub \" + vOffset + \",\" + temp + \",\" + temp2 + \"\\n\";\n\t\t\tcode += \"mul \" + vOffset + \",\" + vOffset + \",\" + vStep + \"\\n\";\n\t\t\tcode += \"add \" + v + \",\" + v + \",\" + vOffset + \"\\n\";\n\t\t}\n\n\t\tcode += \"div \" + temp2 + \",\" + temp + \",\" + uStep + \"\\n\";\n\t\tcode += \"frc \" + temp + \",\" + temp2 + \"\\n\";\n\t\tcode += \"sub \" + temp2 + \",\" + temp2 + \",\" + temp + \"\\n\";\n\t\tcode += \"mul \" + temp + \",\" + temp2 + \",\" + uStep + \"\\n\";\n\n\t\tif (this._iNumRows > 1)\n\t\t\tcode += \"frc \" + temp + \",\" + temp + \"\\n\";\n\t\tcode += \"add \" + u + \",\" + u + \",\" + temp + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleSpriteSheetState\n\t{\n\t\treturn <ParticleSpriteSheetState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.hasUVNode = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tif (this._iUsesCycle) {\n\t\t\tvar uvCycle:Vector3D = param[ParticleSpriteSheetNode.UV_VECTOR3D];\n\t\t\tif (!uvCycle)\n\t\t\t\tthrow(new Error(\"there is no \" + ParticleSpriteSheetNode.UV_VECTOR3D + \" in param!\"));\n\t\t\tif (uvCycle.x <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tvar uTotal:number = this._iTotalFrames/this._iNumColumns;\n\t\t\tthis._pOneData[0] = uTotal/uvCycle.x;\n\t\t\tthis._pOneData[1] = uvCycle.x;\n\t\t\tif (this._iUsesPhase)\n\t\t\t\tthis._pOneData[2] = uvCycle.y;\n\t\t}\n\t}\n}\n\nexport = ParticleSpriteSheetNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleTimeState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleTimeState\");\n\n/**\n * A particle animation node used as the base node for timekeeping inside a particle. Automatically added to a particle animation set on instatiation.\n */\nclass ParticleTimeNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUsesDuration:boolean;\n\t/** @private */\n\tpublic _iUsesDelay:boolean;\n\t/** @private */\n\tpublic _iUsesLooping:boolean;\n\n\t/**\n\t * Creates a new <code>ParticleTimeNode</code>\n\t *\n\t * @param    [optional] usesDuration    Defines whether the node uses the <code>duration</code> data in the static properties to determine how long a particle is visible for. Defaults to false.\n\t * @param    [optional] usesDelay       Defines whether the node uses the <code>delay</code> data in the static properties to determine how long a particle is hidden for. Defaults to false. Requires <code>usesDuration</code> to be true.\n\t * @param    [optional] usesLooping     Defines whether the node creates a looping timeframe for each particle determined by the <code>startTime</code>, <code>duration</code> and <code>delay</code> data in the static properties function. Defaults to false. Requires <code>usesLooping</code> to be true.\n\t */\n\tconstructor(usesDuration:boolean = false, usesLooping:boolean = false, usesDelay:boolean = false)\n\t{\n\t\tthis._pStateClass = ParticleTimeState;\n\n\t\tthis._iUsesDuration = usesDuration;\n\t\tthis._iUsesLooping = usesLooping;\n\t\tthis._iUsesDelay = usesDelay;\n\n\t\tsuper(\"ParticleTime\", ParticlePropertiesMode.LOCAL_STATIC, 4, 0);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar timeStreamRegister:ShaderRegisterElement = animationRegisterCache.getFreeVertexAttribute(); //timeStreamRegister.x is starttimeStreamRegister.y is during time\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleTimeState.TIME_STREAM_INDEX, timeStreamRegister.index);\n\t\tvar timeConst:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleTimeState.TIME_CONSTANT_INDEX, timeConst.index);\n\n\t\tvar code:string = \"\";\n\t\tcode += \"sub \" + animationRegisterCache.vertexTime + \",\" + timeConst + \",\" + timeStreamRegister + \".x\\n\";\n\t\t//if time=0,set the position to zero.\n\t\tvar temp:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\tcode += \"sge \" + temp + \",\" + animationRegisterCache.vertexTime + \",\" + animationRegisterCache.vertexZeroConst + \"\\n\";\n\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + temp + \"\\n\";\n\t\tif (this._iUsesDuration) {\n\t\t\tif (this._iUsesLooping) {\n\t\t\t\tvar div:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\t\t\tif (this._iUsesDelay) {\n\t\t\t\t\tcode += \"div \" + div + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".z\\n\";\n\t\t\t\t\tcode += \"frc \" + div + \",\" + div + \"\\n\";\n\t\t\t\t\tcode += \"mul \" + animationRegisterCache.vertexTime + \",\" + div + \",\" + timeStreamRegister + \".z\\n\";\n\t\t\t\t\tcode += \"slt \" + div + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".y\\n\";\n\t\t\t\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + div + \"\\n\";\n\t\t\t\t} else {\n\t\t\t\t\tcode += \"mul \" + div + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".w\\n\";\n\t\t\t\t\tcode += \"frc \" + div + \",\" + div + \"\\n\";\n\t\t\t\t\tcode += \"mul \" + animationRegisterCache.vertexTime + \",\" + div + \",\" + timeStreamRegister + \".y\\n\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar sge:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\t\t\t\tcode += \"sge \" + sge + \",\" + timeStreamRegister + \".y,\" + animationRegisterCache.vertexTime + \"\\n\";\n\t\t\t\tcode += \"mul \" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + animationRegisterCache.scaleAndRotateTarget + \".xyz,\" + sge + \"\\n\";\n\t\t\t}\n\t\t}\n\t\tcode += \"mul \" + animationRegisterCache.vertexLife + \",\" + animationRegisterCache.vertexTime + \",\" + timeStreamRegister + \".w\\n\";\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleTimeState\n\t{\n\t\treturn <ParticleTimeState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tthis._pOneData[0] = param.startTime;\n\t\tthis._pOneData[1] = param.duration;\n\t\tthis._pOneData[2] = param.delay + param.duration;\n\t\tthis._pOneData[3] = 1/param.duration;\n\n\t}\n}\n\nexport = ParticleTimeNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimationSet\");\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleUVState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleUVState\");\n\n/**\n * A particle animation node used to control the UV offset and scale of a particle over time.\n */\nclass ParticleUVNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iUvData:Vector3D;\n\n\t/**\n\t *\n\t */\n\tpublic static U_AXIS:string = \"x\";\n\n\t/**\n\t *\n\t */\n\tpublic static V_AXIS:string = \"y\";\n\n\tprivate _cycle:number;\n\tprivate _scale:number;\n\tprivate _axis:string;\n\n\t/**\n\t * Creates a new <code>ParticleTimeNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] cycle           Defines whether the time track is in loop mode. Defaults to false.\n\t * @param    [optional] scale           Defines whether the time track is in loop mode. Defaults to false.\n\t * @param    [optional] axis            Defines whether the time track is in loop mode. Defaults to false.\n\t */\n\tconstructor(mode:number /*uint*/, cycle:number = 1, scale:number = 1, axis:string = \"x\")\n\t{\n\t\t//because of the stage3d register limitation, it only support the global mode\n\t\tsuper(\"ParticleUV\", ParticlePropertiesMode.GLOBAL, 4, ParticleAnimationSet.POST_PRIORITY + 1);\n\n\t\tthis._pStateClass = ParticleUVState;\n\n\t\tthis._cycle = cycle;\n\t\tthis._scale = scale;\n\t\tthis._axis = axis;\n\n\t\tthis.updateUVData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get cycle():number\n\t{\n\t\treturn this._cycle;\n\t}\n\n\tpublic set cycle(value:number)\n\t{\n\t\tthis._cycle = value;\n\n\t\tthis.updateUVData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get scale():number\n\t{\n\t\treturn this._scale;\n\t}\n\n\tpublic set scale(value:number)\n\t{\n\t\tthis._scale = value;\n\n\t\tthis.updateUVData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get axis():string\n\t{\n\t\treturn this._axis;\n\t}\n\n\tpublic set axis(value:string)\n\t{\n\t\tthis._axis = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALUVCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tvar uvConst:ShaderRegisterElement = animationRegisterCache.getFreeVertexConstant();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleUVState.UV_INDEX, uvConst.index);\n\n\t\tvar axisIndex:number = this._axis == \"x\"? 0 : (this._axis == \"y\"? 1 : 2);\n\n\t\tvar target:ShaderRegisterElement = new ShaderRegisterElement(animationRegisterCache.uvTarget.regName, animationRegisterCache.uvTarget.index, axisIndex);\n\n\t\tvar sin:ShaderRegisterElement = animationRegisterCache.getFreeVertexSingleTemp();\n\n\t\tif (this._scale != 1)\n\t\t\tcode += \"mul \" + target + \",\" + target + \",\" + uvConst + \".y\\n\";\n\n\t\tcode += \"mul \" + sin + \",\" + animationRegisterCache.vertexTime + \",\" + uvConst + \".x\\n\";\n\t\tcode += \"sin \" + sin + \",\" + sin + \"\\n\";\n\t\tcode += \"add \" + target + \",\" + target + \",\" + sin + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleUVState\n\t{\n\t\treturn <ParticleUVState> animator.getAnimationState(this);\n\t}\n\n\tprivate updateUVData()\n\t{\n\t\tthis._iUvData = new Vector3D(Math.PI*2/this._cycle, this._scale, 0, 0);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iProcessAnimationSetting(particleAnimationSet:ParticleAnimationSet)\n\t{\n\t\tparticleAnimationSet.hasUVNode = true;\n\t}\n}\n\nexport = ParticleUVNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport ShaderBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\nimport ParticleProperties\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleProperties\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleVelocityState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleVelocityState\");\n\n/**\n * A particle animation node used to set the starting velocity of a particle.\n */\nclass ParticleVelocityNode extends ParticleNodeBase\n{\n\t/** @private */\n\tpublic _iVelocity:Vector3D;\n\n\t/**\n\t * Reference for velocity node properties on a single particle (when in local property mode).\n\t * Expects a <code>Vector3D</code> object representing the direction of movement on the particle.\n\t */\n\tpublic static VELOCITY_VECTOR3D:string = \"VelocityVector3D\";\n\n\t/**\n\t * Creates a new <code>ParticleVelocityNode</code>\n\t *\n\t * @param               mode            Defines whether the mode of operation acts on local properties of a particle or global properties of the node.\n\t * @param    [optional] velocity        Defines the default velocity vector of the node, used when in global mode.\n\t */\n\tconstructor(mode:number /*uint*/, velocity:Vector3D = null)\n\t{\n\t\tsuper(\"ParticleVelocity\", mode, 3);\n\n\t\tthis._pStateClass = ParticleVelocityState;\n\n\t\tthis._iVelocity = velocity || new Vector3D();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAGALVertexCode(shader:ShaderBase, animationRegisterCache:AnimationRegisterCache):string\n\t{\n\t\tvar velocityValue:ShaderRegisterElement = (this._pMode == ParticlePropertiesMode.GLOBAL)? animationRegisterCache.getFreeVertexConstant() : animationRegisterCache.getFreeVertexAttribute();\n\t\tanimationRegisterCache.setRegisterIndex(this, ParticleVelocityState.VELOCITY_INDEX, velocityValue.index);\n\n\t\tvar distance:ShaderRegisterElement = animationRegisterCache.getFreeVertexVectorTemp();\n\t\tvar code:string = \"\";\n\t\tcode += \"mul \" + distance + \",\" + animationRegisterCache.vertexTime + \",\" + velocityValue + \"\\n\";\n\t\tcode += \"add \" + animationRegisterCache.positionTarget + \".xyz,\" + distance + \",\" + animationRegisterCache.positionTarget + \".xyz\\n\";\n\n\t\tif (animationRegisterCache.needVelocity)\n\t\t\tcode += \"add \" + animationRegisterCache.velocityTarget + \".xyz,\" + velocityValue + \".xyz,\" + animationRegisterCache.velocityTarget + \".xyz\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):ParticleVelocityState\n\t{\n\t\treturn <ParticleVelocityState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGeneratePropertyOfOneParticle(param:ParticleProperties)\n\t{\n\t\tvar _tempVelocity:Vector3D = param[ParticleVelocityNode.VELOCITY_VECTOR3D];\n\t\tif (!_tempVelocity)\n\t\t\tthrow new Error(\"there is no \" + ParticleVelocityNode.VELOCITY_VECTOR3D + \" in param!\");\n\n\t\tthis._pOneData[0] = _tempVelocity.x;\n\t\tthis._pOneData[1] = _tempVelocity.y;\n\t\tthis._pOneData[2] = _tempVelocity.z;\n\t}\n}\n\nexport = ParticleVelocityNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonBinaryLERPState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState\");\n\n/**\n * A skeleton animation node that uses two animation node inputs to blend a lineraly interpolated output of a skeleton pose.\n */\nclass SkeletonBinaryLERPNode extends AnimationNodeBase\n{\n\t/**\n\t * Defines input node A to use for the blended output.\n\t */\n\tpublic inputA:AnimationNodeBase;\n\n\t/**\n\t * Defines input node B to use for the blended output.\n\t */\n\tpublic inputB:AnimationNodeBase;\n\n\t/**\n\t * Creates a new <code>SkeletonBinaryLERPNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonBinaryLERPState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonBinaryLERPState\n\t{\n\t\treturn <SkeletonBinaryLERPState> animator.getAnimationState(this);\n\t}\n}\n\nexport = SkeletonBinaryLERPNode;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\nimport SkeletonClipState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonClipState\");\n\n/**\n * A skeleton animation node containing time-based animation data as individual skeleton poses.\n */\nclass SkeletonClipNode extends AnimationClipNodeBase\n{\n\tprivate _frames:Array<SkeletonPose> = new Array<SkeletonPose>();\n\n\t/**\n\t * Determines whether to use SLERP equations (true) or LERP equations (false) in the calculation\n\t * of the output skeleton pose. Defaults to false.\n\t */\n\tpublic highQuality:boolean = false;\n\n\t/**\n\t * Returns a vector of skeleton poses representing the pose of each animation frame in the clip.\n\t */\n\tpublic get frames():Array<SkeletonPose>\n\t{\n\t\treturn this._frames;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonClipNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonClipState;\n\t}\n\n\t/**\n\t * Adds a skeleton pose frame to the internal timeline of the animation node.\n\t *\n\t * @param skeletonPose The skeleton pose object to add to the timeline of the node.\n\t * @param duration The specified duration of the frame in milliseconds.\n\t */\n\tpublic addFrame(skeletonPose:SkeletonPose, duration:number /*number /*uint*/)\n\t{\n\t\tthis._frames.push(skeletonPose);\n\t\tthis._pDurations.push(duration);\n\n\t\tthis._pNumFrames = this._pDurations.length;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonClipState\n\t{\n\t\treturn <SkeletonClipState> animator.getAnimationState(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateStitch()\n\t{\n\t\tsuper._pUpdateStitch();\n\n\t\tvar i:number /*uint*/ = this._pNumFrames - 1;\n\t\tvar p1:Vector3D, p2:Vector3D, delta:Vector3D;\n\t\twhile (i--) {\n\t\t\tthis._pTotalDuration += this._pDurations[i];\n\t\t\tp1 = this._frames[i].jointPoses[0].translation;\n\t\t\tp2 = this._frames[i + 1].jointPoses[0].translation;\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\n\t\tif (this._pStitchFinalFrame || !this._pLooping) {\n\t\t\tthis._pTotalDuration += this._pDurations[this._pNumFrames - 1];\n\t\t\tp1 = this._frames[0].jointPoses[0].translation;\n\t\t\tp2 = this._frames[1].jointPoses[0].translation;\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\t}\n}\n\nexport = SkeletonClipNode;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonDifferenceState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonDifferenceState\");\n\n/**\n * A skeleton animation node that uses a difference input pose with a base input pose to blend a linearly interpolated output of a skeleton pose.\n */\nclass SkeletonDifferenceNode extends AnimationNodeBase\n{\n\t/**\n\t * Defines a base input node to use for the blended output.\n\t */\n\tpublic baseInput:AnimationNodeBase;\n\n\t/**\n\t * Defines a difference input node to use for the blended output.\n\t */\n\tpublic differenceInput:AnimationNodeBase;\n\n\t/**\n\t * Creates a new <code>SkeletonAdditiveNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonDifferenceState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonDifferenceState\n\t{\n\t\treturn <SkeletonDifferenceState> animator.getAnimationState(this);\n\t}\n}\n\nexport = SkeletonDifferenceNode",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonDirectionalState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonDirectionalState\");\n\n/**\n * A skeleton animation node that uses four directional input poses with an input direction to blend a linearly interpolated output of a skeleton pose.\n */\nclass SkeletonDirectionalNode extends AnimationNodeBase\n{\n\t/**\n\t * Defines the forward configured input node to use for the blended output.\n\t */\n\tpublic forward:AnimationNodeBase;\n\n\t/**\n\t * Defines the backwards configured input node to use for the blended output.\n\t */\n\tpublic backward:AnimationNodeBase;\n\n\t/**\n\t * Defines the left configured input node to use for the blended output.\n\t */\n\tpublic left:AnimationNodeBase;\n\n\t/**\n\t * Defines the right configured input node to use for the blended output.\n\t */\n\tpublic right:AnimationNodeBase;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonDirectionalState;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonDirectionalState\n\t{\n\t\treturn <SkeletonDirectionalState> animator.getAnimationState(this);\n\t}\n\n}\n\nexport = SkeletonDirectionalNode;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport SkeletonNaryLERPState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState\");\n\n/**\n * A skeleton animation node that uses an n-dimensional array of animation node inputs to blend a lineraly interpolated output of a skeleton pose.\n */\nclass SkeletonNaryLERPNode extends AnimationNodeBase\n{\n\tpublic _iInputs:Array<AnimationNodeBase> = new Array<AnimationNodeBase>();\n\n\tprivate _numInputs:number /*uint*/;\n\n\tpublic get numInputs():number /*uint*/\n\t{\n\t\treturn this._numInputs;\n\t}\n\n\t/**\n\t * Creates a new <code>SkeletonNaryLERPNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = SkeletonNaryLERPState;\n\t}\n\n\t/**\n\t * Returns an integer representing the input index of the given skeleton animation node.\n\t *\n\t * @param input The skeleton animation node for with the input index is requested.\n\t */\n\tpublic getInputIndex(input:AnimationNodeBase):number /*int*/\n\t{\n\t\treturn this._iInputs.indexOf(input);\n\t}\n\n\t/**\n\t * Returns the skeleton animation node object that resides at the given input index.\n\t *\n\t * @param index The input index for which the skeleton animation node is requested.\n\t */\n\tpublic getInputAt(index:number /*uint*/):AnimationNodeBase\n\t{\n\t\treturn this._iInputs[index];\n\t}\n\n\t/**\n\t * Adds a new skeleton animation node input to the animation node.\n\t */\n\tpublic addInput(input:AnimationNodeBase)\n\t{\n\t\tthis._iInputs[this._numInputs++] = input;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getAnimationState(animator:AnimatorBase):SkeletonNaryLERPState\n\t{\n\t\treturn <SkeletonNaryLERPState> animator.getAnimationState(this);\n\t}\n}\n\nexport = SkeletonNaryLERPNode",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\nimport VertexClipState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/VertexClipState\");\n\n/**\n * A vertex animation node containing time-based animation data as individual geometry obejcts.\n */\nclass VertexClipNode extends AnimationClipNodeBase\n{\n\tprivate _frames:Array<Geometry> = new Array<Geometry>();\n\tprivate _translations:Array<Vector3D> = new Array<Vector3D>();\n\n\t/**\n\t * Returns a vector of geometry frames representing the vertex values of each animation frame in the clip.\n\t */\n\tpublic get frames():Array<Geometry>\n\t{\n\t\treturn this._frames;\n\t}\n\n\t/**\n\t * Creates a new <code>VertexClipNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = VertexClipState;\n\t}\n\n\t/**\n\t * Adds a geometry object to the internal timeline of the animation node.\n\t *\n\t * @param geometry The geometry object to add to the timeline of the node.\n\t * @param duration The specified duration of the frame in milliseconds.\n\t * @param translation The absolute translation of the frame, used in root delta calculations for mesh movement.\n\t */\n\tpublic addFrame(geometry:Geometry, duration:number /*uint*/, translation:Vector3D = null)\n\t{\n\t\tthis._frames.push(geometry);\n\t\tthis._pDurations.push(duration);\n\t\tthis._translations.push(translation || new Vector3D());\n\n\t\tthis._pNumFrames = this._pDurations.length;\n\n\t\tthis._pStitchDirty = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateStitch()\n\t{\n\t\tsuper._pUpdateStitch();\n\n\t\tvar i:number /*uint*/ = this._pNumFrames - 1;\n\t\tvar p1:Vector3D, p2:Vector3D, delta:Vector3D;\n\t\twhile (i--) {\n\t\t\tthis._pTotalDuration += this._pDurations[i];\n\t\t\tp1 = this._translations[i];\n\t\t\tp2 = this._translations[i + 1];\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\n\t\tif (this._pNumFrames > 1 && (this._pStitchFinalFrame || !this._pLooping)) {\n\t\t\tthis._pTotalDuration += this._pDurations[this._pNumFrames - 1];\n\t\t\tp1 = this._translations[0];\n\t\t\tp2 = this._translations[1];\n\t\t\tdelta = p2.subtract(p1);\n\t\t\tthis._pTotalDelta.x += delta.x;\n\t\t\tthis._pTotalDelta.y += delta.y;\n\t\t\tthis._pTotalDelta.z += delta.z;\n\t\t}\n\t}\n}\n\nexport = VertexClipNode;",
    "import AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\n\n/**\n *\n */\nclass AnimationClipState extends AnimationStateBase\n{\n\tprivate _animationClipNode:AnimationClipNodeBase;\n\tprivate _animationStatePlaybackComplete:AnimationStateEvent;\n\tpublic _pBlendWeight:number;\n\tpublic _pCurrentFrame:number /*uint*/;\n\tpublic _pNextFrame:number /*uint*/;\n\n\tpublic _pOldFrame:number /*uint*/;\n\tpublic _pTimeDir:number /*int*/;\n\tpublic _pFramesDirty:boolean = true;\n\n\t/**\n\t * Returns a fractional value between 0 and 1 representing the blending ratio of the current playhead position\n\t * between the current frame (0) and next frame (1) of the animation.\n\t *\n\t * @see #currentFrame\n\t * @see #nextFrame\n\t */\n\tpublic get blendWeight():number\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._pBlendWeight;\n\t}\n\n\t/**\n\t * Returns the current frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get currentFrame():number /*uint*/\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._pCurrentFrame;\n\t}\n\n\t/**\n\t * Returns the next frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get nextFrame():number /*uint*/\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._pNextFrame;\n\t}\n\n\tconstructor(animator:AnimatorBase, animationClipNode:AnimationClipNodeBase)\n\t{\n\t\tsuper(animator, animationClipNode);\n\n\t\tthis._animationClipNode = animationClipNode;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic update(time:number /*int*/)\n\t{\n\t\tif (!this._animationClipNode.looping) {\n\t\t\tif (time > this._pStartTime + this._animationClipNode.totalDuration)\n\t\t\t\ttime = this._pStartTime + this._animationClipNode.totalDuration; else if (time < this._pStartTime)\n\t\t\t\ttime = this._pStartTime;\n\t\t}\n\n\t\tif (this._pTime == time - this._pStartTime)\n\t\t\treturn;\n\n\t\tthis._pUpdateTime(time);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tvar time:number /*int*/ = value*this._animationClipNode.totalDuration + this._pStartTime;\n\n\t\tif (this._pTime == time - this._pStartTime)\n\t\t\treturn;\n\n\t\tthis._pUpdateTime(time);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._pFramesDirty = true;\n\n\t\tthis._pTimeDir = (time - this._pStartTime > this._pTime)? 1 : -1;\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Updates the nodes internal playhead to determine the current and next animation frame, and the blendWeight between the two.\n\t *\n\t * @see #currentFrame\n\t * @see #nextFrame\n\t * @see #blendWeight\n\t */\n\tpublic _pUpdateFrames()\n\t{\n\t\tthis._pFramesDirty = false;\n\n\t\tvar looping:boolean = this._animationClipNode.looping;\n\t\tvar totalDuration:number /*uint*/ = this._animationClipNode.totalDuration;\n\t\tvar lastFrame:number /*uint*/ = this._animationClipNode.lastFrame;\n\t\tvar time:number /*int*/ = this._pTime;\n\n\t\t//trace(\"time\", time, totalDuration)\n\t\tif (looping && (time >= totalDuration || time < 0)) {\n\t\t\ttime %= totalDuration;\n\t\t\tif (time < 0)\n\t\t\t\ttime += totalDuration;\n\t\t}\n\n\t\tif (!looping && time >= totalDuration) {\n\t\t\tthis.notifyPlaybackComplete();\n\t\t\tthis._pCurrentFrame = lastFrame;\n\t\t\tthis._pNextFrame = lastFrame;\n\t\t\tthis._pBlendWeight = 0;\n\t\t} else if (!looping && time <= 0) {\n\t\t\tthis._pCurrentFrame = 0;\n\t\t\tthis._pNextFrame = 0;\n\t\t\tthis._pBlendWeight = 0;\n\t\t} else if (this._animationClipNode.fixedFrameRate) {\n\t\t\tvar t:number = time/totalDuration*lastFrame;\n\t\t\tthis._pCurrentFrame = Math.floor(t);\n\t\t\tthis._pBlendWeight = t - this._pCurrentFrame;\n\t\t\tthis._pNextFrame = this._pCurrentFrame + 1;\n\t\t} else {\n\t\t\tthis._pCurrentFrame = 0;\n\t\t\tthis._pNextFrame = 0;\n\n\t\t\tvar dur:number /*uint*/ = 0, frameTime:number /*uint*/;\n\t\t\tvar durations:Array<number> /*uint*/ = this._animationClipNode.durations;\n\n\t\t\tdo {\n\t\t\t\tframeTime = dur;\n\t\t\t\tdur += durations[this._pNextFrame];\n\t\t\t\tthis._pCurrentFrame = this._pNextFrame++;\n\t\t\t} while (time > dur);\n\n\t\t\tif (this._pCurrentFrame == lastFrame) {\n\t\t\t\tthis._pCurrentFrame = 0;\n\t\t\t\tthis._pNextFrame = 1;\n\t\t\t}\n\n\t\t\tthis._pBlendWeight = (time - frameTime)/durations[this._pCurrentFrame];\n\t\t}\n\t}\n\n\tprivate notifyPlaybackComplete()\n\t{\n\t\tif (this._animationStatePlaybackComplete == null)\n\t\t\tthis._animationStatePlaybackComplete = new AnimationStateEvent(AnimationStateEvent.PLAYBACK_COMPLETE, this._pAnimator, this, this._animationClipNode);\n\n\t\tthis._animationClipNode.dispatchEvent(this._animationStatePlaybackComplete);\n\t}\n}\n\nexport = AnimationClipState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport IAnimationState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IAnimationState\");\n\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\n\n/**\n *\n */\nclass AnimationStateBase implements IAnimationState\n{\n\tpublic _pAnimationNode:AnimationNodeBase;\n\tpublic _pRootDelta:Vector3D = new Vector3D();\n\tpublic _pPositionDeltaDirty:boolean = true;\n\n\tpublic _pTime:number;\n\tpublic _pStartTime:number = 0;\n\tpublic _pAnimator:AnimatorBase;\n\n\t/**\n\t * Returns a 3d vector representing the translation delta of the animating entity for the current timestep of animation\n\t */\n\tpublic get positionDelta():Vector3D\n\t{\n\t\tif (this._pPositionDeltaDirty) {\n\n\t\t\tthis._pUpdatePositionDelta();\n\t\t}\n\n\t\treturn this._pRootDelta;\n\n\t}\n\n\tconstructor(animator:AnimatorBase, animationNode:AnimationNodeBase)\n\t{\n\t\tthis._pAnimator = animator;\n\t\tthis._pAnimationNode = animationNode;\n\t}\n\n\t/**\n\t * Resets the start time of the node to a  new value.\n\t *\n\t * @param startTime The absolute start time (in milliseconds) of the node's starting time.\n\t */\n\tpublic offset(startTime:number)\n\t{\n\t\tthis._pStartTime = startTime;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t}\n\n\t/**\n\t * Updates the configuration of the node to its current state.\n\t *\n\t * @param time The absolute time (in milliseconds) of the animator's play head position.\n\t *\n\t * @see AnimatorBase#update()\n\t */\n\tpublic update(time:number)\n\t{\n\t\tif (this._pTime == time - this._pStartTime) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._pUpdateTime(time);\n\n\t}\n\n\t/**\n\t * Sets the animation phase of the node.\n\t *\n\t * @param value The phase value to use. 0 represents the beginning of an animation clip, 1 represents the end.\n\t */\n\tpublic phase(value:number)\n\t{\n\n\t}\n\n\t/**\n\t * Updates the node's internal playhead position.\n\t *\n\t * @param time The local time (in milliseconds) of the node's playhead position.\n\t */\n\tpublic _pUpdateTime(time:number)\n\t{\n\t\tthis._pTime = time - this._pStartTime;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t}\n\n\t/**\n\t * Updates the node's root delta position\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t}\n}\n\nexport = AnimationStateBase;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleAccelerationNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleAccelerationState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static ACCELERATION_INDEX:number /*int*/ = 0;\n\n\tprivate _particleAccelerationNode:ParticleAccelerationNode;\n\tprivate _acceleration:Vector3D;\n\tprivate _halfAcceleration:Vector3D;\n\t\n\t/**\n\t * Defines the acceleration vector of the state, used when in global mode.\n\t */\n\tpublic get acceleration():Vector3D\n\t{\n\t\treturn this._acceleration;\n\t}\n\t\n\tpublic set acceleration(value:Vector3D)\n\t{\n\t\tthis._acceleration.x = value.x;\n\t\tthis._acceleration.y = value.y;\n\t\tthis._acceleration.z = value.z;\n\n\t\tthis.updateAccelerationData();\n\t}\n\t\n\tconstructor(animator:ParticleAnimator, particleAccelerationNode:ParticleAccelerationNode)\n\t{\n\t\tsuper(animator, particleAccelerationNode);\n\n\t\tthis._particleAccelerationNode = particleAccelerationNode;\n\t\tthis._acceleration = this._particleAccelerationNode._acceleration;\n\n\t\tthis.updateAccelerationData();\n\t}\n\t\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleAccelerationState.ACCELERATION_INDEX);\n\t\t\n\t\tif (this._particleAccelerationNode.mode == ParticlePropertiesMode.LOCAL_STATIC)\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleAccelerationNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\telse\n\t\t\tanimationRegisterCache.setVertexConst(index, this._halfAcceleration.x, this._halfAcceleration.y, this._halfAcceleration.z);\n\t}\n\t\n\tprivate updateAccelerationData()\n\t{\n\t\tif (this._particleAccelerationNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tthis._halfAcceleration = new Vector3D(this._acceleration.x/2, this._acceleration.y/2, this._acceleration.z/2);\n\t}\n}\n\nexport = ParticleAccelerationState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleBezierCurveNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n/**\n * ...\n */\nclass ParticleBezierCurveState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static BEZIER_CONTROL_INDEX:number /*int*/ = 0;\n\n\t/** @private */\n\tpublic static BEZIER_END_INDEX:number /*int*/ = 1;\n\n\tprivate _particleBezierCurveNode:ParticleBezierCurveNode;\n\tprivate _controlPoint:Vector3D;\n\tprivate _endPoint:Vector3D;\n\n\t/**\n\t * Defines the default control point of the node, used when in global mode.\n\t */\n\tpublic get controlPoint():Vector3D\n\t{\n\t\treturn this._controlPoint;\n\t}\n\n\tpublic set controlPoint(value:Vector3D)\n\t{\n\t\tthis._controlPoint = value;\n\t}\n\n\t/**\n\t * Defines the default end point of the node, used when in global mode.\n\t */\n\tpublic get endPoint():Vector3D\n\t{\n\t\treturn this._endPoint;\n\t}\n\n\tpublic set endPoint(value:Vector3D)\n\t{\n\t\tthis._endPoint = value;\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleBezierCurveNode:ParticleBezierCurveNode)\n\t{\n\t\tsuper(animator, particleBezierCurveNode);\n\n\t\tthis._particleBezierCurveNode = particleBezierCurveNode;\n\t\tthis._controlPoint = this._particleBezierCurveNode._iControlPoint;\n\t\tthis._endPoint = this._particleBezierCurveNode._iEndPoint;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar controlIndex:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleBezierCurveState.BEZIER_CONTROL_INDEX);\n\t\tvar endIndex:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleBezierCurveState.BEZIER_END_INDEX);\n\n\t\tif (this._particleBezierCurveNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tanimationSubGeometry.activateVertexBuffer(controlIndex, this._particleBezierCurveNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\tanimationSubGeometry.activateVertexBuffer(endIndex, this._particleBezierCurveNode._iDataOffset + 3, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else {\n\t\t\tanimationRegisterCache.setVertexConst(controlIndex, this._controlPoint.x, this._controlPoint.y, this._controlPoint.z);\n\t\t\tanimationRegisterCache.setVertexConst(endIndex, this._endPoint.x, this._endPoint.y, this._endPoint.z);\n\t\t}\n\t}\n}\n\nexport = ParticleBezierCurveState;",
    "import MathConsts\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/MathConsts\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport Orientation3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Orientation3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleBillboardNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleBillboardState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MATRIX_INDEX:number /*int*/ = 0;\n\n\tprivate _matrix:Matrix3D = new Matrix3D;\n\n\tprivate _billboardAxis:Vector3D;\n\n\t/**\n\t *\n\t */\n\tconstructor(animator:ParticleAnimator, particleNode:ParticleBillboardNode)\n\t{\n\t\tsuper(animator, particleNode);\n\n\t\tthis._billboardAxis = particleNode._iBillboardAxis;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar comps:Array<Vector3D>;\n\t\tif (this._billboardAxis) {\n\t\t\tvar pos:Vector3D = renderable.sourceEntity.sceneTransform.position;\n\t\t\tvar look:Vector3D = camera.sceneTransform.position.subtract(pos);\n\t\t\tvar right:Vector3D = look.crossProduct(this._billboardAxis);\n\t\t\tright.normalize();\n\t\t\tlook = this.billboardAxis.crossProduct(right);\n\t\t\tlook.normalize();\n\n\t\t\t//create a quick inverse projection matrix\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tcomps = this._matrix.decompose(Orientation3D.AXIS_ANGLE);\n\t\t\tthis._matrix.copyColumnFrom(0, right);\n\t\t\tthis._matrix.copyColumnFrom(1, this.billboardAxis);\n\t\t\tthis._matrix.copyColumnFrom(2, look);\n\t\t\tthis._matrix.copyColumnFrom(3, pos);\n\t\t\tthis._matrix.appendRotation(-comps[1].w*MathConsts.RADIANS_TO_DEGREES, comps[1]);\n\t\t} else {\n\t\t\t//create a quick inverse projection matrix\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tthis._matrix.append(camera.inverseSceneTransform);\n\n\t\t\t//decompose using axis angle rotations\n\t\t\tcomps = this._matrix.decompose(Orientation3D.AXIS_ANGLE);\n\n\t\t\t//recreate the matrix with just the rotation data\n\t\t\tthis._matrix.identity();\n\t\t\tthis._matrix.appendRotation(-comps[1].w*MathConsts.RADIANS_TO_DEGREES, comps[1]);\n\t\t}\n\n\t\t//set a new matrix transform constant\n\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleBillboardState.MATRIX_INDEX), this._matrix);\n\t}\n\n\t/**\n\t * Defines the billboard axis.\n\t */\n\tpublic get billboardAxis():Vector3D\n\t{\n\t\treturn this.billboardAxis;\n\t}\n\n\tpublic set billboardAxis(value:Vector3D)\n\t{\n\t\tthis.billboardAxis = value? value.clone() : null;\n\t\tif (this.billboardAxis)\n\t\t\tthis.billboardAxis.normalize();\n\t}\n\n}\n\nexport = ParticleBillboardState;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleColorNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleColorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n * @author ...\n */\nclass ParticleColorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static START_MULTIPLIER_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static DELTA_MULTIPLIER_INDEX:number /*uint*/ = 1;\n\n\t/** @private */\n\tpublic static START_OFFSET_INDEX:number /*uint*/ = 2;\n\n\t/** @private */\n\tpublic static DELTA_OFFSET_INDEX:number /*uint*/ = 3;\n\n\t/** @private */\n\tpublic static CYCLE_INDEX:number /*uint*/ = 4;\n\n\tprivate _particleColorNode:ParticleColorNode;\n\tprivate _usesMultiplier:boolean;\n\tprivate _usesOffset:boolean;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _startColor:ColorTransform;\n\tprivate _endColor:ColorTransform;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _cycleData:Vector3D;\n\tprivate _startMultiplierData:Vector3D;\n\tprivate _deltaMultiplierData:Vector3D;\n\tprivate _startOffsetData:Vector3D;\n\tprivate _deltaOffsetData:Vector3D;\n\n\t/**\n\t * Defines the start color transform of the state, when in global mode.\n\t */\n\tpublic get startColor():ColorTransform\n\t{\n\t\treturn this._startColor;\n\t}\n\n\tpublic set startColor(value:ColorTransform)\n\t{\n\t\tthis._startColor = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the end color transform of the state, when in global mode.\n\t */\n\tpublic get endColor():ColorTransform\n\t{\n\t\treturn this._endColor;\n\t}\n\n\tpublic set endColor(value:ColorTransform)\n\t{\n\t\tthis._endColor = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleColorNode:ParticleColorNode)\n\t{\n\t\tsuper(animator, particleColorNode);\n\n\t\tthis._particleColorNode = particleColorNode;\n\t\tthis._usesMultiplier = this._particleColorNode._iUsesMultiplier;\n\t\tthis._usesOffset = this._particleColorNode._iUsesOffset;\n\t\tthis._usesCycle = this._particleColorNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleColorNode._iUsesPhase;\n\t\tthis._startColor = this._particleColorNode._iStartColor;\n\t\tthis._endColor = this._particleColorNode._iEndColor;\n\t\tthis._cycleDuration = this._particleColorNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleColorNode._iCyclePhase;\n\n\t\tthis.updateColorData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tvar dataOffset:number /*uint*/ = this._particleColorNode._iDataOffset;\n\t\t\tif (this._usesCycle)\n\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.CYCLE_INDEX), this._cycleData.x, this._cycleData.y, this._cycleData.z, this._cycleData.w);\n\n\t\t\tif (this._usesMultiplier) {\n\t\t\t\tif (this._particleColorNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_MULTIPLIER_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_MULTIPLIER_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t} else {\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_MULTIPLIER_INDEX), this._startMultiplierData.x, this._startMultiplierData.y, this._startMultiplierData.z, this._startMultiplierData.w);\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_MULTIPLIER_INDEX), this._deltaMultiplierData.x, this._deltaMultiplierData.y, this._deltaMultiplierData.z, this._deltaMultiplierData.w);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._usesOffset) {\n\t\t\t\tif (this._particleColorNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_OFFSET_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_OFFSET_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t} else {\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.START_OFFSET_INDEX), this._startOffsetData.x, this._startOffsetData.y, this._startOffsetData.z, this._startOffsetData.w);\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleColorState.DELTA_OFFSET_INDEX), this._deltaOffsetData.x, this._deltaOffsetData.y, this._deltaOffsetData.z, this._deltaOffsetData.w);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateColorData()\n\t{\n\t\tif (this._usesCycle) {\n\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tthis._cycleData = new Vector3D(Math.PI*2/this._cycleDuration, this._cyclePhase*Math.PI/180, 0, 0);\n\t\t}\n\t\tif (this._particleColorNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._usesMultiplier) {\n\t\t\t\t\tthis._startMultiplierData = new Vector3D((this._startColor.redMultiplier + this._endColor.redMultiplier)/2, (this._startColor.greenMultiplier + this._endColor.greenMultiplier)/2, (this._startColor.blueMultiplier + this._endColor.blueMultiplier)/2, (this._startColor.alphaMultiplier + this._endColor.alphaMultiplier)/2);\n\t\t\t\t\tthis._deltaMultiplierData = new Vector3D((this._endColor.redMultiplier - this._startColor.redMultiplier)/2, (this._endColor.greenMultiplier - this._startColor.greenMultiplier)/2, (this._endColor.blueMultiplier - this._startColor.blueMultiplier)/2, (this._endColor.alphaMultiplier - this._startColor.alphaMultiplier)/2);\n\t\t\t\t}\n\n\t\t\t\tif (this._usesOffset) {\n\t\t\t\t\tthis._startOffsetData = new Vector3D((this._startColor.redOffset + this._endColor.redOffset)/(255*2), (this._startColor.greenOffset + this._endColor.greenOffset)/(255*2), (this._startColor.blueOffset + this._endColor.blueOffset)/(255*2), (this._startColor.alphaOffset + this._endColor.alphaOffset)/(255*2));\n\t\t\t\t\tthis._deltaOffsetData = new Vector3D((this._endColor.redOffset - this._startColor.redOffset)/(255*2), (this._endColor.greenOffset - this._startColor.greenOffset)/(255*2), (this._endColor.blueOffset - this._startColor.blueOffset)/(255*2), (this._endColor.alphaOffset - this._startColor.alphaOffset)/(255*2));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this._usesMultiplier) {\n\t\t\t\t\tthis._startMultiplierData = new Vector3D(this._startColor.redMultiplier, this._startColor.greenMultiplier, this._startColor.blueMultiplier, this._startColor.alphaMultiplier);\n\t\t\t\t\tthis._deltaMultiplierData = new Vector3D((this._endColor.redMultiplier - this._startColor.redMultiplier), (this._endColor.greenMultiplier - this._startColor.greenMultiplier), (this._endColor.blueMultiplier - this._startColor.blueMultiplier), (this._endColor.alphaMultiplier - this._startColor.alphaMultiplier));\n\t\t\t\t}\n\n\t\t\t\tif (this._usesOffset) {\n\t\t\t\t\tthis._startOffsetData = new Vector3D(this._startColor.redOffset/255, this._startColor.greenOffset/255, this._startColor.blueOffset/255, this._startColor.alphaOffset/255);\n\t\t\t\t\tthis._deltaOffsetData = new Vector3D((this._endColor.redOffset - this._startColor.redOffset)/255, (this._endColor.greenOffset - this._startColor.greenOffset)/255, (this._endColor.blueOffset - this._startColor.blueOffset )/255, (this._endColor.alphaOffset - this._startColor.alphaOffset)/255);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport = ParticleColorState;",
    "import MathConsts\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/MathConsts\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticleFollowNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleFollowNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleFollowState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static FOLLOW_POSITION_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static FOLLOW_ROTATION_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleFollowNode:ParticleFollowNode;\n\tprivate _followTarget:DisplayObject;\n\n\tprivate _targetPos:Vector3D = new Vector3D();\n\tprivate _targetEuler:Vector3D = new Vector3D();\n\tprivate _prePos:Vector3D;\n\tprivate _preEuler:Vector3D;\n\tprivate _smooth:boolean;\n\n\t//temporary vector3D for calculation\n\tprivate _temp:Vector3D = new Vector3D();\n\n\tconstructor(animator:ParticleAnimator, particleFollowNode:ParticleFollowNode)\n\t{\n\t\tsuper(animator, particleFollowNode, true);\n\n\t\tthis._particleFollowNode = particleFollowNode;\n\t\tthis._smooth = particleFollowNode._iSmooth;\n\t}\n\n\tpublic get followTarget():DisplayObject\n\t{\n\t\treturn this._followTarget;\n\t}\n\n\tpublic set followTarget(value:DisplayObject)\n\t{\n\t\tthis._followTarget = value;\n\t}\n\n\tpublic get smooth():boolean\n\t{\n\t\treturn this._smooth;\n\t}\n\n\tpublic set smooth(value:boolean)\n\t{\n\t\tthis._smooth = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._followTarget) {\n\t\t\tif (this._particleFollowNode._iUsesPosition) {\n\t\t\t\tthis._targetPos.x = this._followTarget.transform.position.x/renderable.sourceEntity.scaleX;\n\t\t\t\tthis._targetPos.y = this._followTarget.transform.position.y/renderable.sourceEntity.scaleY;\n\t\t\t\tthis._targetPos.z = this._followTarget.transform.position.z/renderable.sourceEntity.scaleZ;\n\t\t\t}\n\t\t\tif (this._particleFollowNode._iUsesRotation) {\n\t\t\t\tthis._targetEuler.x = this._followTarget.rotationX;\n\t\t\t\tthis._targetEuler.y = this._followTarget.rotationY;\n\t\t\t\tthis._targetEuler.z = this._followTarget.rotationZ;\n\t\t\t\tthis._targetEuler.scaleBy(MathConsts.DEGREES_TO_RADIANS);\n\t\t\t}\n\t\t}\n\t\t//initialization\n\t\tif (!this._prePos)\n\t\t\tthis._prePos = this._targetPos.clone();\n\t\tif (!this._preEuler)\n\t\t\tthis._preEuler = this._targetEuler.clone();\n\n\t\tvar currentTime:number = this._pTime/1000;\n\t\tvar previousTime:number = animationSubGeometry.previousTime;\n\t\tvar deltaTime:number = currentTime - previousTime;\n\n\t\tvar needProcess:boolean = previousTime != currentTime;\n\n\t\tif (this._particleFollowNode._iUsesPosition && this._particleFollowNode._iUsesRotation) {\n\t\t\tif (needProcess)\n\t\t\t\tthis.processPositionAndRotation(currentTime, deltaTime, animationSubGeometry);\n\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_POSITION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_ROTATION_INDEX), this._particleFollowNode._iDataOffset + 3, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else if (this._particleFollowNode._iUsesPosition) {\n\t\t\tif (needProcess)\n\t\t\t\tthis.processPosition(currentTime, deltaTime, animationSubGeometry);\n\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_POSITION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else if (this._particleFollowNode._iUsesRotation) {\n\t\t\tif (needProcess)\n\t\t\t\tthis.precessRotation(currentTime, deltaTime, animationSubGeometry);\n\n\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleFollowState.FOLLOW_ROTATION_INDEX), this._particleFollowNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t}\n\n\t\tthis._prePos.copyFrom(this._targetPos);\n\t\tthis._targetEuler.copyFrom(this._targetEuler);\n\t\tanimationSubGeometry.previousTime = currentTime;\n\t}\n\n\tprivate processPosition(currentTime:number, deltaTime:number, animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tvar data:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\n\t\tvar changed:boolean = false;\n\t\tvar len:number /*uint*/ = data.length;\n\t\tvar interpolatedPos:Vector3D;\n\t\tvar posVelocity:Vector3D;\n\t\tif (this._smooth) {\n\t\t\tposVelocity = this._prePos.subtract(this._targetPos);\n\t\t\tposVelocity.scaleBy(1/deltaTime);\n\t\t} else\n\t\t\tinterpolatedPos = this._targetPos;\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++) {\n\t\t\tvar k:number = (currentTime - data[i].startTime)/data[i].totalTime;\n\t\t\tvar t:number = (k - Math.floor(k))*data[i].totalTime;\n\t\t\tif (t - deltaTime <= 0) {\n\t\t\t\tvar inc:number /*int*/ = data[i].startVertexIndex*animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;\n\n\t\t\t\tif (this._smooth) {\n\t\t\t\t\tthis._temp.copyFrom(posVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedPos = this._targetPos.add(this._temp);\n\t\t\t\t}\n\n\t\t\t\tif (vertexData[inc] != interpolatedPos.x || vertexData[inc + 1] != interpolatedPos.y || vertexData[inc + 2] != interpolatedPos.z) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfor (var j:number /*uint*/ = 0; j < data[i].numVertices; j++) {\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.z;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (changed)\n\t\t\tanimationSubGeometry.invalidateBuffer();\n\n\t}\n\n\tprivate precessRotation(currentTime:number, deltaTime:number, animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tvar data:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\n\t\tvar changed:boolean = false;\n\t\tvar len:number /*uint*/ = data.length;\n\n\t\tvar interpolatedRotation:Vector3D;\n\t\tvar rotationVelocity:Vector3D;\n\n\t\tif (this._smooth) {\n\t\t\trotationVelocity = this._preEuler.subtract(this._targetEuler);\n\t\t\trotationVelocity.scaleBy(1/deltaTime);\n\t\t} else\n\t\t\tinterpolatedRotation = this._targetEuler;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++) {\n\t\t\tvar k:number = (currentTime - data[i].startTime)/data[i].totalTime;\n\t\t\tvar t:number = (k - Math.floor(k))*data[i].totalTime;\n\t\t\tif (t - deltaTime <= 0) {\n\t\t\t\tvar inc:number /*int*/ = data[i].startVertexIndex*animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;\n\n\t\t\t\tif (this._smooth) {\n\t\t\t\t\tthis._temp.copyFrom(rotationVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedRotation = this._targetEuler.add(this._temp);\n\t\t\t\t}\n\n\t\t\t\tif (vertexData[inc] != interpolatedRotation.x || vertexData[inc + 1] != interpolatedRotation.y || vertexData[inc + 2] != interpolatedRotation.z) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfor (var j:number /*uint*/ = 0; j < data[i].numVertices; j++) {\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.z;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (changed)\n\t\t\tanimationSubGeometry.invalidateBuffer();\n\n\t}\n\n\tprivate processPositionAndRotation(currentTime:number, deltaTime:number, animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tvar data:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\n\t\tvar changed:boolean = false;\n\t\tvar len:number /*uint*/ = data.length;\n\n\t\tvar interpolatedPos:Vector3D;\n\t\tvar interpolatedRotation:Vector3D;\n\n\t\tvar posVelocity:Vector3D;\n\t\tvar rotationVelocity:Vector3D;\n\t\tif (this._smooth) {\n\t\t\tposVelocity = this._prePos.subtract(this._targetPos);\n\t\t\tposVelocity.scaleBy(1/deltaTime);\n\t\t\trotationVelocity = this._preEuler.subtract(this._targetEuler);\n\t\t\trotationVelocity.scaleBy(1/deltaTime);\n\t\t} else {\n\t\t\tinterpolatedPos = this._targetPos;\n\t\t\tinterpolatedRotation = this._targetEuler;\n\t\t}\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++) {\n\t\t\tvar k:number = (currentTime - data[i].startTime)/data[i].totalTime;\n\t\t\tvar t:number = (k - Math.floor(k))*data[i].totalTime;\n\t\t\tif (t - deltaTime <= 0) {\n\t\t\t\tvar inc:number /*int*/ = data[i].startVertexIndex*animationSubGeometry.totalLenOfOneVertex + this._particleFollowNode._iDataOffset;\n\t\t\t\tif (this._smooth) {\n\t\t\t\t\tthis._temp.copyFrom(posVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedPos = this._targetPos.add(this._temp);\n\n\t\t\t\t\tthis._temp.copyFrom(rotationVelocity);\n\t\t\t\t\tthis._temp.scaleBy(t);\n\t\t\t\t\tinterpolatedRotation = this._targetEuler.add(this._temp);\n\t\t\t\t}\n\n\t\t\t\tif (vertexData[inc] != interpolatedPos.x || vertexData[inc + 1] != interpolatedPos.y || vertexData[inc + 2] != interpolatedPos.z || vertexData[inc + 3] != interpolatedRotation.x || vertexData[inc + 4] != interpolatedRotation.y || vertexData[inc + 5] != interpolatedRotation.z) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfor (var j:number /*uint*/ = 0; j < data[i].numVertices; j++) {\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedPos.z;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.x;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.y;\n\t\t\t\t\t\tvertexData[inc++] = interpolatedRotation.z;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (changed)\n\t\t\tanimationSubGeometry.invalidateBuffer();\n\t}\n\n}\n\nexport = ParticleFollowState;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleInitialColorNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n*\n*/\nclass ParticleInitialColorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MULTIPLIER_INDEX:number /*uint*/ = 0;\n\t/** @private */\n\tpublic static OFFSET_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleInitialColorNode:ParticleInitialColorNode;\n\tprivate _usesMultiplier:boolean;\n\tprivate _usesOffset:boolean;\n\tprivate _initialColor:ColorTransform;\n\tprivate _multiplierData:Vector3D;\n\tprivate _offsetData:Vector3D;\n\n\tconstructor(animator:ParticleAnimator, particleInitialColorNode:ParticleInitialColorNode)\n\t{\n\t\tsuper(animator, particleInitialColorNode);\n\n\t\tthis._particleInitialColorNode = particleInitialColorNode;\n\t\tthis._usesMultiplier = particleInitialColorNode._iUsesMultiplier;\n\t\tthis._usesOffset = particleInitialColorNode._iUsesOffset;\n\t\tthis._initialColor = particleInitialColorNode._iInitialColor;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the initial color transform of the state, when in global mode.\n\t */\n\tpublic get initialColor():ColorTransform\n\t{\n\t\treturn this._initialColor;\n\t}\n\n\tpublic set initialColor(value:ColorTransform)\n\t{\n\t\tthis._initialColor = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\t// TODO: not used\n\t\trenderable = renderable;\n\t\tcamera = camera;\n\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tif (this._particleInitialColorNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\tvar dataOffset:number /*uint*/ = this._particleInitialColorNode._iDataOffset;\n\t\t\t\tif (this._usesMultiplier) {\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.MULTIPLIER_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\t\tdataOffset += 4;\n\t\t\t\t}\n\t\t\t\tif (this._usesOffset)\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.OFFSET_INDEX), dataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t} else {\n\t\t\t\tif (this._usesMultiplier)\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.MULTIPLIER_INDEX), this._multiplierData.x, this._multiplierData.y, this._multiplierData.z, this._multiplierData.w);\n\t\t\t\tif (this._usesOffset)\n\t\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleInitialColorState.OFFSET_INDEX), this._offsetData.x, this._offsetData.y, this._offsetData.z, this._offsetData.w);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateColorData()\n\t{\n\t\tif (this._particleInitialColorNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._usesMultiplier)\n\t\t\t\tthis._multiplierData = new Vector3D(this._initialColor.redMultiplier, this._initialColor.greenMultiplier, this._initialColor.blueMultiplier, this._initialColor.alphaMultiplier);\n\t\t\tif (this._usesOffset)\n\t\t\t\tthis._offsetData = new Vector3D(this._initialColor.redOffset/255, this._initialColor.greenOffset/255, this._initialColor.blueOffset/255, this._initialColor.alphaOffset/255);\n\t\t}\n\t}\n\n}\n\nexport = ParticleInitialColorState;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleOrbitNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleOrbitState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static ORBIT_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static EULERS_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleOrbitNode:ParticleOrbitNode;\n\tprivate _usesEulers:boolean;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _radius:number;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _eulers:Vector3D;\n\tprivate _orbitData:Vector3D;\n\tprivate _eulersMatrix:Matrix3D;\n\n\t/**\n\t * Defines the radius of the orbit when in global mode. Defaults to 100.\n\t */\n\tpublic get radius():number\n\t{\n\t\treturn this._radius;\n\t}\n\n\tpublic set radius(value:number)\n\t{\n\t\tthis._radius = value;\n\n\t\tthis.updateOrbitData();\n\t}\n\n\t/**\n\t * Defines the duration of the orbit in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateOrbitData();\n\t}\n\n\t/**\n\t * Defines the phase of the orbit in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateOrbitData();\n\t}\n\n\t/**\n\t * Defines the euler rotation in degrees, applied to the orientation of the orbit when in global mode.\n\t */\n\tpublic get eulers():Vector3D\n\t{\n\t\treturn this._eulers;\n\t}\n\n\tpublic set eulers(value:Vector3D)\n\t{\n\t\tthis._eulers = value;\n\n\t\tthis.updateOrbitData();\n\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleOrbitNode:ParticleOrbitNode)\n\t{\n\t\tsuper(animator, particleOrbitNode);\n\n\t\tthis._particleOrbitNode = particleOrbitNode;\n\t\tthis._usesEulers = this._particleOrbitNode._iUsesEulers;\n\t\tthis._usesCycle = this._particleOrbitNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleOrbitNode._iUsesPhase;\n\t\tthis._eulers = this._particleOrbitNode._iEulers;\n\t\tthis._radius = this._particleOrbitNode._iRadius;\n\t\tthis._cycleDuration = this._particleOrbitNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleOrbitNode._iCyclePhase;\n\t\tthis.updateOrbitData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleOrbitState.ORBIT_INDEX);\n\n\t\tif (this._particleOrbitNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tif (this._usesPhase)\n\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleOrbitNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\telse\n\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleOrbitNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t} else\n\t\t\tanimationRegisterCache.setVertexConst(index, this._orbitData.x, this._orbitData.y, this._orbitData.z, this._orbitData.w);\n\n\t\tif (this._usesEulers)\n\t\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleOrbitState.EULERS_INDEX), this._eulersMatrix);\n\t}\n\n\tprivate updateOrbitData()\n\t{\n\t\tif (this._usesEulers) {\n\t\t\tthis._eulersMatrix = new Matrix3D();\n\t\t\tthis._eulersMatrix.appendRotation(this._eulers.x, Vector3D.X_AXIS);\n\t\t\tthis._eulersMatrix.appendRotation(this._eulers.y, Vector3D.Y_AXIS);\n\t\t\tthis._eulersMatrix.appendRotation(this._eulers.z, Vector3D.Z_AXIS);\n\t\t}\n\t\tif (this._particleOrbitNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tthis._orbitData = new Vector3D(this._radius, 0, this._radius*Math.PI*2, this._cyclePhase*Math.PI/180);\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\t\tthis._orbitData.y = Math.PI*2/this._cycleDuration;\n\t\t\t} else\n\t\t\t\tthis._orbitData.y = Math.PI*2;\n\t\t}\n\t}\n}\n\nexport = ParticleOrbitState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleOscillatorNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleOscillatorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static OSCILLATOR_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleOscillatorNode:ParticleOscillatorNode;\n\tprivate _oscillator:Vector3D;\n\tprivate _oscillatorData:Vector3D;\n\n\t/**\n\t * Defines the default oscillator axis (x, y, z) and cycleDuration (w) of the state, used when in global mode.\n\t */\n\tpublic get oscillator():Vector3D\n\t{\n\t\treturn this._oscillator;\n\t}\n\n\tpublic set oscillator(value:Vector3D)\n\t{\n\t\tthis._oscillator = value;\n\n\t\tthis.updateOscillatorData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleOscillatorNode:ParticleOscillatorNode)\n\t{\n\t\tsuper(animator, particleOscillatorNode);\n\n\t\tthis._particleOscillatorNode = particleOscillatorNode;\n\t\tthis._oscillator = this._particleOscillatorNode._iOscillator;\n\n\t\tthis.updateOscillatorData();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleOscillatorState.OSCILLATOR_INDEX);\n\n\t\tif (this._particleOscillatorNode.mode == ParticlePropertiesMode.LOCAL_STATIC)\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleOscillatorNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\telse\n\t\t\tanimationRegisterCache.setVertexConst(index, this._oscillatorData.x, this._oscillatorData.y, this._oscillatorData.z, this._oscillatorData.w);\n\t}\n\n\tprivate updateOscillatorData()\n\t{\n\t\tif (this._particleOscillatorNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._oscillator.w <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\n\t\t\tif (this._oscillatorData == null)\n\t\t\t\tthis._oscillatorData = new Vector3D();\n\n\t\t\tthis._oscillatorData.x = this._oscillator.x;\n\t\t\tthis._oscillatorData.y = this._oscillator.y;\n\t\t\tthis._oscillatorData.z = this._oscillator.z;\n\t\t\tthis._oscillatorData.w = Math.PI*2/this._oscillator.w;\n\t\t}\n\t}\n}\n\nexport = ParticleOscillatorState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticlePositionNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticlePositionNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n * @author ...\n */\nclass ParticlePositionState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static POSITION_INDEX:number /*uint*/ = 0;\n\n\tprivate _particlePositionNode:ParticlePositionNode;\n\tprivate _position:Vector3D;\n\n\t/**\n\t * Defines the position of the particle when in global mode. Defaults to 0,0,0.\n\t */\n\tpublic get position():Vector3D\n\t{\n\t\treturn this._position;\n\t}\n\n\tpublic set position(value:Vector3D)\n\t{\n\t\tthis._position = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getPositions():Array<Vector3D>\n\t{\n\t\treturn this._pDynamicProperties;\n\t}\n\n\tpublic setPositions(value:Array<Vector3D>)\n\t{\n\t\tthis._pDynamicProperties = value;\n\n\t\tthis._pDynamicPropertiesDirty = new Object();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particlePositionNode:ParticlePositionNode)\n\t{\n\t\tsuper(animator, particlePositionNode);\n\n\t\tthis._particlePositionNode = particlePositionNode;\n\t\tthis._position = this._particlePositionNode._iPosition;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._particlePositionNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])\n\t\t\tthis._pUpdateDynamicProperties(animationSubGeometry);\n\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticlePositionState.POSITION_INDEX);\n\n\t\tif (this._particlePositionNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tanimationRegisterCache.setVertexConst(index, this._position.x, this._position.y, this._position.z);\n\t\telse\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particlePositionNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t}\n}\n\nexport = ParticlePositionState;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport ParticleRotateToHeadingNode\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleRotateToHeadingState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MATRIX_INDEX:number /*int*/ = 0;\n\n\tprivate _matrix:Matrix3D = new Matrix3D();\n\n\tconstructor(animator:ParticleAnimator, particleNode:ParticleNodeBase)\n\t{\n\t\tsuper(animator, particleNode);\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tthis._matrix.append(camera.inverseSceneTransform);\n\t\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotateToHeadingState.MATRIX_INDEX), this._matrix);\n\t\t}\n\t}\n\n}\n\nexport = ParticleRotateToHeadingState;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleRotateToPositionNode\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleRotateToPositionState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static MATRIX_INDEX:number /*int*/ = 0;\n\t/** @private */\n\tpublic static POSITION_INDEX:number /*int*/ = 1;\n\n\tprivate _particleRotateToPositionNode:ParticleRotateToPositionNode;\n\tprivate _position:Vector3D;\n\tprivate _matrix:Matrix3D = new Matrix3D();\n\tprivate _offset:Vector3D;\n\n\t/**\n\t * Defines the position of the point the particle will rotate to face when in global mode. Defaults to 0,0,0.\n\t */\n\tpublic get position():Vector3D\n\t{\n\t\treturn this._position;\n\t}\n\n\tpublic set position(value:Vector3D)\n\t{\n\t\tthis._position = value;\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleRotateToPositionNode:ParticleRotateToPositionNode)\n\t{\n\t\tsuper(animator, particleRotateToPositionNode);\n\n\t\tthis._particleRotateToPositionNode = particleRotateToPositionNode;\n\t\tthis._position = this._particleRotateToPositionNode._iPosition;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotateToPositionState.POSITION_INDEX);\n\n\t\tif (animationRegisterCache.hasBillboard) {\n\t\t\tthis._matrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\t\tthis._matrix.append(camera.inverseSceneTransform);\n\t\t\tanimationRegisterCache.setVertexConstFromMatrix(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotateToPositionState.MATRIX_INDEX), this._matrix);\n\t\t}\n\n\t\tif (this._particleRotateToPositionNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tthis._offset = renderable.sourceEntity.inverseSceneTransform.transformVector(this._position);\n\t\t\tanimationRegisterCache.setVertexConst(index, this._offset.x, this._offset.y, this._offset.z);\n\t\t} else\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleRotateToPositionNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\n\t}\n\n}\n\nexport = ParticleRotateToPositionState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleRotationalVelocityNode\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleRotationalVelocityState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static ROTATIONALVELOCITY_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleRotationalVelocityNode:ParticleRotationalVelocityNode;\n\tprivate _rotationalVelocityData:Vector3D;\n\tprivate _rotationalVelocity:Vector3D;\n\n\t/**\n\t * Defines the default rotationalVelocity of the state, used when in global mode.\n\t */\n\tpublic get rotationalVelocity():Vector3D\n\t{\n\t\treturn this._rotationalVelocity;\n\t}\n\n\tpublic set rotationalVelocity(value:Vector3D)\n\t{\n\t\tthis._rotationalVelocity = value;\n\n\t\tthis.updateRotationalVelocityData();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getRotationalVelocities():Array<Vector3D>\n\t{\n\t\treturn this._pDynamicProperties;\n\t}\n\n\tpublic setRotationalVelocities(value:Array<Vector3D>)\n\t{\n\t\tthis._pDynamicProperties = value;\n\n\t\tthis._pDynamicPropertiesDirty = new Object();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleRotationNode:ParticleRotationalVelocityNode)\n\t{\n\t\tsuper(animator, particleRotationNode);\n\n\t\tthis._particleRotationalVelocityNode = particleRotationNode;\n\t\tthis._rotationalVelocity = this._particleRotationalVelocityNode._iRotationalVelocity;\n\n\t\tthis.updateRotationalVelocityData();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])\n\t\t\tthis._pUpdateDynamicProperties(animationSubGeometry);\n\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleRotationalVelocityState.ROTATIONALVELOCITY_INDEX);\n\n\t\tif (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tanimationRegisterCache.setVertexConst(index, this._rotationalVelocityData.x, this._rotationalVelocityData.y, this._rotationalVelocityData.z, this._rotationalVelocityData.w);\n\t\telse\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleRotationalVelocityNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t}\n\n\tprivate updateRotationalVelocityData()\n\t{\n\t\tif (this._particleRotationalVelocityNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._rotationalVelocity.w <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must greater than zero\"));\n\t\t\tvar rotation:Vector3D = this._rotationalVelocity.clone();\n\n\t\t\tif (rotation.length <= 0)\n\t\t\t\trotation.z = 1; //set the default direction\n\t\t\telse\n\t\t\t\trotation.normalize();\n\t\t\t// w is used as angle/2 in agal\n\t\t\tthis._rotationalVelocityData = new Vector3D(rotation.x, rotation.y, rotation.z, Math.PI/rotation.w);\n\t\t}\n\t}\n}\n\nexport = ParticleRotationalVelocityState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleScaleNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleScaleNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleScaleState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static SCALE_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleScaleNode:ParticleScaleNode;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _minScale:number;\n\tprivate _maxScale:number;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _scaleData:Vector3D;\n\n\t/**\n\t * Defines the end scale of the state, when in global mode. Defaults to 1.\n\t */\n\tpublic get minScale():number\n\t{\n\t\treturn this._minScale;\n\t}\n\n\tpublic set minScale(value:number)\n\t{\n\t\tthis._minScale = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\t/**\n\t * Defines the end scale of the state, when in global mode. Defaults to 1.\n\t */\n\tpublic get maxScale():number\n\t{\n\t\treturn this._maxScale;\n\t}\n\n\tpublic set maxScale(value:number)\n\t{\n\t\tthis._maxScale = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\t/**\n\t * Defines the duration of the animation in seconds, used as a period independent of particle duration when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\t/**\n\t * Defines the phase of the cycle in degrees, used as the starting offset of the cycle when in global mode. Defaults to 0.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateScaleData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleScaleNode:ParticleScaleNode)\n\t{\n\t\tsuper(animator, particleScaleNode);\n\n\t\tthis._particleScaleNode = particleScaleNode;\n\t\tthis._usesCycle = this._particleScaleNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleScaleNode._iUsesPhase;\n\t\tthis._minScale = this._particleScaleNode._iMinScale;\n\t\tthis._maxScale = this._particleScaleNode._iMaxScale;\n\t\tthis._cycleDuration = this._particleScaleNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleScaleNode._iCyclePhase;\n\n\t\tthis.updateScaleData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleScaleState.SCALE_INDEX);\n\n\t\tif (this._particleScaleNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._usesPhase)\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleScaleNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\t\t\t\telse\n\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleScaleNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\t} else\n\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleScaleNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t} else\n\t\t\tanimationRegisterCache.setVertexConst(index, this._scaleData.x, this._scaleData.y, this._scaleData.z, this._scaleData.w);\n\t}\n\n\tprivate updateScaleData()\n\t{\n\t\tif (this._particleScaleNode.mode == ParticlePropertiesMode.GLOBAL) {\n\t\t\tif (this._usesCycle) {\n\t\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\t\tthis._scaleData = new Vector3D((this._minScale + this._maxScale)/2, Math.abs(this._minScale - this._maxScale)/2, Math.PI*2/this._cycleDuration, this._cyclePhase*Math.PI/180);\n\t\t\t} else\n\t\t\t\tthis._scaleData = new Vector3D(this._minScale, this._maxScale - this._minScale, 0, 0);\n\t\t}\n\t}\n}\n\nexport = ParticleScaleState;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ColorSegmentPoint\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ColorSegmentPoint\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleSegmentedColorNode\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n *\n */\nclass ParticleSegmentedColorState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static START_MULTIPLIER_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static START_OFFSET_INDEX:number /*uint*/ = 1;\n\n\t/** @private */\n\tpublic static TIME_DATA_INDEX:number /*uint*/ = 2;\n\n\tprivate _usesMultiplier:boolean;\n\tprivate _usesOffset:boolean;\n\tprivate _startColor:ColorTransform;\n\tprivate _endColor:ColorTransform;\n\tprivate _segmentPoints:Array<ColorSegmentPoint>;\n\tprivate _numSegmentPoint:number /*int*/;\n\n\tprivate _timeLifeData:Array<number>;\n\tprivate _multiplierData:Array<number>;\n\tprivate _offsetData:Array<number>;\n\n\t/**\n\t * Defines the start color transform of the state, when in global mode.\n\t */\n\tpublic get startColor():ColorTransform\n\t{\n\t\treturn this._startColor;\n\t}\n\n\tpublic set startColor(value:ColorTransform)\n\t{\n\t\tthis._startColor = value;\n\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the end color transform of the state, when in global mode.\n\t */\n\tpublic get endColor():ColorTransform\n\t{\n\t\treturn this._endColor;\n\t}\n\n\tpublic set endColor(value:ColorTransform)\n\t{\n\t\tthis._endColor = value;\n\t\tthis.updateColorData();\n\t}\n\n\t/**\n\t * Defines the number of segments.\n\t */\n\tpublic get numSegmentPoint():number /*int*/\n\t{\n\t\treturn this._numSegmentPoint;\n\t}\n\n\t/**\n\t * Defines the key points of color\n\t */\n\tpublic get segmentPoints():Array<ColorSegmentPoint>\n\t{\n\t\treturn this._segmentPoints;\n\t}\n\n\tpublic set segmentPoints(value:Array<ColorSegmentPoint>)\n\t{\n\t\tthis._segmentPoints = value;\n\t\tthis.updateColorData();\n\t}\n\n\tpublic get usesMultiplier():boolean\n\t{\n\t\treturn this._usesMultiplier;\n\t}\n\n\tpublic get usesOffset():boolean\n\t{\n\t\treturn this._usesOffset;\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleSegmentedColorNode:ParticleSegmentedColorNode)\n\t{\n\t\tsuper(animator, particleSegmentedColorNode);\n\n\t\tthis._usesMultiplier = particleSegmentedColorNode._iUsesMultiplier;\n\t\tthis._usesOffset = particleSegmentedColorNode._iUsesOffset;\n\t\tthis._startColor = particleSegmentedColorNode._iStartColor;\n\t\tthis._endColor = particleSegmentedColorNode._iEndColor;\n\t\tthis._segmentPoints = particleSegmentedColorNode._iSegmentPoints;\n\t\tthis._numSegmentPoint = particleSegmentedColorNode._iNumSegmentPoint;\n\t\tthis.updateColorData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needFragmentAnimation) {\n\t\t\tif (this._numSegmentPoint > 0)\n\t\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSegmentedColorState.TIME_DATA_INDEX), this._timeLifeData[0], this._timeLifeData[1], this._timeLifeData[2], this._timeLifeData[3]);\n\t\t\tif (this._usesMultiplier)\n\t\t\t\tanimationRegisterCache.setVertexConstFromArray(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSegmentedColorState.START_MULTIPLIER_INDEX), this._multiplierData);\n\t\t\tif (this._usesOffset)\n\t\t\t\tanimationRegisterCache.setVertexConstFromArray(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSegmentedColorState.START_OFFSET_INDEX), this._offsetData);\n\t\t}\n\t}\n\n\tprivate updateColorData()\n\t{\n\t\tthis._timeLifeData = new Array<number>();\n\t\tthis._multiplierData = new Array<number>();\n\t\tthis._offsetData = new Array<number>();\n\t\tvar i:number /*int*/;\n\t\tfor (i = 0; i < this._numSegmentPoint; i++) {\n\t\t\tif (i == 0)\n\t\t\t\tthis._timeLifeData.push(this._segmentPoints[i].life);\n\t\t\telse\n\t\t\t\tthis._timeLifeData.push(this._segmentPoints[i].life - this._segmentPoints[i - 1].life);\n\t\t}\n\t\tif (this._numSegmentPoint == 0)\n\t\t\tthis._timeLifeData.push(1);\n\t\telse\n\t\t\tthis._timeLifeData.push(1 - this._segmentPoints[i - 1].life);\n\n\t\tif (this._usesMultiplier) {\n\t\t\tthis._multiplierData.push(this._startColor.redMultiplier, this._startColor.greenMultiplier, this._startColor.blueMultiplier, this._startColor.alphaMultiplier);\n\t\t\tfor (i = 0; i < this._numSegmentPoint; i++) {\n\t\t\t\tif (i == 0)\n\t\t\t\t\tthis._multiplierData.push((this._segmentPoints[i].color.redMultiplier - this._startColor.redMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.greenMultiplier - this._startColor.greenMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.blueMultiplier - this._startColor.blueMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.alphaMultiplier - this._startColor.alphaMultiplier)/this._timeLifeData[i]);\n\t\t\t\telse\n\t\t\t\t\tthis._multiplierData.push((this._segmentPoints[i].color.redMultiplier - this._segmentPoints[i - 1].color.redMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.greenMultiplier - this._segmentPoints[i - 1].color.greenMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.blueMultiplier - this._segmentPoints[i - 1].color.blueMultiplier)/this._timeLifeData[i], (this._segmentPoints[i].color.alphaMultiplier - this._segmentPoints[i - 1].color.alphaMultiplier)/this._timeLifeData[i]);\n\t\t\t}\n\t\t\tif (this._numSegmentPoint == 0)\n\t\t\t\tthis._multiplierData.push(this._endColor.redMultiplier - this._startColor.redMultiplier, this._endColor.greenMultiplier - this._startColor.greenMultiplier, this._endColor.blueMultiplier - this._startColor.blueMultiplier, this._endColor.alphaMultiplier - this._startColor.alphaMultiplier);\n\t\t\telse\n\t\t\t\tthis._multiplierData.push((this._endColor.redMultiplier - this._segmentPoints[i - 1].color.redMultiplier)/this._timeLifeData[i], (this._endColor.greenMultiplier - this._segmentPoints[i - 1].color.greenMultiplier)/this._timeLifeData[i], (this._endColor.blueMultiplier - this._segmentPoints[i - 1].color.blueMultiplier)/this._timeLifeData[i], (this._endColor.alphaMultiplier - this._segmentPoints[i - 1].color.alphaMultiplier)/this._timeLifeData[i]);\n\t\t}\n\n\t\tif (this._usesOffset) {\n\t\t\tthis._offsetData.push(this._startColor.redOffset/255, this._startColor.greenOffset/255, this._startColor.blueOffset/255, this._startColor.alphaOffset/255);\n\t\t\tfor (i = 0; i < this._numSegmentPoint; i++) {\n\t\t\t\tif (i == 0)\n\t\t\t\t\tthis._offsetData.push((this._segmentPoints[i].color.redOffset - this._startColor.redOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.greenOffset - this._startColor.greenOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.blueOffset - this._startColor.blueOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.alphaOffset - this._startColor.alphaOffset)/this._timeLifeData[i]/255);\n\t\t\t\telse\n\t\t\t\t\tthis._offsetData.push((this._segmentPoints[i].color.redOffset - this._segmentPoints[i - 1].color.redOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.greenOffset - this._segmentPoints[i - 1].color.greenOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.blueOffset - this._segmentPoints[i - 1].color.blueOffset)/this._timeLifeData[i]/255, (this._segmentPoints[i].color.alphaOffset - this._segmentPoints[i - 1].color.alphaOffset)/this._timeLifeData[i]/255);\n\t\t\t}\n\t\t\tif (this._numSegmentPoint == 0)\n\t\t\t\tthis._offsetData.push((this._endColor.redOffset - this._startColor.redOffset)/255, (this._endColor.greenOffset - this._startColor.greenOffset)/255, (this._endColor.blueOffset - this._startColor.blueOffset)/255, (this._endColor.alphaOffset - this._startColor.alphaOffset)/255);\n\t\t\telse\n\t\t\t\tthis._offsetData.push((this._endColor.redOffset - this._segmentPoints[i - 1].color.redOffset)/this._timeLifeData[i]/255, (this._endColor.greenOffset - this._segmentPoints[i - 1].color.greenOffset)/this._timeLifeData[i]/255, (this._endColor.blueOffset - this._segmentPoints[i - 1].color.blueOffset)/this._timeLifeData[i]/255, (this._endColor.alphaOffset - this._segmentPoints[i - 1].color.alphaOffset)/this._timeLifeData[i]/255);\n\t\t}\n\t\t//cut off the data\n\t\tthis._timeLifeData.length = 4;\n\t}\n}\n\nexport = ParticleSegmentedColorState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleSpriteSheetNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleSpriteSheetState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static UV_INDEX_0:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static UV_INDEX_1:number /*uint*/ = 1;\n\n\tprivate _particleSpriteSheetNode:ParticleSpriteSheetNode;\n\tprivate _usesCycle:boolean;\n\tprivate _usesPhase:boolean;\n\tprivate _totalFrames:number /*int*/;\n\tprivate _numColumns:number /*int*/;\n\tprivate _numRows:number /*int*/;\n\tprivate _cycleDuration:number;\n\tprivate _cyclePhase:number;\n\tprivate _spriteSheetData:Array<number>;\n\n\t/**\n\t * Defines the cycle phase, when in global mode. Defaults to zero.\n\t */\n\tpublic get cyclePhase():number\n\t{\n\t\treturn this._cyclePhase;\n\t}\n\n\tpublic set cyclePhase(value:number)\n\t{\n\t\tthis._cyclePhase = value;\n\n\t\tthis.updateSpriteSheetData();\n\t}\n\n\t/**\n\t * Defines the cycle duration in seconds, when in global mode. Defaults to 1.\n\t */\n\tpublic get cycleDuration():number\n\t{\n\t\treturn this._cycleDuration;\n\t}\n\n\tpublic set cycleDuration(value:number)\n\t{\n\t\tthis._cycleDuration = value;\n\n\t\tthis.updateSpriteSheetData();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleSpriteSheetNode:ParticleSpriteSheetNode)\n\t{\n\t\tsuper(animator, particleSpriteSheetNode);\n\n\t\tthis._particleSpriteSheetNode = particleSpriteSheetNode;\n\n\t\tthis._usesCycle = this._particleSpriteSheetNode._iUsesCycle;\n\t\tthis._usesPhase = this._particleSpriteSheetNode._iUsesCycle;\n\t\tthis._totalFrames = this._particleSpriteSheetNode._iTotalFrames;\n\t\tthis._numColumns = this._particleSpriteSheetNode._iNumColumns;\n\t\tthis._numRows = this._particleSpriteSheetNode._iNumRows;\n\t\tthis._cycleDuration = this._particleSpriteSheetNode._iCycleDuration;\n\t\tthis._cyclePhase = this._particleSpriteSheetNode._iCyclePhase;\n\n\t\tthis.updateSpriteSheetData();\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needUVAnimation) {\n\t\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSpriteSheetState.UV_INDEX_0), this._spriteSheetData[0], this._spriteSheetData[1], this._spriteSheetData[2], this._spriteSheetData[3]);\n\t\t\tif (this._usesCycle) {\n\t\t\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleSpriteSheetState.UV_INDEX_1);\n\t\t\t\tif (this._particleSpriteSheetNode.mode == ParticlePropertiesMode.LOCAL_STATIC) {\n\t\t\t\t\tif (this._usesPhase)\n\t\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleSpriteSheetNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t\t\t\t\telse\n\t\t\t\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleSpriteSheetNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\t\t} else\n\t\t\t\t\tanimationRegisterCache.setVertexConst(index, this._spriteSheetData[4], this._spriteSheetData[5]);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate updateSpriteSheetData()\n\t{\n\t\tthis._spriteSheetData = new Array<number>(8);\n\n\t\tvar uTotal:number = this._totalFrames/this._numColumns;\n\n\t\tthis._spriteSheetData[0] = uTotal;\n\t\tthis._spriteSheetData[1] = 1/this._numColumns;\n\t\tthis._spriteSheetData[2] = 1/this._numRows;\n\n\t\tif (this._usesCycle) {\n\t\t\tif (this._cycleDuration <= 0)\n\t\t\t\tthrow(new Error(\"the cycle duration must be greater than zero\"));\n\t\t\tthis._spriteSheetData[4] = uTotal/this._cycleDuration;\n\t\t\tthis._spriteSheetData[5] = this._cycleDuration;\n\t\t\tif (this._usesPhase)\n\t\t\t\tthis._spriteSheetData[6] = this._cyclePhase;\n\t\t}\n\t}\n}\n\nexport = ParticleSpriteSheetState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleAnimationData\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleAnimationData\");\nimport ParticleNodeBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleStateBase extends AnimationStateBase\n{\n\tprivate _particleNode:ParticleNodeBase;\n\n\tpublic _pDynamicProperties:Array<Vector3D> = new Array<Vector3D>();\n\tpublic _pDynamicPropertiesDirty:Object = new Object();\n\n\tpublic _pNeedUpdateTime:boolean;\n\n\tconstructor(animator:ParticleAnimator, particleNode:ParticleNodeBase, needUpdateTime:boolean = false)\n\t{\n\t\tsuper(animator, particleNode);\n\n\t\tthis._particleNode = particleNode;\n\t\tthis._pNeedUpdateTime = needUpdateTime;\n\t}\n\n\tpublic get needUpdateTime():boolean\n\t{\n\t\treturn this._pNeedUpdateTime;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\n\t}\n\n\tpublic _pUpdateDynamicProperties(animationSubGeometry:AnimationSubGeometry)\n\t{\n\t\tthis._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId] = true;\n\n\t\tvar animationParticles:Array<ParticleAnimationData> = animationSubGeometry.animationParticles;\n\t\tvar vertexData:Array<number> = animationSubGeometry.vertexData;\n\t\tvar totalLenOfOneVertex:number /*uint*/ = animationSubGeometry.totalLenOfOneVertex;\n\t\tvar dataLength:number /*uint*/ = this._particleNode.dataLength;\n\t\tvar dataOffset:number /*uint*/ = this._particleNode._iDataOffset;\n\t\tvar vertexLength:number /*uint*/;\n\t\t//\t\t\tvar particleOffset:number /*uint*/;\n\t\tvar startingOffset:number /*uint*/;\n\t\tvar vertexOffset:number /*uint*/;\n\t\tvar data:Vector3D;\n\t\tvar animationParticle:ParticleAnimationData;\n\n\t\t//\t\t\tvar numParticles:number /*uint*/ = _positions.length/dataLength;\n\t\tvar numParticles:number /*uint*/ = this._pDynamicProperties.length;\n\t\tvar i:number /*uint*/ = 0;\n\t\tvar j:number /*uint*/ = 0;\n\t\tvar k:number /*uint*/ = 0;\n\n\t\t//loop through all particles\n\t\twhile (i < numParticles) {\n\t\t\t//loop through each particle data for the current particle\n\t\t\twhile (j < numParticles && (animationParticle = animationParticles[j]).index == i) {\n\t\t\t\tdata = this._pDynamicProperties[i];\n\t\t\t\tvertexLength = animationParticle.numVertices*totalLenOfOneVertex;\n\t\t\t\tstartingOffset = animationParticle.startVertexIndex*totalLenOfOneVertex + dataOffset;\n\t\t\t\t//loop through each vertex in the particle data\n\t\t\t\tfor (k = 0; k < vertexLength; k += totalLenOfOneVertex) {\n\t\t\t\t\tvertexOffset = startingOffset + k;\n\t\t\t\t\t//\t\t\t\t\t\tparticleOffset = i * dataLength;\n\t\t\t\t\t//loop through all vertex data for the current particle data\n\t\t\t\t\tfor (k = 0; k < vertexLength; k += totalLenOfOneVertex) {\n\t\t\t\t\t\tvertexOffset = startingOffset + k;\n\t\t\t\t\t\tvertexData[vertexOffset++] = data.x;\n\t\t\t\t\t\tvertexData[vertexOffset++] = data.y;\n\t\t\t\t\t\tvertexData[vertexOffset++] = data.z;\n\n\t\t\t\t\t\tif (dataLength == 4)\n\t\t\t\t\t\t\tvertexData[vertexOffset++] = data.w;\n\t\t\t\t\t}\n\t\t\t\t\t\t//loop through each value in the particle vertex\n\t\t\t\t\t\t//\t\t\t\t\t\tswitch(dataLength) {\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t//\t\t\t\t\t\t\t\tvertexData[vertexOffset++] = _positions[particleOffset++];\n\t\t\t\t\t\t//\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tj++;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\n\t\tanimationSubGeometry.invalidateBuffer();\n\t}\n\n}\n\nexport = ParticleStateBase;",
    "import Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleTimeNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleTimeState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static TIME_STREAM_INDEX:number /*uint*/ = 0;\n\n\t/** @private */\n\tpublic static TIME_CONSTANT_INDEX:number /*uint*/ = 1;\n\n\tprivate _particleTimeNode:ParticleTimeNode;\n\n\tconstructor(animator:ParticleAnimator, particleTimeNode:ParticleTimeNode)\n\t{\n\t\tsuper(animator, particleTimeNode, true);\n\n\t\tthis._particleTimeNode = particleTimeNode;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tanimationSubGeometry.activateVertexBuffer(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleTimeState.TIME_STREAM_INDEX), this._particleTimeNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_4);\n\n\t\tvar particleTime:number = this._pTime/1000;\n\t\tanimationRegisterCache.setVertexConst(animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleTimeState.TIME_CONSTANT_INDEX), particleTime, particleTime, particleTime, particleTime);\n\t}\n\n}\n\nexport = ParticleTimeState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticleUVNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleUVNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleUVState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static UV_INDEX:number /*uint*/ = 0;\n\n\tprivate _particleUVNode:ParticleUVNode;\n\n\tconstructor(animator:ParticleAnimator, particleUVNode:ParticleUVNode)\n\t{\n\t\tsuper(animator, particleUVNode);\n\n\t\tthis._particleUVNode = particleUVNode;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (animationRegisterCache.needUVAnimation) {\n\t\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleUVState.UV_INDEX);\n\t\t\tvar data:Vector3D = this._particleUVNode._iUvData;\n\t\t\tanimationRegisterCache.setVertexConst(index, data.x, data.y);\n\t\t}\n\t}\n\n}\n\nexport = ParticleUVState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLVertexBufferFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport ParticleAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/ParticleAnimator\");\nimport AnimationRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport AnimationSubGeometry\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationSubGeometry\");\nimport ParticlePropertiesMode\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode\");\nimport ParticleVelocityNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode\");\nimport ParticleStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ParticleStateBase\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ...\n */\nclass ParticleVelocityState extends ParticleStateBase\n{\n\t/** @private */\n\tpublic static VELOCITY_INDEX:number /*int*/ = 0;\n\n\tprivate _particleVelocityNode:ParticleVelocityNode;\n\tprivate _velocity:Vector3D;\n\n\t/**\n\t * Defines the default velocity vector of the state, used when in global mode.\n\t */\n\tpublic get velocity():Vector3D\n\t{\n\t\treturn this._velocity;\n\t}\n\n\tpublic set velocity(value:Vector3D)\n\t{\n\t\tthis._velocity = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getVelocities():Array<Vector3D>\n\t{\n\t\treturn this._pDynamicProperties;\n\t}\n\n\tpublic setVelocities(value:Array<Vector3D>)\n\t{\n\t\tthis._pDynamicProperties = value;\n\n\t\tthis._pDynamicPropertiesDirty = new Object();\n\t}\n\n\tconstructor(animator:ParticleAnimator, particleVelocityNode:ParticleVelocityNode)\n\t{\n\t\tsuper(animator, particleVelocityNode);\n\n\t\tthis._particleVelocityNode = particleVelocityNode;\n\t\tthis._velocity = this._particleVelocityNode._iVelocity;\n\t}\n\n\tpublic setRenderState(stage:Stage, renderable:RenderableBase, animationSubGeometry:AnimationSubGeometry, animationRegisterCache:AnimationRegisterCache, camera:Camera)\n\t{\n\t\tif (this._particleVelocityNode.mode == ParticlePropertiesMode.LOCAL_DYNAMIC && !this._pDynamicPropertiesDirty[animationSubGeometry._iUniqueId])\n\t\t\tthis._pUpdateDynamicProperties(animationSubGeometry);\n\n\t\tvar index:number /*int*/ = animationRegisterCache.getRegisterIndex(this._pAnimationNode, ParticleVelocityState.VELOCITY_INDEX);\n\n\t\tif (this._particleVelocityNode.mode == ParticlePropertiesMode.GLOBAL)\n\t\t\tanimationRegisterCache.setVertexConst(index, this._velocity.x, this._velocity.y, this._velocity.z);\n\t\telse\n\t\t\tanimationSubGeometry.activateVertexBuffer(index, this._particleVelocityNode._iDataOffset, stage, ContextGLVertexBufferFormat.FLOAT_3);\n\t}\n}\n\nexport = ParticleVelocityState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonBinaryLERPNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonBinaryLERPState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _blendWeight:number = 0;\n\tprivate _skeletonAnimationNode:SkeletonBinaryLERPNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _inputA:ISkeletonAnimationState;\n\tprivate _inputB:ISkeletonAnimationState;\n\n\t/**\n\t * Defines a fractional value between 0 and 1 representing the blending ratio between inputA (0) and inputB (1),\n\t * used to produce the skeleton pose output.\n\t *\n\t * @see inputA\n\t * @see inputB\n\t */\n\tpublic get blendWeight():number\n\t{\n\t\treturn this._blendWeight;\n\t}\n\n\tpublic set blendWeight(value:number)\n\t{\n\t\tthis._blendWeight = value;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t\tthis._skeletonPoseDirty = true;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonBinaryLERPNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tthis._inputA = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.inputA);\n\t\tthis._inputB = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.inputB);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tthis._inputA.phase(value);\n\t\tthis._inputB.phase(value);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._inputA.update(time);\n\t\tthis._inputB.update(time);\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tvar deltA:Vector3D = this._inputA.positionDelta;\n\t\tvar deltB:Vector3D = this._inputB.positionDelta;\n\n\t\tthis._pRootDelta.x = deltA.x + this._blendWeight*(deltB.x - deltA.x);\n\t\tthis._pRootDelta.y = deltA.y + this._blendWeight*(deltB.y - deltA.y);\n\t\tthis._pRootDelta.z = deltA.z + this._blendWeight*(deltB.z - deltA.z);\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the blendWeight value between input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tvar endPose:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar poses1:Array<JointPose> = this._inputA.getSkeletonPose(skeleton).jointPoses;\n\t\tvar poses2:Array<JointPose> = this._inputB.getSkeletonPose(skeleton).jointPoses;\n\t\tvar pose1:JointPose, pose2:JointPose;\n\t\tvar p1:Vector3D, p2:Vector3D;\n\t\tvar tr:Vector3D;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tpose1 = poses1[i];\n\t\t\tpose2 = poses2[i];\n\t\t\tp1 = pose1.translation;\n\t\t\tp2 = pose2.translation;\n\n\t\t\tendPose.orientation.lerp(pose1.orientation, pose2.orientation, this._blendWeight);\n\n\t\t\ttr = endPose.translation;\n\t\t\ttr.x = p1.x + this._blendWeight*(p2.x - p1.x);\n\t\t\ttr.y = p1.y + this._blendWeight*(p2.y - p1.y);\n\t\t\ttr.z = p1.z + this._blendWeight*(p2.z - p1.z);\n\t\t}\n\t}\n}\n\nexport = SkeletonBinaryLERPState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport SkeletonAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimator\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode\");\nimport AnimationClipState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationClipState\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonClipState extends AnimationClipState implements ISkeletonAnimationState\n{\n\tprivate _rootPos:Vector3D = new Vector3D();\n\tprivate _frames:Array<SkeletonPose>;\n\tprivate _skeletonClipNode:SkeletonClipNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _currentPose:SkeletonPose;\n\tprivate _nextPose:SkeletonPose;\n\n\t/**\n\t * Returns the current skeleton pose frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get currentPose():SkeletonPose\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._currentPose;\n\t}\n\n\t/**\n\t * Returns the next skeleton pose frame of animation in the clip based on the internal playhead position.\n\t */\n\tpublic get nextPose():SkeletonPose\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._nextPose;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonClipNode:SkeletonClipNode)\n\t{\n\t\tsuper(animator, skeletonClipNode);\n\n\t\tthis._skeletonClipNode = skeletonClipNode;\n\t\tthis._frames = this._skeletonClipNode.frames;\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateFrames()\n\t{\n\t\tsuper._pUpdateFrames();\n\n\t\tthis._currentPose = this._frames[this._pCurrentFrame];\n\n\t\tif (this._skeletonClipNode.looping && this._pNextFrame >= this._skeletonClipNode.lastFrame) {\n\t\t\tthis._nextPose = this._frames[0];\n\t\t\t(<SkeletonAnimator> this._pAnimator).dispatchCycleEvent();\n\t\t} else\n\t\t\tthis._nextPose = this._frames[this._pNextFrame];\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the internal playhead position.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tif (!this._skeletonClipNode.totalDuration)\n\t\t\treturn;\n\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\tvar currentPose:Array<JointPose> = this._currentPose.jointPoses;\n\t\tvar nextPose:Array<JointPose> = this._nextPose.jointPoses;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\t\tvar p1:Vector3D, p2:Vector3D;\n\t\tvar pose1:JointPose, pose2:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar endPose:JointPose;\n\t\tvar tr:Vector3D;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tif ((numJoints != currentPose.length) || (numJoints != nextPose.length))\n\t\t\tthrow new Error(\"joint counts don't match!\");\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tpose1 = currentPose[i];\n\t\t\tpose2 = nextPose[i];\n\t\t\tp1 = pose1.translation;\n\t\t\tp2 = pose2.translation;\n\n\t\t\tif (this._skeletonClipNode.highQuality)\n\t\t\t\tendPose.orientation.slerp(pose1.orientation, pose2.orientation, this._pBlendWeight); else\n\t\t\t\tendPose.orientation.lerp(pose1.orientation, pose2.orientation, this._pBlendWeight);\n\n\t\t\tif (i > 0) {\n\t\t\t\ttr = endPose.translation;\n\t\t\t\ttr.x = p1.x + this._pBlendWeight*(p2.x - p1.x);\n\t\t\t\ttr.y = p1.y + this._pBlendWeight*(p2.y - p1.y);\n\t\t\t\ttr.z = p1.z + this._pBlendWeight*(p2.z - p1.z);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\tvar p1:Vector3D, p2:Vector3D, p3:Vector3D;\n\t\tvar totalDelta:Vector3D = this._skeletonClipNode.totalDelta;\n\n\t\t// jumping back, need to reset position\n\t\tif ((this._pTimeDir > 0 && this._pNextFrame < this._pOldFrame) || (this._pTimeDir < 0 && this._pNextFrame > this._pOldFrame)) {\n\t\t\tthis._rootPos.x -= totalDelta.x*this._pTimeDir;\n\t\t\tthis._rootPos.y -= totalDelta.y*this._pTimeDir;\n\t\t\tthis._rootPos.z -= totalDelta.z*this._pTimeDir;\n\t\t}\n\n\t\tvar dx:number = this._rootPos.x;\n\t\tvar dy:number = this._rootPos.y;\n\t\tvar dz:number = this._rootPos.z;\n\n\t\tif (this._skeletonClipNode.stitchFinalFrame && this._pNextFrame == this._skeletonClipNode.lastFrame) {\n\t\t\tp1 = this._frames[0].jointPoses[0].translation;\n\t\t\tp2 = this._frames[1].jointPoses[0].translation;\n\t\t\tp3 = this._currentPose.jointPoses[0].translation;\n\n\t\t\tthis._rootPos.x = p3.x + p1.x + this._pBlendWeight*(p2.x - p1.x);\n\t\t\tthis._rootPos.y = p3.y + p1.y + this._pBlendWeight*(p2.y - p1.y);\n\t\t\tthis._rootPos.z = p3.z + p1.z + this._pBlendWeight*(p2.z - p1.z);\n\t\t} else {\n\t\t\tp1 = this._currentPose.jointPoses[0].translation;\n\t\t\tp2 = this._frames[this._pNextFrame].jointPoses[0].translation; //cover the instances where we wrap the pose but still want the final frame translation values\n\t\t\tthis._rootPos.x = p1.x + this._pBlendWeight*(p2.x - p1.x);\n\t\t\tthis._rootPos.y = p1.y + this._pBlendWeight*(p2.y - p1.y);\n\t\t\tthis._rootPos.z = p1.z + this._pBlendWeight*(p2.z - p1.z);\n\t\t}\n\n\t\tthis._pRootDelta.x = this._rootPos.x - dx;\n\t\tthis._pRootDelta.y = this._rootPos.y - dy;\n\t\tthis._pRootDelta.z = this._rootPos.z - dz;\n\n\t\tthis._pOldFrame = this._pNextFrame;\n\t}\n}\n\nexport = SkeletonClipState;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonDifferenceNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonDifferenceState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _blendWeight:number = 0;\n\tprivate static _tempQuat:Quaternion = new Quaternion();\n\tprivate _skeletonAnimationNode:SkeletonDifferenceNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _baseInput:ISkeletonAnimationState;\n\tprivate _differenceInput:ISkeletonAnimationState;\n\n\t/**\n\t * Defines a fractional value between 0 and 1 representing the blending ratio between the base input (0) and difference input (1),\n\t * used to produce the skeleton pose output.\n\t *\n\t * @see #baseInput\n\t * @see #differenceInput\n\t */\n\tpublic get blendWeight():number\n\t{\n\t\treturn this._blendWeight;\n\t}\n\n\tpublic set blendWeight(value:number)\n\t{\n\t\tthis._blendWeight = value;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t\tthis._skeletonPoseDirty = true;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonDifferenceNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tthis._baseInput = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.baseInput);\n\t\tthis._differenceInput = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.differenceInput);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tthis._baseInput.phase(value);\n\t\tthis._baseInput.phase(value);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._baseInput.update(time);\n\t\tthis._differenceInput.update(time);\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tvar deltA:Vector3D = this._baseInput.positionDelta;\n\t\tvar deltB:Vector3D = this._differenceInput.positionDelta;\n\n\t\tthis.positionDelta.x = deltA.x + this._blendWeight*deltB.x;\n\t\tthis.positionDelta.y = deltA.y + this._blendWeight*deltB.y;\n\t\tthis.positionDelta.z = deltA.z + this._blendWeight*deltB.z;\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the blendWeight value between base input and difference input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tvar endPose:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar basePoses:Array<JointPose> = this._baseInput.getSkeletonPose(skeleton).jointPoses;\n\t\tvar diffPoses:Array<JointPose> = this._differenceInput.getSkeletonPose(skeleton).jointPoses;\n\t\tvar base:JointPose, diff:JointPose;\n\t\tvar basePos:Vector3D, diffPos:Vector3D;\n\t\tvar tr:Vector3D;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tbase = basePoses[i];\n\t\t\tdiff = diffPoses[i];\n\t\t\tbasePos = base.translation;\n\t\t\tdiffPos = diff.translation;\n\n\t\t\tSkeletonDifferenceState._tempQuat.multiply(diff.orientation, base.orientation);\n\t\t\tendPose.orientation.lerp(base.orientation, SkeletonDifferenceState._tempQuat, this._blendWeight);\n\n\t\t\ttr = endPose.translation;\n\t\t\ttr.x = basePos.x + this._blendWeight*diffPos.x;\n\t\t\ttr.y = basePos.y + this._blendWeight*diffPos.y;\n\t\t\ttr.z = basePos.z + this._blendWeight*diffPos.z;\n\t\t}\n\t}\n}\n\nexport = SkeletonDifferenceState;",
    "import Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonDirectionalNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonDirectionalState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _skeletonAnimationNode:SkeletonDirectionalNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _inputA:ISkeletonAnimationState;\n\tprivate _inputB:ISkeletonAnimationState;\n\tprivate _blendWeight:number = 0;\n\tprivate _direction:number = 0;\n\tprivate _blendDirty:boolean = true;\n\tprivate _forward:ISkeletonAnimationState;\n\tprivate _backward:ISkeletonAnimationState;\n\tprivate _left:ISkeletonAnimationState;\n\tprivate _right:ISkeletonAnimationState;\n\n\t/**\n\t * Defines the direction in degrees of the aniamtion between the forwards (0), right(90) backwards (180) and left(270) input nodes,\n\t * used to produce the skeleton pose output.\n\t */\n\tpublic set direction(value:number)\n\t{\n\t\tif (this._direction == value)\n\t\t\treturn;\n\n\t\tthis._direction = value;\n\n\t\tthis._blendDirty = true;\n\n\t\tthis._skeletonPoseDirty = true;\n\t\tthis._pPositionDeltaDirty = true;\n\t}\n\n\tpublic get direction():number\n\t{\n\t\treturn this._direction;\n\t}\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonDirectionalNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tthis._forward = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.forward);\n\t\tthis._backward = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.backward);\n\t\tthis._left = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.left);\n\t\tthis._right = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode.right);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tthis._inputA.phase(value);\n\t\tthis._inputB.phase(value);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUdateTime(time:number /*int*/)\n\t{\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._inputA.update(time);\n\t\tthis._inputB.update(time);\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tvar deltA:Vector3D = this._inputA.positionDelta;\n\t\tvar deltB:Vector3D = this._inputB.positionDelta;\n\n\t\tthis.positionDelta.x = deltA.x + this._blendWeight*(deltB.x - deltA.x);\n\t\tthis.positionDelta.y = deltA.y + this._blendWeight*(deltB.y - deltA.y);\n\t\tthis.positionDelta.z = deltA.z + this._blendWeight*(deltB.z - deltA.z);\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the direction value between forward, backwards, left and right input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tif (this._blendDirty)\n\t\t\tthis.updateBlend();\n\n\t\tvar endPose:JointPose;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar poses1:Array<JointPose> = this._inputA.getSkeletonPose(skeleton).jointPoses;\n\t\tvar poses2:Array<JointPose> = this._inputB.getSkeletonPose(skeleton).jointPoses;\n\t\tvar pose1:JointPose, pose2:JointPose;\n\t\tvar p1:Vector3D, p2:Vector3D;\n\t\tvar tr:Vector3D;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var i:number /*uint*/ = 0; i < numJoints; ++i) {\n\t\t\tendPose = endPoses[i];\n\n\t\t\tif (endPose == null)\n\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\tpose1 = poses1[i];\n\t\t\tpose2 = poses2[i];\n\t\t\tp1 = pose1.translation;\n\t\t\tp2 = pose2.translation;\n\n\t\t\tendPose.orientation.lerp(pose1.orientation, pose2.orientation, this._blendWeight);\n\n\t\t\ttr = endPose.translation;\n\t\t\ttr.x = p1.x + this._blendWeight*(p2.x - p1.x);\n\t\t\ttr.y = p1.y + this._blendWeight*(p2.y - p1.y);\n\t\t\ttr.z = p1.z + this._blendWeight*(p2.z - p1.z);\n\t\t}\n\t}\n\n\t/**\n\t * Updates the blend value for the animation output based on the direction value between forward, backwards, left and right input nodes.\n\t *\n\t * @private\n\t */\n\tprivate updateBlend()\n\t{\n\t\tthis._blendDirty = false;\n\n\t\tif (this._direction < 0 || this._direction > 360) {\n\t\t\tthis._direction %= 360;\n\t\t\tif (this._direction < 0)\n\t\t\t\tthis._direction += 360;\n\t\t}\n\n\t\tif (this._direction < 90) {\n\t\t\tthis._inputA = this._forward;\n\t\t\tthis._inputB = this._right;\n\t\t\tthis._blendWeight = this._direction/90;\n\t\t} else if (this._direction < 180) {\n\t\t\tthis._inputA = this._right;\n\t\t\tthis._inputB = this._backward;\n\t\t\tthis._blendWeight = (this._direction - 90)/90;\n\t\t} else if (this._direction < 270) {\n\t\t\tthis._inputA = this._backward;\n\t\t\tthis._inputB = this._left;\n\t\t\tthis._blendWeight = (this._direction - 180)/90;\n\t\t} else {\n\t\t\tthis._inputA = this._left;\n\t\t\tthis._inputB = this._forward;\n\t\t\tthis._blendWeight = (this._direction - 270)/90;\n\t\t}\n\t}\n}\n\nexport = SkeletonDirectionalState;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonNaryLERPNode\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode\");\nimport AnimationStateBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationStateBase\");\nimport ISkeletonAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState\");\n\n/**\n *\n */\nclass SkeletonNaryLERPState extends AnimationStateBase implements ISkeletonAnimationState\n{\n\tprivate _skeletonAnimationNode:SkeletonNaryLERPNode;\n\tprivate _skeletonPose:SkeletonPose = new SkeletonPose();\n\tprivate _skeletonPoseDirty:boolean = true;\n\tprivate _blendWeights:Array<number> = new Array<number>();\n\tprivate _inputs:Array<ISkeletonAnimationState> = new Array<ISkeletonAnimationState>();\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:SkeletonNaryLERPNode)\n\t{\n\t\tsuper(animator, skeletonAnimationNode);\n\n\t\tthis._skeletonAnimationNode = skeletonAnimationNode;\n\n\t\tvar i:number /*uint*/ = this._skeletonAnimationNode.numInputs;\n\n\t\twhile (i--)\n\t\t\tthis._inputs[i] = <ISkeletonAnimationState> animator.getAnimationState(this._skeletonAnimationNode._iInputs[i]);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic phase(value:number)\n\t{\n\t\tthis._skeletonPoseDirty = true;\n\n\t\tthis._pPositionDeltaDirty = true;\n\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tif (this._blendWeights[j])\n\t\t\t\tthis._inputs[j].update(value);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUdateTime(time:number /*int*/)\n\t{\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tif (this._blendWeights[j])\n\t\t\t\tthis._inputs[j].update(time);\n\t\t}\n\n\t\tsuper._pUpdateTime(time);\n\t}\n\n\t/**\n\t * Returns the current skeleton pose of the animation in the clip based on the internal playhead position.\n\t */\n\tpublic getSkeletonPose(skeleton:Skeleton):SkeletonPose\n\t{\n\t\tif (this._skeletonPoseDirty)\n\t\t\tthis.updateSkeletonPose(skeleton);\n\n\t\treturn this._skeletonPose;\n\t}\n\n\t/**\n\t * Returns the blend weight of the skeleton aniamtion node that resides at the given input index.\n\t *\n\t * @param index The input index for which the skeleton animation node blend weight is requested.\n\t */\n\tpublic getBlendWeightAt(index:number /*uint*/):number\n\t{\n\t\treturn this._blendWeights[index];\n\t}\n\n\t/**\n\t * Sets the blend weight of the skeleton aniamtion node that resides at the given input index.\n\t *\n\t * @param index The input index on which the skeleton animation node blend weight is to be set.\n\t * @param blendWeight The blend weight value to use for the given skeleton animation node index.\n\t */\n\tpublic setBlendWeightAt(index:number /*uint*/, blendWeight:number)\n\t{\n\t\tthis._blendWeights[index] = blendWeight;\n\n\t\tthis._pPositionDeltaDirty = true;\n\t\tthis._skeletonPoseDirty = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\tthis._pPositionDeltaDirty = false;\n\n\t\tvar delta:Vector3D;\n\t\tvar weight:number;\n\n\t\tthis.positionDelta.x = 0;\n\t\tthis.positionDelta.y = 0;\n\t\tthis.positionDelta.z = 0;\n\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tweight = this._blendWeights[j];\n\n\t\t\tif (weight) {\n\t\t\t\tdelta = this._inputs[j].positionDelta;\n\t\t\t\tthis.positionDelta.x += weight*delta.x;\n\t\t\t\tthis.positionDelta.y += weight*delta.y;\n\t\t\t\tthis.positionDelta.z += weight*delta.z;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Updates the output skeleton pose of the node based on the blend weight values given to the input nodes.\n\t *\n\t * @param skeleton The skeleton used by the animator requesting the ouput pose.\n\t */\n\tprivate updateSkeletonPose(skeleton:Skeleton)\n\t{\n\t\tthis._skeletonPoseDirty = false;\n\n\t\tvar weight:number;\n\t\tvar endPoses:Array<JointPose> = this._skeletonPose.jointPoses;\n\t\tvar poses:Array<JointPose>;\n\t\tvar endPose:JointPose, pose:JointPose;\n\t\tvar endTr:Vector3D, tr:Vector3D;\n\t\tvar endQuat:Quaternion, q:Quaternion;\n\t\tvar firstPose:Array<JointPose>;\n\t\tvar i:number /*uint*/;\n\t\tvar w0:number, x0:number, y0:number, z0:number;\n\t\tvar w1:number, x1:number, y1:number, z1:number;\n\t\tvar numJoints:number /*uint*/ = skeleton.numJoints;\n\n\t\t// :s\n\t\tif (endPoses.length != numJoints)\n\t\t\tendPoses.length = numJoints;\n\n\t\tfor (var j:number /*uint*/ = 0; j < this._skeletonAnimationNode.numInputs; ++j) {\n\t\t\tweight = this._blendWeights[j];\n\n\t\t\tif (!weight)\n\t\t\t\tcontinue;\n\n\t\t\tposes = this._inputs[j].getSkeletonPose(skeleton).jointPoses;\n\n\t\t\tif (!firstPose) {\n\t\t\t\tfirstPose = poses;\n\t\t\t\tfor (i = 0; i < numJoints; ++i) {\n\t\t\t\t\tendPose = endPoses[i];\n\n\t\t\t\t\tif (endPose == null)\n\t\t\t\t\t\tendPose = endPoses[i] = new JointPose();\n\n\t\t\t\t\tpose = poses[i];\n\t\t\t\t\tq = pose.orientation;\n\t\t\t\t\ttr = pose.translation;\n\n\t\t\t\t\tendQuat = endPose.orientation;\n\n\t\t\t\t\tendQuat.x = weight*q.x;\n\t\t\t\t\tendQuat.y = weight*q.y;\n\t\t\t\t\tendQuat.z = weight*q.z;\n\t\t\t\t\tendQuat.w = weight*q.w;\n\n\t\t\t\t\tendTr = endPose.translation;\n\t\t\t\t\tendTr.x = weight*tr.x;\n\t\t\t\t\tendTr.y = weight*tr.y;\n\t\t\t\t\tendTr.z = weight*tr.z;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (i = 0; i < skeleton.numJoints; ++i) {\n\t\t\t\t\tendPose = endPoses[i];\n\t\t\t\t\tpose = poses[i];\n\n\t\t\t\t\tq = firstPose[i].orientation;\n\t\t\t\t\tx0 = q.x;\n\t\t\t\t\ty0 = q.y;\n\t\t\t\t\tz0 = q.z;\n\t\t\t\t\tw0 = q.w;\n\n\t\t\t\t\tq = pose.orientation;\n\t\t\t\t\ttr = pose.translation;\n\n\t\t\t\t\tx1 = q.x;\n\t\t\t\t\ty1 = q.y;\n\t\t\t\t\tz1 = q.z;\n\t\t\t\t\tw1 = q.w;\n\t\t\t\t\t// find shortest direction\n\t\t\t\t\tif (x0*x1 + y0*y1 + z0*z1 + w0*w1 < 0) {\n\t\t\t\t\t\tx1 = -x1;\n\t\t\t\t\t\ty1 = -y1;\n\t\t\t\t\t\tz1 = -z1;\n\t\t\t\t\t\tw1 = -w1;\n\t\t\t\t\t}\n\t\t\t\t\tendQuat = endPose.orientation;\n\t\t\t\t\tendQuat.x += weight*x1;\n\t\t\t\t\tendQuat.y += weight*y1;\n\t\t\t\t\tendQuat.z += weight*z1;\n\t\t\t\t\tendQuat.w += weight*w1;\n\n\t\t\t\t\tendTr = endPose.translation;\n\t\t\t\t\tendTr.x += weight*tr.x;\n\t\t\t\t\tendTr.y += weight*tr.y;\n\t\t\t\t\tendTr.z += weight*tr.z;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < skeleton.numJoints; ++i)\n\t\t\tendPoses[i].orientation.normalize();\n\t}\n}\n\nexport = SkeletonNaryLERPState;",
    "import Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport VertexAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimator\");\nimport VertexClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/VertexClipNode\");\nimport AnimationClipState\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/AnimationClipState\");\nimport IVertexAnimationState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IVertexAnimationState\");\n\n/**\n *\n */\nclass VertexClipState extends AnimationClipState implements IVertexAnimationState\n{\n\tprivate _frames:Array<Geometry>;\n\tprivate _vertexClipNode:VertexClipNode;\n\tprivate _currentGeometry:Geometry;\n\tprivate _nextGeometry:Geometry;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get currentGeometry():Geometry\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._currentGeometry;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get nextGeometry():Geometry\n\t{\n\t\tif (this._pFramesDirty)\n\t\t\tthis._pUpdateFrames();\n\n\t\treturn this._nextGeometry;\n\t}\n\n\tconstructor(animator:AnimatorBase, vertexClipNode:VertexClipNode)\n\t{\n\t\tsuper(animator, vertexClipNode);\n\n\t\tthis._vertexClipNode = vertexClipNode;\n\t\tthis._frames = this._vertexClipNode.frames;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateFrames()\n\t{\n\t\tsuper._pUpdateFrames();\n\n\t\tthis._currentGeometry = this._frames[this._pCurrentFrame];\n\n\t\tif (this._vertexClipNode.looping && this._pNextFrame >= this._vertexClipNode.lastFrame) {\n\t\t\tthis._nextGeometry = this._frames[0];\n\t\t\t(<VertexAnimator> this._pAnimator).dispatchCycleEvent();\n\t\t} else\n\t\t\tthis._nextGeometry = this._frames[this._pNextFrame];\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdatePositionDelta()\n\t{\n\t\t//TODO:implement positiondelta functionality for vertex animations\n\t}\n}\n\nexport = VertexClipState;",
    "import SkeletonBinaryLERPNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode\");\nimport CrossfadeTransitionState\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState\");\n\n/**\n * A skeleton animation node that uses two animation node inputs to blend a lineraly interpolated output of a skeleton pose.\n */\nclass CrossfadeTransitionNode extends SkeletonBinaryLERPNode\n{\n\tpublic blendSpeed:number;\n\n\tpublic startBlend:number /*int*/;\n\n\t/**\n\t * Creates a new <code>CrossfadeTransitionNode</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pStateClass = CrossfadeTransitionState;\n\t}\n}\n\nexport = CrossfadeTransitionNode;",
    "import AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport SkeletonBinaryLERPNode\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode\");\nimport SkeletonBinaryLERPState\t\t\t= require(\"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState\");\nimport CrossfadeTransitionNode\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode\");\nimport AnimationStateEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/AnimationStateEvent\");\n\n/**\n *\n */\nclass CrossfadeTransitionState extends SkeletonBinaryLERPState\n{\n\tprivate _crossfadeTransitionNode:CrossfadeTransitionNode;\n\tprivate _animationStateTransitionComplete:AnimationStateEvent;\n\n\tconstructor(animator:AnimatorBase, skeletonAnimationNode:CrossfadeTransitionNode)\n\t{\n\t\tsuper(animator, <SkeletonBinaryLERPNode> skeletonAnimationNode);\n\n\t\tthis._crossfadeTransitionNode = skeletonAnimationNode;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateTime(time:number /*int*/)\n\t{\n\t\tthis.blendWeight = Math.abs(time - this._crossfadeTransitionNode.startBlend)/(1000*this._crossfadeTransitionNode.blendSpeed);\n\n\t\tif (this.blendWeight >= 1) {\n\t\t\tthis.blendWeight = 1;\n\n\t\t\tif (this._animationStateTransitionComplete == null)\n\t\t\t\tthis._animationStateTransitionComplete = new AnimationStateEvent(AnimationStateEvent.TRANSITION_COMPLETE, this._pAnimator, this, this._crossfadeTransitionNode);\n\n\t\t\tthis._crossfadeTransitionNode.dispatchEvent(this._animationStateTransitionComplete);\n\t\t}\n\n\t\tsuper._pUpdateTime(time);\n\t}\n}\n\nexport = CrossfadeTransitionState;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport CrossfadeTransitionNode\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode\");\nimport IAnimationTransition\t\t\t\t= require(\"awayjs-renderergl/lib/animators/transitions/IAnimationTransition\");\n\n/**\n *\n */\nclass CrossfadeTransition implements IAnimationTransition\n{\n\tpublic blendSpeed:number = 0.5;\n\n\tconstructor(blendSpeed:number)\n\t{\n\t\tthis.blendSpeed = blendSpeed;\n\t}\n\n\tpublic getAnimationNode(animator:AnimatorBase, startNode:AnimationNodeBase, endNode:AnimationNodeBase, startBlend:number /*int*/):AnimationNodeBase\n\t{\n\t\tvar crossFadeTransitionNode:CrossfadeTransitionNode = new CrossfadeTransitionNode();\n\t\tcrossFadeTransitionNode.inputA = startNode;\n\t\tcrossFadeTransitionNode.inputB = endNode;\n\t\tcrossFadeTransitionNode.blendSpeed = this.blendSpeed;\n\t\tcrossFadeTransitionNode.startBlend = startBlend;\n\n\t\treturn <AnimationNodeBase> crossFadeTransitionNode;\n\t}\n}\n\nexport = CrossfadeTransition;",
    "import Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\n\nimport ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\n\n/**\n * @class away.base.ParticleGeometry\n */\nclass ParticleGeometry extends Geometry\n{\n\tpublic particles:Array<ParticleData>;\n\n\tpublic numParticles:number /*uint*/;\n\n}\n\nexport = ParticleGeometry;",
    "import Error\t\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\n\nclass AnimationSetError extends Error\n{\n\tconstructor(message:string)\n\t{\n\t\tsuper(message);\n\t}\n}\n\nexport = AnimationSetError;",
    "import AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\n\nimport Event\t\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport IAnimationState\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/states/IAnimationState\");\n\n/**\n * Dispatched to notify changes in an animation state's state.\n */\nclass AnimationStateEvent extends Event\n{\n\t/**\n\t * Dispatched when a non-looping clip node inside an animation state reaches the end of its timeline.\n\t */\n\tpublic static PLAYBACK_COMPLETE:string = \"playbackComplete\";\n\n\tpublic static TRANSITION_COMPLETE:string = \"transitionComplete\";\n\n\tprivate _animator:AnimatorBase;\n\tprivate _animationState:IAnimationState;\n\tprivate _animationNode:AnimationNodeBase;\n\n\t/**\n\t * Create a new <code>AnimatonStateEvent</code>\n\t *\n\t * @param type The event type.\n\t * @param animator The animation state object that is the subject of this event.\n\t * @param animationNode The animation node inside the animation state from which the event originated.\n\t */\n\tconstructor(type:string, animator:AnimatorBase, animationState:IAnimationState, animationNode:AnimationNodeBase)\n\t{\n\t\tsuper(type);\n\n\t\tthis._animator = animator;\n\t\tthis._animationState = animationState;\n\t\tthis._animationNode = animationNode;\n\t}\n\n\t/**\n\t * The animator object that is the subject of this event.\n\t */\n\tpublic get animator():AnimatorBase\n\t{\n\t\treturn this._animator;\n\t}\n\n\t/**\n\t * The animation state object that is the subject of this event.\n\t */\n\tpublic get animationState():IAnimationState\n\t{\n\t\treturn this._animationState;\n\t}\n\n\t/**\n\t * The animation node inside the animation state from which the event originated.\n\t */\n\tpublic get animationNode():AnimationNodeBase\n\t{\n\t\treturn this._animationNode;\n\t}\n\n\t/**\n\t * Clones the event.\n\t *\n\t * @return An exact duplicate of the current object.\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn new AnimationStateEvent(this.type, this._animator, this._animationState, this._animationNode);\n\t}\n}\n\nexport = AnimationStateEvent;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\n\n/**\n * Dispatched to notify changes in an animator's state.\n */\nclass AnimatorEvent extends Event\n{\n\t/**\n\t * Defines the value of the type property of a start event object.\n\t */\n\tpublic static START:string = \"start\";\n\n\t/**\n\t * Defines the value of the type property of a stop event object.\n\t */\n\tpublic static STOP:string = \"stop\";\n\n\t/**\n\t * Defines the value of the type property of a cycle complete event object.\n\t */\n\tpublic static CYCLE_COMPLETE:string = \"cycle_complete\";\n\n\tprivate _animator:AnimatorBase;\n\n\t/**\n\t * Create a new <code>AnimatorEvent</code> object.\n\t *\n\t * @param type The event type.\n\t * @param animator The animator object that is the subject of this event.\n\t */\n\tconstructor(type:string, animator:AnimatorBase)\n\t{\n\t\tsuper(type);\n\t\tthis._animator = animator;\n\t}\n\n\tpublic get animator():AnimatorBase\n\t{\n\t\treturn this._animator;\n\t}\n\n\t/**\n\t * Clones the event.\n\t *\n\t * @return An exact duplicate of the current event object.\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn new AnimatorEvent(this.type, this._animator);\n\t}\n}\n\nexport = AnimatorEvent;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass ShadingMethodEvent extends Event\n{\n\tpublic static SHADER_INVALIDATED:string = \"ShaderInvalidated\";\n\n\tconstructor(type:string)\n\t{\n\n\t\tsuper(type);\n\n\t}\n}\n\nexport = ShadingMethodEvent;",
    "import Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\n\nimport Filter3DTaskBase\t\t\t\t= require(\"awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase\");\n\nclass Filter3DBase\n{\n\tprivate _tasks:Array<Filter3DTaskBase>;\n\tprivate _requireDepthRender:boolean;\n\tprivate _textureWidth:number;\n\tprivate _textureHeight:number;\n\n\tconstructor()\n\t{\n\t\tthis._tasks = new Array<Filter3DTaskBase>();\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n\tpublic pAddTask(filter:Filter3DTaskBase)\n\t{\n\t\tthis._tasks.push(filter);\n\n\t\tif (this._requireDepthRender == null)\n\t\t\tthis._requireDepthRender = filter.requireDepthRender;\n\t}\n\n\tpublic get tasks():Filter3DTaskBase[]\n\t{\n\t\treturn this._tasks;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\treturn this._tasks[0].getMainInputTexture(stage);\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic set textureWidth(value:number)\n\t{\n\t\tthis._textureWidth = value;\n\n\t\tfor (var i:number = 0; i < this._tasks.length; ++i)\n\t\t\tthis._tasks[i].textureWidth = value;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic set textureHeight(value:number)\n\t{\n\t\tthis._textureHeight = value;\n\n\t\tfor (var i:number = 0; i < this._tasks.length; ++i)\n\t\t\tthis._tasks[i].textureHeight = value;\n\t}\n\n\t// link up the filters correctly with the next filter\n\tpublic setRenderTargets(mainTarget:ITexture, stage:Stage)\n\t{\n\t\tthis._tasks[this._tasks.length - 1].target = mainTarget;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var i:number = 0; i < this._tasks.length; ++i)\n\t\t\tthis._tasks[i].dispose();\n\t}\n\n\tpublic update(stage:Stage, camera:Camera)\n\t{\n\n\t}\n}\n\nexport = Filter3DBase;",
    "import AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport AGALMiniAssembler\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport ContextGLTextureFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFormat\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IProgram\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\n\nclass Filter3DTaskBase\n{\n\tprivate _mainInputTexture:ITexture;\n\n\tprivate _scaledTextureWidth:number = -1;\n\tprivate _scaledTextureHeight:number = -1;\n\tprivate _textureWidth:number = -1;\n\tprivate _textureHeight:number = -1;\n\tprivate _textureDimensionsInvalid:boolean = true;\n\tprivate _program3DInvalid:boolean = true;\n\tprivate _program3D:IProgram;\n\tprivate _target:ITexture;\n\tprivate _requireDepthRender:boolean;\n\tprivate _textureScale:number = 0;\n\n\tconstructor(requireDepthRender:boolean = false)\n\t{\n\n\t\tthis._requireDepthRender = requireDepthRender;\n\n\t}\n\n\t/**\n\t * The texture scale for the input of this texture. This will define the output of the previous entry in the chain\n\t */\n\tpublic get textureScale():number\n\t{\n\t\treturn this._textureScale;\n\t}\n\n\tpublic set textureScale(value:number)\n\t{\n\t\tif (this._textureScale == value)\n\t\t\treturn;\n\n\t\tthis._textureScale = value;\n\t\tthis._scaledTextureWidth = this._textureWidth >> this._textureScale;\n\t\tthis._scaledTextureHeight = this._textureHeight >> this._textureScale;\n\t\tthis._textureDimensionsInvalid = true;\n\t}\n\n\tpublic get target():ITexture\n\t{\n\t\treturn this._target;\n\t}\n\n\tpublic set target(value:ITexture)\n\t{\n\t\tthis._target = value;\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic set textureWidth(value:number)\n\t{\n\t\tif (this._textureWidth == value)\n\t\t\treturn;\n\n\t\tthis._textureWidth = value;\n\t\tthis._scaledTextureWidth = this._textureWidth >> this._textureScale;\n\t\tthis._textureDimensionsInvalid = true;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic set textureHeight(value:number)\n\t{\n\t\tif (this._textureHeight == value)\n\t\t\treturn;\n\n\t\tthis._textureHeight = value;\n\t\tthis._scaledTextureHeight = this._textureHeight >> this._textureScale;\n\t\tthis._textureDimensionsInvalid = true;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\tif (this._textureDimensionsInvalid)\n\t\t\tthis.pUpdateTextures(stage);\n\n\t\treturn this._mainInputTexture;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tif (this._mainInputTexture)\n\t\t\tthis._mainInputTexture.dispose();\n\n\t\tif (this._program3D)\n\t\t\tthis._program3D.dispose();\n\t}\n\n\tpublic pInvalidateProgram()\n\t{\n\t\tthis._program3DInvalid = true;\n\t}\n\n\tpublic pUpdateProgram(stage:Stage)\n\t{\n\t\tif (this._program3D)\n\t\t\tthis._program3D.dispose();\n\n\t\tthis._program3D = stage.context.createProgram();\n\n\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + this.pGetVertexCode() + \"endpart\"))['vertex'].data;\n\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + this.pGetFragmentCode() + \"endpart\"))['fragment'].data;\n\t\tthis._program3D.upload(vertexByteCode, fragmentByteCode);\n\t\tthis._program3DInvalid = false;\n\t}\n\n\tpublic pGetVertexCode():string\n\t{\n\t\t// TODO: imeplement AGAL <> GLSL\n\n\t\treturn \"mov op, va0\\n\" + \"mov v0, va1\\n\";\n\t}\n\n\tpublic pGetFragmentCode():string\n\t{\n\t\tthrow new AbstractMethodError();\n\n\t\treturn null;\n\t}\n\n\tpublic pUpdateTextures(stage:Stage)\n\t{\n\t\tif (this._mainInputTexture)\n\t\t\tthis._mainInputTexture.dispose();\n\n\t\tthis._mainInputTexture = stage.context.createTexture(this._scaledTextureWidth, this._scaledTextureHeight, ContextGLTextureFormat.BGRA, true);\n\n\t\tthis._textureDimensionsInvalid = false;\n\t}\n\n\tpublic getProgram(stage:Stage):IProgram\n\t{\n\t\tif (this._program3DInvalid)\n\t\t\tthis.pUpdateProgram(stage);\n\n\t\treturn this._program3D;\n\t}\n\n\tpublic activate(stage:Stage, camera:Camera, depthTexture:ITexture)\n\t{\n\t}\n\n\tpublic deactivate(stage:Stage)\n\t{\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n}\n\nexport = Filter3DTaskBase;",
    "import Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ImageUtils\t\t\t\t\t= require(\"awayjs-core/lib/utils/ImageUtils\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nclass RTTBufferManager extends EventDispatcher\n{\n\tprivate static _instances:Array<RTTBufferManagerVO>;\n\n\tprivate _renderToTextureVertexBuffer:IVertexBuffer;\n\tprivate _renderToScreenVertexBuffer:IVertexBuffer;\n\n\tprivate _indexBuffer:IIndexBuffer;\n\tprivate _stage:Stage;\n\tprivate _viewWidth:number = -1;\n\tprivate _viewHeight:number = -1;\n\tprivate _textureWidth:number = -1;\n\tprivate _textureHeight:number = -1;\n\tprivate _renderToTextureRect:Rectangle;\n\tprivate _buffersInvalid:boolean = true;\n\n\tprivate _textureRatioX:number;\n\tprivate _textureRatioY:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper();\n\n\t\tthis._renderToTextureRect = new Rectangle();\n\n\t\tthis._stage = stage;\n\n\t}\n\n\tpublic static getInstance(stage:Stage):RTTBufferManager\n\t{\n\t\tif (!stage)\n\t\t\tthrow new Error(\"stage key cannot be null!\");\n\n\t\tif (RTTBufferManager._instances == null)\n\t\t\tRTTBufferManager._instances = new Array<RTTBufferManagerVO>();\n\n\t\tvar rttBufferManager:RTTBufferManager = RTTBufferManager.getRTTBufferManagerFromStage(stage);\n\n\t\tif (rttBufferManager == null) {\n\t\t\trttBufferManager = new RTTBufferManager(stage);\n\n\t\t\tvar vo:RTTBufferManagerVO = new RTTBufferManagerVO();\n\n\t\t\tvo.stage3d = stage;\n\t\t\tvo.rttbfm = rttBufferManager;\n\n\t\t\tRTTBufferManager._instances.push(vo);\n\t\t}\n\n\t\treturn rttBufferManager;\n\n\t}\n\n\tprivate static getRTTBufferManagerFromStage(stage:Stage):RTTBufferManager\n\t{\n\n\t\tvar l:number = RTTBufferManager._instances.length;\n\t\tvar r:RTTBufferManagerVO;\n\n\t\tfor (var c:number = 0; c < l; c++) {\n\t\t\tr = RTTBufferManager._instances[ c ];\n\n\t\t\tif (r.stage3d === stage)\n\t\t\t\treturn r.rttbfm;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate static deleteRTTBufferManager(stage:Stage):void\n\t{\n\t\tvar l:number = RTTBufferManager._instances.length;\n\t\tvar r:RTTBufferManagerVO;\n\n\t\tfor (var c:number = 0; c < l; c++) {\n\t\t\tr = RTTBufferManager._instances[ c ];\n\n\t\t\tif (r.stage3d === stage) {\n\t\t\t\tRTTBufferManager._instances.splice(c, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get textureRatioX():number\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._textureRatioX;\n\t}\n\n\tpublic get textureRatioY():number\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._textureRatioY;\n\t}\n\n\tpublic get viewWidth():number\n\t{\n\t\treturn this._viewWidth;\n\t}\n\n\tpublic set viewWidth(value:number)\n\t{\n\t\tif (value == this._viewWidth)\n\t\t\treturn;\n\n\t\tthis._viewWidth = value;\n\n\t\tthis._buffersInvalid = true;\n\n\t\tthis._textureWidth = ImageUtils.getBestPowerOf2(this._viewWidth);\n\n\t\tif (this._textureWidth > this._viewWidth) {\n\t\t\tthis._renderToTextureRect.x = Math.floor((this._textureWidth - this._viewWidth)*.5);\n\t\t\tthis._renderToTextureRect.width = this._viewWidth;\n\t\t} else {\n\t\t\tthis._renderToTextureRect.x = 0;\n\t\t\tthis._renderToTextureRect.width = this._textureWidth;\n\t\t}\n\n\t\tthis.dispatchEvent(new Event(Event.RESIZE));\n\t}\n\n\tpublic get viewHeight():number\n\t{\n\t\treturn this._viewHeight;\n\t}\n\n\tpublic set viewHeight(value:number)\n\t{\n\t\tif (value == this._viewHeight)\n\t\t\treturn;\n\n\t\tthis._viewHeight = value;\n\n\t\tthis._buffersInvalid = true;\n\n\t\tthis._textureHeight = ImageUtils.getBestPowerOf2(this._viewHeight);\n\n\t\tif (this._textureHeight > this._viewHeight) {\n\t\t\tthis._renderToTextureRect.y = Math.floor((this._textureHeight - this._viewHeight)*.5);\n\t\t\tthis._renderToTextureRect.height = this._viewHeight;\n\t\t} else {\n\t\t\tthis._renderToTextureRect.y = 0;\n\t\t\tthis._renderToTextureRect.height = this._textureHeight;\n\t\t}\n\n\t\tthis.dispatchEvent(new Event(Event.RESIZE));\n\t}\n\n\tpublic get renderToTextureVertexBuffer():IVertexBuffer\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToTextureVertexBuffer;\n\t}\n\n\tpublic get renderToScreenVertexBuffer():IVertexBuffer\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToScreenVertexBuffer;\n\n\t}\n\n\tpublic get indexBuffer():IIndexBuffer\n\t{\n\t\treturn this._indexBuffer;\n\t}\n\n\tpublic get renderToTextureRect():Rectangle\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToTextureRect;\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tRTTBufferManager.deleteRTTBufferManager(this._stage);\n\n\t\tif (this._indexBuffer) {\n\t\t\tthis._indexBuffer.dispose();\n\t\t\tthis._renderToScreenVertexBuffer.dispose();\n\t\t\tthis._renderToTextureVertexBuffer.dispose();\n\t\t\tthis._renderToScreenVertexBuffer = null;\n\t\t\tthis._renderToTextureVertexBuffer = null;\n\t\t\tthis._indexBuffer = null;\n\t\t}\n\t}\n\n\t// todo: place all this in a separate model, since it's used all over the place\n\t// maybe it even has a place in the core (together with screenRect etc)?\n\t// needs to be stored per view of course\n\tprivate updateRTTBuffers()\n\t{\n\t\tvar context:IContextGL = this._stage.context;\n\t\tvar textureVerts:number[];\n\t\tvar screenVerts:number[];\n\n\t\tvar x:number;\n\t\tvar y:number;\n\n\t\tif (this._renderToTextureVertexBuffer == null)\n\t\t\tthis._renderToTextureVertexBuffer = context.createVertexBuffer(4, 5);\n\n\t\tif (this._renderToScreenVertexBuffer == null)\n\t\t\tthis._renderToScreenVertexBuffer = context.createVertexBuffer(4, 5);\n\n\t\tif (!this._indexBuffer) {\n\t\t\tthis._indexBuffer = context.createIndexBuffer(6);\n\n\t\t\tthis._indexBuffer.uploadFromArray([2, 1, 0, 3, 2, 0], 0, 6);\n\t\t}\n\n\t\tthis._textureRatioX = x = Math.min(this._viewWidth/this._textureWidth, 1);\n\t\tthis._textureRatioY = y = Math.min(this._viewHeight/this._textureHeight, 1);\n\n\t\tvar u1:number = (1 - x)*.5;\n\t\tvar u2:number = (x + 1)*.5;\n\t\tvar v1:number = (y + 1)*.5;\n\t\tvar v2:number = (1 - y)*.5;\n\n\t\t// last element contains indices for data per vertex that can be passed to the vertex shader if necessary (ie: frustum corners for deferred rendering)\n\t\ttextureVerts = [    -x, -y, u1, v1, 0, x, -y, u2, v1, 1, x, y, u2, v2, 2, -x, y, u1, v2, 3 ];\n\n\t\tscreenVerts = [     -1, -1, u1, v1, 0, 1, -1, u2, v1, 1, 1, 1, u2, v2, 2, -1, 1, u1, v2, 3 ];\n\n\t\tthis._renderToTextureVertexBuffer.uploadFromArray(textureVerts, 0, 4);\n\t\tthis._renderToScreenVertexBuffer.uploadFromArray(screenVerts, 0, 4);\n\n\t\tthis._buffersInvalid = false;\n\t}\n}\n\nexport = RTTBufferManager;\n\nclass RTTBufferManagerVO\n{\n\tpublic stage3d:Stage;\n\n\tpublic rttbfm:RTTBufferManager;\n}",
    "import Debug\t\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/Debug\");\nimport BitmapImage2D\t\t\t\t\t= require(\"awayjs-core/lib/data/BitmapImage2D\");\nimport Box\t\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Box\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Point\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Rectangle\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Scene\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport View\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/View\");\nimport IPicker\t\t\t\t\t\t\t= require(\"awayjs-display/lib/pick/IPicker\");\nimport PickingCollisionVO\t\t\t\t= require(\"awayjs-display/lib/pick/PickingCollisionVO\");\nimport EntityCollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport AGALMiniAssembler\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport ContextGLDrawMode\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLDrawMode\");\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLClearMask\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport ContextGLCompareMode\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLProgramType\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLTriangleFace\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTriangleFace\");\nimport IContextGL\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport IProgram\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\nimport ITextureBase\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITextureBase\");\n\nimport DefaultRenderer\t\t\t\t\t= require(\"awayjs-renderergl/lib/DefaultRenderer\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport SubGeometryVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\nimport SubGeometryVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\n\n/**\n * Picks a 3d object from a view or scene by performing a separate render pass on the scene around the area being picked using key color values,\n * then reading back the color value of the pixel in the render representing the picking ray. Requires multiple passes and readbacks for retriving details\n * on an entity that has its shaderPickingDetails property set to true.\n *\n * A read-back operation from any GPU is not a very efficient process, and the amount of processing used can vary significantly between different hardware.\n *\n * @see away.entities.Entity#shaderPickingDetails\n *\n * @class away.pick.ShaderPicker\n */\nclass ShaderPicker implements IPicker\n{\n\tprivate _opaqueRenderableHead:RenderableBase;\n\tprivate _blendedRenderableHead:RenderableBase;\n\n\tprivate _stage:Stage;\n\tprivate _context:IContextGL;\n\tprivate _onlyMouseEnabled:boolean = true;\n\n\tprivate _objectProgram:IProgram;\n\tprivate _triangleProgram:IProgram;\n\tprivate _bitmapImage2D:BitmapImage2D;\n\tprivate _viewportData:Array<number>;\n\tprivate _boundOffsetScale:Array<number>;\n\tprivate _id:Array<number>;\n\n\tprivate _interactives:Array<RenderableBase> = new Array<RenderableBase>();\n\tprivate _interactiveId:number;\n\tprivate _hitColor:number;\n\tprivate _projX:number;\n\tprivate _projY:number;\n\n\tprivate _hitRenderable:RenderableBase;\n\tprivate _hitEntity:IEntity;\n\tprivate _localHitPosition:Vector3D = new Vector3D();\n\tprivate _hitUV:Point = new Point();\n\tprivate _faceIndex:number;\n\tprivate _subGeometryIndex:number;\n\n\tprivate _localHitNormal:Vector3D = new Vector3D();\n\n\tprivate _rayPos:Vector3D = new Vector3D();\n\tprivate _rayDir:Vector3D = new Vector3D();\n\tprivate _potentialFound:boolean;\n\tprivate static MOUSE_SCISSOR_RECT:Rectangle = new Rectangle(0, 0, 1, 1);\n\n\tprivate _shaderPickingDetails:boolean;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get onlyMouseEnabled():boolean\n\t{\n\t\treturn this._onlyMouseEnabled;\n\t}\n\n\tpublic set onlyMouseEnabled(value:boolean)\n\t{\n\t\tthis._onlyMouseEnabled = value;\n\t}\n\n\t/**\n\t * Creates a new <code>ShaderPicker</code> object.\n\t *\n\t * @param shaderPickingDetails Determines whether the picker includes a second pass to calculate extra\n\t * properties such as uv and normal coordinates.\n\t */\n\tconstructor(shaderPickingDetails:boolean = false)\n\t{\n\t\tthis._shaderPickingDetails = shaderPickingDetails;\n\n\t\tthis._id = new Array<number>(4);\n\t\tthis._viewportData = new Array<number>(4); // first 2 contain scale, last 2 translation\n\t\tthis._boundOffsetScale = new Array<number>(8); // first 2 contain scale, last 2 translation\n\t\tthis._boundOffsetScale[3] = 0;\n\t\tthis._boundOffsetScale[7] = 1;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getViewCollision(x:number, y:number, view:View):PickingCollisionVO\n\t{\n\t\tvar collector:EntityCollector = <EntityCollector> view.iEntityCollector;\n\n\t\tthis._stage = (<DefaultRenderer> view.renderer).stage;\n\n\t\tif (!this._stage)\n\t\t\treturn null;\n\n\t\tthis._context = <IContextGL> this._stage.context;\n\n\t\tthis._viewportData[0] = view.width;\n\t\tthis._viewportData[1] = view.height;\n\t\tthis._viewportData[2] = -(this._projX = 2*x/view.width - 1);\n\t\tthis._viewportData[3] = this._projY = 2*y/view.height - 1;\n\n\t\t// _potentialFound will be set to true if any object is actually rendered\n\t\tthis._potentialFound = false;\n\n\t\t//reset head values\n\t\tthis._blendedRenderableHead = null;\n\t\tthis._opaqueRenderableHead = null;\n\n\t\tthis.pDraw(collector, null);\n\n\t\t// clear buffers\n\t\tthis._context.setVertexBufferAt(0, null);\n\n\t\tif (!this._context || !this._potentialFound)\n\t\t\treturn null;\n\n\t\tif (!this._bitmapImage2D)\n\t\t\tthis._bitmapImage2D = new BitmapImage2D(1, 1, false, 0);\n\n\t\tthis._context.drawToBitmapImage2D(this._bitmapImage2D);\n\t\tthis._hitColor = this._bitmapImage2D.getPixel(0, 0);\n\n\t\tif (!this._hitColor) {\n\t\t\tthis._context.present();\n\t\t\treturn null;\n\t\t}\n\n\t\tthis._hitRenderable = this._interactives[this._hitColor - 1];\n\t\tthis._hitEntity = this._hitRenderable.sourceEntity;\n\n\t\tif (this._onlyMouseEnabled && !this._hitEntity._iIsMouseEnabled())\n\t\t\treturn null;\n\n\t\tvar _collisionVO:PickingCollisionVO = this._hitEntity._iPickingCollisionVO;\n\t\tif (this._shaderPickingDetails) {\n\t\t\tthis.getHitDetails(view.camera);\n\t\t\t_collisionVO.localPosition = this._localHitPosition;\n\t\t\t_collisionVO.localNormal = this._localHitNormal;\n\t\t\t_collisionVO.uv = this._hitUV;\n\t\t\t_collisionVO.index = this._faceIndex;\n\t\t\t//_collisionVO.subGeometryIndex = this._subGeometryIndex;\n\n\t\t} else {\n\t\t\t_collisionVO.localPosition = null;\n\t\t\t_collisionVO.localNormal = null;\n\t\t\t_collisionVO.uv = null;\n\t\t\t_collisionVO.index = 0;\n\t\t\t//_collisionVO.subGeometryIndex = 0;\n\t\t}\n\n\t\treturn _collisionVO;\n\t}\n\n\t//*/\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getSceneCollision(position:Vector3D, direction:Vector3D, scene:Scene):PickingCollisionVO\n\t{\n\t\treturn null;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pDraw(entityCollector:EntityCollector, target:ITextureBase)\n\t{\n\n\t\tvar camera:Camera = entityCollector.camera;\n\n\t\tthis._context.clear(0, 0, 0, 1);\n\t\tthis._stage.scissorRect = ShaderPicker.MOUSE_SCISSOR_RECT;\n\n\t\tthis._interactives.length = this._interactiveId = 0;\n\n\t\tif (!this._objectProgram)\n\t\t\tthis.initObjectProgram();\n\n\t\tthis._context.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\tthis._context.setDepthTest(true, ContextGLCompareMode.LESS);\n\t\tthis._context.setProgram(this._objectProgram);\n\t\tthis._context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 4, this._viewportData, 1);\n\t\t//this.drawRenderables(entityCollector.opaqueRenderableHead, camera);\n\t\t//this.drawRenderables(entityCollector.blendedRenderableHead, camera);\n\t\t//TODO: reimplement ShaderPicker inheriting from RendererBase\n\t}\n\n\t/**\n\t * Draw a list of renderables.\n\t * @param renderables The renderables to draw.\n\t * @param camera The camera for which to render.\n\t */\n\tprivate drawRenderables(renderable:RenderableBase, camera:Camera)\n\t{\n\t\tvar matrix:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\t\tvar viewProjection:Matrix3D = camera.viewProjection;\n\n\t\twhile (renderable) {\n\t\t\t// it's possible that the renderable was already removed from the scene\n\t\t\tif (!renderable.sourceEntity.scene || !renderable.sourceEntity._iIsMouseEnabled()) {\n\t\t\t\trenderable = renderable.next;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis._potentialFound = true;\n\n\t\t\tthis._context.setCulling((<MaterialBase> renderable.renderOwner).bothSides? ContextGLTriangleFace.NONE : ContextGLTriangleFace.BACK, camera.projection.coordinateSystem);\n\n\t\t\tthis._interactives[this._interactiveId++] = renderable;\n\t\t\t// color code so that reading from bitmapdata will contain the correct value\n\t\t\tthis._id[1] = (this._interactiveId >> 8)/255; // on green channel\n\t\t\tthis._id[2] = (this._interactiveId & 0xff)/255; // on blue channel\n\n\t\t\tmatrix.copyFrom(renderable.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix.append(viewProjection);\n\t\t\tthis._context.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, matrix, true);\n\t\t\tthis._context.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, this._id, 1);\n\n\t\t\tvar subGeometryVO:SubGeometryVOBase = this._hitRenderable.subGeometryVO;\n\n\t\t\tsubGeometryVO.activateVertexBufferVO(0, (<TriangleSubGeometry> subGeometryVO.subGeometry).positions, this._stage);\n\t\t\tsubGeometryVO.getIndexBufferVO(this._stage).draw(ContextGLDrawMode.TRIANGLES, 0, subGeometryVO.numIndices);\n\n\t\t\trenderable = renderable.next;\n\t\t}\n\n\t}\n\n\tprivate updateRay(camera:Camera)\n\t{\n\t\tthis._rayPos = camera.scenePosition;\n\n\t\tthis._rayDir = camera.getRay(this._projX, this._projY, 1);\n\t\tthis._rayDir.normalize();\n\t}\n\n\t/**\n\t * Creates the Program that color-codes objects.\n\t */\n\tprivate initObjectProgram()\n\t{\n\t\tvar vertexCode:string;\n\t\tvar fragmentCode:string;\n\n\t\tthis._objectProgram = this._context.createProgram();\n\n\t\tvertexCode = \"m44 vt0, va0, vc0\t\t\t\\n\" + \"mul vt1.xy, vt0.w, vc4.zw\t\\n\" + \"add vt0.xy, vt0.xy, vt1.xy\t\\n\" + \"mul vt0.xy, vt0.xy, vc4.xy\t\\n\" + \"mov op, vt0\t\\n\";\n\t\tfragmentCode = \"mov oc, fc0\"; // write identifier\n\n\t\tDebug.throwPIR('ShaderPicker', 'initTriangleProgram', 'Dependency: initObjectProgram')\n\t\t//_objectProgram.upload(new AGALMiniAssembler().assemble(ContextGLProgramType.VERTEX, vertexCode),new AGALMiniAssembler().assemble(ContextGLProgramType.FRAGMENT, fragmentCode));\n\t}\n\n\t/**\n\t * Creates the Program that renders positions.\n\t */\n\n\tprivate initTriangleProgram()\n\t{\n\t\tvar vertexCode:string;\n\t\tvar fragmentCode:string;\n\n\t\tthis._triangleProgram = this._context.createProgram();\n\n\t\t// todo: add animation code\n\t\tvertexCode = \"add vt0, va0, vc5 \t\t\t\\n\" + \"mul vt0, vt0, vc6 \t\t\t\\n\" + \"mov v0, vt0\t\t\t\t\\n\" + \"m44 vt0, va0, vc0\t\t\t\\n\" + \"mul vt1.xy, vt0.w, vc4.zw\t\\n\" + \"add vt0.xy, vt0.xy, vt1.xy\t\\n\" + \"mul vt0.xy, vt0.xy, vc4.xy\t\\n\" + \"mov op, vt0\t\\n\";\n\t\tfragmentCode = \"mov oc, v0\"; // write identifier\n\n\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + vertexCode + \"endpart\"))['vertex'].data;\n\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + fragmentCode + \"endpart\"))['fragment'].data;\n\t\tthis._triangleProgram.upload(vertexByteCode, fragmentByteCode);\n\t}\n\n\t/**\n\t * Gets more detailed information about the hir position, if required.\n\t * @param camera The camera used to view the hit object.\n\t */\n\tprivate getHitDetails(camera:Camera)\n\t{\n\t\tthis.getApproximatePosition(camera);\n\t\tthis.getPreciseDetails(camera);\n\t}\n\n\t/**\n\t * Finds a first-guess approximate position about the hit position.\n\t *\n\t * @param camera The camera used to view the hit object.\n\t */\n\tprivate getApproximatePosition(camera:Camera)\n\t{\n\t\tvar bounds:Box = this._hitRenderable.sourceEntity.getBox();\n\t\tvar col:number;\n\t\tvar scX:number, scY:number, scZ:number;\n\t\tvar offsX:number, offsY:number, offsZ:number;\n\t\tvar localViewProjection:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\tlocalViewProjection.copyFrom(this._hitRenderable.sourceEntity.getRenderSceneTransform(camera));\n\t\tlocalViewProjection.append(camera.viewProjection);\n\t\tif (!this._triangleProgram) {\n\t\t\tthis.initTriangleProgram();\n\t\t}\n\n\t\tthis._boundOffsetScale[4] = 1/(scX = bounds.width);\n\t\tthis._boundOffsetScale[5] = 1/(scY = bounds.height);\n\t\tthis._boundOffsetScale[6] = 1/(scZ = bounds.depth);\n\t\tthis._boundOffsetScale[0] = offsX = -bounds.x;\n\t\tthis._boundOffsetScale[1] = offsY = -bounds.y;\n\t\tthis._boundOffsetScale[2] = offsZ = -bounds.z;\n\n\t\tthis._context.setProgram(this._triangleProgram);\n\t\tthis._context.clear(0, 0, 0, 0, 1, 0, ContextGLClearMask.DEPTH);\n\t\tthis._context.setScissorRectangle(ShaderPicker.MOUSE_SCISSOR_RECT);\n\t\tthis._context.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, localViewProjection, true);\n\t\tthis._context.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, this._boundOffsetScale, 2);\n\n\t\tvar subGeometryVO:SubGeometryVOBase = this._hitRenderable.subGeometryVO;\n\n\t\tsubGeometryVO.activateVertexBufferVO(0, (<TriangleSubGeometry> subGeometryVO.subGeometry).positions, this._stage);\n\t\tsubGeometryVO.getIndexBufferVO(this._stage).draw(ContextGLDrawMode.TRIANGLES, 0, subGeometryVO.numIndices);\n\n\t\tthis._context.drawToBitmapImage2D(this._bitmapImage2D);\n\n\t\tcol = this._bitmapImage2D.getPixel(0, 0);\n\n\t\tthis._localHitPosition.x = ((col >> 16) & 0xff)*scX/255 - offsX;\n\t\tthis._localHitPosition.y = ((col >> 8) & 0xff)*scY/255 - offsY;\n\t\tthis._localHitPosition.z = (col & 0xff)*scZ/255 - offsZ;\n\t}\n\n\t/**\n\t * Use the approximate position info to find the face under the mouse position from which we can derive the precise\n\t * ray-face intersection point, then use barycentric coordinates to figure out the uv coordinates, etc.\n\t * @param camera The camera used to view the hit object.\n\t */\n\tprivate getPreciseDetails(camera:Camera)\n\t{\n\t\tvar len:number = indices.length;\n\t\tvar x1:number, y1:number, z1:number;\n\t\tvar x2:number, y2:number, z2:number;\n\t\tvar x3:number, y3:number, z3:number;\n\t\tvar i:number = 0, j:number = 1, k:number = 2;\n\t\tvar t1:number, t2:number, t3:number;\n\t\tvar v0x:number, v0y:number, v0z:number;\n\t\tvar v1x:number, v1y:number, v1z:number;\n\t\tvar v2x:number, v2y:number, v2z:number;\n\t\tvar ni1:number, ni2:number, ni3:number;\n\t\tvar n1:number, n2:number, n3:number, nLength:number;\n\t\tvar dot00:number, dot01:number, dot02:number, dot11:number, dot12:number;\n\t\tvar s:number, t:number, invDenom:number;\n\t\tvar x:number = this._localHitPosition.x, y:number = this._localHitPosition.y, z:number = this._localHitPosition.z;\n\t\tvar u:number, v:number;\n\t\tvar ui1:number, ui2:number, ui3:number;\n\t\tvar s0x:number, s0y:number, s0z:number;\n\t\tvar s1x:number, s1y:number, s1z:number;\n\t\tvar nl:number;\n\t\tvar subGeom:TriangleSubGeometry = <TriangleSubGeometry> this._hitRenderable._pGetSubGeometry();\n\t\tvar indices:Uint16Array = subGeom.indices.get(subGeom.numElements);\n\n\t\tvar positions:Float32Array = subGeom.positions.get(subGeom.numVertices);\n\t\tvar posDim:number = subGeom.positions.dimensions;\n\n\t\tvar uvs:Float32Array = subGeom.uvs.get(subGeom.numVertices);\n\t\tvar uvDim:number = subGeom.uvs.dimensions;\n\n\t\tvar normals:Float32Array = subGeom.normals.get(subGeom.numVertices);\n\t\tvar normalDim:number = subGeom.normals.dimensions;\n\n\t\tthis.updateRay(camera);\n\n\t\twhile (i < len) {\n\t\t\tt1 = indices[i]*posDim;\n\t\t\tt2 = indices[j]*posDim;\n\t\t\tt3 = indices[k]*posDim;\n\t\t\tx1 = positions[t1];\n\t\t\ty1 = positions[t1 + 1];\n\t\t\tz1 = positions[t1 + 2];\n\t\t\tx2 = positions[t2];\n\t\t\ty2 = positions[t2 + 1];\n\t\t\tz2 = positions[t2 + 2];\n\t\t\tx3 = positions[t3];\n\t\t\ty3 = positions[t3 + 1];\n\t\t\tz3 = positions[t3 + 2];\n\n\t\t\t// if within bounds\n\t\t\tif (!(    (x < x1 && x < x2 && x < x3) || (y < y1 && y < y2 && y < y3) || (z < z1 && z < z2 && z < z3) || (x > x1 && x > x2 && x > x3) || (y > y1 && y > y2 && y > y3) || (z > z1 && z > z2 && z > z3))) {\n\n\t\t\t\t// calculate barycentric coords for approximated position\n\t\t\t\tv0x = x3 - x1;\n\t\t\t\tv0y = y3 - y1;\n\t\t\t\tv0z = z3 - z1;\n\t\t\t\tv1x = x2 - x1;\n\t\t\t\tv1y = y2 - y1;\n\t\t\t\tv1z = z2 - z1;\n\t\t\t\tv2x = x - x1;\n\t\t\t\tv2y = y - y1;\n\t\t\t\tv2z = z - z1;\n\t\t\t\tdot00 = v0x*v0x + v0y*v0y + v0z*v0z;\n\t\t\t\tdot01 = v0x*v1x + v0y*v1y + v0z*v1z;\n\t\t\t\tdot02 = v0x*v2x + v0y*v2y + v0z*v2z;\n\t\t\t\tdot11 = v1x*v1x + v1y*v1y + v1z*v1z;\n\t\t\t\tdot12 = v1x*v2x + v1y*v2y + v1z*v2z;\n\t\t\t\tinvDenom = 1/(dot00*dot11 - dot01*dot01);\n\t\t\t\ts = (dot11*dot02 - dot01*dot12)*invDenom;\n\t\t\t\tt = (dot00*dot12 - dot01*dot02)*invDenom;\n\n\t\t\t\t// if inside the current triangle, fetch details hit information\n\t\t\t\tif (s >= 0 && t >= 0 && (s + t) <= 1) {\n\n\t\t\t\t\tni1 = indices[i]*normalDim;\n\t\t\t\t\tni2 = indices[j]*normalDim;\n\t\t\t\t\tni3 = indices[k]*normalDim;\n\n\t\t\t\t\tn1 = indices[ni1] + indices[ni2] + indices[ni3];\n\t\t\t\t\tn2 = indices[ni1 + 1] + indices[ni2 + 1] + indices[ni3 + 1];\n\t\t\t\t\tn3 = indices[ni1 + 2] + indices[ni2 + 2] + indices[ni3 + 2];\n\n\t\t\t\t\tnLength = Math.sqrt(n1*n1 + n2*n2 + n3*n3);\n\n\t\t\t\t\tn1 /= nLength;\n\t\t\t\t\tn2 /= nLength;\n\t\t\t\t\tn3 /= nLength;\n\n\t\t\t\t\t// this is def the triangle, now calculate precise coords\n\t\t\t\t\tthis.getPrecisePosition(this._hitRenderable.sourceEntity.inverseSceneTransform, n1, n2, n3, x1, y1, z1);\n\n\t\t\t\t\tv2x = this._localHitPosition.x - x1;\n\t\t\t\t\tv2y = this._localHitPosition.y - y1;\n\t\t\t\t\tv2z = this._localHitPosition.z - z1;\n\n\t\t\t\t\ts0x = x2 - x1; // s0 = p1 - p0\n\t\t\t\t\ts0y = y2 - y1;\n\t\t\t\t\ts0z = z2 - z1;\n\t\t\t\t\ts1x = x3 - x1; // s1 = p2 - p0\n\t\t\t\t\ts1y = y3 - y1;\n\t\t\t\t\ts1z = z3 - z1;\n\t\t\t\t\tthis._localHitNormal.x = s0y*s1z - s0z*s1y; // n = s0 x s1\n\t\t\t\t\tthis._localHitNormal.y = s0z*s1x - s0x*s1z;\n\t\t\t\t\tthis._localHitNormal.z = s0x*s1y - s0y*s1x;\n\t\t\t\t\tnl = 1/Math.sqrt(this._localHitNormal.x*this._localHitNormal.x + this._localHitNormal.y*this._localHitNormal.y + this._localHitNormal.z*this._localHitNormal.z); // normalize n\n\t\t\t\t\tthis._localHitNormal.x *= nl;\n\t\t\t\t\tthis._localHitNormal.y *= nl;\n\t\t\t\t\tthis._localHitNormal.z *= nl;\n\n\t\t\t\t\tdot02 = v0x*v2x + v0y*v2y + v0z*v2z;\n\t\t\t\t\tdot12 = v1x*v2x + v1y*v2y + v1z*v2z;\n\t\t\t\t\ts = (dot11*dot02 - dot01*dot12)*invDenom;\n\t\t\t\t\tt = (dot00*dot12 - dot01*dot02)*invDenom;\n\n\t\t\t\t\tui1 = indices[i]*uvDim\n\t\t\t\t\tui2 = indices[j]*uvDim\n\t\t\t\t\tui3 = indices[k]*uvDim\n\n\t\t\t\t\tu = uvs[ui1];\n\t\t\t\t\tv = uvs[ui1 + 1];\n\t\t\t\t\tthis._hitUV.x = u + t*(uvs[ui2] - u) + s*(uvs[ui3] - u);\n\t\t\t\t\tthis._hitUV.y = v + t*(uvs[ui2 + 1] - v) + s*(uvs[ui3 + 1] - v);\n\n\t\t\t\t\tthis._faceIndex = i;\n\t\t\t\t\t//TODO add back subGeometryIndex value\n\t\t\t\t\t//this._subGeometryIndex = away.utils.GeometryUtils.getMeshSubGeometryIndex(subGeom);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti += 3;\n\t\t\tj += 3;\n\t\t\tk += 3;\n\t\t}\n\t}\n\n\t/**\n\t * Finds the precise hit position by unprojecting the screen coordinate back unto the hit face's plane and\n\t * calculating the intersection point.\n\t * @param camera The camera used to render the object.\n\t * @param invSceneTransform The inverse scene transformation of the hit object.\n\t * @param nx The x-coordinate of the face's plane normal.\n\t * @param ny The y-coordinate of the face plane normal.\n\t * @param nz The z-coordinate of the face plane normal.\n\t * @param px The x-coordinate of a point on the face's plane (ie a face vertex)\n\t * @param py The y-coordinate of a point on the face's plane (ie a face vertex)\n\t * @param pz The z-coordinate of a point on the face's plane (ie a face vertex)\n\t */\n\n\tprivate getPrecisePosition(invSceneTransform:Matrix3D, nx:number, ny:number, nz:number, px:number, py:number, pz:number)\n\t{\n\t\t// calculate screen ray and find exact intersection position with triangle\n\t\tvar rx:number, ry:number, rz:number;\n\t\tvar ox:number, oy:number, oz:number;\n\t\tvar t:number;\n\t\tvar raw:Array<number> = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\tvar cx:number = this._rayPos.x, cy:number = this._rayPos.y, cz:number = this._rayPos.z;\n\n\t\t// unprojected projection point, gives ray dir in cam space\n\t\tox = this._rayDir.x;\n\t\toy = this._rayDir.y;\n\t\toz = this._rayDir.z;\n\n\t\t// transform ray dir and origin (cam pos) to object space\n\t\t//invSceneTransform.copyRawDataTo( raw  );\n\t\tinvSceneTransform.copyRawDataTo(raw);\n\t\trx = raw[0]*ox + raw[4]*oy + raw[8]*oz;\n\t\try = raw[1]*ox + raw[5]*oy + raw[9]*oz;\n\t\trz = raw[2]*ox + raw[6]*oy + raw[10]*oz;\n\n\t\tox = raw[0]*cx + raw[4]*cy + raw[8]*cz + raw[12];\n\t\toy = raw[1]*cx + raw[5]*cy + raw[9]*cz + raw[13];\n\t\toz = raw[2]*cx + raw[6]*cy + raw[10]*cz + raw[14];\n\n\t\tt = ((px - ox)*nx + (py - oy)*ny + (pz - oz)*nz)/(rx*nx + ry*ny + rz*nz);\n\n\t\tthis._localHitPosition.x = ox + rx*t;\n\t\tthis._localHitPosition.y = oy + ry*t;\n\t\tthis._localHitPosition.z = oz + rz*t;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._bitmapImage2D.dispose();\n\t\tif (this._triangleProgram)\n\t\t\tthis._triangleProgram.dispose();\n\n\t\tif (this._objectProgram)\n\t\t\tthis._objectProgram.dispose();\n\n\t\tthis._triangleProgram = null;\n\t\tthis._objectProgram = null;\n\t\tthis._bitmapImage2D = null;\n\t\tthis._hitRenderable = null;\n\t\tthis._hitEntity = null;\n\t}\n}\n\nexport = ShaderPicker;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport BasicMaterialPass\t\t\t= require(\"awayjs-renderergl/lib/render/passes/BasicMaterialPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\n\n/**\n * RenderMaterialObject forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass BasicMaterialRender extends RenderBase\n{\n\tprivate _material:BasicMaterial;\n\tprivate _pass:BasicMaterialPass;\n\n\n\tconstructor(pool:RenderPool, material:BasicMaterial, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, material, renderableClass, stage);\n\n\t\tthis._material = material;\n\n\t\tthis._pAddPass(this._pass = new BasicMaterialPass(this, material, renderableClass, this._stage));\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateRender()\n\t{\n\t\tsuper._pUpdateRender();\n\n\t\tthis._pRequiresBlending = (this._material.blendMode != BlendMode.NORMAL || this._material.alphaBlending || (this._material.colorTransform && this._material.colorTransform.alphaMultiplier < 1));\n\t\tthis._pass.preserveAlpha = this._material.preserveAlpha;//this._pRequiresBlending;\n\t\tthis._pass.shader.setBlendMode((this._renderOwner.blendMode == BlendMode.NORMAL && this._pRequiresBlending)? BlendMode.LAYER : this._material.blendMode);\n\t\t//this._pass.forceSeparateMVP = false;\n\t}\n}\n\nexport = BasicMaterialRender;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPassBase\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * DepthRender forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass DepthRender extends RenderPassBase\n{\n\tprivate _fragmentConstantsIndex:number;\n\n\t/**\n\t *\n\t * @param pool\n\t * @param renderOwner\n\t * @param renderableClass\n\t * @param stage\n\t */\n\tconstructor(pool:RenderPool, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, renderOwner, renderableClass, stage);\n\n\t\tthis._shader = new ShaderBase(renderableClass, this, this._stage);\n\n\t\tthis._pAddPass(this);\n\t}\n\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tsuper._iIncludeDependencies(shader);\n\n\t\tshader.projectionDependencies++;\n\n\t\tif (shader.alphaThreshold > 0)\n\t\t\tshader.uvDependencies++;\n\t}\n\n\n\tpublic _iInitConstantData(shader:ShaderBase)\n\t{\n\t\tsuper._iInitConstantData(shader);\n\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = shader.fragmentConstantData;\n\t\tdata[index] = 1.0;\n\t\tdata[index + 1] = 255.0;\n\t\tdata[index + 2] = 65025.0;\n\t\tdata[index + 3] = 16581375.0;\n\t\tdata[index + 4] = 1.0/255.0;\n\t\tdata[index + 5] = 1.0/255.0;\n\t\tdata[index + 6] = 1.0/255.0;\n\t\tdata[index + 7] = 0.0;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar targetReg:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\t\tvar dataReg1:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tvar dataReg2:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\tthis._fragmentConstantsIndex = dataReg1.index*4;\n\n\t\tvar temp1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp1, 1);\n\t\tvar temp2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp2, 1);\n\n\t\tcode += \"div \" + temp1 + \", \" + sharedRegisters.projectionFragment + \", \" + sharedRegisters.projectionFragment + \".w\\n\" + //\"sub ft2.z, fc0.x, ft2.z\\n\" +    //invert\n\t\t\t\"mul \" + temp1 + \", \" + dataReg1 + \", \" + temp1 + \".z\\n\" +\n\t\t\t\"frc \" + temp1 + \", \" + temp1 + \"\\n\" +\n\t\t\t\"mul \" + temp2 + \", \" + temp1 + \".yzww, \" + dataReg2 + \"\\n\";\n\n\t\t//codeF += \"mov ft1.w, fc1.w\t\\n\" +\n\t\t//    \"mov ft0.w, fc0.x\t\\n\";\n\n\t\tif (shader.texture && shader.alphaThreshold > 0) {\n\n\t\t\tshader.texture._iInitRegisters(shader, registerCache);\n\n\t\t\tvar albedo:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\t\tcode += shader.texture._iGetFragmentCode(shader, albedo, registerCache, sharedRegisters.uvVarying);\n\n\t\t\tvar cutOffReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\t\tcode += \"sub \" + albedo + \".w, \" + albedo + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\t\"kil \" + albedo + \".w\\n\";\n\t\t}\n\n\t\tcode += \"sub \" + targetReg + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\tregisterCache.removeFragmentTempUsage(temp1);\n\t\tregisterCache.removeFragmentTempUsage(temp2);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tif (this._shader.texture && this._shader.alphaThreshold > 0) {\n\t\t\tthis._shader.texture.activate(this._shader);\n\n\t\t\tthis._shader.fragmentConstantData[this._fragmentConstantsIndex + 8] = this._shader.alphaThreshold;\n\t\t}\n\t}\n}\n\nexport = DepthRender;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPassBase\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * DistanceRender is a pass that writes distance values to a depth map as a 32-bit value exploded over the 4 texture channels.\n * This is used to render omnidirectional shadow maps.\n */\nclass DistanceRender extends RenderPassBase\n{\n\tprivate _fragmentConstantsIndex:number;\n\n\t/**\n\t * Creates a new DistanceRender object.\n\t *\n\t * @param material The material to which this pass belongs.\n\t */\n\tconstructor(pool:RenderPool, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, renderOwner, renderableClass, stage);\n\n\t\tthis._shader = new ShaderBase(renderableClass, this, this._stage);\n\n\t\tthis._pAddPass(this);\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this material.\n\t */\n\tpublic _iInitConstantData(shader:ShaderBase)\n\t{\n\t\tsuper._iInitConstantData(shader);\n\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = shader.fragmentConstantData;\n\t\tdata[index + 4] = 1.0/255.0;\n\t\tdata[index + 5] = 1.0/255.0;\n\t\tdata[index + 6] = 1.0/255.0;\n\t\tdata[index + 7] = 0.0;\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tsuper._iIncludeDependencies(shader);\n\n\t\tshader.projectionDependencies++;\n\t\tshader.viewDirDependencies++;\n\n\t\tif (shader.alphaThreshold > 0)\n\t\t\tshader.uvDependencies++;\n\n\t\tif (shader.viewDirDependencies > 0)\n\t\t\tshader.globalPosDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string;\n\t\tvar targetReg:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\t\tvar dataReg1:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tvar dataReg2:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\tthis._fragmentConstantsIndex = dataReg1.index*4;\n\n\t\tvar temp1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp1, 1);\n\t\tvar temp2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp2, 1);\n\n\t\t// squared distance to view\n\t\tcode = \"dp3 \" + temp1 + \".z, \" + sharedRegisters.viewDirVarying + \".xyz, \" + sharedRegisters.viewDirVarying + \".xyz\\n\" +\n\t\t\t\"mul \" + temp1 + \", \" + dataReg1 + \", \" + temp1 + \".z\\n\" +\n\t\t\t\"frc \" + temp1 + \", \" + temp1 + \"\\n\" +\n\t\t\t\"mul \" + temp2 + \", \" + temp1 + \".yzww, \" + dataReg2 + \"\\n\";\n\n\t\tif (shader.alphaThreshold > 0) {\n\t\t\tshader.texture._iInitRegisters(shader, registerCache);\n\n\t\t\tvar albedo:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\t\tcode += shader.texture._iGetFragmentCode(shader, albedo, registerCache, sharedRegisters.uvVarying);\n\n\t\t\tvar cutOffReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\t\tcode += \"sub \" + albedo + \".w, \" + albedo + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\t\"kil \" + albedo + \".w\\n\";\n\t\t}\n\n\t\tcode += \"sub \" + targetReg + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tvar f:number = camera.projection.far;\n\n\t\tf = 1/(2*f*f);\n\t\t// sqrt(f*f+f*f) is largest possible distance for any frustum, so we need to divide by it. Rarely a tight fit, but with 32 bits precision, it's enough.\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = this._shader.fragmentConstantData;\n\t\tdata[index] = 1.0*f;\n\t\tdata[index + 1] = 255.0*f;\n\t\tdata[index + 2] = 65025.0*f;\n\t\tdata[index + 3] = 16581375.0*f;\n\n\t\tif (this._shader.alphaThreshold > 0) {\n\t\t\tthis._shader.texture.activate(this._shader);\n\n\t\t\tdata[index + 8] = this._shader.alphaThreshold;\n\t\t}\n\t}\n}\n\nexport = DistanceRender;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\n\nimport IRender\t\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRender\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n *\n * @class away.pool.Passes\n */\nclass RenderBase extends EventDispatcher implements IRender\n{\n\tpublic _forceSeparateMVP:boolean = false;\n\n\tprivate _pool:RenderPool;\n\tpublic _renderOwner:IRenderOwner;\n\tpublic _renderableClass:IRenderableClass;\n\tpublic _stage:Stage;\n\n\tprivate _renderOrderId:number;\n\tprivate _invalidAnimation:boolean = true;\n\tprivate _invalidRender:boolean = true;\n\tprivate _passes:Array<IPass> = new Array<IPass>();\n\n\n\n\tpublic _pRequiresBlending:boolean = false;\n\n\tprivate _onPassChangeDelegate:(event:Event) => void;\n\n\tpublic renderId:number;\n\n\t/**\n\t * Indicates whether or not the renderable requires alpha blending during rendering.\n\t */\n\tpublic get requiresBlending():boolean\n\t{\n\t\treturn this._pRequiresBlending;\n\t}\n\n\tpublic get renderOrderId():number\n\t{\n\t\tif (this._invalidAnimation)\n\t\t\tthis._updateAnimation();\n\n\t\treturn this._renderOrderId;\n\t}\n\n\tpublic get passes():Array<IPass>\n\t{\n\t\tif (this._invalidAnimation)\n\t\t\tthis._updateAnimation();\n\n\t\treturn this._passes;\n\t}\n\n\tconstructor(pool:RenderPool, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper();\n\n\t\tthis._pool = pool;\n\t\tthis.renderId = renderOwner.id;\n\t\tthis._renderOwner = renderOwner;\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\n\n\t\tthis._onPassChangeDelegate = (event:Event) => this.onPassChange(event);\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tthis._renderableClass._iIncludeDependencies(shader);\n\n\t\tshader.alphaThreshold = this._renderOwner.alphaThreshold;\n\t\tshader.useMipmapping = this._renderOwner.mipmap;\n\t\tshader.useSmoothTextures = this._renderOwner.smooth;\n\n\t\tif (this._renderOwner instanceof MaterialBase) {\n\t\t\tvar material:MaterialBase = <MaterialBase> this._renderOwner;\n\t\t\tshader.useAlphaPremultiplied = material.alphaPremultiplied;\n\t\t\tshader.useBothSides = material.bothSides;\n\t\t\tshader.repeatTextures = material.repeat;\n\t\t\tshader.usesUVTransform = material.animateUVs;\n\t\t\tshader.usesColorTransform = material.useColorTransform;\n\t\t\tif (material.texture)\n\t\t\t\tshader.texture = shader.getTextureVO(material.texture);\n\t\t\tshader.color = material.color;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pClearPasses();\n\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._passes[i].dispose();\n\n\t\tthis._passes = null;\n\n\t\tthis._pool.disposeItem(this._renderOwner);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateRender()\n\t{\n\t\tthis._invalidRender = true;\n\t\tthis._invalidAnimation = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidatePasses()\n\t{\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._passes[i].invalidatePass();\n\n\t\tthis._invalidAnimation = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateAnimation()\n\t{\n\t\tthis._invalidAnimation = true;\n\t}\n\n\t/**\n\t *\n\t * @param renderOwner\n\t */\n\tprivate _updateAnimation()\n\t{\n\t\tif (this._invalidRender)\n\t\t\tthis._pUpdateRender();\n\n\t\tthis._invalidAnimation = false;\n\n\t\tvar enabledGPUAnimation:boolean = this._getEnabledGPUAnimation();\n\n\t\tvar renderOrderId = 0;\n\t\tvar mult:number = 1;\n\t\tvar shader:ShaderBase;\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tshader = this._passes[i].shader;\n\n\t\t\tif (shader.usesAnimation != enabledGPUAnimation) {\n\t\t\t\tshader.usesAnimation = enabledGPUAnimation;\n\t\t\t\tshader.invalidateProgram();\n\t\t\t}\n\n\t\t\trenderOrderId += shader.programData.id*mult;\n\t\t\tmult *= 1000;\n\t\t}\n\n\t\tthis._renderOrderId = renderOrderId;\n\t}\n\n\t/**\n\t * Performs any processing that needs to occur before any of its passes are used.\n\t *\n\t * @private\n\t */\n\tpublic _pUpdateRender()\n\t{\n\t\tthis._invalidRender = false;\n\n\t\t//overrride to update shader object properties\n\t}\n\n\t/**\n\t * Removes a pass from the renderOwner.\n\t * @param pass The pass to be removed.\n\t */\n\tpublic _pRemovePass(pass:IPass)\n\t{\n\t\tpass.removeEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\t\tthis._passes.splice(this._passes.indexOf(pass), 1);\n\t}\n\n\t/**\n\t * Removes all passes from the renderOwner\n\t */\n\tpublic _pClearPasses()\n\t{\n\t\tvar len:number = this._passes.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._passes[i].removeEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\n\t\tthis._passes.length = 0;\n\t}\n\n\t/**\n\t * Adds a pass to the renderOwner\n\t * @param pass\n\t */\n\tpublic _pAddPass(pass:IPass)\n\t{\n\t\tthis._passes.push(pass);\n\t\tpass.addEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\t}\n\n\t/**\n\t * Listener for when a pass's shader code changes. It recalculates the render order id.\n\t */\n\tprivate onPassChange(event:Event)\n\t{\n\t\tthis.invalidateAnimation();\n\t}\n\n\n\t/**\n\t * test if animation will be able to run on gpu BEFORE compiling materials\n\t * test if the shader objects supports animating the animation set in the vertex shader\n\t * if any object using this material fails to support accelerated animations for any of the shader objects,\n\t * we should do everything on cpu (otherwise we have the cost of both gpu + cpu animations)\n\t */\n\tprivate _getEnabledGPUAnimation():boolean\n\t{\n\t\tif (this._renderOwner.animationSet) {\n\t\t\tthis._renderOwner.animationSet.resetGPUCompatibility();\n\n\t\t\tvar owners:Array<IRenderableOwner> = this._renderOwner.iOwners;\n\t\t\tvar numOwners:number = owners.length;\n\n\t\t\tvar len:number = this._passes.length;\n\t\t\tfor (var i:number = 0; i < len; i++)\n\t\t\t\tfor (var j:number = 0; j < numOwners; j++)\n\t\t\t\t\tif (owners[j].animator)\n\t\t\t\t\t\t(<AnimatorBase> owners[j].animator).testGPUCompatibility(this._passes[i].shader);\n\n\t\t\treturn !this._renderOwner.animationSet.usesCPU;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\nexport = RenderBase;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\")\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\n\n/**\n * RenderPassBase provides an abstract base class for material shader passes. A material pass constitutes at least\n * a render call per required renderable.\n */\nclass RenderPassBase extends RenderBase implements IPass\n{\n\tpublic _shader:ShaderBase;\n\n\tpublic get shader():ShaderBase\n\t{\n\t\treturn this._shader;\n\t}\n\n\tpublic get animationSet():AnimationSetBase\n\t{\n\t\treturn <AnimationSetBase> this._renderOwner.animationSet;\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t * @param deep Indicates whether other resources should be cleaned up, that could potentially be shared across different instances.\n\t */\n\tpublic dispose()\n\t{\n\t\tsuper.dispose();\n\n\t\tthis._shader.dispose();\n\n\t\tthis._shader = null;\n\t}\n\n\t/**\n\t * Renders the current pass. Before calling pass, activatePass needs to be called with the same index.\n\t * @param pass The pass used to render the renderable.\n\t * @param renderable The IRenderable object to draw.\n\t * @param stage The Stage object used for rendering.\n\t * @param entityCollector The EntityCollector object that contains the visible scene data.\n\t * @param viewProjection The view-projection matrix used to project to the screen. This is not the same as\n\t * camera.viewProjection as it includes the scaling factors when rendering to textures.\n\t *\n\t * @internal\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tthis._shader._iRender(renderable, camera, viewProjection);\n\t}\n\n\t/**\n\t * Sets the render state for the pass that is independent of the rendered object. This needs to be called before\n\t * calling pass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tthis._shader._iActivate(camera);\n\t}\n\n\t/**\n\t * Clears the render state for the pass. This needs to be called before activating another pass.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @private\n\t */\n\tpublic _iDeactivate()\n\t{\n\t\tthis._shader._iDeactivate();\n\t}\n\n\t/**\n\t * Marks the shader program as invalid, so it will be recompiled before the next render.\n\t *\n\t * @param updateMaterial Indicates whether the invalidation should be performed on the entire material. Should always pass \"true\" unless it's called from the material itself.\n\t */\n\tpublic invalidatePass()\n\t{\n\t\tthis._shader.invalidateShader();\n\n\t\tthis.dispatchEvent(new Event(Event.CHANGE));\n\t}\n\n\n\tpublic _iInitConstantData(shader:ShaderBase)\n\t{\n\n\t}\n\n\tpublic _iGetPreLightingVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetPreLightingFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n}\n\nexport = RenderPassBase;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\n\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport BasicMaterialRender\t\t\t= require(\"awayjs-renderergl/lib/render/BasicMaterialRender\");\nimport IRenderClass\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/IRenderClass\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport SkyboxRender\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/SkyboxRender\");\n\n/**\n * @class away.pool.RenderPool\n */\nclass RenderPool\n{\n\tprivate static _classPool:Object = new Object();\n\t\n\tprivate _pool:Object = new Object();\n\tprivate _renderableClass:IRenderableClass;\n\tprivate _stage:Stage;\n\tprivate _renderClass:IRenderClass;\n\t\n\t/**\n\t * //TODO\n\t *\n\t * @param renderClass\n\t */\n\tconstructor(renderableClass:IRenderableClass, stage:Stage, renderClass:IRenderClass = null)\n\t{\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\t\tthis._renderClass = renderClass;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t * @returns IRenderable\n\t */\n\tpublic getItem(renderOwner:IRenderOwner):RenderBase\n\t{\n\t\treturn (this._pool[renderOwner.id] || (this._pool[renderOwner.id] = renderOwner._iAddRender(new (this._renderClass || RenderPool.getClass(renderOwner))(this, renderOwner, this._renderableClass, this._stage))))\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t */\n\tpublic disposeItem(renderOwner:IRenderOwner)\n\t{\n\t\trenderOwner._iRemoveRender(this._pool[renderOwner.id]);\n\n\t\tthis._pool[renderOwner.id] = null;\n\t}\n\t\n\t/**\n\t *\n\t * @param imageObjectClass\n\t */\n\tpublic static registerClass(renderClass:IRenderClass, assetClass:IAssetClass)\n\t{\n\t\tRenderPool._classPool[assetClass.assetType] = renderClass;\n\t}\n\n\t/**\n\t *\n\t * @param subGeometry\n\t */\n\tpublic static getClass(renderOwner:IRenderOwner):IRenderClass\n\t{\n\t\treturn RenderPool._classPool[renderOwner.assetType];\n\t}\n\t\n\n\tprivate static main = RenderPool.addDefaults();\n\n\tprivate static addDefaults()\n\t{\n\t\tRenderPool.registerClass(BasicMaterialRender, BasicMaterial);\n\t\tRenderPool.registerClass(SkyboxRender, Skybox);\n\t}\n}\n\nexport = RenderPool;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport BasicMaterial\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPassBase\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport TextureVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\n\n/**\n * SkyboxRender forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass SkyboxRender extends RenderPassBase\n{\n\tpublic _skybox:Skybox;\n\tpublic _cubeTexture:TextureVOBase;\n\n\tconstructor(pool:RenderPool, skybox:Skybox, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(pool, skybox, renderableClass, stage);\n\n\t\tthis._skybox = skybox;\n\n\t\tthis._shader = new ShaderBase(renderableClass, this, this._stage);\n\n\t\tthis._cubeTexture = this._shader.getTextureVO(this._skybox.cubeMap);\n\n\t\tthis._pAddPass(this);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pUpdateRender()\n\t{\n\t\tsuper._pUpdateRender();\n\n\t\tthis._pRequiresBlending = (this._renderOwner.blendMode != BlendMode.NORMAL);\n\n\t\tthis.shader.setBlendMode((this._renderOwner.blendMode == BlendMode.NORMAL && this._pRequiresBlending)? BlendMode.LAYER : this._renderOwner.blendMode);\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tsuper._iIncludeDependencies(shader);\n\n\t\tshader.usesLocalPosFragment = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tthis._cubeTexture._iInitRegisters(shader, registerCache);\n\n\t\treturn this._cubeTexture._iGetFragmentCode(shader, sharedRegisters.shadedTarget, registerCache, sharedRegisters.localPositionVarying);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setDepthTest(false, ContextGLCompareMode.LESS);\n\t\tthis._cubeTexture.activate(this._shader);\n\t}\n}\n\nexport = SkyboxRender;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n\n/**\n * BasicMaterialPass forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass BasicMaterialPass extends PassBase\n{\n\tprivate _diffuseR:number = 1;\n\tprivate _diffuseG:number = 1;\n\tprivate _diffuseB:number = 1;\n\tprivate _diffuseA:number = 1;\n\n\tprivate _fragmentConstantsIndex:number;\n\n\tconstructor(render:RenderBase, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper(render, renderOwner, renderableClass, stage);\n\n\t\tthis._shader = new ShaderBase(renderableClass, this, this._stage);\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tsuper._iIncludeDependencies(shader);\n\n\t\tif (shader.texture != null)\n\t\t\tshader.uvDependencies++;\n    }\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n        var alphaReg:ShaderRegisterElement;\n\n        if (this.preserveAlpha) {\n            alphaReg = regCache.getFreeFragmentSingleTemp();\n            regCache.addFragmentTempUsages(alphaReg, 1);\n            code += \"mov \" + alphaReg + \", \" + sharedReg.shadedTarget + \".w\\n\";\n        }\n\n\t\tvar targetReg:ShaderRegisterElement = sharedReg.shadedTarget;\n\n\t\tif (shader.texture != null) {\n\n\t\t\tshader.texture._iInitRegisters(shader, regCache);\n\n\t\t\tcode += shader.texture._iGetFragmentCode(shader, targetReg, regCache, sharedReg.uvVarying);\n\n\t\t\tif (shader.alphaThreshold > 0) {\n\t\t\t\tvar cutOffReg:ShaderRegisterElement = regCache.getFreeFragmentConstant();\n\t\t\t\tthis._fragmentConstantsIndex = cutOffReg.index*4;\n\n\t\t\t\tcode += \"sub \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\" + \"kil \" + targetReg + \".w\\n\" + \"add \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\";\n\t\t\t}\n\t\t} else if (shader.colorBufferIndex != -1) {\n\n\t\t\tcode += \"mov \" + targetReg + \", \" + sharedReg.colorVarying + \"\\n\";\n\t\t} else {\n\t\t\tvar diffuseInputReg:ShaderRegisterElement = regCache.getFreeFragmentConstant();\n\n\t\t\tthis._fragmentConstantsIndex = diffuseInputReg.index*4;\n\n\t\t\tcode += \"mov \" + targetReg + \", \" + diffuseInputReg + \"\\n\";\n\t\t}\n\n        if (this.preserveAlpha) {\n            code += \"mul \" + sharedReg.shadedTarget + \".w, \" + sharedReg.shadedTarget + \".w, \" + alphaReg + \"\\n\";\n            regCache.removeFragmentTempUsage(alphaReg);\n        }\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tsuper._iActivate(camera);\n\n\t\tif (this._shader.texture != null) {\n\t\t\tthis._shader.texture.activate(this._shader);\n\n\t\t\tif (this._shader.alphaThreshold > 0)\n\t\t\t\tthis._shader.fragmentConstantData[this._fragmentConstantsIndex] = this._shader.alphaThreshold;\n\t\t} else if (this._shader.colorBufferIndex == -1) {\n\t\t\tvar index:number = this._fragmentConstantsIndex;\n\t\t\tvar data:Array<number> = this._shader.fragmentConstantData;\n\t\t\tdata[index] = this._diffuseR;\n\t\t\tdata[index + 1] = this._diffuseG;\n\t\t\tdata[index + 2] = this._diffuseB;\n\t\t\tdata[index + 3] = this._diffuseA;\n\t\t}\n\t}\n}\n\nexport = BasicMaterialPass;",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport AssetBase\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetBase\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\")\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\n\n/**\n * PassBase provides an abstract base class for material shader passes. A material pass constitutes at least\n * a render call per required renderable.\n */\nclass PassBase extends EventDispatcher implements IPass\n{\n\tprivate _render:RenderBase;\n\tpublic _renderOwner:IRenderOwner;\n\tpublic _renderableClass:IRenderableClass;\n\tpublic _stage:Stage;\n\t\n\tpublic _shader:ShaderBase;\n\n\tprivate _preserveAlpha:boolean = true;\n\tprivate _forceSeparateMVP:boolean = false;\n\n\tpublic get shader():ShaderBase\n\t{\n\t\treturn this._shader;\n\t}\n\n\tpublic get animationSet():AnimationSetBase\n\t{\n\t\treturn <AnimationSetBase> this._renderOwner.animationSet;\n\t}\n\n\t/**\n\t * Indicates whether the output alpha value should remain unchanged compared to the material's original alpha.\n\t */\n\tpublic get preserveAlpha():boolean\n\t{\n\t\treturn this._preserveAlpha;\n\t}\n\n\tpublic set preserveAlpha(value:boolean)\n\t{\n\t\tif (this._preserveAlpha == value)\n\t\t\treturn;\n\n\t\tthis._preserveAlpha = value;\n\n\t\tthis.invalidatePass();\n\t}\n\n\t/**\n\t * Indicates whether the screen projection should be calculated by forcing a separate scene matrix and\n\t * view-projection matrix. This is used to prevent rounding errors when using multiple passes with different\n\t * projection code.\n\t */\n\tpublic get forceSeparateMVP():boolean\n\t{\n\t\treturn this._forceSeparateMVP;\n\t}\n\n\tpublic set forceSeparateMVP(value:boolean)\n\t{\n\t\tif (this._forceSeparateMVP == value)\n\t\t\treturn;\n\n\t\tthis._forceSeparateMVP = value;\n\n\t\tthis.invalidatePass();\n\t}\n\n\t/**\n\t * Creates a new PassBase object.\n\t */\n\tconstructor(render:RenderBase, renderOwner:IRenderOwner, renderableClass:IRenderableClass, stage:Stage)\n\t{\n\t\tsuper();\n\n\t\tthis._render = render;\n\t\tthis._renderOwner = renderOwner;\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t * @param deep Indicates whether other resources should be cleaned up, that could potentially be shared across different instances.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._shader.dispose();\n\n\t\tthis._shader = null;\n\t}\n\n\t/**\n\t * Renders the current pass. Before calling pass, activatePass needs to be called with the same index.\n\t * @param pass The pass used to render the renderable.\n\t * @param renderable The IRenderable object to draw.\n\t * @param stage The Stage object used for rendering.\n\t * @param entityCollector The EntityCollector object that contains the visible scene data.\n\t * @param viewProjection The view-projection matrix used to project to the screen. This is not the same as\n\t * camera.viewProjection as it includes the scaling factors when rendering to textures.\n\t *\n\t * @internal\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tthis._shader._iRender(renderable, camera, viewProjection);\n\t}\n\n\t/**\n\t * Sets the render state for the pass that is independent of the rendered object. This needs to be called before\n\t * calling pass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tthis._shader._iActivate(camera);\n\t}\n\n\t/**\n\t * Clears the render state for the pass. This needs to be called before activating another pass.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @private\n\t */\n\tpublic _iDeactivate()\n\t{\n\t\tthis._shader._iDeactivate();\n\t}\n\n\t/**\n\t * Marks the shader program as invalid, so it will be recompiled before the next render.\n\t *\n\t * @param updateMaterial Indicates whether the invalidation should be performed on the entire material. Should always pass \"true\" unless it's called from the material itself.\n\t */\n\tpublic invalidatePass()\n\t{\n\t\tthis._shader.invalidateShader();\n\n\t\tthis.dispatchEvent(new Event(Event.CHANGE));\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tthis._render._iIncludeDependencies(shader);\n\t\t\n\t\tif (this._forceSeparateMVP)\n\t\t\tshader.globalPosDependencies++;\n\t}\n\n\n\tpublic _iInitConstantData(shader:ShaderBase)\n\t{\n\n\t}\n\n\tpublic _iGetPreLightingVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetPreLightingFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n}\n\nexport = PassBase;",
    "import AttributesBuffer\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\n\n/**\n * @class away.pool.RenderableListItem\n */\nclass BillboardRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = Billboard;\n\n\tprivate static _materialGeometry:Object = new Object();\n\n\tpublic static vertexAttributesOffset:number = 1;\n\n\t/**\n\t *\n\t */\n\tprivate _billboard:Billboard;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param billboard\n\t */\n\tconstructor(pool:RenderablePool, billboard:Billboard, stage:Stage)\n\t{\n\t\tsuper(pool, billboard, billboard, billboard.material, stage);\n\n\t\tthis._billboard = billboard;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {away.base.TriangleSubGeometry}\n\t */\n\tpublic _pGetSubGeometry():SubGeometryBase\n\t{\n\t\tvar material:MaterialBase = this._billboard.material;\n\t\tvar billboardRect:Rectangle = this._billboard.billboardRect;\n\n\t\tvar geometry:TriangleSubGeometry = BillboardRenderable._materialGeometry[material.id];\n\n\t\tif (!geometry) {\n\t\t\tgeometry = BillboardRenderable._materialGeometry[material.id] = new TriangleSubGeometry(new AttributesBuffer(11, 4));\n\t\t\tgeometry.autoDeriveNormals = false;\n\t\t\tgeometry.autoDeriveTangents = false;\n\t\t\tgeometry.setIndices(Array<number>(0, 1, 2, 0, 2, 3));\n\t\t\tgeometry.setPositions(Array<number>(-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, -billboardRect.y, 0, -billboardRect.x, -billboardRect.y, 0));\n\t\t\tgeometry.setNormals(Array<number>(1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0));\n\t\t\tgeometry.setTangents(Array<number>(0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1));\n\t\t\tgeometry.setUVs(Array<number>(0, 0, 1, 0, 1, 1, 0, 1));\n\t\t} else {\n\t\t\tgeometry.setPositions(Array<number>(-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, material.height-billboardRect.y, 0, material.width-billboardRect.x, -billboardRect.y, 0, -billboardRect.x, -billboardRect.y, 0));\n\t\t}\n\n\t\treturn geometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\n\t}\n\n\tpublic static _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shader.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshader.viewMatrixIndex = viewMatrixReg.index*4;\n\n\t\tif (shader.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \", \" + viewMatrixReg + \"\\n\" +\n\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\"mov op, \" + temp + \"\\n\";\n\t\t} else {\n\t\t\tcode += \"m44 op, \" + position + \", \" + viewMatrixReg + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar shader:ShaderBase = pass.shader;\n\n\t\tif (shader.sceneMatrixIndex >= 0) {\n\t\t\tthis.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shader.vertexConstantData, shader.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(this.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shader.vertexConstantData, shader.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shader.fragmentConstantData, shader.numUsedFragmentConstants);\n\t}\n}\n\nexport = BillboardRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport CurveSubMesh\t\t\t\t    = require(\"awayjs-display/lib/base/CurveSubMesh\");\nimport CurveSubGeometry\t\t    \t= require(\"awayjs-display/lib/base/CurveSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextWebGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextWebGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\")\n\n/**\n * @class away.pool.TriangleSubMeshRenderable\n */\nclass CurveSubMeshRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = CurveSubMesh;\n\n\tpublic static vertexAttributesOffset:number = 2;\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:CurveSubMesh;\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param indexOffset\n\t */\n\tconstructor(pool:RenderablePool, subMesh:CurveSubMesh, stage:Stage)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, subMesh.material, stage);\n\n\t\tthis.subMesh = subMesh;\n\t}\n\n\t/**\n\t *\n\t * @returns {SubGeometryBase}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():CurveSubGeometry\n\t{\n\t\treturn (this.subMesh.animator)? <CurveSubGeometry> this.subMesh.animator.getRenderableSubGeometry(this, this.subMesh.subGeometry) : this.subMesh.subGeometry;\n\t}\n\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n        shader.usesLocalPosFragment = true;\n\t}\n\n\tpublic static _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shader.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshader.viewMatrixIndex = viewMatrixReg.index*4;\n\n\n\t\tif (shader.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \".xyw, \" + viewMatrixReg + \"\\n\" +\n\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\"mov v2 va1 \\n\" +\n\t\t\t\"mov op, \" + temp + \"\\n\";\n\n\t\t} else {\n\t\t\tcode += \"mov v2 va1 \\n\";\n\t\t\tcode += \"m44 op, \" + position + \".xyw, \" + viewMatrixReg + \"\\n\";\n\t\t}\n\t\treturn code;\n\t}\n    /**\n     * @inheritDoc\n     */\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar sd:boolean = (<ContextWebGL>shader._stage.context).standardDerivatives;\n\t\tvar pos:ShaderRegisterElement = sharedRegisters.localPositionVarying;\n\t\tvar out:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\n\t\tvar curve:string = \"v2\";\n\t\tvar curvex:string = \"v2.x\";\n\t\tvar curvey:string = \"v2.y\";\n\t\tvar curvez:string = pos + \".z\";\n\n\n\t\t//get some free registers\n\t\tvar free:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(free, 1);\n\t\tvar free1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(free1, 1);\n\t\tvar free2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(free2, 1);\n\n\t\t//distance from curve\n\t\tvar d:string = free + \".x\";\n\t\tvar dx:string = free + \".y\";\n\t\tvar dy:string = free + \".z\";\n\t\tvar t:string = free + \".w\";\n\t\tvar d2:string = free1 + \".x\";\n\t\tvar fixa:string = free1 + \".y\";\n\t\tvar fixb:string = free1 + \".z\";\n\n\t\tvar _aa:string = \"fc7.z\";\n\t\tvar _0:string = \"fc7.x\";\n\t\tvar _1:string = \"fc7.y\";\n\n\t\tvar nl:string = \"\\n\";\n\n\t\tvar code:Array<string> =  new Array<string>();\n\n\t\t//distance from curve\n\t\tcode.push(\"mul\",d, curvex, curvex, nl);\n\t\tcode.push(\"sub\",d, d, curvey, nl);\n\t\tcode.push(\"mul\",d, d, curvez, nl);\t//flipper\n\n\t\t//kill based on distance from curve\n\t\tcode.push(\"kil\" ,d, nl);\n\n\t\tvar applyAA:boolean = false;\n\t\tif(applyAA && sd)\n\t\t{\n\n\t\t\t//derivatives\n\t\t\tcode.push(\"ddx\", dx, d, nl);\n\t\t\tcode.push(\"ddy\", dy, d, nl);\n\n\t\t\t//AA\n\t\t\tcode.push(\"mul\",dx, dx, dx, nl);\n\t\t\tcode.push(\"mul\",dy, dy, dy, nl);\n\t\t\tcode.push(\"add\",t, dx, dy, nl);\n\t\t\tcode.push(\"sqt\",t, t, nl);\n\n\t\t\tcode.push(\"mul\",t, t, _aa, nl);\n\t\t\tcode.push(\"div\",d, d, t, nl);\n\n/*\n\t\t\t//code.push(\"sge\", fixa, curvex, _1, nl);\n\t\t\tcode.push(\"slt\", fixb, curvex, _1, nl);\n\t\t\tcode.push(\"sub\", fixa, _1, fixb, nl);\n\t\t\t//code.push(\"sub\", fixb, _1, fixa, nl);\n\n\t\t\tcode.push(\"mul\", d, d, fixb, nl);\n\n*/\n//\t\t\tcode.push(\"abs\", d, d, nl);\n\t\t\tcode.push(\"max\", d, d, _0, nl);\n\t\t\tcode.push(\"min\", d, d, _1, nl);\n\t\t\tcode.push(\"mov\", out+\".w\", d, nl);\n\t\t}\n\n\n\t\tcode.push(\"mov\", out+\".w\", _1, nl);\n\t\treturn code.join(\" \");\n\t}\n    private _constants:Array<number> = new Array<number>(0, 1, 1, 0.5);\n    /**\n     * @inheritDoc\n     */\n    public _iActivate(pass:PassBase, camera:Camera)\n    {\n        super._iActivate(pass, camera);\n\n        var context:IContextGL = this._stage.context;\n\n        context.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 7, this._constants, 1);\n\n    }\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar shader:ShaderBase = pass.shader;\n\n\t\tif (shader.sceneMatrixIndex >= 0) {\n\t\t\tthis.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shader.vertexConstantData, shader.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(this.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shader.vertexConstantData, shader.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shader.fragmentConstantData, shader.numUsedFragmentConstants);\n\t}\n}\n\nexport = CurveSubMeshRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport LineSegment\t\t\t\t\t= require(\"awayjs-display/lib/entities/LineSegment\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n/**\n * @class away.pool.LineSubMeshRenderable\n */\nclass LineSegmentRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = LineSegment;\n\n\tprivate static _lineGeometry:Object = new Object();\n\n\tpublic static pONE_VECTOR:Array<number> = Array<number>(1, 1, 1, 1);\n\tpublic static pFRONT_VECTOR:Array<number> = Array<number>(0, 0, -1, 0);\n\n\tprivate _constants:Array<number> = new Array<number>(0, 0, 0, 0);\n\tprivate _calcMatrix:Matrix3D;\n\tprivate _thickness:number = 1.25;\n\n\n\tpublic static vertexAttributesOffset:number = 3;\n\n\t/**\n\t *\n\t */\n\tprivate _lineSegment:LineSegment;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param dataOffset\n\t */\n\tconstructor(pool:RenderablePool, lineSegment:LineSegment, stage:Stage)\n\t{\n\t\tsuper(pool, lineSegment, lineSegment, lineSegment.material, stage);\n\n\t\tthis._lineSegment = lineSegment;\n\n\t\tthis._calcMatrix = new Matrix3D();\n\n\t\tthis._constants[1] = 1/255;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {base.LineSubGeometry}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():LineSubGeometry\n\t{\n\t\tvar geometry:LineSubGeometry = LineSegmentRenderable._lineGeometry[this._lineSegment.id] || (LineSegmentRenderable._lineGeometry[this._lineSegment.id] = new LineSubGeometry());\n\n\t\tvar start:Vector3D = this._lineSegment.startPostion;\n\t\tvar end:Vector3D = this._lineSegment.endPosition;\n\n\t\tvar positions:Float32Array;\n\t\tvar thickness:Float32Array;\n\n\t\t//if (geometry.indices != null) {\n\t\t//\tpositions = <Float32Array> geometry.positions.get(geometry.numVertices);\n\t\t//\tthickness = geometry.thickness.get(geometry.numVertices);\n\t\t//} else {\n\t\t\tpositions = new Float32Array(6);\n\t\t\tthickness = new Float32Array(1);\n\t\t//}\n\n\t\tpositions[0] = start.x;\n\t\tpositions[1] = start.y;\n\t\tpositions[2] = start.z;\n\t\tpositions[3] = end.x;\n\t\tpositions[4] = end.y;\n\t\tpositions[5] = end.z;\n\t\tthickness[0] = this._lineSegment.thickness;\n\n\t\tgeometry.setPositions(positions);\n\t\tgeometry.setThickness(thickness);\n\n\t\treturn geometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tshader.colorDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static _iGetVertexCode(shader:ShaderBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\treturn \"m44 vt0, va0, vc8\t\t\t\\n\" + // transform Q0 to eye space\n\t\t\t\"m44 vt1, va1, vc8\t\t\t\\n\" + // transform Q1 to eye space\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\n\t\t\t\t// test if behind camera near plane\n\t\t\t\t// if 0 - Q0.z < Camera.near then the point needs to be clipped\n\t\t\t\t//\"neg vt5.x, vt0.z\t\t\t\t\\n\" + // 0 - Q0.z\n\t\t\t\"slt vt5.x, vt0.z, vc7.z\t\t\t\\n\" + // behind = ( 0 - Q0.z < -Camera.near ) ? 1 : 0\n\t\t\t\"sub vt5.y, vc5.x, vt5.x\t\t\t\\n\" + // !behind = 1 - behind\n\n\t\t\t\t// p = point on the plane (0,0,-near)\n\t\t\t\t// n = plane normal (0,0,-1)\n\t\t\t\t// D = Q1 - Q0\n\t\t\t\t// t = ( dot( n, ( p - Q0 ) ) / ( dot( n, d )\n\n\t\t\t\t// solve for t where line crosses Camera.near\n\t\t\t\"add vt4.x, vt0.z, vc7.z\t\t\t\\n\" + // Q0.z + ( -Camera.near )\n\t\t\t\"sub vt4.y, vt0.z, vt1.z\t\t\t\\n\" + // Q0.z - Q1.z\n\n\t\t\t\t// fix divide by zero for horizontal lines\n\t\t\t\"seq vt4.z, vt4.y vc6.x\t\t\t\\n\" + // offset = (Q0.z - Q1.z)==0 ? 1 : 0\n\t\t\t\"add vt4.y, vt4.y, vt4.z\t\t\t\\n\" + // ( Q0.z - Q1.z ) + offset\n\n\t\t\t\"div vt4.z, vt4.x, vt4.y\t\t\t\\n\" + // t = ( Q0.z - near ) / ( Q0.z - Q1.z )\n\n\t\t\t\"mul vt4.xyz, vt4.zzz, vt2.xyz\t\\n\" + // t(L)\n\t\t\t\"add vt3.xyz, vt0.xyz, vt4.xyz\t\\n\" + // Qclipped = Q0 + t(L)\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // Qclipped.w = 1\n\n\t\t\t\t// If necessary, replace Q0 with new Qclipped\n\t\t\t\"mul vt0, vt0, vt5.yyyy\t\t\t\\n\" + // !behind * Q0\n\t\t\t\"mul vt3, vt3, vt5.xxxx\t\t\t\\n\" + // behind * Qclipped\n\t\t\t\"add vt0, vt0, vt3\t\t\t\t\\n\" + // newQ0 = Q0 + Qclipped\n\n\t\t\t\t// calculate side vector for line\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\t\t\t\"nrm vt2.xyz, vt2.xyz\t\t\t\\n\" + // normalize( L )\n\t\t\t\"nrm vt5.xyz, vt0.xyz\t\t\t\\n\" + // D = normalize( Q1 )\n\t\t\t\"mov vt5.w, vc5.x\t\t\t\t\\n\" + // D.w = 1\n\t\t\t\"crs vt3.xyz, vt2, vt5\t\t\t\\n\" + // S = L x D\n\t\t\t\"nrm vt3.xyz, vt3.xyz\t\t\t\\n\" + // normalize( S )\n\n\t\t\t\t// face the side vector properly for the given point\n\t\t\t\"mul vt3.xyz, vt3.xyz, va2.xxx\t\\n\" + // S *= weight\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // S.w = 1\n\n\t\t\t\t// calculate the amount required to move at the point's distance to correspond to the line's pixel width\n\t\t\t\t// scale the side vector by that amount\n\t\t\t\"dp3 vt4.x, vt0, vc6\t\t\t\\n\" + // distance = dot( view )\n\t\t\t\"mul vt4.x, vt4.x, vc7.x\t\t\t\\n\" + // distance *= vpsod\n\t\t\t\"mul vt3.xyz, vt3.xyz, vt4.xxx\t\\n\" + // S.xyz *= pixelScaleFactor\n\n\t\t\t\t// add scaled side vector to Q0 and transform to clip space\n\t\t\t\"add vt0.xyz, vt0.xyz, vt3.xyz\t\\n\" + // Q0 + S\n\n\t\t\t\"m44 op, vt0, vc0\t\t\t\\n\"  // transform Q0 to clip space\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:PassBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, camera);\n\n\t\tthis._constants[0] = this._thickness/((this._stage.scissorRect)? Math.min(this._stage.scissorRect.width, this._stage.scissorRect.height) : Math.min(this._stage.width, this._stage.height));\n\n\t\t// value to convert distance from camera to model length per pixel width\n\t\tthis._constants[2] = camera.projection.near;\n\n\t\tvar context:IContextGL = this._stage.context;\n\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, LineSegmentRenderable.pONE_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 6, LineSegmentRenderable.pFRONT_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 7, this._constants, 1);\n\n\t\t// projection matrix\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, camera.projection.matrix, true);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tthis._calcMatrix.copyFrom(this.sourceEntity.sceneTransform);\n\t\tthis._calcMatrix.append(camera.inverseSceneTransform);\n\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 8, this._calcMatrix, true);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.LineSubMeshRenderable}\n\t * @private\n\t */\n\tpublic _pGetOverflowRenderable(indexOffset:number):RenderableBase\n\t{\n\t\treturn new LineSegmentRenderable(this._pool, <LineSegment> this.renderableOwner, this._stage);\n\t}\n}\n\nexport = LineSegmentRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n/**\n * @class away.pool.LineSubMeshRenderable\n */\nclass LineSubMeshRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = LineSubMesh;\n\n\tpublic static pONE_VECTOR:Array<number> = Array<number>(1, 1, 1, 1);\n\tpublic static pFRONT_VECTOR:Array<number> = Array<number>(0, 0, -1, 0);\n\n\tprivate _constants:Array<number> = new Array<number>(0, 0, 0, 0);\n\tprivate _calcMatrix:Matrix3D;\n\tprivate _thickness:number = 1.25;\n\n\n\tpublic static vertexAttributesOffset:number = 3;\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:LineSubMesh;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param dataOffset\n\t */\n\tconstructor(pool:RenderablePool, subMesh:LineSubMesh, stage:Stage)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, subMesh.material, stage);\n\n\t\tthis.subMesh = subMesh;\n\n\t\tthis._calcMatrix = new Matrix3D();\n\n\t\tthis._constants[1] = 1/255;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {base.LineSubGeometry}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():LineSubGeometry\n\t{\n\t\treturn this.subMesh.subGeometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\t\tshader.colorDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static _iGetVertexCode(shader:ShaderBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\treturn \"m44 vt0, va0, vc8\t\t\t\\n\" + // transform Q0 to eye space\n\t\t\t\"m44 vt1, va1, vc8\t\t\t\\n\" + // transform Q1 to eye space\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\n\t\t\t\t// test if behind camera near plane\n\t\t\t\t// if 0 - Q0.z < Camera.near then the point needs to be clipped\n\t\t\t\t//\"neg vt5.x, vt0.z\t\t\t\t\\n\" + // 0 - Q0.z\n\t\t\t\"slt vt5.x, vt0.z, vc7.z\t\t\t\\n\" + // behind = ( 0 - Q0.z < -Camera.near ) ? 1 : 0\n\t\t\t\"sub vt5.y, vc5.x, vt5.x\t\t\t\\n\" + // !behind = 1 - behind\n\n\t\t\t\t// p = point on the plane (0,0,-near)\n\t\t\t\t// n = plane normal (0,0,-1)\n\t\t\t\t// D = Q1 - Q0\n\t\t\t\t// t = ( dot( n, ( p - Q0 ) ) / ( dot( n, d )\n\n\t\t\t\t// solve for t where line crosses Camera.near\n\t\t\t\"add vt4.x, vt0.z, vc7.z\t\t\t\\n\" + // Q0.z + ( -Camera.near )\n\t\t\t\"sub vt4.y, vt0.z, vt1.z\t\t\t\\n\" + // Q0.z - Q1.z\n\n\t\t\t\t// fix divide by zero for horizontal lines\n\t\t\t\"seq vt4.z, vt4.y vc6.x\t\t\t\\n\" + // offset = (Q0.z - Q1.z)==0 ? 1 : 0\n\t\t\t\"add vt4.y, vt4.y, vt4.z\t\t\t\\n\" + // ( Q0.z - Q1.z ) + offset\n\n\t\t\t\"div vt4.z, vt4.x, vt4.y\t\t\t\\n\" + // t = ( Q0.z - near ) / ( Q0.z - Q1.z )\n\n\t\t\t\"mul vt4.xyz, vt4.zzz, vt2.xyz\t\\n\" + // t(L)\n\t\t\t\"add vt3.xyz, vt0.xyz, vt4.xyz\t\\n\" + // Qclipped = Q0 + t(L)\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // Qclipped.w = 1\n\n\t\t\t\t// If necessary, replace Q0 with new Qclipped\n\t\t\t\"mul vt0, vt0, vt5.yyyy\t\t\t\\n\" + // !behind * Q0\n\t\t\t\"mul vt3, vt3, vt5.xxxx\t\t\t\\n\" + // behind * Qclipped\n\t\t\t\"add vt0, vt0, vt3\t\t\t\t\\n\" + // newQ0 = Q0 + Qclipped\n\n\t\t\t\t// calculate side vector for line\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\t\t\t\"nrm vt2.xyz, vt2.xyz\t\t\t\\n\" + // normalize( L )\n\t\t\t\"nrm vt5.xyz, vt0.xyz\t\t\t\\n\" + // D = normalize( Q1 )\n\t\t\t\"mov vt5.w, vc5.x\t\t\t\t\\n\" + // D.w = 1\n\t\t\t\"crs vt3.xyz, vt2, vt5\t\t\t\\n\" + // S = L x D\n\t\t\t\"nrm vt3.xyz, vt3.xyz\t\t\t\\n\" + // normalize( S )\n\n\t\t\t\t// face the side vector properly for the given point\n\t\t\t\"mul vt3.xyz, vt3.xyz, va2.xxx\t\\n\" + // S *= weight\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // S.w = 1\n\n\t\t\t\t// calculate the amount required to move at the point's distance to correspond to the line's pixel width\n\t\t\t\t// scale the side vector by that amount\n\t\t\t\"dp3 vt4.x, vt0, vc6\t\t\t\\n\" + // distance = dot( view )\n\t\t\t\"mul vt4.x, vt4.x, vc7.x\t\t\t\\n\" + // distance *= vpsod\n\t\t\t\"mul vt3.xyz, vt3.xyz, vt4.xxx\t\\n\" + // S.xyz *= pixelScaleFactor\n\n\t\t\t\t// add scaled side vector to Q0 and transform to clip space\n\t\t\t\"add vt0.xyz, vt0.xyz, vt3.xyz\t\\n\" + // Q0 + S\n\n\t\t\t\"m44 op, vt0, vc0\t\t\t\\n\"  // transform Q0 to clip space\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:PassBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, camera);\n\n\t\tthis._constants[0] = this._thickness/((this._stage.scissorRect)? Math.min(this._stage.scissorRect.width, this._stage.scissorRect.height) : Math.min(this._stage.width, this._stage.height));\n\n\t\t// value to convert distance from camera to model length per pixel width\n\t\tthis._constants[2] = camera.projection.near;\n\n\t\tvar context:IContextGL = this._stage.context;\n\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, LineSubMeshRenderable.pONE_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 6, LineSubMeshRenderable.pFRONT_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 7, this._constants, 1);\n\n\t\t// projection matrix\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, camera.projection.matrix, true);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tthis._calcMatrix.copyFrom(this.sourceEntity.sceneTransform);\n\t\tthis._calcMatrix.append(camera.inverseSceneTransform);\n\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 8, this._calcMatrix, true);\n\t}\n}\n\nexport = LineSubMeshRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/IRenderer\");\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport IRenderable\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport RenderableOwnerEvent\t\t\t= require(\"awayjs-display/lib/events/RenderableOwnerEvent\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport RenderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderBase\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\n/**\n * @class RenderableListItem\n */\nclass RenderableBase implements IRenderable\n{\n\tprivate _onRenderOwnerUpdatedDelegate:(event:RenderableOwnerEvent) => void;\n\n\tpublic _subGeometryVOPool:SubGeometryVOPool;\n\tpublic _subGeometryVO:SubGeometryVOBase;\n\tprivate _geometryDirty:boolean = true;\n\n\tpublic JOINT_INDEX_FORMAT:string;\n\tpublic JOINT_WEIGHT_FORMAT:string;\n\n\t/**\n\t *\n\t */\n\tpublic _pool:RenderablePool;\n\n\tpublic _stage:Stage;\n\n\t/**\n\t *\n\t */\n\tpublic next:RenderableBase;\n\n\tpublic id:number;\n\n\t/**\n\t *\n\t */\n\tpublic renderId:number;\n\n\t/**\n\t *\n\t */\n\tpublic renderOrderId:number;\n\n\t/**\n\t *\n\t */\n\tpublic zIndex:number;\n\n\t/**\n\t *\n\t */\n\tpublic cascaded:boolean;\n\n\t/**\n\t *\n\t */\n\tpublic renderSceneTransform:Matrix3D;\n\n\t/**\n\t *\n\t */\n\tpublic sourceEntity:IEntity;\n\n\t/**\n\t *\n\t */\n\tpublic renderableOwner:IRenderableOwner;\n\n\n\t/**\n\t *\n\t */\n\tpublic renderOwner:IRenderOwner;\n\n\t/**\n\t *\n\t */\n\tpublic render:RenderBase;\n\n\n\tpublic get subGeometryVO():SubGeometryVOBase\n\t{\n\t\tif (this._geometryDirty)\n\t\t\tthis._updateGeometry();\n\n\t\treturn this._subGeometryVO;\n\t}\n\t/**\n\t *\n\t * @param sourceEntity\n\t * @param renderableOwner\n\t * @param subGeometry\n\t * @param animationSubGeometry\n\t */\n\tconstructor(pool:RenderablePool, sourceEntity:IEntity, renderableOwner:IRenderableOwner, renderOwner:IRenderOwner, stage:Stage)\n\t{\n\t\tthis._onRenderOwnerUpdatedDelegate = (event:RenderableOwnerEvent) => this._onRenderOwnerUpdated(event);\n\n\t\t//store a reference to the pool for later disposal\n\t\tthis._pool = pool;\n\t\tthis._stage = stage;\n\n\t\tthis._subGeometryVOPool = SubGeometryVOPool.getPool();\n\n\t\tthis.sourceEntity = sourceEntity;\n\n\t\tthis.renderableOwner = renderableOwner;\n\n\t\tthis.renderableOwner.addEventListener(RenderableOwnerEvent.RENDER_OWNER_UPDATED, this._onRenderOwnerUpdatedDelegate)\n\n\t\tthis.renderOwner = renderOwner;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this.renderableOwner);\n\t}\n\n\tpublic invalidateGeometry()\n\t{\n\t\tthis._geometryDirty = true;\n\t}\n\n\tpublic _pGetSubGeometry():SubGeometryBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * Sets the render state for the pass that is independent of the rendered object. This needs to be called before\n\t * calling pass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivate(pass:IPass, camera:Camera)\n\t{\n\t\tpass._iActivate(camera);\n\t}\n\n\t/**\n\t * Renders an object to the current render target.\n\t *\n\t * @private\n\t */\n\tpublic _iRender(pass:IPass, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tthis._setRenderState(pass, camera, viewProjection)\n\n\t\tif (this._geometryDirty)\n\t\t\tthis._updateGeometry();\n\n\t\tthis._subGeometryVO._iRender(pass.shader, this._stage);\n\t}\n\n\tpublic _setRenderState(pass:IPass, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tpass._iRender(this, camera, viewProjection);\n\t}\n\n\t/**\n\t * Clears the render state for the pass. This needs to be called before activating another pass.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @private\n\t */\n\tpublic _iDeactivate(pass:IPass)\n\t{\n\t\tpass._iDeactivate();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @private\n\t */\n\tprivate _updateGeometry()\n\t{\n\t\tthis._subGeometryVO = this._subGeometryVOPool.getItem(this._pGetSubGeometry());\n\n\t\tthis._geometryDirty = false;\n\t}\n\n\tprivate _onRenderOwnerUpdated(event:RenderableOwnerEvent)\n\t{\n\t\t//TODO flag unused renders for deletion\n\t\tthis.renderOwner = event.renderOwner;\n\t}\n}\n\nexport = RenderableBase;",
    "import IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport CurveSubMesh\t\t\t    \t= require(\"awayjs-display/lib/base/CurveSubMesh\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport LineSegment\t\t\t\t\t= require(\"awayjs-display/lib/entities/LineSegment\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/RendererBase\");\nimport IRenderClass\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/IRenderClass\");\nimport RenderPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RenderPool\");\nimport BillboardRenderable\t\t\t= require(\"awayjs-renderergl/lib/renderables/BillboardRenderable\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport LineSegmentRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/LineSegmentRenderable\");\nimport LineSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/renderables/LineSubMeshRenderable\");\nimport CurveSubMeshRenderable\t    = require(\"awayjs-renderergl/lib/renderables/CurveSubMeshRenderable\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport SkyboxRenderable\t\t\t    = require(\"awayjs-renderergl/lib/renderables/SkyboxRenderable\");\nimport TriangleSubMeshRenderable\t= require(\"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable\");\n\n/**\n * RenderablePool forms an abstract base class for classes that are used in the rendering pipeline to render the\n * contents of a partition\n *\n * @class away.render.RenderablePool\n */\nclass RenderablePool\n{\n\tprivate static _classPool:Object = new Object();\n\n\tprivate _stage:Stage;\n\tprivate _pool:Object = new Object();\n\n\tprivate _objectPools:Object = new Object();\n\t\n\t/**\n\t * Creates a new RenderablePool object.\n\t *\n\t * @param stage\n\t * @param renderClass\n\t */\n\tconstructor(stage:Stage, renderClass:IRenderClass = null)\n\t{\n\t\tthis._stage = stage;\n\n\t\tfor (var i in RenderablePool._classPool)\n\t\t\tthis._objectPools[i] = new RenderPool(RenderablePool._classPool[i], this._stage, renderClass);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableOwner\n\t * @returns IRenderable\n\t */\n\tpublic getItem(renderableOwner:IRenderableOwner):RenderableBase\n\t{\n\t\treturn this._pool[renderableOwner.id] || (this._pool[renderableOwner.id] = renderableOwner._iAddRenderable(new (RenderablePool.getClass(renderableOwner))(this, renderableOwner, this._stage)));\n\t}\n\n\t/**\n\t *\n\t * @param image\n\t */\n\tpublic disposeItem(renderableOwner:IRenderableOwner)\n\t{\n\t\trenderableOwner._iRemoveRenderable(this._pool[renderableOwner.id]);\n\n\t\tthis._pool[renderableOwner.id] = null;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t * @returns RenderPool\n\t */\n\tpublic getRenderPool(renderableOwner:IRenderableOwner):RenderPool\n\t{\n\t\treturn this._objectPools[renderableOwner.assetType];\n\t}\n\n\t/**\n\t *\n\t * @param imageObjectClass\n\t */\n\tpublic static registerClass(renderableClass:IRenderableClass)\n\t{\n\t\tRenderablePool._classPool[renderableClass.assetClass.assetType] = renderableClass;\n\t}\n\n\t/**\n\t *\n\t * @param subGeometry\n\t */\n\tpublic static getClass(renderableOwner:IRenderableOwner):IRenderableClass\n\t{\n\t\treturn RenderablePool._classPool[renderableOwner.assetType];\n\t}\n\n\t/**\n\t * Disposes the resources used by the RenderablePool.\n\t */\n\tpublic dispose()\n\t{\n\t\tfor (var id in this._pool)\n\t\t\tthis._pool[id].dispose();\n\n\t\tthis._pool = null;\n\t}\n\n\n\tprivate static main = RenderablePool.addDefaults();\n\n\tprivate static addDefaults()\n\t{\n\t\tRenderablePool.registerClass(BillboardRenderable);\n\t\tRenderablePool.registerClass(LineSegmentRenderable);\n\t\tRenderablePool.registerClass(LineSubMeshRenderable);\n\t\tRenderablePool.registerClass(TriangleSubMeshRenderable);\n\t\tRenderablePool.registerClass(CurveSubMeshRenderable);\n\t\tRenderablePool.registerClass(SkyboxRenderable);\n\t}\n}\n\nexport = RenderablePool;",
    "import AttributesBuffer\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n/**\n * @class away.pool.SkyboxRenderable\n */\nclass SkyboxRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = Skybox;\n\n\tpublic static vertexAttributesOffset:number = 1;\n\n\t/**\n\t *\n\t */\n\tprivate static _geometry:TriangleSubGeometry;\n\n\tprivate _vertexArray:Array<number>;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param skybox\n\t */\n\tconstructor(pool:RenderablePool, skybox:Skybox, stage:Stage)\n\t{\n\t\tsuper(pool, skybox, skybox, skybox, stage);\n\n\t\tthis._vertexArray = new Array<number>(0, 0, 0, 0, 1, 1, 1, 1);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {away.base.TriangleSubGeometry}\n\t * @private\n\t */\n\tpublic _pGetSubGeometry():TriangleSubGeometry\n\t{\n\t\tvar geometry:TriangleSubGeometry = SkyboxRenderable._geometry;\n\n\t\tif (!geometry) {\n\t\t\tgeometry = SkyboxRenderable._geometry = new TriangleSubGeometry(new AttributesBuffer(11, 4));\n\t\t\tgeometry.autoDeriveNormals = false;\n\t\t\tgeometry.autoDeriveTangents = false;\n\t\t\tgeometry.setIndices(Array<number>(0, 1, 2, 2, 3, 0, 6, 5, 4, 4, 7, 6, 2, 6, 7, 7, 3, 2, 4, 5, 1, 1, 0, 4, 4, 0, 3, 3, 7, 4, 2, 1, 5, 5, 6, 2));\n\t\t\tgeometry.setPositions(Array<number>(-1, 1, -1, 1, 1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1, 1));\n\t\t}\n\n\t\treturn geometry;\n\t}\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic static _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"mul vt0, va0, vc5\\n\" +\n\t\t\t\"add vt0, vt0, vc4\\n\" +\n\t\t\t\"m44 op, vt0, vc0\\n\";\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tvar pos:Vector3D = camera.scenePosition;\n\t\tthis._vertexArray[0] = pos.x;\n\t\tthis._vertexArray[1] = pos.y;\n\t\tthis._vertexArray[2] = pos.z;\n\t\tthis._vertexArray[4] = this._vertexArray[5] = this._vertexArray[6] = camera.projection.far/Math.sqrt(3);\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, viewProjection, true);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 4, this._vertexArray, 2);\n\t}\n}\n\nexport = SkyboxRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport IRenderableOwner\t\t\t\t= require(\"awayjs-display/lib/base/IRenderableOwner\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderablePool\");\nimport PassBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/PassBase\");\n\n/**\n * @class away.pool.TriangleSubMeshRenderable\n */\nclass TriangleSubMeshRenderable extends RenderableBase\n{\n\tpublic static assetClass:IAssetClass = TriangleSubMesh;\n\n\tpublic static vertexAttributesOffset:number = 1;\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:TriangleSubMesh;\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param indexOffset\n\t */\n\tconstructor(pool:RenderablePool, subMesh:TriangleSubMesh, stage:Stage)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, subMesh.material, stage);\n\n\t\tthis.subMesh = subMesh;\n\t}\n\n\t/**\n\t *\n\t * @returns {SubGeometryBase}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():TriangleSubGeometry\n\t{\n\t\treturn (this.subMesh.animator)? <TriangleSubGeometry> this.subMesh.animator.getRenderableSubGeometry(this, this.subMesh.subGeometry) : this.subMesh.subGeometry;\n\t}\n\n\n\tpublic static _iIncludeDependencies(shader:ShaderBase)\n\t{\n\n\t}\n\n\tpublic static _iGetVertexCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shader.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshader.viewMatrixIndex = viewMatrixReg.index*4;\n\n\t\tif (shader.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \", \" + viewMatrixReg + \"\\n\" +\n\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\"mov op, \" + temp + \"\\n\";\n\t\t} else {\n\t\t\tcode += \"m44 op, \" + position + \", \" + viewMatrixReg + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\tpublic static _iGetFragmentCode(shader:ShaderBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _setRenderState(pass:PassBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._setRenderState(pass, camera, viewProjection);\n\n\t\tvar shader:ShaderBase = pass.shader;\n\n\t\tif (shader.sceneMatrixIndex >= 0) {\n\t\t\tthis.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shader.vertexConstantData, shader.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(this.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shader.vertexConstantData, shader.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextGL = this._stage.context;\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shader.vertexConstantData, shader.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shader.fragmentConstantData, shader.numUsedFragmentConstants);\n\t}\n}\n\nexport = TriangleSubMeshRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport LightProbe\t\t\t\t\t= require(\"awayjs-display/lib/entities/LightProbe\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IRenderOwner\t\t\t\t\t= require(\"awayjs-display/lib/base/IRenderOwner\");\nimport LightSources\t\t\t\t\t= require(\"awayjs-display/lib/materials/LightSources\");\n\nimport ContextGLProfile\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProfile\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextGL\");\n\nimport ILightingPass\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/ILightingPass\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport CompilerBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/compilers/CompilerBase\");\nimport LightingCompiler\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/compilers/LightingCompiler\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\n\n/**\n * ShaderBase keeps track of the number of dependencies for \"named registers\" used across a pass.\n * Named registers are that are not necessarily limited to a single method. They are created by the compiler and\n * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed\n * each time a method has been compiled into the shader.\n *\n * @see RegisterPool.addUsage\n */\nclass LightingShader extends ShaderBase\n{\n\tpublic _lightingPass:ILightingPass;\n\n\tprivate _includeCasters:boolean = true;\n\n\t/**\n\t * The first index for the fragment constants containing the light data.\n\t */\n\tpublic lightFragmentConstantIndex:number;\n\n\t/**\n\t * The starting index if the vertex constant to which light data needs to be uploaded.\n\t */\n\tpublic lightVertexConstantIndex:number;\n\n\t/**\n\t * Indices for the light probe diffuse textures.\n\t */\n\tpublic lightProbeDiffuseIndices:Array<number> /*uint*/;\n\n\t/**\n\t * Indices for the light probe specular textures.\n\t */\n\tpublic lightProbeSpecularIndices:Array<number> /*uint*/;\n\n\t/**\n\t * The index of the fragment constant containing the weights for the light probes.\n\t */\n\tpublic probeWeightsIndex:number;\n\n\tpublic numLights:number;\n\tpublic numDirectionalLights:number;\n\tpublic numPointLights:number;\n\tpublic numLightProbes:number;\n\n\tpublic usesLightFallOff:boolean;\n\n\tpublic usesShadows:boolean;\n\n\t/**\n\t * Indicates whether the shader uses any lights.\n\t */\n\tpublic usesLights:boolean;\n\n\t/**\n\t * Indicates whether the shader uses any light probes.\n\t */\n\tpublic usesProbes:boolean;\n\n\t/**\n\t * Indicates whether the lights uses any specular components.\n\t */\n\tpublic usesLightsForSpecular:boolean;\n\n\t/**\n\t * Indicates whether the probes uses any specular components.\n\t */\n\tpublic usesProbesForSpecular:boolean;\n\n\t/**\n\t * Indicates whether the lights uses any diffuse components.\n\t */\n\tpublic usesLightsForDiffuse:boolean;\n\n\t/**\n\t * Indicates whether the probes uses any diffuse components.\n\t */\n\tpublic usesProbesForDiffuse:boolean;\n\n\t/**\n\t * Creates a new MethodCompilerVO object.\n\t */\n\tconstructor(renderableClass:IRenderableClass, lightingPass:ILightingPass, stage:Stage)\n\t{\n\t\tsuper(renderableClass, lightingPass, stage);\n\n\t\tthis._lightingPass = lightingPass;\n\t}\n\n\tpublic _iIncludeDependencies()\n\t{\n\t\tthis.numPointLights = this._lightingPass.numPointLights;\n\t\tthis.numDirectionalLights = this._lightingPass.numDirectionalLights;\n\t\tthis.numLightProbes = this._lightingPass.numLightProbes;\n\n\t\tvar numAllLights:number = this._lightingPass.numPointLights + this._lightingPass.numDirectionalLights;\n\t\tvar numLightProbes:number = this._lightingPass.numLightProbes;\n\t\tvar diffuseLightSources:number = this._lightingPass._iUsesDiffuse(this)? this._lightingPass.diffuseLightSources : 0x00;\n\t\tvar specularLightSources:number = this._lightingPass._iUsesSpecular(this)? this._lightingPass.specularLightSources : 0x00;\n\t\tvar combinedLightSources:number = diffuseLightSources | specularLightSources;\n\n\t\tthis.usesLightFallOff = this._lightingPass.enableLightFallOff && this.profile != ContextGLProfile.BASELINE_CONSTRAINED;\n\t\tthis.numLights = numAllLights + numLightProbes;\n\t\tthis.usesLights = numAllLights > 0 && (combinedLightSources & LightSources.LIGHTS) != 0;\n\t\tthis.usesProbes = numLightProbes > 0 && (combinedLightSources & LightSources.PROBES) != 0;\n\t\tthis.usesLightsForSpecular = numAllLights > 0 && (specularLightSources & LightSources.LIGHTS) != 0;\n\t\tthis.usesProbesForSpecular = numLightProbes > 0 && (specularLightSources & LightSources.PROBES) != 0;\n\t\tthis.usesLightsForDiffuse = numAllLights > 0 && (diffuseLightSources & LightSources.LIGHTS) != 0;\n\t\tthis.usesProbesForDiffuse = numLightProbes > 0 && (diffuseLightSources & LightSources.PROBES) != 0;\n\t\tthis.usesShadows = this._lightingPass._iUsesShadows(this);\n\n\t\t//IMPORTANT this must occur after shader lighting initialisation above\n\t\tsuper._iIncludeDependencies();\n\t}\n\n\t/**\n\t * Factory method to create a concrete compiler object for this object\n\t *\n\t * @param materialPassVO\n\t * @returns {away.materials.LightingCompiler}\n\t */\n\tpublic createCompiler(renderableClass:IRenderableClass, pass:ILightingPass):CompilerBase\n\t{\n\t\treturn new LightingCompiler(renderableClass, pass, this);\n\t}\n\n\t/**\n\t * Clears dependency counts for all registers. Called when recompiling a pass.\n\t */\n\tpublic reset()\n\t{\n\t\tsuper.reset();\n\n\t\tthis.numLights = 0;\n\t\tthis.usesLightFallOff = true;\n\t}\n\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRender(renderable, camera, viewProjection);\n\n\t\tif (this._lightingPass.lightPicker)\n\t\t\tthis._lightingPass.lightPicker.collectLights(renderable);\n\n\t\tif (this.usesLights)\n\t\t\tthis.updateLights();\n\n\t\tif (this.usesProbes)\n\t\t\tthis.updateProbes();\n\t}\n\n\t/**\n\t * Updates constant data render state used by the lights. This method is optional for subclasses to implement.\n\t */\n\tprivate updateLights()\n\t{\n\t\tvar dirLight:DirectionalLight;\n\t\tvar pointLight:PointLight;\n\t\tvar i:number = 0;\n\t\tvar k:number = 0;\n\t\tvar len:number;\n\t\tvar dirPos:Vector3D;\n\t\tvar total:number = 0;\n\t\tvar numLightTypes:number = this.usesShadows? 2 : 1;\n\t\tvar l:number;\n\t\tvar offset:number;\n\n\t\tthis.ambientR = this.ambientG = this.ambientB = 0;\n\n\t\tl = this.lightVertexConstantIndex;\n\t\tk = this.lightFragmentConstantIndex;\n\n\t\tvar cast:number = 0;\n\t\tvar dirLights:Array<DirectionalLight> = this._lightingPass.lightPicker.directionalLights;\n\t\toffset = this._lightingPass.directionalLightsOffset;\n\t\tlen = this._lightingPass.lightPicker.directionalLights.length;\n\n\t\tif (offset > len) {\n\t\t\tcast = 1;\n\t\t\toffset -= len;\n\t\t}\n\n\t\tfor (; cast < numLightTypes; ++cast) {\n\t\t\tif (cast)\n\t\t\t\tdirLights = this._lightingPass.lightPicker.castingDirectionalLights;\n\n\t\t\tlen = dirLights.length;\n\n\t\t\tif (len > this.numDirectionalLights)\n\t\t\t\tlen = this.numDirectionalLights;\n\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tdirLight = dirLights[offset + i];\n\t\t\t\tdirPos = dirLight.sceneDirection;\n\n\t\t\t\tthis.ambientR += dirLight._iAmbientR;\n\t\t\t\tthis.ambientG += dirLight._iAmbientG;\n\t\t\t\tthis.ambientB += dirLight._iAmbientB;\n\n\t\t\t\tif (this.usesTangentSpace) {\n\t\t\t\t\tvar x:number = -dirPos.x;\n\t\t\t\t\tvar y:number = -dirPos.y;\n\t\t\t\t\tvar z:number = -dirPos.z;\n\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.x;\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.y;\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.z;\n\t\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseR;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseG;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseB;\n\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularR;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularG;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularB;\n\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\n\t\t\t\tif (++total == this.numDirectionalLights) {\n\t\t\t\t\t// break loop\n\t\t\t\t\ti = len;\n\t\t\t\t\tcast = numLightTypes;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// more directional supported than currently picked, need to clamp all to 0\n\t\tif (this.numDirectionalLights > total) {\n\t\t\ti = k + (this.numDirectionalLights - total)*12;\n\n\t\t\twhile (k < i)\n\t\t\t\tthis.fragmentConstantData[k++] = 0;\n\t\t}\n\n\t\ttotal = 0;\n\n\t\tvar pointLights:Array<PointLight> = this._lightingPass.lightPicker.pointLights;\n\t\toffset = this._lightingPass.pointLightsOffset;\n\t\tlen = this._lightingPass.lightPicker.pointLights.length;\n\n\t\tif (offset > len) {\n\t\t\tcast = 1;\n\t\t\toffset -= len;\n\t\t} else {\n\t\t\tcast = 0;\n\t\t}\n\n\t\tfor (; cast < numLightTypes; ++cast) {\n\t\t\tif (cast)\n\t\t\t\tpointLights = this._lightingPass.lightPicker.castingPointLights;\n\n\t\t\tlen = pointLights.length;\n\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tpointLight = pointLights[offset + i];\n\t\t\t\tdirPos = pointLight.scenePosition;\n\n\t\t\t\tthis.ambientR += pointLight._iAmbientR;\n\t\t\t\tthis.ambientG += pointLight._iAmbientG;\n\t\t\t\tthis.ambientB += pointLight._iAmbientB;\n\n\t\t\t\tif (this.usesTangentSpace) {\n\t\t\t\t\tx = dirPos.x;\n\t\t\t\t\ty = dirPos.y;\n\t\t\t\t\tz = dirPos.z;\n\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z + this._pInverseSceneMatrix[12];\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z + this._pInverseSceneMatrix[13];\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z + this._pInverseSceneMatrix[14];\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else if (!this.usesGlobalPosFragment) {\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.x;\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.y;\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.z;\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.x;\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.y;\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.z;\n\t\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseR;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseG;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseB;\n\n\t\t\t\tvar radius:number = pointLight._pRadius;\n\t\t\t\tthis.fragmentConstantData[k++] = radius*radius;\n\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularR;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularG;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularB;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._pFallOffFactor;\n\n\t\t\t\tif (++total == this.numPointLights) {\n\t\t\t\t\t// break loop\n\t\t\t\t\ti = len;\n\t\t\t\t\tcast = numLightTypes;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// more directional supported than currently picked, need to clamp all to 0\n\t\tif (this.numPointLights > total) {\n\t\t\ti = k + (total - this.numPointLights)*12;\n\n\t\t\tfor (; k < i; ++k)\n\t\t\t\tthis.fragmentConstantData[k] = 0;\n\t\t}\n\t}\n\n\t/**\n\t * Updates constant data render state used by the light probes. This method is optional for subclasses to implement.\n\t */\n\tprivate updateProbes()\n\t{\n\t\tvar probe:LightProbe;\n\t\tvar lightProbes:Array<LightProbe> = this._lightingPass.lightPicker.lightProbes;\n\t\tvar weights:Array<number> = this._lightingPass.lightPicker.lightProbeWeights;\n\t\tvar len:number = lightProbes.length - this._lightingPass.lightProbesOffset;\n\t\tvar addDiff:boolean = this.usesProbesForDiffuse;\n\t\tvar addSpec:boolean = this.usesProbesForSpecular;\n\n\t\tif (!(addDiff || addSpec))\n\t\t\treturn;\n\n\t\tif (len > this.numLightProbes)\n\t\t\tlen = this.numLightProbes;\n\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tprobe = lightProbes[ this._lightingPass.lightProbesOffset + i];\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._stage.getImageObject(probe.diffuseMap).activate(this.lightProbeDiffuseIndices[i], false, this.useSmoothTextures, this.useMipmapping);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._stage.getImageObject(probe.specularMap).activate(this.lightProbeSpecularIndices[i], false, this.useSmoothTextures, this.useMipmapping);\n\t\t}\n\n\t\tfor (i = 0; i < len; ++i)\n\t\t\tthis.fragmentConstantData[this.probeWeightsIndex + i] = weights[this._lightingPass.lightProbesOffset + i];\n\t}\n}\n\nexport = LightingShader;",
    "import ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * RegisterPool is used by the shader compilers process to keep track of which registers of a certain type are\n * currently used and should not be allowed to be written to. Either entire registers can be requested and locked,\n * or single components (x, y, z, w) of a single register.\n * It is used by ShaderRegisterCache to track usages of individual register types.\n *\n * @see away.materials.ShaderRegisterCache\n */\nclass RegisterPool\n{\n\tprivate static _regPool:Object = new Object();\n\tprivate static _regCompsPool:Object = new Object();\n\n\tprivate _vectorRegisters:Array<ShaderRegisterElement>;\n\tprivate _registerComponents;\n\n\tprivate _regName:string;\n\tprivate _usedSingleCount:Array<Array<number>>;\n\tprivate _usedVectorCount:Array<number> /*uint*/;\n\tprivate _regCount:number;\n\n\tprivate _persistent:boolean;\n\n\t/**\n\t * Creates a new RegisterPool object.\n\t * @param regName The base name of the register type (\"ft\" for fragment temporaries, \"vc\" for vertex constants, etc)\n\t * @param regCount The amount of available registers of this type.\n\t * @param persistent Whether or not registers, once reserved, can be freed again. For example, temporaries are not persistent, but constants are.\n\t */\n\tconstructor(regName:string, regCount:number, persistent:boolean = true)\n\t{\n\t\tthis._regName = regName;\n\t\tthis._regCount = regCount;\n\t\tthis._persistent = persistent;\n\t\tthis.initRegisters(regName, regCount);\n\t}\n\n\t/**\n\t * Retrieve an entire vector register that's still available.\n\t */\n\tpublic requestFreeVectorReg():ShaderRegisterElement\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i) {\n\t\t\tif (!this.isRegisterUsed(i)) {\n\t\t\t\tif (this._persistent)\n\t\t\t\t\tthis._usedVectorCount[i]++;\n\n\t\t\t\treturn this._vectorRegisters[i];\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(\"Register overflow!\");\n\t}\n\n\t/**\n\t * Retrieve a single vector component that's still available.\n\t */\n\tpublic requestFreeRegComponent():ShaderRegisterElement\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i) {\n\t\t\tif (this._usedVectorCount[i] > 0)\n\t\t\t\tcontinue;\n\n\t\t\tfor (var j:number = 0; j < 4; ++j) {\n\t\t\t\tif (this._usedSingleCount[j][i] == 0) {\n\t\t\t\t\tif (this._persistent)\n\t\t\t\t\t\tthis._usedSingleCount[j][i]++;\n\n\t\t\t\t\treturn this._registerComponents[j][i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(\"Register overflow!\");\n\t}\n\n\t/**\n\t * Marks a register as used, so it cannot be retrieved. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addUsage(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tif (register._component > -1)\n\t\t\tthis._usedSingleCount[register._component][register.index] += usageCount;\n\t\telse\n\t\t\tthis._usedVectorCount[register.index] += usageCount;\n\t}\n\n\t/**\n\t * Removes a usage from a register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeUsage(register:ShaderRegisterElement)\n\t{\n\t\tif (register._component > -1) {\n\t\t\tif (--this._usedSingleCount[register._component][register.index] < 0)\n\t\t\t\tthrow new Error(\"More usages removed than exist!\");\n\t\t} else {\n\t\t\tif (--this._usedVectorCount[register.index] < 0)\n\t\t\t\tthrow new Error(\"More usages removed than exist!\");\n\t\t}\n\t}\n\n\t/**\n\t * Disposes any resources used by the current RegisterPool object.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._vectorRegisters = null;\n\t\tthis._registerComponents = null;\n\t\tthis._usedSingleCount = null;\n\t\tthis._usedVectorCount = null;\n\t}\n\n\t/**\n\t * Indicates whether or not any registers are in use.\n\t */\n\tpublic hasRegisteredRegs():boolean\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i)\n\t\t\tif (this.isRegisterUsed(i))\n\t\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Initializes all registers.\n\t */\n\tprivate initRegisters(regName:string, regCount:number)\n\t{\n\t\tvar hash:string = RegisterPool._initPool(regName, regCount);\n\n\t\tthis._vectorRegisters = RegisterPool._regPool[hash];\n\t\tthis._registerComponents = RegisterPool._regCompsPool[hash];\n\n\t\tthis._usedVectorCount = this._initArray(Array<number>(regCount), 0);\n\n\t\tthis._usedSingleCount = new Array<Array<number>>(4);\n\t\tthis._usedSingleCount[0] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[1] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[2] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[3] = this._initArray(new Array<number>(regCount), 0);\n\t}\n\n\tprivate static _initPool(regName:string, regCount:number):string\n\t{\n\t\tvar hash:string = regName + regCount;\n\n\t\tif (RegisterPool._regPool[hash] != undefined)\n\t\t\treturn hash;\n\n\t\tvar vectorRegisters:Array<ShaderRegisterElement> = new Array<ShaderRegisterElement>(regCount);\n\t\tRegisterPool._regPool[hash] = vectorRegisters;\n\n\t\tvar registerComponents = [\n\t\t\t[],\n\t\t\t[],\n\t\t\t[],\n\t\t\t[]\n\t\t];\n\t\tRegisterPool._regCompsPool[hash] = registerComponents;\n\n\t\tfor (var i:number = 0; i < regCount; ++i) {\n\n\t\t\tvectorRegisters[i] = new ShaderRegisterElement(regName, i);\n\n\t\t\tfor (var j:number = 0; j < 4; ++j)\n\t\t\t\tregisterComponents[j][i] = new ShaderRegisterElement(regName, i, j);\n\t\t}\n\n\t\treturn hash;\n\t}\n\n\n\t/**\n\t * Check if the temp register is either used for single or vector use\n\t */\n\tprivate isRegisterUsed(index:number):boolean\n\t{\n\t\tif (this._usedVectorCount[index] > 0)\n\t\t\treturn true;\n\n\t\tfor (var i:number = 0; i < 4; ++i)\n\t\t\tif (this._usedSingleCount[i][index] > 0)\n\t\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\n\tprivate _initArray(a:Array<any>, val:any):Array<any>\n\t{\n\t\tvar l:number = a.length;\n\n\t\tfor (var c:number = 0; c < l; c++)\n\t\t\ta[c] = val;\n\n\t\treturn a;\n\t}\n}\n\nexport = RegisterPool;\n",
    "import BlendMode\t\t\t\t\t= require(\"awayjs-core/lib/data/BlendMode\");\nimport Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport ColorTransform\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\n\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport TextureBase\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLTriangleFace\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTriangleFace\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\n\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport CompilerBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/compilers/CompilerBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport TextureVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOPool\");\nimport TextureVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\n\n/**\n * ShaderBase keeps track of the number of dependencies for \"named registers\" used across a pass.\n * Named registers are that are not necessarily limited to a single method. They are created by the compiler and\n * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed\n * each time a method has been compiled into the shader.\n *\n * @see RegisterPool.addUsage\n */\nclass ShaderBase\n{\n\tprivate _textureVOPool:TextureVOPool;\n\tprivate _renderableClass:IRenderableClass;\n\tprivate _pass:IPass;\n\tpublic _stage:Stage;\n\tprivate _programData:ProgramData;\n\n\tprivate _blendFactorSource:string = ContextGLBlendFactor.ONE;\n\tprivate _blendFactorDest:string = ContextGLBlendFactor.ZERO;\n\n\tprivate _invalidShader:boolean = true;\n\tprivate _invalidProgram:boolean = true;\n\tprivate _animationVertexCode:string = \"\";\n\tprivate _animationFragmentCode:string = \"\";\n\n\tpublic get programData():ProgramData\n\t{\n\t\tif (this._invalidProgram)\n\t\t\tthis._updateProgram();\n\n\t\treturn this._programData;\n\t}\n\n\tpublic usesBlending:boolean = false;\n\n\t/**\n\t * The depth compare mode used to render the renderables using this material.\n\t *\n\t * @see away.stagegl.ContextGLCompareMode\n\t */\n\tpublic depthCompareMode:string = ContextGLCompareMode.LESS_EQUAL;\n\n\n\t/**\n\t * Indicate whether the shader should write to the depth buffer or not. Ignored when blending is enabled.\n\t */\n\tpublic writeDepth:boolean = true;\n\n\tpublic profile:string;\n\n\tpublic usesAnimation:boolean;\n\n\tprivate _defaultCulling:string = ContextGLTriangleFace.BACK;\n\n\tpublic _pInverseSceneMatrix:Array<number> = new Array<number>();\n\n\tpublic animationRegisterCache:AnimationRegisterCache;\n\n\t/**\n\t * The amount of used vertex constants in the vertex code. Used by the animation code generation to know from which index on registers are available.\n\t */\n\tpublic numUsedVertexConstants:number;\n\n\t/**\n\t * The amount of used fragment constants in the fragment code. Used by the animation code generation to know from which index on registers are available.\n\t */\n\tpublic numUsedFragmentConstants:number;\n\n\t/**\n\t * The amount of used vertex streams in the vertex code. Used by the animation code generation to know from which index on streams are available.\n\t */\n\tpublic numUsedStreams:number;\n\n\t/**\n\t *\n\t */\n\tpublic numUsedTextures:number;\n\n\t/**\n\t *\n\t */\n\tpublic numUsedVaryings:number;\n\n\tpublic animatableAttributes:Array<string>;\n\tpublic animationTargetRegisters:Array<string>;\n\tpublic uvSource:string;\n\tpublic uvTarget:string;\n\n\tpublic useAlphaPremultiplied:boolean;\n\tpublic useBothSides:boolean;\n\tpublic useMipmapping:boolean;\n\tpublic useSmoothTextures:boolean;\n\tpublic repeatTextures:boolean;\n\tpublic usesUVTransform:boolean;\n\tpublic usesColorTransform:boolean;\n\tpublic alphaThreshold:number;\n\tpublic texture:TextureVOBase;\n\tpublic color:number;\n\n\n\t//set ambient values to default\n\tpublic ambientR:number = 0xFF;\n\tpublic ambientG:number = 0xFF;\n\tpublic ambientB:number = 0xFF;\n\n\t/**\n\t * Indicates whether the pass requires any fragment animation code.\n\t */\n\tpublic usesFragmentAnimation:boolean;\n\n\t/**\n\t * The amount of dependencies on the projected position.\n\t */\n\tpublic projectionDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the normal vector.\n\t */\n\tpublic normalDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the vertex color.\n\t */\n\tpublic colorDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the view direction.\n\t */\n\tpublic viewDirDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the primary UV coordinates.\n\t */\n\tpublic uvDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the secondary UV coordinates.\n\t */\n\tpublic secondaryUVDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the global position. This can be 0 while hasGlobalPosDependencies is true when\n\t * the global position is used as a temporary value (fe to calculate the view direction)\n\t */\n\tpublic globalPosDependencies:number;\n\n\t/**\n\t * The amount of tangent vector dependencies (fragment shader).\n\t */\n\tpublic tangentDependencies:number;\n\n\t/**\n\t *\n\t */\n\tpublic outputsColors:boolean;\n\n\t/**\n\t * Indicates whether or not normals are output.\n\t */\n\tpublic outputsNormals:boolean;\n\n\t/**\n\t * Indicates whether or not normal calculations are output in tangent space.\n\t */\n\tpublic outputsTangentNormals:boolean;\n\n\t/**\n\t * Indicates whether or not normal calculations are expected in tangent space. This is only the case if no world-space\n\t * dependencies exist and normals are being output.\n\t */\n\tpublic usesTangentSpace:boolean;\n\n\t/**\n\t * Indicates whether there are any dependencies on the world-space position vector.\n\t */\n\tpublic usesGlobalPosFragment:boolean = false;\n\n\t/**\n\t * Indicates whether there are any dependencies on the local position vector.\n\t */\n\tpublic usesLocalPosFragment:boolean = false;\n\n\tpublic vertexConstantData:Array<number> = new Array<number>();\n\tpublic fragmentConstantData:Array<number> = new Array<number>();\n\n\t/**\n\t * The index for the common data register.\n\t */\n\tpublic commonsDataIndex:number;\n\n\t/**\n\t * The index for the UV vertex attribute stream.\n\t */\n\tpublic uvBufferIndex:number;\n\n\t/**\n\t * The index for the secondary UV vertex attribute stream.\n\t */\n\tpublic secondaryUVBufferIndex:number;\n\n\t/**\n\t * The index for the vertex normal attribute stream.\n\t */\n\tpublic normalBufferIndex:number;\n\n\t/**\n\t * The index for the color attribute stream.\n\t */\n\tpublic colorBufferIndex:number;\n\n\t/**\n\t * The index for the vertex tangent attribute stream.\n\t */\n\tpublic tangentBufferIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the view matrix.\n\t */\n\tpublic viewMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the scene matrix.\n\t */\n\tpublic sceneMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the uniform scene matrix (the inverse transpose).\n\t */\n\tpublic sceneNormalMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the camera position.\n\t */\n\tpublic cameraPositionIndex:number;\n\n\t/**\n\t * The index for the UV transformation matrix vertex constant.\n\t */\n\tpublic uvTransformIndex:number;\n\n\t/**\n\t * The index for the color transform fragment constant.\n\t */\n\tpublic colorTransformIndex:number;\n\n\t/**\n\t *\n\t */\n\tpublic jointIndexIndex:number;\n\n\t/**\n\t *\n\t */\n\tpublic jointWeightIndex:number;\n\n\t/**\n\t * Creates a new MethodCompilerVO object.\n\t */\n\tconstructor(renderableClass:IRenderableClass, pass:IPass, stage:Stage)\n\t{\n\t\tthis._renderableClass = renderableClass;\n\t\tthis._pass = pass;\n\t\tthis._stage = stage;\n\t\tthis.profile = this._stage.profile;\n\n\t\tthis._textureVOPool = new TextureVOPool(this._stage);\n\t}\n\n\tpublic getTextureVO(texture:TextureBase):TextureVOBase\n\t{\n\t\treturn this._textureVOPool.getItem(texture);\n\t}\n\n\tpublic _iIncludeDependencies()\n\t{\n\t\tthis._pass._iIncludeDependencies(this);\n\t}\n\n\t/**\n\t * Factory method to create a concrete compiler object for this object\n\t *\n\t * @param renderableClass\n\t * @param pass\n\t * @param stage\n\t * @returns {CompilerBase}\n\t */\n\tpublic createCompiler(renderableClass:IRenderableClass, pass:IPass):CompilerBase\n\t{\n\t\treturn new CompilerBase(renderableClass, pass, this);\n\t}\n\n\t/**\n\t * Clears dependency counts for all registers. Called when recompiling a pass.\n\t */\n\tpublic reset()\n\t{\n\t\tthis.projectionDependencies = 0;\n\t\tthis.normalDependencies = 0;\n\t\tthis.colorDependencies = 0;\n\t\tthis.viewDirDependencies = 0;\n\t\tthis.uvDependencies = 0;\n\t\tthis.secondaryUVDependencies = 0;\n\t\tthis.globalPosDependencies = 0;\n\t\tthis.tangentDependencies = 0;\n\t\tthis.usesGlobalPosFragment = false;\n\t\tthis.usesLocalPosFragment = false;\n\t\tthis.usesFragmentAnimation = false;\n\t\tthis.usesTangentSpace = false;\n\t\tthis.outputsNormals = false;\n\t\tthis.outputsTangentNormals = false;\n\t}\n\n\tpublic pInitRegisterIndices()\n\t{\n\t\tthis.commonsDataIndex = -1;\n\t\tthis.cameraPositionIndex = -1;\n\t\tthis.uvBufferIndex = -1;\n\t\tthis.uvTransformIndex = -1;\n\t\tthis.colorTransformIndex = -1;\n\t\tthis.secondaryUVBufferIndex = -1;\n\t\tthis.normalBufferIndex = -1;\n\t\tthis.colorBufferIndex = -1;\n\t\tthis.tangentBufferIndex = -1;\n\t\tthis.sceneMatrixIndex = -1;\n\t\tthis.sceneNormalMatrixIndex = -1;\n\t\tthis.jointIndexIndex = -1;\n\t\tthis.jointWeightIndex = -1;\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this shader object.\n\t */\n\tpublic initConstantData(registerCache:ShaderRegisterCache, animatableAttributes:Array<string>, animationTargetRegisters:Array<string>, uvSource:string, uvTarget:string)\n\t{\n\t\t//Updates the amount of used register indices.\n\t\tthis.numUsedVertexConstants = registerCache.numUsedVertexConstants;\n\t\tthis.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;\n\t\tthis.numUsedStreams = registerCache.numUsedStreams;\n\t\tthis.numUsedTextures = registerCache.numUsedTextures;\n\t\tthis.numUsedVaryings = registerCache.numUsedVaryings;\n\t\tthis.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;\n\n\t\tthis.animatableAttributes = animatableAttributes;\n\t\tthis.animationTargetRegisters = animationTargetRegisters;\n\t\tthis.uvSource = uvSource;\n\t\tthis.uvTarget = uvTarget;\n\n\t\tthis.vertexConstantData.length = this.numUsedVertexConstants*4;\n\t\tthis.fragmentConstantData.length = this.numUsedFragmentConstants*4;\n\n\t\t//Initializes commonly required constant values.\n\t\tthis.fragmentConstantData[this.commonsDataIndex] = .5;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 1] = 0;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 2] = 1/255;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 3] = 1;\n\n\t\t//Initializes the default UV transformation matrix.\n\t\tif (this.uvTransformIndex >= 0) {\n\t\t\tthis.vertexConstantData[this.uvTransformIndex] = 1;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 2] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = 1;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 6] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = 0;\n\t\t}\n\n\t\t//Initializes the default colorTransform.\n\t\tif (this.colorTransformIndex >= 0) {\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex] = 1;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 1] = 1;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 2] = 1;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 3] = 1;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 4] = 0;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 5] = 0;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 6] = 0;\n\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 7] = 0;\n\t\t}\n\t\tif (this.cameraPositionIndex >= 0)\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 3] = 1;\n\t}\n\n\t/**\n\t * The blend mode to use when drawing this renderable. The following blend modes are supported:\n\t * <ul>\n\t * <li>BlendMode.NORMAL: No blending, unless the material inherently needs it</li>\n\t * <li>BlendMode.LAYER: Force blending. This will draw the object the same as NORMAL, but without writing depth writes.</li>\n\t * <li>BlendMode.MULTIPLY</li>\n\t * <li>BlendMode.ADD</li>\n\t * <li>BlendMode.ALPHA</li>\n\t * </ul>\n\t */\n\tpublic setBlendMode(value:string)\n\t{\n\t\tswitch (value) {\n\t\t\tcase BlendMode.NORMAL:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ONE;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis.usesBlending = false;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.LAYER:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ONE_MINUS_SOURCE_ALPHA;\n\t\t\t\tthis.usesBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.MULTIPLY:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.SOURCE_COLOR;\n\t\t\t\tthis.usesBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.ADD:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ONE;\n\t\t\t\tthis.usesBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.ALPHA:\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis.usesBlending = true;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new ArgumentError(\"Unsupported blend mode!\");\n\t\t}\n\t}\n\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(camera:Camera)\n\t{\n\t\tif (this.usesAnimation)\n\t\t\t(<AnimationSetBase> this._pass.animationSet).activate(this, this._stage);\n\n\t\tthis._stage.context.setCulling(this.useBothSides? ContextGLTriangleFace.NONE : this._defaultCulling, camera.projection.coordinateSystem);\n\n\t\tif (!this.usesTangentSpace && this.cameraPositionIndex >= 0) {\n\t\t\tvar pos:Vector3D = camera.scenePosition;\n\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex] = pos.x;\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 1] = pos.y;\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 2] = pos.z;\n\t\t}\n\n\t\tthis._stage.context.setDepthTest(( this.writeDepth && !this.usesBlending ), this.depthCompareMode);\n\n\t\tif (this.usesBlending)\n\t\t\tthis._stage.context.setBlendFactors(this._blendFactorSource, this._blendFactorDest);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iDeactivate()\n\t{\n\t\tif (this.usesAnimation)\n\t\t\t(<AnimationSetBase> this._pass.animationSet).deactivate(this, this._stage);\n\n\t\t//For the love of god don't remove this if you want your multi-material shadows to not flicker like shit\n\t\tthis._stage.context.setDepthTest(true, ContextGLCompareMode.LESS_EQUAL);\n\t}\n\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic _iRender(renderable:RenderableBase, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tif (renderable.renderableOwner.animator)\n\t\t\t(<AnimatorBase> renderable.renderableOwner.animator).setRenderState(this, renderable, this._stage, camera, this.numUsedVertexConstants, this.numUsedStreams);\n\n\t\tif (this.usesUVTransform) {\n\t\t\tvar uvTransform:Matrix = renderable.renderableOwner.uvTransform.matrix;\n\n\t\t\tif (uvTransform) {\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex] = uvTransform.a;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = uvTransform.b;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = uvTransform.tx;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = uvTransform.c;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = uvTransform.d;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = uvTransform.ty;\n\t\t\t} else {\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex] = 1;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = 1;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = 0;\n\t\t\t}\n\t\t}\n\t\tif (this.usesColorTransform) {\n\n\t\t\tvar colorTransform:ColorTransform = renderable.renderableOwner.colorTransform;\n\n\t\t\tif (colorTransform) {\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex] = colorTransform.redMultiplier;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 1] = colorTransform.greenMultiplier;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 2] = colorTransform.blueMultiplier;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 3] = colorTransform.alphaMultiplier;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 4] = colorTransform.redOffset/255;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 5] = colorTransform.greenOffset/255;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 6] = colorTransform.blueOffset/255;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 7] = colorTransform.alphaOffset/255;\n\t\t\t} else {\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex] = 1;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 1] = 1;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 2] = 1;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 3] = 1;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 4] = 0;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 5] = 0;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 6] = 0;\n\t\t\t\tthis.fragmentConstantData[this.colorTransformIndex + 7] = 0;\n\t\t\t}\n\t\t}\n\t\tif (this.sceneNormalMatrixIndex >= 0)\n\t\t\trenderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this.vertexConstantData, this.sceneNormalMatrixIndex, false);\n\n\t\tif (this.usesTangentSpace && this.cameraPositionIndex >= 0) {\n\n\t\t\trenderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this._pInverseSceneMatrix);\n\t\t\tvar pos:Vector3D = camera.scenePosition;\n\t\t\tvar x:number = pos.x;\n\t\t\tvar y:number = pos.y;\n\t\t\tvar z:number = pos.z;\n\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z + this._pInverseSceneMatrix[12];\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 1] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z + this._pInverseSceneMatrix[13];\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 2] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z + this._pInverseSceneMatrix[14];\n\t\t}\n\t}\n\t\n\tpublic invalidateProgram()\n\t{\n\t\tthis._invalidProgram = true;\n\t}\n\n\tpublic invalidateShader()\n\t{\n\t\tthis._invalidShader = true;\n\t\tthis._invalidProgram = true;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._programData.dispose();\n\t\tthis._programData = null;\n\t}\n\n\tprivate _updateProgram()\n\t{\n\t\tthis._invalidProgram = false;\n\n\t\tvar compiler:CompilerBase;\n\n\t\tif (this._invalidShader) {\n\t\t\tthis._invalidShader = false;\n\n\t\t\tcompiler = this.createCompiler(this._renderableClass, this._pass);\n\t\t\tcompiler.compile();\n\t\t}\n\n\t\tthis._calcAnimationCode(compiler.shadedTarget);\n\n\t\tvar programData:ProgramData = this._stage.getProgramData(this._animationVertexCode + compiler.vertexCode, compiler.fragmentCode + this._animationFragmentCode + compiler.postAnimationFragmentCode);\n\n\t\t//check program data hasn't changed, keep count of program usages\n\t\tif (this._programData != programData) {\n\t\t\tif (this._programData)\n\t\t\t\tthis._programData.dispose();\n\n\t\t\tthis._programData = programData;\n\n\t\t\tprogramData.usages++;\n\t\t}\n\t}\n\n\tprivate _calcAnimationCode(shadedTarget:string)\n\t{\n\t\t//reset code\n\t\tthis._animationVertexCode = \"\";\n\t\tthis._animationFragmentCode = \"\";\n\n\t\t//check to see if GPU animation is used\n\t\tif (this.usesAnimation) {\n\n\t\t\tvar animationSet:AnimationSetBase = <AnimationSetBase> this._pass.animationSet;\n\n\t\t\tthis._animationVertexCode += animationSet.getAGALVertexCode(this);\n\n\t\t\tif (this.uvDependencies > 0 && !this.usesUVTransform)\n\t\t\t\tthis._animationVertexCode += animationSet.getAGALUVCode(this);\n\n\t\t\tif (this.usesFragmentAnimation)\n\t\t\t\tthis._animationFragmentCode += animationSet.getAGALFragmentCode(this, shadedTarget);\n\n\t\t\tanimationSet.doneAGALCode(this);\n\n\t\t} else {\n\t\t\t// simply write attributes to targets, do not animate them\n\t\t\t// projection will pick up on targets[0] to do the projection\n\t\t\tvar len:number = this.animatableAttributes.length;\n\t\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\t\tthis._animationVertexCode += \"mov \" + this.animationTargetRegisters[i] + \", \" + this.animatableAttributes[i] + \"\\n\";\n\n\t\t\tif (this.uvDependencies > 0 && !this.usesUVTransform)\n\t\t\t\tthis._animationVertexCode += \"mov \" + this.uvTarget + \",\" + this.uvSource + \"\\n\";\n\t\t}\n\t}\n}\n\nexport = ShaderBase;",
    "import RegisterPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/RegisterPool\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * ShaderRegister Cache provides the usage management system for all registers during shading compilers.\n */\nclass ShaderRegisterCache\n{\n\tprivate _fragmentTempCache:RegisterPool;\n\tprivate _vertexTempCache:RegisterPool;\n\tprivate _varyingCache:RegisterPool;\n\tprivate _fragmentConstantsCache:RegisterPool;\n\tprivate _vertexConstantsCache:RegisterPool;\n\tprivate _textureCache:RegisterPool;\n\tprivate _vertexAttributesCache:RegisterPool;\n\tprivate _vertexConstantOffset:number; //TODO: check if this should be initialised to 0\n\tprivate _vertexAttributesOffset:number;//TODO: check if this should be initialised to 0\n\tprivate _varyingsOffset:number;//TODO: check if this should be initialised to 0\n\tprivate _fragmentConstantOffset:number;//TODO: check if this should be initialised to 0\n\n\tprivate _fragmentOutputRegister:ShaderRegisterElement;\n\tprivate _vertexOutputRegister:ShaderRegisterElement;\n\tprivate _numUsedVertexConstants:number = 0;\n\tprivate _numUsedFragmentConstants:number = 0;\n\tprivate _numUsedStreams:number = 0;\n\tprivate _numUsedTextures:number = 0;\n\tprivate _numUsedVaryings:number = 0;\n\tprivate _profile:string;\n\n\t/**\n\t * Create a new ShaderRegisterCache object.\n\t *\n\t * @param profile The compatibility profile used by the renderer.\n\t */\n\tconstructor(profile:string)\n\t{\n\t\tthis._profile = profile;\n\t}\n\n\t/**\n\t * Resets all registers.\n\t */\n\tpublic reset()\n\t{\n\t\tthis._fragmentTempCache = new RegisterPool(\"ft\", 8, false);\n\t\tthis._vertexTempCache = new RegisterPool(\"vt\", 8, false);\n\t\tthis._varyingCache = new RegisterPool(\"v\", 8);\n\t\tthis._textureCache = new RegisterPool(\"fs\", 8);\n\t\tthis._vertexAttributesCache = new RegisterPool(\"va\", 8);\n\t\tthis._fragmentConstantsCache = new RegisterPool(\"fc\", 28);\n\t\tthis._vertexConstantsCache = new RegisterPool(\"vc\", 128);\n\t\tthis._fragmentOutputRegister = new ShaderRegisterElement(\"oc\", -1);\n\t\tthis._vertexOutputRegister = new ShaderRegisterElement(\"op\", -1);\n\t\tthis._numUsedVertexConstants = 0;\n\t\tthis._numUsedStreams = 0;\n\t\tthis._numUsedTextures = 0;\n\t\tthis._numUsedVaryings = 0;\n\t\tthis._numUsedFragmentConstants = 0;\n\n\t\tvar i:number;\n\n\t\tfor (i = 0; i < this._vertexAttributesOffset; ++i)\n\t\t\tthis.getFreeVertexAttribute();\n\n\t\tfor (i = 0; i < this._vertexConstantOffset; ++i)\n\t\t\tthis.getFreeVertexConstant();\n\n\t\tfor (i = 0; i < this._varyingsOffset; ++i)\n\t\t\tthis.getFreeVarying();\n\n\t\tfor (i = 0; i < this._fragmentConstantOffset; ++i)\n\t\t\tthis.getFreeFragmentConstant();\n\t}\n\n\t/**\n\t * Disposes all resources used.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._fragmentTempCache.dispose();\n\t\tthis._vertexTempCache.dispose();\n\t\tthis._varyingCache.dispose();\n\t\tthis._fragmentConstantsCache.dispose();\n\t\tthis._vertexAttributesCache.dispose();\n\n\t\tthis._fragmentTempCache = null;\n\t\tthis._vertexTempCache = null;\n\t\tthis._varyingCache = null;\n\t\tthis._fragmentConstantsCache = null;\n\t\tthis._vertexAttributesCache = null;\n\t\tthis._fragmentOutputRegister = null;\n\t\tthis._vertexOutputRegister = null;\n\t}\n\n\t/**\n\t * Marks a fragment temporary register as used, so it cannot be retrieved. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addFragmentTempUsages(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tthis._fragmentTempCache.addUsage(register, usageCount);\n\t}\n\n\t/**\n\t * Removes a usage from a fragment temporary register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeFragmentTempUsage(register:ShaderRegisterElement)\n\t{\n\t\tthis._fragmentTempCache.removeUsage(register);\n\t}\n\n\t/**\n\t * Marks a vertex temporary register as used, so it cannot be retrieved. The register won't be able to be used\n\t * until removeUsage has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addVertexTempUsages(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tthis._vertexTempCache.addUsage(register, usageCount);\n\t}\n\n\t/**\n\t * Removes a usage from a vertex temporary register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeVertexTempUsage(register:ShaderRegisterElement)\n\t{\n\t\tthis._vertexTempCache.removeUsage(register);\n\t}\n\n\t/**\n\t * Retrieve an entire fragment temporary register that's still available. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t */\n\tpublic getFreeFragmentVectorTemp():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentTempCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve a single component from a fragment temporary register that's still available.\n\t */\n\tpublic getFreeFragmentSingleTemp():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentTempCache.requestFreeRegComponent();\n\t}\n\n\t/**\n\t * Retrieve an available varying register\n\t */\n\tpublic getFreeVarying():ShaderRegisterElement\n\t{\n\t\t++this._numUsedVaryings;\n\t\treturn this._varyingCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available fragment constant register\n\t */\n\tpublic getFreeFragmentConstant():ShaderRegisterElement\n\t{\n\t\t++this._numUsedFragmentConstants;\n\t\treturn this._fragmentConstantsCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available vertex constant register\n\t */\n\tpublic getFreeVertexConstant():ShaderRegisterElement\n\t{\n\t\t++this._numUsedVertexConstants;\n\t\treturn this._vertexConstantsCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an entire vertex temporary register that's still available.\n\t */\n\tpublic getFreeVertexVectorTemp():ShaderRegisterElement\n\t{\n\t\treturn this._vertexTempCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve a single component from a vertex temporary register that's still available.\n\t */\n\tpublic getFreeVertexSingleTemp():ShaderRegisterElement\n\t{\n\t\treturn this._vertexTempCache.requestFreeRegComponent();\n\t}\n\n\t/**\n\t * Retrieve an available vertex attribute register\n\t */\n\tpublic getFreeVertexAttribute():ShaderRegisterElement\n\t{\n\t\t++this._numUsedStreams;\n\t\treturn this._vertexAttributesCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available texture register\n\t */\n\tpublic getFreeTextureReg():ShaderRegisterElement\n\t{\n\t\t++this._numUsedTextures;\n\t\treturn this._textureCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve vertex constants.\n\t */\n\tpublic get vertexConstantOffset():number\n\t{\n\t\treturn this._vertexConstantOffset;\n\t}\n\n\tpublic set vertexConstantOffset(vertexConstantOffset:number)\n\t{\n\t\tthis._vertexConstantOffset = vertexConstantOffset;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve vertex attributes.\n\t */\n\tpublic get vertexAttributesOffset():number\n\t{\n\t\treturn this._vertexAttributesOffset;\n\t}\n\n\tpublic set vertexAttributesOffset(value:number)\n\t{\n\t\tthis._vertexAttributesOffset = value;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve varying registers.\n\t */\n\tpublic get varyingsOffset():number\n\t{\n\t\treturn this._varyingsOffset;\n\t}\n\n\tpublic set varyingsOffset(value:number)\n\t{\n\t\tthis._varyingsOffset = value;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve fragment constants.\n\t */\n\tpublic get fragmentConstantOffset():number\n\t{\n\t\treturn this._fragmentConstantOffset;\n\t}\n\n\tpublic set fragmentConstantOffset(value:number)\n\t{\n\t\tthis._fragmentConstantOffset = value;\n\t}\n\n\t/**\n\t * The fragment output register.\n\t */\n\tpublic get fragmentOutputRegister():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentOutputRegister;\n\t}\n\n\t/**\n\t * The amount of used vertex constant registers.\n\t */\n\tpublic get numUsedVertexConstants():number\n\t{\n\t\treturn this._numUsedVertexConstants;\n\t}\n\n\t/**\n\t * The amount of used fragment constant registers.\n\t */\n\tpublic get numUsedFragmentConstants():number\n\t{\n\t\treturn this._numUsedFragmentConstants;\n\t}\n\n\t/**\n\t * The amount of used vertex streams.\n\t */\n\tpublic get numUsedStreams():number\n\t{\n\t\treturn this._numUsedStreams;\n\t}\n\n\t/**\n\t * The amount of used texture slots.\n\t */\n\tpublic get numUsedTextures():number\n\t{\n\t\treturn this._numUsedTextures;\n\t}\n\n\t/**\n\t * The amount of used varying registers.\n\t */\n\tpublic get numUsedVaryings():number\n\t{\n\t\treturn this._numUsedVaryings;\n\t}\n}\n\nexport = ShaderRegisterCache;",
    "import ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n/**\n * ShaderRegisterData contains the \"named\" registers, generated by the compiler and to be passed on to the methods.\n */\nclass ShaderRegisterData\n{\n\tpublic normalVarying:ShaderRegisterElement;\n\tpublic colorVarying:ShaderRegisterElement\n\tpublic tangentVarying:ShaderRegisterElement;\n\tpublic bitangentVarying:ShaderRegisterElement;\n\tpublic uvVarying:ShaderRegisterElement;\n\tpublic secondaryUVVarying:ShaderRegisterElement;\n\tpublic viewDirVarying:ShaderRegisterElement;\n\tpublic shadowTarget:ShaderRegisterElement;\n\tpublic shadedTarget:ShaderRegisterElement;\n\tpublic globalPositionVertex:ShaderRegisterElement;\n\tpublic globalPositionVarying:ShaderRegisterElement;\n    public localPositionVarying:ShaderRegisterElement;\n\tpublic localPosition:ShaderRegisterElement;\n\tpublic normalInput:ShaderRegisterElement;\n\tpublic colorInput:ShaderRegisterElement;\n\tpublic tangentInput:ShaderRegisterElement;\n\tpublic animatedNormal:ShaderRegisterElement;\n\tpublic animatedTangent:ShaderRegisterElement;\n\tpublic commons:ShaderRegisterElement;\n\tpublic projectionFragment:ShaderRegisterElement;\n\tpublic normalFragment:ShaderRegisterElement;\n\tpublic viewDirFragment:ShaderRegisterElement;\n\tpublic bitangent:ShaderRegisterElement;\n\n\tconstructor()\n\t{\n\n\t}\n}\n\nexport = ShaderRegisterData;",
    "/**\n * A single register element (an entire register or a single register's component) used by the RegisterPool.\n */\nclass ShaderRegisterElement\n{\n\tprivate _regName:string;\n\tprivate _index:number;\n\tprivate _toStr:string;\n\n\tprivate static COMPONENTS = [\"x\", \"y\", \"z\", \"w\"];\n\n\tpublic _component:number;\n\n\t/**\n\t * Creates a new ShaderRegisterElement object.\n\t *\n\t * @param regName The name of the register.\n\t * @param index The index of the register.\n\t * @param component The register's component, if not the entire register is represented.\n\t */\n\tconstructor(regName:string, index:number, component:number = -1)\n\t{\n\t\tthis._component = component;\n\t\tthis._regName = regName;\n\t\tthis._index = index;\n\n\t\tthis._toStr = this._regName;\n\n\t\tif (this._index >= 0)\n\t\t\tthis._toStr += this._index;\n\n\t\tif (component > -1)\n\t\t\tthis._toStr += \".\" + ShaderRegisterElement.COMPONENTS[component];\n\t}\n\n\t/**\n\t * Converts the register or the components AGAL string representation.\n\t */\n\tpublic toString():string\n\t{\n\t\treturn this._toStr;\n\t}\n\n\t/**\n\t * The register's name.\n\t */\n\tpublic get regName():string\n\t{\n\t\treturn this._regName;\n\t}\n\n\t/**\n\t * The register's index.\n\t */\n\tpublic get index():number\n\t{\n\t\treturn this._index;\n\t}\n}\n\nexport = ShaderRegisterElement;",
    "import RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/RenderableBase\");\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport IPass\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/IPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\n\n/**\n * CompilerBase is an abstract base class for shader compilers that use modular shader methods to assemble a\n * material. Concrete subclasses are used by the default materials.\n *\n * @see away.materials.ShadingMethodBase\n */\nclass CompilerBase\n{\n\tpublic _pShader:ShaderBase;\n\tpublic _pSharedRegisters:ShaderRegisterData;\n\tpublic _pRegisterCache:ShaderRegisterCache;\n\tpublic _pRenderableClass:IRenderableClass;\n\tpublic _pRenderPass:IPass;\n\n\tpublic _pVertexCode:string = ''; // Changed to emtpy string- AwayTS\n\tpublic _pFragmentCode:string = '';// Changed to emtpy string - AwayTS\n\tpublic _pPostAnimationFragmentCode:string = '';// Changed to emtpy string - AwayTS\n\n\t//The attributes that need to be animated by animators.\n\tpublic _pAnimatableAttributes:Array<string>;\n\n\t//The target registers for animated properties, written to by the animators.\n\tpublic _pAnimationTargetRegisters:Array<string>;\n\n\t//The target register to place the animated UV coordinate.\n\tprivate _uvTarget:string;\n\n\t//The souce register providing the UV coordinate to animate.\n\tprivate _uvSource:string;\n\n\t/**\n\t * Creates a new CompilerBase object.\n\t * @param profile The compatibility profile of the renderer.\n\t */\n\tconstructor(renderableClass:IRenderableClass, pass:IPass, shader:ShaderBase)\n\t{\n\t\tthis._pRenderableClass = renderableClass;\n\t\tthis._pRenderPass = pass;\n\t\tthis._pShader = shader;\n\n\t\tthis._pSharedRegisters = new ShaderRegisterData();\n\n\t\tthis._pRegisterCache = new ShaderRegisterCache(shader.profile);\n\t\tthis._pRegisterCache.vertexAttributesOffset = renderableClass.vertexAttributesOffset;\n\t\tthis._pRegisterCache.reset();\n\t}\n\n\t/**\n\t * Compiles the code after all setup on the compiler has finished.\n\t */\n\tpublic compile()\n\t{\n\t\tthis._pShader.reset();\n\n\t\tthis._pShader._iIncludeDependencies();\n\n\t\tthis.pInitRegisterIndices();\n\n\t\tthis.pCompileDependencies();\n\n\t\t//compile custom vertex & fragment codes\n\t\tthis._pVertexCode += this._pRenderPass._iGetVertexCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pPostAnimationFragmentCode += this._pRenderPass._iGetFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\n\t\tconsole.log(\"uses ct:\",this._pShader.usesColorTransform);\n\t\tif (this._pShader.usesColorTransform)\n\t\t{\n\t\t\tthis.compileColorTransformCode();\n\t\t}else{\n\t\t\tthis._pShader.colorTransformIndex = -1;\n\t\t}\n\n\t\t//assign the final output color to the output register\n\t\tthis._pPostAnimationFragmentCode += \"mov \" + this._pRegisterCache.fragmentOutputRegister + \", \" + this._pSharedRegisters.shadedTarget + \"\\n\";\n\t\tthis._pRegisterCache.removeFragmentTempUsage(this._pSharedRegisters.shadedTarget);\n\n\t\t//initialise the required shader constants\n\t\tthis._pShader.initConstantData(this._pRegisterCache, this._pAnimatableAttributes, this._pAnimationTargetRegisters, this._uvSource, this._uvTarget);\n\t\tthis._pRenderPass._iInitConstantData(this._pShader);\n\t}\n\t/**\n\t * Calculate the transformed colours\n\t */\n\tprivate compileColorTransformCode()\n\t{\n\t\t// rm, gm, bm, am - multiplier\n\t\t// ro, go, bo, ao - offset\n\t\tvar ct1:ShaderRegisterElement = this._pRegisterCache.getFreeFragmentConstant();\n\t\tvar ct2:ShaderRegisterElement = this._pRegisterCache.getFreeFragmentConstant();\n\t\tthis._pShader.colorTransformIndex = ct1.index*4;\n\t\tthis._pPostAnimationFragmentCode += \"mul \" + this._pSharedRegisters.shadedTarget + \", \" + this._pSharedRegisters.shadedTarget + \", \" + ct1 + \"\\n\";\n\t\tthis._pPostAnimationFragmentCode += \"add \" + this._pSharedRegisters.shadedTarget + \", \" + this._pSharedRegisters.shadedTarget + \", \" + ct2 + \"\\n\";\n\t}\n\t/**\n\t * Compile the code for the methods.\n\t */\n\tpublic pCompileDependencies()\n\t{\n\t\tthis._pSharedRegisters.shadedTarget = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadedTarget, 1);\n\n\t\t//compile the world-space position if required\n\t\tif (this._pShader.globalPosDependencies > 0)\n\t\t\tthis.compileGlobalPositionCode();\n\n        //compile the local-space position if required\n        if (this._pShader.usesLocalPosFragment)\n            this.compileLocalPositionCode();\n\n\t\t//Calculate the (possibly animated) UV coordinates.\n\t\tif (this._pShader.uvDependencies > 0)\n\t\t\tthis.compileUVCode();\n\n\t\tif (this._pShader.secondaryUVDependencies > 0)\n\t\t\tthis.compileSecondaryUVCode();\n\n\t\tif (this._pShader.normalDependencies > 0)\n\t\t\tthis.compileNormalCode();\n\n\t\tif (this._pShader.viewDirDependencies > 0)\n\t\t\tthis.compileViewDirCode();\n\n\t\t//collect code from material\n\t\tthis._pVertexCode += this._pRenderableClass._iGetVertexCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._pRenderableClass._iGetFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t//collect code from pass\n\t\tthis._pVertexCode += this._pRenderPass._iGetPreLightingVertexCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._pRenderPass._iGetPreLightingFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t}\n\n\tprivate compileGlobalPositionCode()\n\t{\n\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.globalPositionVertex = this._pRegisterCache.getFreeVertexVectorTemp(), this._pShader.globalPosDependencies);\n\n\t\tvar sceneMatrixReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\n\t\tthis._pShader.sceneMatrixIndex = sceneMatrixReg.index*4;\n\n\t\tthis._pVertexCode += \"m44 \" + this._pSharedRegisters.globalPositionVertex + \", \" + this._pSharedRegisters.localPosition + \", \" + sceneMatrixReg + \"\\n\";\n\n\t\tif (this._pShader.usesGlobalPosFragment) {\n\t\t\tthis._pSharedRegisters.globalPositionVarying = this._pRegisterCache.getFreeVarying();\n\t\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.globalPositionVarying + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t}\n\t}\n    private compileLocalPositionCode()\n    {\n        this._pSharedRegisters.localPositionVarying = this._pRegisterCache.getFreeVarying();\n        this._pVertexCode += \"mov \" + this._pSharedRegisters.localPositionVarying + \", \" + this._pSharedRegisters.localPosition + \"\\n\";\n    }\n\t/**\n\t * Calculate the (possibly animated) UV coordinates.\n\t */\n\tprivate compileUVCode()\n\t{\n\t\tvar uvAttributeReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexAttribute();\n\t\tthis._pShader.uvBufferIndex = uvAttributeReg.index;\n\n\t\tvar varying:ShaderRegisterElement = this._pSharedRegisters.uvVarying = this._pRegisterCache.getFreeVarying();\n\n\t\tif (this._pShader.usesUVTransform) {\n\t\t\t// a, b, 0, tx\n\t\t\t// c, d, 0, ty\n\t\t\tvar uvTransform1:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tvar uvTransform2:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tthis._pShader.uvTransformIndex = uvTransform1.index*4;\n\n\t\t\tthis._pVertexCode += \"dp4 \" + varying + \".x, \" + uvAttributeReg + \", \" + uvTransform1 + \"\\n\" +\n\t\t\t\t\t\t\t\t \"dp4 \" + varying + \".y, \" + uvAttributeReg + \", \" + uvTransform2 + \"\\n\" +\n\t\t\t\t\t\t\t\t \"mov \" + varying + \".zw, \" + uvAttributeReg + \".zw \\n\";\n\t\t} else {\n\t\t\tthis._pShader.uvTransformIndex = -1;\n\t\t\tthis._uvTarget = varying.toString();\n\t\t\tthis._uvSource = uvAttributeReg.toString();\n\t\t}\n\t}\n\n\t/**\n\t * Provide the secondary UV coordinates.\n\t */\n\tprivate compileSecondaryUVCode()\n\t{\n\t\tvar uvAttributeReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexAttribute();\n\t\tthis._pShader.secondaryUVBufferIndex = uvAttributeReg.index;\n\t\tthis._pSharedRegisters.secondaryUVVarying = this._pRegisterCache.getFreeVarying();\n\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.secondaryUVVarying + \", \" + uvAttributeReg + \"\\n\";\n\t}\n\n\t/**\n\t * Calculate the view direction.\n\t */\n\tpublic compileViewDirCode()\n\t{\n\t\tvar cameraPositionReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pSharedRegisters.viewDirVarying = this._pRegisterCache.getFreeVarying();\n\t\tthis._pSharedRegisters.viewDirFragment = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.viewDirFragment, this._pShader.viewDirDependencies);\n\n\t\tthis._pShader.cameraPositionIndex = cameraPositionReg.index*4;\n\n\t\tif (this._pShader.usesTangentSpace) {\n\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pVertexCode += \"sub \" + temp + \", \" + cameraPositionReg + \", \" + this._pSharedRegisters.localPosition + \"\\n\" +\n\t\t\t\t\"m33 \" + this._pSharedRegisters.viewDirVarying + \".xyz, \" + temp + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.viewDirVarying + \".w, \" + this._pSharedRegisters.localPosition + \".w\\n\";\n\t\t} else {\n\t\t\tthis._pVertexCode += \"sub \" + this._pSharedRegisters.viewDirVarying + \", \" + cameraPositionReg + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.globalPositionVertex);\n\t\t}\n\n\t\t//TODO is this required in all cases? (re: distancemappass)\n\t\tthis._pFragmentCode += \"nrm \" + this._pSharedRegisters.viewDirFragment + \".xyz, \" + this._pSharedRegisters.viewDirVarying + \"\\n\" +\n\t\t\t\"mov \" + this._pSharedRegisters.viewDirFragment + \".w,   \" + this._pSharedRegisters.viewDirVarying + \".w\\n\";\n\t}\n\n\t/**\n\t * Calculate the normal.\n\t */\n\tpublic compileNormalCode()\n\t{\n\t\tthis._pSharedRegisters.normalFragment = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.normalFragment, this._pShader.normalDependencies);\n\n\t\t//simple normal aquisition if no tangent space is being used\n\t\tif (this._pShader.outputsNormals && !this._pShader.outputsTangentNormals) {\n\t\t\tthis._pVertexCode += this._pRenderPass._iGetNormalVertexCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\t\tthis._pFragmentCode += this._pRenderPass._iGetNormalFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar normalMatrix:Array<ShaderRegisterElement>;\n\n\t\tif (!this._pShader.outputsNormals || !this._pShader.usesTangentSpace) {\n\t\t\tnormalMatrix = new Array<ShaderRegisterElement>(3);\n\t\t\tnormalMatrix[0] = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tnormalMatrix[1] = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tnormalMatrix[2] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\tthis._pRegisterCache.getFreeVertexConstant();\n\n\t\t\tthis._pShader.sceneNormalMatrixIndex = normalMatrix[0].index*4;\n\n\t\t\tthis._pSharedRegisters.normalVarying = this._pRegisterCache.getFreeVarying();\n\t\t}\n\n\t\tif (this._pShader.outputsNormals) {\n\t\t\tif (this._pShader.usesTangentSpace) {\n\t\t\t\t// normalize normal + tangent vector and generate (approximated) bitangent used in m33 operation for view\n\t\t\t\tthis._pVertexCode += \"nrm \" + this._pSharedRegisters.animatedNormal + \".xyz, \" + this._pSharedRegisters.animatedNormal + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedTangent + \".xyz, \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"crs \" + this._pSharedRegisters.bitangent + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\";\n\n\t\t\t\tthis._pFragmentCode += this._pRenderPass._iGetNormalFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t} else {\n\t\t\t\t//Compiles the vertex shader code for tangent-space normal maps.\n\t\t\t\tthis._pSharedRegisters.tangentVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tthis._pSharedRegisters.bitangentVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + temp + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedNormal + \".xyz, \" + temp + \"\\n\" +\n\t\t\t\t\t\"m33 \" + temp + \".xyz, \" + this._pSharedRegisters.animatedTangent + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedTangent + \".xyz, \" + temp + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".x  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".x  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".z  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".z  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"crs \" + temp + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".y, \" + temp + \".x    \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".y, \" + temp + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".y, \" + temp + \".z    \\n\";\n\n\t\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedTangent);\n\n\t\t\t\t//Compiles the fragment shader code for tangent-space normal maps.\n\t\t\t\tvar t:ShaderRegisterElement;\n\t\t\t\tvar b:ShaderRegisterElement;\n\t\t\t\tvar n:ShaderRegisterElement;\n\n\t\t\t\tt = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(t, 1);\n\t\t\t\tb = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(b, 1);\n\t\t\t\tn = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(n, 1);\n\n\t\t\t\tthis._pFragmentCode += \"nrm \" + t + \".xyz, \" + this._pSharedRegisters.tangentVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + t + \".w, \" + this._pSharedRegisters.tangentVarying + \".w\t\\n\" +\n\t\t\t\t\t\"nrm \" + b + \".xyz, \" + this._pSharedRegisters.bitangentVarying + \"\\n\" +\n\t\t\t\t\t\"nrm \" + n + \".xyz, \" + this._pSharedRegisters.normalVarying + \"\\n\";\n\n\t\t\t\t//compile custom fragment code for normal calcs\n\t\t\t\tthis._pFragmentCode += this._pRenderPass._iGetNormalFragmentCode(this._pShader, this._pRegisterCache, this._pSharedRegisters) +\n\t\t\t\t\t\"m33 \" + this._pSharedRegisters.normalFragment + \".xyz, \" + this._pSharedRegisters.normalFragment + \", \" + t + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalFragment + \".w, \" + this._pSharedRegisters.normalVarying + \".w\\n\";\n\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(b);\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(t);\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(n);\n\t\t\t}\n\t\t} else {\n\t\t\t// no output, world space is enough\n\t\t\tthis._pVertexCode += \"m33 \" + this._pSharedRegisters.normalVarying + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".w, \" + this._pSharedRegisters.animatedNormal + \".w\\n\";\n\n\t\t\tthis._pFragmentCode += \"nrm \" + this._pSharedRegisters.normalFragment + \".xyz, \" + this._pSharedRegisters.normalVarying + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.normalFragment + \".w, \" + this._pSharedRegisters.normalVarying + \".w\\n\";\n\n\t\t\tif (this._pShader.tangentDependencies > 0) {\n\t\t\t\tthis._pSharedRegisters.tangentVarying = this._pRegisterCache.getFreeVarying();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + this._pSharedRegisters.tangentVarying + \".xyz, \" + this._pSharedRegisters.animatedTangent + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".w, \" + this._pSharedRegisters.animatedTangent + \".w\\n\";\n\t\t\t}\n\t\t}\n\n\t\tif (!this._pShader.usesTangentSpace)\n\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedNormal);\n\t}\n\n\t/**\n\t * Reset all the indices to \"unused\".\n\t */\n\tpublic pInitRegisterIndices()\n\t{\n\t\tthis._pShader.pInitRegisterIndices();\n\n\t\tthis._pAnimatableAttributes = new Array<string>(\"va0\");\n\t\tthis._pAnimationTargetRegisters = new Array<string>(\"vt0\");\n\t\tthis._pVertexCode = \"\";\n\t\tthis._pFragmentCode = \"\";\n\t\tthis._pPostAnimationFragmentCode = \"\";\n\n\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.localPosition = this._pRegisterCache.getFreeVertexVectorTemp(), 1);\n\n\t\t//create commonly shared constant registers\n\t\tthis._pSharedRegisters.commons = this._pRegisterCache.getFreeFragmentConstant();\n\t\tthis._pShader.commonsDataIndex = this._pSharedRegisters.commons.index*4;\n\n\t\t//Creates the registers to contain the tangent data.\n\t\t// need to be created FIRST and in this order (for when using tangent space)\n\t\tif (this._pShader.tangentDependencies > 0 || this._pShader.outputsNormals) {\n\t\t\tthis._pSharedRegisters.tangentInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShader.tangentBufferIndex = this._pSharedRegisters.tangentInput.index;\n\n\t\t\tthis._pSharedRegisters.animatedTangent = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedTangent, 1);\n\n\t\t\tif (this._pShader.usesTangentSpace) {\n\t\t\t\tthis._pSharedRegisters.bitangent = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.bitangent, 1);\n\t\t\t}\n\n\t\t\tthis._pAnimatableAttributes.push(this._pSharedRegisters.tangentInput.toString());\n\t\t\tthis._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedTangent.toString());\n\t\t}\n\n\t\tif (this._pShader.normalDependencies > 0) {\n\t\t\tthis._pSharedRegisters.normalInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShader.normalBufferIndex = this._pSharedRegisters.normalInput.index;\n\n\t\t\tthis._pSharedRegisters.animatedNormal = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedNormal, 1);\n\n\t\t\tthis._pAnimatableAttributes.push(this._pSharedRegisters.normalInput.toString());\n\t\t\tthis._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedNormal.toString());\n\t\t}\n\n\t\tif (this._pShader.colorDependencies > 0) {\n\t\t\tthis._pSharedRegisters.colorInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShader.colorBufferIndex = this._pSharedRegisters.colorInput.index;\n\n\t\t\tthis._pSharedRegisters.colorVarying = this._pRegisterCache.getFreeVarying();\n\t\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.colorVarying + \", \" + this._pSharedRegisters.colorInput + \"\\n\";\n\t\t}\n\t}\n\n\t/**\n\t * Disposes all resources used by the compiler.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pRegisterCache.dispose();\n\t\tthis._pRegisterCache = null;\n\t\tthis._pSharedRegisters = null;\n\t}\n\n\t/**\n\t * The generated vertex code.\n\t */\n\tpublic get vertexCode():string\n\t{\n\t\treturn this._pVertexCode;\n\t}\n\n\t/**\n\t * The generated fragment code.\n\t */\n\tpublic get fragmentCode():string\n\t{\n\t\treturn this._pFragmentCode;\n\t}\n\n\t/**\n\t * The generated fragment code.\n\t */\n\tpublic get postAnimationFragmentCode():string\n\t{\n\t\treturn this._pPostAnimationFragmentCode;\n\t}\n\n\t/**\n\t * The register name containing the final shaded colour.\n\t */\n\tpublic get shadedTarget():string\n\t{\n\t\treturn this._pSharedRegisters.shadedTarget.toString();\n\t}\n}\n\nexport = CompilerBase;",
    "import ContextGLProfile\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProfile\");\n\nimport LightingShader\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/LightingShader\");\nimport CompilerBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/compilers/CompilerBase\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport ILightingPass\t\t\t\t= require(\"awayjs-renderergl/lib/render/passes/ILightingPass\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-renderergl/lib/renderables/IRenderableClass\");\n\n/**\n * CompilerBase is an abstract base class for shader compilers that use modular shader methods to assemble a\n * material. Concrete subclasses are used by the default materials.\n *\n * @see away.materials.ShadingMethodBase\n */\nclass LightingCompiler extends CompilerBase\n{\n\tprivate _shaderLightingObject:LightingShader;\n\tprivate _lightingPass:ILightingPass;\n\tpublic _pointLightFragmentConstants:Array<ShaderRegisterElement>;\n\tpublic _pointLightVertexConstants:Array<ShaderRegisterElement>;\n\tpublic _dirLightFragmentConstants:Array<ShaderRegisterElement>;\n\tpublic _dirLightVertexConstants:Array<ShaderRegisterElement>;\n\n\tpublic _pNumProbeRegisters:number;\n\n\t/**\n\t * Creates a new CompilerBase object.\n\t * @param profile The compatibility profile of the renderer.\n\t */\n\tconstructor(renderableClass:IRenderableClass, lightingPass:ILightingPass, shaderLightingObject:LightingShader)\n\t{\n\t\tsuper(renderableClass, lightingPass, shaderLightingObject);\n\n\t\tthis._shaderLightingObject = shaderLightingObject;\n\t\tthis._lightingPass = lightingPass;\n\t}\n\n\t/**\n\t * Compile the code for the methods.\n\t */\n\tpublic pCompileDependencies()\n\t{\n\t\tsuper.pCompileDependencies();\n\n\t\t//compile the lighting code\n\t\tif (this._shaderLightingObject.usesShadows)\n\t\t\tthis.pCompileShadowCode();\n\n\t\tif (this._shaderLightingObject.usesLights) {\n\t\t\tthis.initLightRegisters();\n\t\t\tthis.compileLightCode();\n\t\t}\n\n\t\tif (this._shaderLightingObject.usesProbes)\n\t\t\tthis.compileLightProbeCode();\n\n\t\tthis._pVertexCode += this._lightingPass._iGetPostLightingVertexCode(this._shaderLightingObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._lightingPass._iGetPostLightingFragmentCode(this._shaderLightingObject, this._pRegisterCache, this._pSharedRegisters);\n\t}\n\n\t/**\n\t * Provides the code to provide shadow mapping.\n\t */\n\tpublic pCompileShadowCode()\n\t{\n\t\tif (this._shaderLightingObject.normalDependencies > 0) {\n\t\t\tthis._pSharedRegisters.shadowTarget = this._pSharedRegisters.normalFragment;\n\t\t} else {\n\t\t\tthis._pSharedRegisters.shadowTarget = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadowTarget, 1);\n\t\t}\n\t}\n\n\t/**\n\t * Initializes constant registers to contain light data.\n\t */\n\tprivate initLightRegisters()\n\t{\n\t\t// init these first so we're sure they're in sequence\n\t\tvar i:number, len:number;\n\n\t\tif (this._dirLightVertexConstants) {\n\t\t\tlen = this._dirLightVertexConstants.length;\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tthis._dirLightVertexConstants[i] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tif (this._shaderLightingObject.lightVertexConstantIndex == -1)\n\t\t\t\t\tthis._shaderLightingObject.lightVertexConstantIndex = this._dirLightVertexConstants[i].index*4;\n\t\t\t}\n\t\t}\n\n\t\tif (this._pointLightVertexConstants) {\n\t\t\tlen = this._pointLightVertexConstants.length;\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tthis._pointLightVertexConstants[i] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tif (this._shaderLightingObject.lightVertexConstantIndex == -1)\n\t\t\t\t\tthis._shaderLightingObject.lightVertexConstantIndex = this._pointLightVertexConstants[i].index*4;\n\t\t\t}\n\t\t}\n\n\t\tlen = this._dirLightFragmentConstants.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._dirLightFragmentConstants[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = this._dirLightFragmentConstants[i].index*4;\n\t\t}\n\n\t\tlen = this._pointLightFragmentConstants.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._pointLightFragmentConstants[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = this._pointLightFragmentConstants[i].index*4;\n\t\t}\n\t}\n\n\t/**\n\t * Compiles the shading code for directional and point lights.\n\t */\n\tprivate compileLightCode()\n\t{\n\t\tvar diffuseColorReg:ShaderRegisterElement;\n\t\tvar specularColorReg:ShaderRegisterElement;\n\t\tvar lightPosReg:ShaderRegisterElement;\n\t\tvar lightDirReg:ShaderRegisterElement;\n\t\tvar vertexRegIndex:number = 0;\n\t\tvar fragmentRegIndex:number = 0;\n\t\tvar addSpec:boolean = this._shaderLightingObject.usesLightsForSpecular;\n\t\tvar addDiff:boolean = this._shaderLightingObject.usesLightsForDiffuse;\n\n\t\t//compile the shading code for directional lights.\n\t\tfor (var i:number = 0; i < this._shaderLightingObject.numDirectionalLights; ++i) {\n\t\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\t\tlightDirReg = this._dirLightVertexConstants[vertexRegIndex++];\n\n\t\t\t\tvar lightVarying:ShaderRegisterElement = this._pRegisterCache.getFreeVarying();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + lightVarying + \".xyz, \" + lightDirReg + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightVarying + \".w, \" + lightDirReg + \".w\\n\";\n\n\t\t\t\tlightDirReg = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addVertexTempUsages(lightDirReg, 1);\n\n\t\t\t\tthis._pFragmentCode += \"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightDirReg + \".w, \" + lightVarying + \".w\\n\";\n\n\t\t\t} else {\n\t\t\t\tlightDirReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\t\t\t}\n\n\t\t\tdiffuseColorReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\t\t\tspecularColorReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject, lightDirReg, diffuseColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject, lightDirReg, specularColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace)\n\t\t\t\tthis._pRegisterCache.removeVertexTempUsage(lightDirReg);\n\t\t}\n\n\t\tvertexRegIndex = 0;\n\t\tfragmentRegIndex = 0;\n\n\t\t//compile the shading code for point lights\n\t\tfor (var i:number = 0; i < this._shaderLightingObject.numPointLights; ++i) {\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace || !this._shaderLightingObject.usesGlobalPosFragment)\n\t\t\t\tlightPosReg = this._pointLightVertexConstants[vertexRegIndex++];\n\t\t\telse\n\t\t\t\tlightPosReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tdiffuseColorReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\t\t\tspecularColorReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tlightDirReg = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\tthis._pRegisterCache.addFragmentTempUsages(lightDirReg, 1);\n\n\t\t\tvar lightVarying:ShaderRegisterElement;\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\t\tlightVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tthis._pVertexCode += \"sub \" + temp + \", \" + lightPosReg + \", \" + this._pSharedRegisters.localPosition + \"\\n\" +\n\t\t\t\t\t\"m33 \" + lightVarying + \".xyz, \" + temp + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightVarying + \".w, \" + this._pSharedRegisters.localPosition + \".w\\n\";\n\t\t\t} else if (!this._shaderLightingObject.usesGlobalPosFragment) {\n\t\t\t\tlightVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tthis._pVertexCode += \"sub \" + lightVarying + \", \" + lightPosReg + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t\t} else {\n\t\t\t\tlightVarying = lightDirReg;\n\t\t\t\tthis._pFragmentCode += \"sub \" + lightDirReg + \", \" + lightPosReg + \", \" + this._pSharedRegisters.globalPositionVarying + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._shaderLightingObject.usesLightFallOff) {\n\t\t\t\t// calculate attenuation\n\t\t\t\tthis._pFragmentCode += // attenuate\n\t\t\t\t\t\"dp3 \" + lightDirReg + \".w, \" + lightVarying + \", \" + lightVarying + \"\\n\" + // w = d - radius\n\t\t\t\t\t\"sub \" + lightDirReg + \".w, \" + lightDirReg + \".w, \" + diffuseColorReg + \".w\\n\" + // w = (d - radius)/(max-min)\n\t\t\t\t\t\"mul \" + lightDirReg + \".w, \" + lightDirReg + \".w, \" + specularColorReg + \".w\\n\" + // w = clamp(w, 0, 1)\n\t\t\t\t\t\"sat \" + lightDirReg + \".w, \" + lightDirReg + \".w\\n\" + // w = 1-w\n\t\t\t\t\t\"sub \" + lightDirReg + \".w, \" + this._pSharedRegisters.commons + \".w, \" + lightDirReg + \".w\\n\" + // normalize\n\t\t\t\t\t\"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\";\n\t\t\t} else {\n\t\t\t\tthis._pFragmentCode += \"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightDirReg + \".w, \" + lightVarying + \".w\\n\";\n\t\t\t}\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = lightPosReg.index*4;\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject, lightDirReg, diffuseColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject, lightDirReg, specularColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tthis._pRegisterCache.removeFragmentTempUsage(lightDirReg);\n\t\t}\n\t}\n\n\t/**\n\t * Compiles shading code for light probes.\n\t */\n\tprivate compileLightProbeCode()\n\t{\n\t\tvar weightReg:string;\n\t\tvar weightComponents = [ \".x\", \".y\", \".z\", \".w\" ];\n\t\tvar weightRegisters:Array<ShaderRegisterElement> = new Array<ShaderRegisterElement>();\n\t\tvar i:number;\n\t\tvar texReg:ShaderRegisterElement;\n\t\tvar addSpec:boolean = this._shaderLightingObject.usesProbesForSpecular;\n\t\tvar addDiff:boolean = this._shaderLightingObject.usesProbesForDiffuse;\n\n\t\tif (addDiff)\n\t\t\tthis._shaderLightingObject.lightProbeDiffuseIndices = new Array<number>();\n\n\t\tif (addSpec)\n\t\t\tthis._shaderLightingObject.lightProbeSpecularIndices = new Array<number>();\n\n\t\tfor (i = 0; i < this._pNumProbeRegisters; ++i) {\n\t\t\tweightRegisters[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (i == 0)\n\t\t\t\tthis._shaderLightingObject.probeWeightsIndex = weightRegisters[i].index*4;\n\t\t}\n\n\t\tfor (i = 0; i < this._shaderLightingObject.numLightProbes; ++i) {\n\t\t\tweightReg = weightRegisters[Math.floor(i/4)].toString() + weightComponents[i%4];\n\n\t\t\tif (addDiff) {\n\t\t\t\ttexReg = this._pRegisterCache.getFreeTextureReg();\n\t\t\t\tthis._shaderLightingObject.lightProbeDiffuseIndices[i] = texReg.index;\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerProbeDiffuseFragmentCode(this._shaderLightingObject, texReg, weightReg, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t}\n\n\t\t\tif (addSpec) {\n\t\t\t\ttexReg = this._pRegisterCache.getFreeTextureReg();\n\t\t\t\tthis._shaderLightingObject.lightProbeSpecularIndices[i] = texReg.index;\n\t\t\t\tthis._pFragmentCode += this._lightingPass._iGetPerProbeSpecularFragmentCode(this._shaderLightingObject, texReg, weightReg, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Reset all the indices to \"unused\".\n\t */\n\tpublic pInitRegisterIndices()\n\t{\n\t\tsuper.pInitRegisterIndices();\n\n\t\tthis._shaderLightingObject.lightVertexConstantIndex = -1;\n\t\tthis._shaderLightingObject.lightFragmentConstantIndex = -1;\n\t\tthis._shaderLightingObject.probeWeightsIndex = -1;\n\n\t\tthis._pNumProbeRegisters = Math.ceil(this._shaderLightingObject.numLightProbes/4);\n\n\t\t//init light data\n\t\tif (this._shaderLightingObject.usesTangentSpace || !this._shaderLightingObject.usesGlobalPosFragment) {\n\t\t\tthis._pointLightVertexConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numPointLights);\n\t\t\tthis._pointLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numPointLights*2);\n\t\t} else {\n\t\t\tthis._pointLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numPointLights*3);\n\t\t}\n\n\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\tthis._dirLightVertexConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numDirectionalLights);\n\t\t\tthis._dirLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numDirectionalLights*2);\n\t\t} else {\n\t\t\tthis._dirLightFragmentConstants = new Array<ShaderRegisterElement>(this._shaderLightingObject.numDirectionalLights*3);\n\t\t}\n\t}\n}\n\nexport = LightingCompiler;",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Matrix3DUtils\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\n\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n/**\n *  Class Merge merges two or more static meshes into one.<code>Merge</code>\n */\nclass Merge\n{\n\n\t//private const LIMIT:uint = 196605;\n\tprivate _objectSpace:boolean;\n\tprivate _keepMaterial:boolean;\n\tprivate _disposeSources:boolean;\n\tprivate _geomVOs:Array<GeometryVO>;\n\tprivate _toDispose:Array<Mesh>;\n\n\t/**\n\t * @param    keepMaterial    [optional]    Determines if the merged object uses the recevier mesh material information or keeps its source material(s). Defaults to false.\n\t * If false and receiver object has multiple materials, the last material found in receiver submeshes is applied to the merged submesh(es).\n\t * @param    disposeSources  [optional]    Determines if the mesh and geometry source(s) used for the merging are disposed. Defaults to false.\n\t * If true, only receiver geometry and resulting mesh are kept in  memory.\n\t * @param    objectSpace     [optional]    Determines if source mesh(es) is/are merged using objectSpace or worldspace. Defaults to false.\n\t */\n\tconstructor(keepMaterial:boolean = false, disposeSources:boolean = false, objectSpace:boolean = false)\n\t{\n\t\tthis._keepMaterial = keepMaterial;\n\t\tthis._disposeSources = disposeSources;\n\t\tthis._objectSpace = objectSpace;\n\t}\n\n\t/**\n\t * Determines if the mesh and geometry source(s) used for the merging are disposed. Defaults to false.\n\t */\n\tpublic set disposeSources(b:boolean)\n\t{\n\t\tthis._disposeSources = b;\n\t}\n\n\tpublic get disposeSources():boolean\n\t{\n\t\treturn this._disposeSources;\n\t}\n\n\t/**\n\t * Determines if the material source(s) used for the merging are disposed. Defaults to false.\n\t */\n\tpublic set keepMaterial(b:boolean)\n\t{\n\t\tthis._keepMaterial = b;\n\t}\n\n\tpublic get keepMaterial():boolean\n\t{\n\t\treturn this._keepMaterial;\n\t}\n\n\t/**\n\t * Determines if source mesh(es) is/are merged using objectSpace or worldspace. Defaults to false.\n\t */\n\tpublic set objectSpace(b:boolean)\n\t{\n\t\tthis._objectSpace = b;\n\t}\n\n\tpublic get objectSpace():boolean\n\t{\n\t\treturn this._objectSpace;\n\t}\n\n\t/**\n\t * Merges all the children of a container into a single Mesh. If no Mesh object is found, method returns the receiver without modification.\n\t *\n\t * @param    receiver           The Mesh to receive the merged contents of the container.\n\t * @param    objectContainer    The DisplayObjectContainer holding the meshes to be mergd.\n\t *\n\t * @return The merged Mesh instance.\n\t */\n\tpublic applyToContainer(receiver:Mesh, objectContainer:DisplayObjectContainer)\n\t{\n\t\tthis.reset();\n\n\t\t//collect container meshes\n\t\tthis.parseContainer(receiver, objectContainer);\n\n\t\t//collect receiver\n\t\tthis.collect(receiver, false);\n\n\t\t//merge to receiver\n\t\tthis.merge(receiver, this._disposeSources);\n\t}\n\n\t/**\n\t * Merges all the meshes found in the Array&lt;Mesh&gt; into a single Mesh.\n\t *\n\t * @param    receiver    The Mesh to receive the merged contents of the meshes.\n\t * @param    meshes      A series of Meshes to be merged with the reciever mesh.\n\t */\n\tpublic applyToMeshes(receiver:Mesh, meshes:Array<Mesh>)\n\t{\n\t\tthis.reset();\n\n\t\tif (!meshes.length)\n\t\t\treturn;\n\n\t\t//collect meshes in vector\n\t\tfor (var i:number /*uint*/ = 0; i < meshes.length; i++)\n\t\t\tif (meshes[i] != receiver)\n\t\t\t\tthis.collect(meshes[i], this._disposeSources);\n\n\t\t//collect receiver\n\t\tthis.collect(receiver, false);\n\n\t\t//merge to receiver\n\t\tthis.merge(receiver, this._disposeSources);\n\t}\n\n\t/**\n\t *  Merges 2 meshes into one. It is recommand to use apply when 2 meshes are to be merged. If more need to be merged, use either applyToMeshes or applyToContainer methods.\n\t *\n\t * @param    receiver    The Mesh to receive the merged contents of both meshes.\n\t * @param    mesh        The Mesh to be merged with the receiver mesh\n\t */\n\tpublic apply(receiver:Mesh, mesh:Mesh)\n\t{\n\t\tthis.reset();\n\n\t\t//collect mesh\n\t\tthis.collect(mesh, this._disposeSources);\n\n\t\t//collect receiver\n\t\tthis.collect(receiver, false);\n\n\t\t//merge to receiver\n\t\tthis.merge(receiver, this._disposeSources);\n\t}\n\n\tprivate reset()\n\t{\n\t\tthis._toDispose  = new Array<Mesh>();\n\t\tthis._geomVOs = new Array<GeometryVO>();\n\t}\n\n\tprivate merge(destMesh:Mesh, dispose:boolean)\n\t{\n\t\tvar i:number /*uint*/;\n\t\tvar subIdx:number /*uint*/;\n\t\tvar oldGeom:Geometry;\n\t\tvar destGeom:Geometry;\n\t\tvar useSubMaterials:boolean;\n\n\t\toldGeom = destMesh.geometry;\n\t\tdestGeom = destMesh.geometry = new Geometry();\n\t\tsubIdx = destMesh.subMeshes.length;\n\n\t\t// Only apply materials directly to sub-meshes if necessary,\n\t\t// i.e. if there is more than one material available.\n\t\tuseSubMaterials = (this._geomVOs.length > 1);\n\n\t\tfor (i = 0; i < this._geomVOs.length; i++) {\n\t\t\tvar s:number /*uint*/;\n\t\t\tvar data:GeometryVO;\n\t\t\tvar sub:TriangleSubGeometry = new TriangleSubGeometry(new AttributesBuffer());\n\t\t\tsub.autoDeriveNormals = false;\n\t\t\tsub.autoDeriveTangents = false;\n\n\t\t\tdata = this._geomVOs[i];\n\t\t\tsub.setIndices(data.indices);\n\t\t\tsub.setPositions(data.vertices);\n\t\t\tsub.setNormals(data.normals);\n\t\t\tsub.setTangents(data.tangents);\n\t\t\tsub.setUVs(data.uvs);\n\n\t\t\tdestGeom.addSubGeometry(sub);\n\n\t\t\tif (this._keepMaterial && useSubMaterials)\n\t\t\t\tdestMesh.subMeshes[subIdx].material = data.material;\n\t\t}\n\n\t\tif (this._keepMaterial && !useSubMaterials && this._geomVOs.length)\n\t\t\tdestMesh.material = this._geomVOs[0].material;\n\n\t\tif (dispose) {\n\t\t\tvar m:Mesh;\n\t\t\tvar len:number = this._toDispose.length;\n\t\t\tfor (var i:number; i < len; i++) {\n\t\t\t\tm = this._toDispose[i];\n\t\t\t\tm.geometry.dispose();\n\t\t\t\tm.dispose();\n\t\t\t}\n\n\t\t\t//dispose of the original receiver geometry\n\t\t\toldGeom.dispose();\n\t\t}\n\n\t\tthis._toDispose = null;\n\t}\n\n\tprivate collect(mesh:Mesh, dispose:boolean)\n\t{\n\t\tif (mesh.geometry) {\n\t\t\tvar subIdx:number /*uint*/;\n\t\t\tvar subGeometries:Array<TriangleSubGeometry> = <Array<TriangleSubGeometry>> mesh.geometry.subGeometries;\n\t\t\tvar calc:number /*uint*/;\n\t\t\tfor (subIdx = 0; subIdx < subGeometries.length; subIdx++) {\n\t\t\t\tvar i:number /*uint*/;\n\t\t\t\tvar len:number /*uint*/;\n\t\t\t\tvar iIdx:number /*uint*/, vIdx:number /*uint*/, nIdx:number /*uint*/, tIdx:number /*uint*/, uIdx:number /*uint*/;\n\t\t\t\tvar indexOffset:number /*uint*/;\n\t\t\t\tvar subGeom:TriangleSubGeometry;\n\t\t\t\tvar vo:GeometryVO;\n\t\t\t\tvar vertices:Array<number>;\n\t\t\t\tvar normals:Array<number>;\n\t\t\t\tvar tangents:Array<number>;\n\t\t\t\tvar ind:Uint16Array, pd:Float32Array, nd:Float32Array, td:Float32Array, ud:Float32Array;\n\n\t\t\t\tsubGeom = subGeometries[subIdx];\n\t\t\t\tpd = subGeom.positions.get(subGeom.numVertices);\n\t\t\t\tnd = subGeom.normals.get(subGeom.numVertices);\n\t\t\t\ttd = subGeom.tangents.get(subGeom.numVertices);\n\t\t\t\tud = subGeom.uvs.get(subGeom.numVertices);\n\n\t\t\t\t// Get (or create) a VO for this material\n\t\t\t\tvo = this.getSubGeomData(mesh.subMeshes[subIdx].material || mesh.material);\n\n\t\t\t\t// Vertices and normals are copied to temporary vectors, to be transformed\n\t\t\t\t// before concatenated onto those of the data. This is unnecessary if no\n\t\t\t\t// transformation will be performed, i.e. for object space merging.\n\t\t\t\tvertices = (this._objectSpace)? vo.vertices : new Array<number>();\n\t\t\t\tnormals = (this._objectSpace)? vo.normals : new Array<number>();\n\t\t\t\ttangents = (this._objectSpace)? vo.tangents : new Array<number>();\n\n\t\t\t\t// Copy over vertex attributes\n\t\t\t\tvIdx = vertices.length;\n\t\t\t\tnIdx = normals.length;\n\t\t\t\ttIdx = tangents.length;\n\t\t\t\tuIdx = vo.uvs.length;\n\t\t\t\tlen = subGeom.numVertices;\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\tcalc = i*3;\n\n\t\t\t\t\t// Position\n\t\t\t\t\tvertices[vIdx++] = pd[calc];\n\t\t\t\t\tvertices[vIdx++] = pd[calc + 1];\n\t\t\t\t\tvertices[vIdx++] = pd[calc + 2];\n\n\t\t\t\t\t// Normal\n\t\t\t\t\tnormals[nIdx++] = nd[calc];\n\t\t\t\t\tnormals[nIdx++] = nd[calc + 1];\n\t\t\t\t\tnormals[nIdx++] = nd[calc + 2];\n\n\t\t\t\t\t// Tangent\n\t\t\t\t\ttangents[tIdx++] = td[calc];\n\t\t\t\t\ttangents[tIdx++] = td[calc + 1];\n\t\t\t\t\ttangents[tIdx++] = td[calc + 2];\n\n\t\t\t\t\t// UV\n\t\t\t\t\tvo.uvs[uIdx++] = ud[i*2];\n\t\t\t\t\tvo.uvs[uIdx++] = ud[i*2 + 1];\n\t\t\t\t}\n\n\t\t\t\t// Copy over triangle indices\n\t\t\t\tindexOffset = (!this._objectSpace)? vo.vertices.length/3 :0;\n\t\t\t\tiIdx = vo.indices.length;\n\t\t\t\tlen = subGeom.numElements;\n\t\t\t\tind = subGeom.indices.get(len);\n\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\tcalc = i*3;\n\t\t\t\t\tvo.indices[iIdx++] = ind[calc] + indexOffset;\n\t\t\t\t\tvo.indices[iIdx++] = ind[calc + 1] + indexOffset;\n\t\t\t\t\tvo.indices[iIdx++] = ind[calc + 2] + indexOffset;\n\t\t\t\t}\n\n\t\t\t\tif (!this._objectSpace) {\n\t\t\t\t\tmesh.sceneTransform.transformVectors(vertices, vertices);\n\t\t\t\t\tMatrix3DUtils.deltaTransformVectors(mesh.sceneTransform, normals, normals);\n\t\t\t\t\tMatrix3DUtils.deltaTransformVectors(mesh.sceneTransform, tangents, tangents);\n\n\t\t\t\t\t// Copy vertex data from temporary (transformed) vectors\n\t\t\t\t\tvIdx = vo.vertices.length;\n\t\t\t\t\tnIdx = vo.normals.length;\n\t\t\t\t\ttIdx = vo.tangents.length;\n\t\t\t\t\tlen = vertices.length;\n\t\t\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\t\tvo.vertices[vIdx++] = vertices[i];\n\t\t\t\t\t\tvo.normals[nIdx++] = normals[i];\n\t\t\t\t\t\tvo.tangents[tIdx++] = tangents[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (dispose)\n\t\t\t\tthis._toDispose.push(mesh);\n\t\t}\n\t}\n\n\tprivate getSubGeomData(material:MaterialBase):GeometryVO\n\t{\n\t\tvar data:GeometryVO;\n\n\t\tif (this._keepMaterial) {\n\t\t\tvar i:number /*uint*/;\n\t\t\tvar len:number /*uint*/;\n\n\t\t\tlen = this._geomVOs.length;\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\tif (this._geomVOs[i].material == material) {\n\t\t\t\t\tdata = this._geomVOs[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (this._geomVOs.length) {\n\t\t\t// If materials are not to be kept, all data can be\n\t\t\t// put into a single VO, so return that one.\n\t\t\tdata = this._geomVOs[0];\n\t\t}\n\n\t\t// No data (for this material) found, create new.\n\t\tif (!data) {\n\t\t\tdata = new GeometryVO();\n\t\t\tdata.vertices = new Array<number>();\n\t\t\tdata.normals = new Array<number>();\n\t\t\tdata.tangents = new Array<number>();\n\t\t\tdata.uvs = new Array<number>();\n\t\t\tdata.indices = new Array<number /*uint*/>();\n\t\t\tdata.material = material;\n\n\t\t\tthis._geomVOs.push(data);\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tprivate parseContainer(receiver:Mesh, object:DisplayObjectContainer)\n\t{\n\t\tvar child:DisplayObjectContainer;\n\t\tvar i:number /*uint*/;\n\n\t\tif (object instanceof Mesh && object != (<DisplayObjectContainer> receiver))\n\t\t\tthis.collect(<Mesh> object, this._disposeSources);\n\n\t\tfor (i = 0; i < object.numChildren; ++i) {\n\t\t\tchild = <DisplayObjectContainer> object.getChildAt(i);\n\t\t\tthis.parseContainer(receiver, child);\n\t\t}\n\t}\n}\n\nexport = Merge;\n\nclass GeometryVO\n{\n\tpublic uvs:Array<number>;\n\tpublic vertices:Array<number>;\n\tpublic normals:Array<number>;\n\tpublic tangents:Array<number>;\n\tpublic indices:Array<number /*uint*/>;\n\tpublic material:MaterialBase;\n}\n",
    "import Matrix\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\n/**\n * ...\n */\nclass ParticleGeometryTransform\n{\n\tprivate _defaultVertexTransform:Matrix3D;\n\tprivate _defaultInvVertexTransform:Matrix3D;\n\tprivate _defaultUVTransform:Matrix;\n\n\tpublic set vertexTransform(value:Matrix3D)\n\t{\n\t\tthis._defaultVertexTransform = value;\n\t\tthis._defaultInvVertexTransform = value.clone();\n\t\tthis._defaultInvVertexTransform.invert();\n\t\tthis._defaultInvVertexTransform.transpose();\n\t}\n\n\tpublic set UVTransform(value:Matrix)\n\t{\n\t\tthis._defaultUVTransform = value;\n\t}\n\n\tpublic get UVTransform():Matrix\n\t{\n\t\treturn this._defaultUVTransform;\n\t}\n\n\tpublic get vertexTransform():Matrix3D\n\t{\n\t\treturn this._defaultVertexTransform;\n\t}\n\n\tpublic get invVertexTransform():Matrix3D\n\t{\n\t\treturn this._defaultInvVertexTransform;\n\t}\n}\n\nexport = ParticleGeometryTransform;",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Matrix\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Point\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport ParticleData\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/ParticleData\");\nimport ParticleGeometry\t\t\t\t\t= require(\"awayjs-renderergl/lib/base/ParticleGeometry\");\nimport ParticleGeometryTransform\t\t= require(\"awayjs-renderergl/lib/tools/data/ParticleGeometryTransform\");\n\n/**\n * ...\n */\nclass ParticleGeometryHelper\n{\n\tpublic static MAX_VERTEX:number /*int*/ = 65535;\n\n\tpublic static generateGeometry(geometries:Array<Geometry>, transforms:Array<ParticleGeometryTransform> = null):ParticleGeometry\n\t{\n\t\tvar indicesVector:Array<Array<number>> /*uint*/ = new Array<Array<number>>() /*uint*/;\n\t\tvar positionsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar normalsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar tangentsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar uvsVector:Array<Array<number>> = new Array<Array<number>>();\n\t\tvar vertexCounters:Array<number> /*uint*/ = new Array<number>() /*uint*/;\n\t\tvar particles:Array<ParticleData> = new Array<ParticleData>();\n\t\tvar subGeometries:Array<TriangleSubGeometry> = new Array<TriangleSubGeometry>();\n\t\tvar numParticles:number /*uint*/ = geometries.length;\n\n\t\tvar sourceSubGeometries:Array<TriangleSubGeometry>;\n\t\tvar sourceSubGeometry:TriangleSubGeometry;\n\t\tvar numSubGeometries:number /*uint*/;\n\t\tvar indices:Array<number> /*uint*/;\n\t\tvar positions:Array<number>;\n\t\tvar normals:Array<number>;\n\t\tvar tangents:Array<number>;\n\t\tvar uvs:Array<number>;\n\t\tvar vertexCounter:number /*uint*/;\n\t\tvar subGeometry:TriangleSubGeometry;\n\t\tvar i:number /*int*/;\n\t\tvar j:number /*int*/;\n\t\tvar sub2SubMap:Array<number> /*int*/ = new Array<number>() /*int*/;\n\n\t\tvar tempVertex:Vector3D = new Vector3D;\n\t\tvar tempNormal:Vector3D = new Vector3D;\n\t\tvar tempTangents:Vector3D = new Vector3D;\n\t\tvar tempUV:Point = new Point;\n\n\t\tfor (i = 0; i < numParticles; i++) {\n\t\t\tsourceSubGeometries = <Array<TriangleSubGeometry>> geometries[i].subGeometries;\n\t\t\tnumSubGeometries = sourceSubGeometries.length;\n\t\t\tfor (var srcIndex:number /*int*/ = 0; srcIndex < numSubGeometries; srcIndex++) {\n\t\t\t\t//create a different particle subgeometry group for each source subgeometry in a particle.\n\t\t\t\tif (sub2SubMap.length <= srcIndex) {\n\t\t\t\t\tsub2SubMap.push(subGeometries.length);\n\t\t\t\t\tindicesVector.push(new Array<number>() /*uint*/);\n\t\t\t\t\tpositionsVector.push(new Array<number>());\n\t\t\t\t\tnormalsVector.push(new Array<number>());\n\t\t\t\t\ttangentsVector.push(new Array<number>());\n\t\t\t\t\tuvsVector.push(new Array<number>());\n\t\t\t\t\tsubGeometries.push(new TriangleSubGeometry(new AttributesBuffer()));\n\t\t\t\t\tvertexCounters.push(0);\n\t\t\t\t}\n\n\t\t\t\tsourceSubGeometry = sourceSubGeometries[srcIndex];\n\n\t\t\t\t//add a new particle subgeometry if this source subgeometry will take us over the maxvertex limit\n\t\t\t\tif (sourceSubGeometry.numVertices + vertexCounters[sub2SubMap[srcIndex]] > ParticleGeometryHelper.MAX_VERTEX) {\n\t\t\t\t\t//update submap and add new subgeom vectors\n\t\t\t\t\tsub2SubMap[srcIndex] = subGeometries.length;\n\t\t\t\t\tindicesVector.push(new Array<number>() /*uint*/);\n\t\t\t\t\tpositionsVector.push(new Array<number>());\n\t\t\t\t\tnormalsVector.push(new Array<number>());\n\t\t\t\t\ttangentsVector.push(new Array<number>());\n\t\t\t\t\tuvsVector.push(new Array<number>());\n\t\t\t\t\tsubGeometries.push(new TriangleSubGeometry(new AttributesBuffer()));\n\t\t\t\t\tvertexCounters.push(0);\n\t\t\t\t}\n\n\t\t\t\tj = sub2SubMap[srcIndex];\n\n\t\t\t\t//select the correct vector\n\t\t\t\tindices = indicesVector[j];\n\t\t\t\tpositions = positionsVector[j];\n\t\t\t\tnormals = normalsVector[j];\n\t\t\t\ttangents = tangentsVector[j];\n\t\t\t\tuvs = uvsVector[j];\n\t\t\t\tvertexCounter = vertexCounters[j];\n\t\t\t\tsubGeometry = subGeometries[j];\n\n\t\t\t\tvar particleData:ParticleData = new ParticleData();\n\t\t\t\tparticleData.numVertices = sourceSubGeometry.numVertices;\n\t\t\t\tparticleData.startVertexIndex = vertexCounter;\n\t\t\t\tparticleData.particleIndex = i;\n\t\t\t\tparticleData.subGeometry = subGeometry;\n\t\t\t\tparticles.push(particleData);\n\n\t\t\t\tvertexCounters[j] += sourceSubGeometry.numVertices;\n\n\t\t\t\tvar k:number /*int*/;\n\t\t\t\tvar tempLen:number /*int*/;\n\t\t\t\tvar compact:TriangleSubGeometry = sourceSubGeometry;\n\t\t\t\tvar product:number /*uint*/;\n\t\t\t\tvar sourcePositions:Float32Array;\n\t\t\t\tvar sourceNormals:Float32Array;\n\t\t\t\tvar sourceTangents:Float32Array;\n\t\t\t\tvar sourceUVs:Float32Array;\n\n\t\t\t\tif (compact) {\n\t\t\t\t\ttempLen = compact.numVertices;\n\t\t\t\t\tsourcePositions = compact.positions.get(tempLen);\n\t\t\t\t\tsourceNormals = compact.normals.get(tempLen);\n\t\t\t\t\tsourceTangents = compact.tangents.get(tempLen);\n\t\t\t\t\tsourceUVs = compact.uvs.get(tempLen);\n\n\t\t\t\t\tif (transforms) {\n\t\t\t\t\t\tvar particleGeometryTransform:ParticleGeometryTransform = transforms[i];\n\t\t\t\t\t\tvar vertexTransform:Matrix3D = particleGeometryTransform.vertexTransform;\n\t\t\t\t\t\tvar invVertexTransform:Matrix3D = particleGeometryTransform.invVertexTransform;\n\t\t\t\t\t\tvar UVTransform:Matrix = particleGeometryTransform.UVTransform;\n\n\t\t\t\t\t\tfor (k = 0; k < tempLen; k++) {\n\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\t * 0 - 2: vertex position X, Y, Z\n\t\t\t\t\t\t\t * 3 - 5: normal X, Y, Z\n\t\t\t\t\t\t\t * 6 - 8: tangent X, Y, Z\n\t\t\t\t\t\t\t * 9 - 10: U V\n\t\t\t\t\t\t\t * 11 - 12: Secondary U V*/\n\t\t\t\t\t\t\tproduct = k*3;\n\t\t\t\t\t\t\ttempVertex.x = sourcePositions[product];\n\t\t\t\t\t\t\ttempVertex.y = sourcePositions[product + 1];\n\t\t\t\t\t\t\ttempVertex.z = sourcePositions[product + 2];\n\t\t\t\t\t\t\ttempNormal.x = sourceNormals[product];\n\t\t\t\t\t\t\ttempNormal.y = sourceNormals[product + 1];\n\t\t\t\t\t\t\ttempNormal.z = sourceNormals[product + 2];\n\t\t\t\t\t\t\ttempTangents.x = sourceTangents[product];\n\t\t\t\t\t\t\ttempTangents.y = sourceTangents[product + 1];\n\t\t\t\t\t\t\ttempTangents.z = sourceTangents[product + 2];\n\t\t\t\t\t\t\ttempUV.x = sourceUVs[k*2];\n\t\t\t\t\t\t\ttempUV.y = sourceUVs[k*2 + 1];\n\t\t\t\t\t\t\tif (vertexTransform) {\n\t\t\t\t\t\t\t\ttempVertex = vertexTransform.transformVector(tempVertex);\n\t\t\t\t\t\t\t\ttempNormal = invVertexTransform.deltaTransformVector(tempNormal);\n\t\t\t\t\t\t\t\ttempTangents = invVertexTransform.deltaTransformVector(tempNormal);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (UVTransform)\n\t\t\t\t\t\t\t\ttempUV = UVTransform.transformPoint(tempUV);\n\t\t\t\t\t\t\t//this is faster than that only push one data\n\t\t\t\t\t\t\tpositions.push(tempVertex.x, tempVertex.y, tempVertex.z);\n\t\t\t\t\t\t\tnormals.push(tempNormal.x, tempNormal.y, tempNormal.z);\n\t\t\t\t\t\t\ttangents.push(tempTangents.x, tempTangents.y, tempTangents.z);\n\t\t\t\t\t\t\tuvs.push(tempUV.x, tempUV.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (k = 0; k < tempLen; k++) {\n\t\t\t\t\t\t\tproduct = k*3;\n\t\t\t\t\t\t\t//this is faster than that only push one data\n\t\t\t\t\t\t\tpositions.push(sourcePositions[product], sourcePositions[product + 1], sourcePositions[product + 2]);\n\t\t\t\t\t\t\tnormals.push(sourceNormals[product], sourceNormals[product + 1], sourceNormals[product + 2]);\n\t\t\t\t\t\t\ttangents.push(sourceTangents[product], sourceTangents[product + 1], sourceTangents[product + 2]);\n\t\t\t\t\t\t\tuvs.push(sourceUVs[k*2], sourceUVs[k*2 + 1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//Todo\n\t\t\t\t}\n\n\t\t\t\ttempLen = sourceSubGeometry.numElements;\n\t\t\t\tvar sourceIndices:Uint16Array = sourceSubGeometry.indices.get(tempLen);\n\t\t\t\tfor (k = 0; k < tempLen; k++) {\n\t\t\t\t\tproduct = k*3;\n\t\t\t\t\tindices.push(sourceIndices[product] + vertexCounter, sourceIndices[product + 1] + vertexCounter, sourceIndices[product + 2] + vertexCounter);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar particleGeometry:ParticleGeometry = new ParticleGeometry();\n\t\tparticleGeometry.particles = particles;\n\t\tparticleGeometry.numParticles = numParticles;\n\n\t\tnumParticles = subGeometries.length;\n\t\tfor (i = 0; i < numParticles; i++) {\n\t\t\tsubGeometry = subGeometries[i];\n\t\t\tsubGeometry.autoDeriveNormals = false;\n\t\t\tsubGeometry.autoDeriveTangents = false;\n\t\t\tsubGeometry.setIndices(indicesVector[i]);\n\t\t\tsubGeometry.setPositions(positionsVector[i]);\n\t\t\tsubGeometry.setNormals(normalsVector[i]);\n\t\t\tsubGeometry.setTangents(tangentsVector[i]);\n\t\t\tsubGeometry.setUVs(uvsVector[i]);\n\t\t\tparticleGeometry.addSubGeometry(subGeometry);\n\t\t}\n\n\t\treturn particleGeometry;\n\t}\n}\n\nexport = ParticleGeometryHelper;",
    "import Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\n/**\n *\n */\nclass PerspectiveMatrix3D extends Matrix3D\n{\n\tconstructor(v:Array<number> = null)\n\t{\n\t\tsuper(v);\n\t}\n\n\tpublic perspectiveFieldOfViewLH(fieldOfViewY:number, aspectRatio:number, zNear:number, zFar:number)\n\t{\n\t\tvar yScale:number = 1/Math.tan(fieldOfViewY/2);\n\t\tvar xScale:number = yScale/aspectRatio;\n\n\t\tthis.copyRawDataFrom([xScale, 0.0, 0.0, 0.0, 0.0, yScale, 0.0, 0.0, 0.0, 0.0, zFar/(zFar - zNear), 1.0, 0.0, 0.0, (zNear*zFar)/(zNear - zFar), 0.0]);\n\t}\n}\n\nexport = PerspectiveMatrix3D;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport ContextGLDrawMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLDrawMode\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport CurveSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/CurveSubGeometry\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\n\n/**\n *\n * @class away.pool.CurveSubGeometryVO\n */\nclass CurveSubGeometryVO extends SubGeometryVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = CurveSubGeometry;\n\n\tprivate _curveSubGeometry:CurveSubGeometry;\n\n\tconstructor(pool:SubGeometryVOPool, curveSubGeometry:CurveSubGeometry)\n\t{\n\t\tsuper(pool, curveSubGeometry);\n\n\t\tthis._curveSubGeometry = curveSubGeometry;\n\n\t\tthis.invalidateVertices(this._curveSubGeometry.positions);\n\t\tthis.invalidateVertices(this._curveSubGeometry.curves);\n\t\tthis.invalidateVertices(this._curveSubGeometry.uvs);\n\t}\n\n\tpublic _render(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (shader.uvBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.uvBufferIndex, this._curveSubGeometry.uvs, stage);\n\n\t\tthis.activateVertexBufferVO(0, this._curveSubGeometry.positions, stage);\n\t\tthis.activateVertexBufferVO(1, this._curveSubGeometry.curves, stage);\n\n\t\tsuper._render(shader, stage);\n\t}\n\n\tpublic _drawElements(firstIndex:number, numIndices:number, stage:Stage)\n\t{\n\t\tthis.getIndexBufferVO(stage).draw(ContextGLDrawMode.TRIANGLES, firstIndex, numIndices);\n\t}\n\n\tpublic _drawArrays(firstVertex:number, numVertices:number, stage:Stage)\n\t{\n\t\tstage.context.drawVertices(ContextGLDrawMode.TRIANGLES, firstVertex, numVertices);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.CurveSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowSubGeometry():SubGeometryVOBase\n\t{\n\t\treturn new CurveSubGeometryVO(this._pool, this._curveSubGeometry);\n\t}\n}\n\nexport = CurveSubGeometryVO;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport ContextGLDrawMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLDrawMode\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\n\n/**\n *\n * @class away.pool.LineSubGeometryVO\n */\nclass LineSubGeometryVO extends SubGeometryVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = LineSubGeometry;\n\n\tprivate _lineSubGeometry:LineSubGeometry;\n\n\tconstructor(pool:SubGeometryVOPool, lineSubGeometry:LineSubGeometry)\n\t{\n\t\tsuper(pool, lineSubGeometry);\n\n\t\tthis._lineSubGeometry = lineSubGeometry;\n\n\t\tthis.invalidateVertices(this._lineSubGeometry.positions);\n\t\tthis.invalidateVertices(this._lineSubGeometry.thickness);\n\t\tthis.invalidateVertices(this._lineSubGeometry.colors);\n\t}\n\n\tpublic _render(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (shader.colorBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.colorBufferIndex, this._lineSubGeometry.colors, stage);\n\n\t\tthis.activateVertexBufferVO(0, this._lineSubGeometry.positions, stage, 3);\n\t\tthis.activateVertexBufferVO(1, this._lineSubGeometry.positions, stage, 3, 12);\n\t\tthis.activateVertexBufferVO(2, this._lineSubGeometry.thickness, stage);\n\n\t\tsuper._render(shader, stage);\n\t}\n\n\tpublic _drawElements(firstIndex:number, numIndices:number, stage:Stage)\n\t{\n\t\tthis.getIndexBufferVO(stage).draw(ContextGLDrawMode.TRIANGLES, 0, numIndices);\n\t}\n\n\tpublic _drawArrays(firstVertex:number, numVertices:number, stage:Stage)\n\t{\n\t\tstage.context.drawVertices(ContextGLDrawMode.TRIANGLES, firstVertex, numVertices);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.LineSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowSubGeometry():SubGeometryVOBase\n\t{\n\t\treturn new LineSubGeometryVO(this._pool, this._lineSubGeometry);\n\t}\n}\n\nexport = LineSubGeometryVO;",
    "import Sampler2D\t\t\t\t\t= require(\"awayjs-core/lib/data/Sampler2D\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SamplerVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SamplerVOBase\");\n\n/**\n *\n * @class away.pool.Sampler2DVO\n */\nclass Sampler2DVO extends SamplerVOBase\n{\n\tpublic sampler2D:Sampler2D;\n\n\tpublic fragmentReg:ShaderRegisterElement;\n\n\tpublic fragmentIndex:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper(stage);\n\t}\n\n\n\tpublic initProperties(sampler2D:Sampler2D, regCache:ShaderRegisterCache)\n\t{\n\t\tthis.sampler2D = sampler2D;\n\n\t\tthis.samplerReg = regCache.getFreeTextureReg();\n\t\tthis.samplerIndex = this.samplerReg.index;\n\n\t\tif (this.sampler2D.imageRect) {\n\t\t\tthis.fragmentReg = regCache.getFreeFragmentConstant();\n\t\t\tthis.fragmentIndex = this.fragmentReg.index*4;\n\t\t}\n\t}\n\n\tpublic getFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar wrap:string = (shader.repeatTextures? \"wrap\":\"clamp\");\n\t\tvar format:string = this.getFormatString(this.sampler2D);\n\t\tvar filter:string = (shader.useSmoothTextures)? (shader.useMipmapping? \"linear,miplinear\" : \"linear\") : (shader.useMipmapping? \"nearest,mipnearest\" : \"nearest\");\n\n\t\tvar temp:ShaderRegisterElement;\n\n\t\t//handles texture atlasing\n\t\tif (this.sampler2D.imageRect) {\n\t\t\ttemp = regCache.getFreeFragmentVectorTemp();\n\n\t\t\tcode += \"mul \" + temp + \", \" + inputReg + \", \" + this.fragmentReg + \".xy\\n\";\n\t\t\tcode += \"add \" + temp + \", \" + temp + \", \" + this.fragmentReg + \".zw\\n\";\n\t\t} else {\n\t\t\ttemp = inputReg;\n\t\t}\n\n\t\tcode += \"tex \" + targetReg + \", \" + temp + \", \" + this.samplerReg + \" <2d,\" + filter + \",\" + format + wrap + \">\\n\";\n\n\t\treturn code;\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthis._stage.getImageObject(this.sampler2D.image2D).activate(this.samplerIndex, this.sampler2D.repeat || shader.repeatTextures, this.sampler2D.smooth || shader.useSmoothTextures, this.sampler2D.mipmap || shader.useMipmapping);\n\n\t\tif (this.sampler2D.imageRect) {\n\t\t\tvar index:number = this.fragmentIndex;\n\t\t\tvar data:Array<number> = shader.fragmentConstantData;\n\t\t\tdata[index] = this.sampler2D.scaleX;\n\t\t\tdata[index + 1] = this.sampler2D.scaleY;\n\t\t\tdata[index + 2] = this.sampler2D.offsetX;\n\t\t\tdata[index + 3] = this.sampler2D.offsetY;\n\t\t}\n\t}\n}\n\nexport = Sampler2DVO;",
    "import SamplerCube\t\t\t\t\t= require(\"awayjs-core/lib/data/SamplerCube\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SamplerVOBase\t\t\t\t= require(\"awayjs-renderergl/lib/vos/SamplerVOBase\");\n\n/**\n *\n * @class away.pool.BitmapObject\n */\nclass SamplerCubeVO extends SamplerVOBase\n{\n\tpublic samplerCube:SamplerCube;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper(stage);\n\t}\n\n\tpublic initProperties(samplerCube:SamplerCube, regCache:ShaderRegisterCache)\n\t{\n\t\tthis.samplerCube = samplerCube;\n\n\t\tthis.samplerReg = regCache.getFreeTextureReg();\n\n\t\tthis.samplerIndex = this.samplerReg.index;\n\t}\n\n\tpublic getFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\tvar filter:string;\n\t\tvar format:string = this.getFormatString(this.samplerCube);\n\t\tvar filter:string = (shader.useSmoothTextures)? (shader.useMipmapping? \"linear,miplinear\" : \"linear\") : (shader.useMipmapping? \"nearest,mipnearest\" : \"nearest\");\n\n\t\treturn \"tex \" + targetReg + \", \" + inputReg + \", \" + this.samplerReg + \" <cube,\" + format + filter + \">\\n\";\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthis._stage.getImageObject(this.samplerCube.imageCube).activate(this.samplerIndex, false, this.samplerCube.smooth || shader.useSmoothTextures, this.samplerCube.mipmap || shader.useMipmapping);\n\t}\n}\n\nexport = SamplerCubeVO;",
    "import SamplerBase\t\t\t\t\t= require(\"awayjs-core/lib/data/SamplerBase\");\n\nimport ContextGLTextureFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFormat\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\n\n\n/**\n *\n * @class away.pool.SamplerVOBase\n */\nclass SamplerVOBase\n{\n\tpublic _stage:Stage;\n\n\tpublic samplerReg:ShaderRegisterElement;\n\n\tpublic samplerIndex:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * Generates a texture format string for the sample instruction.\n\t * @param texture The texture for which to get the format string.\n\t * @return\n\t *\n\t * @protected\n\t */\n\tpublic getFormatString(bitmap:SamplerBase):string\n\t{\n\t\tswitch (bitmap.format) {\n\t\t\tcase ContextGLTextureFormat.COMPRESSED:\n\t\t\t\treturn \"dxt1,\";\n\t\t\t\tbreak;\n\t\t\tcase ContextGLTextureFormat.COMPRESSED_ALPHA:\n\t\t\t\treturn \"dxt5,\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn \"\";\n\t\t}\n\t}\n}\n\nexport = SamplerVOBase;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport Single2DTexture\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport TextureVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOPool\");\nimport TextureVOBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\nimport Sampler2DVO\t\t\t\t= require(\"awayjs-renderergl/lib/vos/Sampler2DVO\");\n\n/**\n *\n * @class away.pool.Single2DTextureVO\n */\nclass Single2DTextureVO extends TextureVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = Single2DTexture;\n\n\tprivate _single2DTexture:Single2DTexture;\n\n\tprivate _sampler2DVO:Sampler2DVO;\n\n\tconstructor(pool:TextureVOPool, single2DTexture:Single2DTexture, stage:Stage)\n\t{\n\t\tsuper(pool, single2DTexture, stage);\n\n\t\tthis._single2DTexture = single2DTexture;\n\n\t\tthis._sampler2DVO = new Sampler2DVO(stage);\n\t}\n\n\tpublic _iInitRegisters(shader:ShaderBase, regCache:ShaderRegisterCache)\n\t{\n\t\tthis._sampler2DVO.initProperties(this._single2DTexture.sampler2D, regCache);\n\t}\n\n\t/**\n\t *\n\t * @param shader\n\t * @param regCache\n\t * @param targetReg The register in which to store the sampled colour.\n\t * @param uvReg The uv coordinate vector with which to sample the texture map.\n\t * @returns {string}\n\t * @private\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\treturn this._sampler2DVO.getFragmentCode(shader, targetReg, regCache, inputReg);\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthis._sampler2DVO.activate(shader);\n\t}\n}\n\nexport = Single2DTextureVO;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport SingleCubeTexture\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport TextureVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOPool\");\nimport TextureVOBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\nimport SamplerCubeVO\t\t\t= require(\"awayjs-renderergl/lib/vos/SamplerCubeVO\");\n\n/**\n *\n * @class away.pool.TextureDataBase\n */\nclass SingleCubeTextureVO extends TextureVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = SingleCubeTexture;\n\n\n\tprivate _singleCubeTexture:SingleCubeTexture;\n\n\tprivate _samplerCubeVO:SamplerCubeVO;\n\n\tconstructor(pool:TextureVOPool, singleCubeTexture:SingleCubeTexture, stage:Stage)\n\t{\n\t\tsuper(pool, singleCubeTexture, stage);\n\n\t\tthis._singleCubeTexture = singleCubeTexture;\n\n\t\tthis._samplerCubeVO = new SamplerCubeVO(stage);\n\t}\n\n\tpublic _iIncludeDependencies(shader:ShaderBase, includeInput:boolean = true)\n\t{\n\t\tif (includeInput)\n\t\t\tshader.usesLocalPosFragment = true;\n\t}\n\n\tpublic _iInitRegisters(shader:ShaderBase, regCache:ShaderRegisterCache)\n\t{\n\t\tthis._samplerCubeVO.initProperties(this._singleCubeTexture.samplerCube, regCache);\n\t}\n\n\t/**\n\t *\n\t * @param shader\n\t * @param regCache\n\t * @param targetReg The register in which to store the sampled colour.\n\t * @param uvReg The direction vector with which to sample the cube map.\n\t * @returns {string}\n\t * @private\n\t */\n\tpublic _iGetFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement):string\n\t{\n\t\treturn this._samplerCubeVO.getFragmentCode(shader, targetReg, regCache, inputReg);\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthis._samplerCubeVO.activate(shader);\n\t}\n}\n\nexport = SingleCubeTextureVO;",
    "import AttributesView\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesView\");\nimport AttributesBuffer\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\nimport SubGeometryUtils\t\t\t\t= require(\"awayjs-display/lib/utils/SubGeometryUtils\");\nimport AttributesBufferVO\t\t\t= require(\"awayjs-stagegl/lib/vos/AttributesBufferVO\");\n\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport ISubGeometryVO\t\t\t\t= require(\"awayjs-display/lib/vos/ISubGeometryVO\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\n\n/**\n *\n * @class away.pool.SubGeometryVOBaseBase\n */\nclass SubGeometryVOBase implements ISubGeometryVO\n{\n\tpublic _pool:SubGeometryVOPool;\n\tprivate _subGeometry:SubGeometryBase;\n\tprivate _onIndicesUpdatedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onIndicesDisposedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onVerticesUpdatedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onVerticesDisposedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _overflow:SubGeometryVOBase;\n\tprivate _indices:AttributesBuffer;\n\tprivate _indicesDirty:boolean;\n\tprivate _vertices:Object = new Object();\n\tprivate _verticesDirty:Object = new Object();\n\n\tpublic _indexMappings:Array<number> = Array<number>();\n\t\n\tprivate _numIndices:number;\n\n\tprivate _numVertices:number;\n\n\tpublic invalid:boolean;\n\n\tpublic get subGeometry()\n\t{\n\t\treturn this._subGeometry;\n\t}\n\t/**\n\t *\n\t */\n\tpublic get numIndices():number\n\t{\n\t\treturn this._numIndices;\n\t}\n\n\tconstructor(pool:SubGeometryVOPool, subGeometry:SubGeometryBase)\n\t{\n\t\tthis._pool = pool;\n\t\tthis._subGeometry = subGeometry;\n\n\t\tthis._onIndicesUpdatedDelegate = (event:SubGeometryEvent) => this._onIndicesUpdated(event);\n\t\tthis._onIndicesDisposedDelegate = (event:SubGeometryEvent) => this._onIndicesDisposed(event);\n\t\tthis._onVerticesUpdatedDelegate = (event:SubGeometryEvent) => this._onVerticesUpdated(event);\n\t\tthis._onVerticesDisposedDelegate = (event:SubGeometryEvent) => this._onVerticesDisposed(event);\n\n\t\tthis._subGeometry.addEventListener(SubGeometryEvent.INDICES_DISPOSED, this._onIndicesDisposedDelegate);\n\t\tthis._subGeometry.addEventListener(SubGeometryEvent.INDICES_UPDATED, this._onIndicesUpdatedDelegate);\n\n\t\tthis._subGeometry.addEventListener(SubGeometryEvent.VERTICES_DISPOSED, this._onVerticesDisposedDelegate);\n\t\tthis._subGeometry.addEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdatedDelegate);\n\n\t\tthis.invalidateIndices();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get indexMappings():Array<number>\n\t{\n\t\tif (this._indicesDirty)\n\t\t\tthis._updateIndices();\n\n\t\treturn this._indexMappings;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getIndexBufferVO(stage:Stage):AttributesBufferVO\n\t{\n\t\tif (this._indicesDirty)\n\t\t\tthis._updateIndices();\n\n\t\treturn stage.getAttributesBufferVO(this._indices);\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic getVertexBufferVO(attributesView:AttributesView, stage:Stage):AttributesBufferVO\n\t{\n\t\tvar bufferId:number = attributesView.buffer.id;\n\t\tif (this._indicesDirty)\n\t\t\tthis._updateIndices();\n\n\t\tif (this._verticesDirty[bufferId])\n\t\t\tthis._updateVertices(attributesView);\n\n\t\treturn stage.getAttributesBufferVO(this._vertices[bufferId]);\n\t}\n\t\n\t/**\n\t *\n\t */\n\tpublic activateVertexBufferVO(index:number, attributesView:AttributesView, stage:Stage, dimensions:number = 0, offset:number = 0)\n\t{\n\t\tthis.getVertexBufferVO(attributesView, stage).activate(index, attributesView.size, dimensions || attributesView.dimensions, attributesView.offset + offset);\n\t}\n\t\n\t/**\n\t *\n\t */\n\tpublic invalidateIndices()\n\t{\n\t\tif (!this._subGeometry.indices)\n\t\t\treturn;\n\n\t\tthis._indicesDirty = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic disposeIndices()\n\t{\n\t\tif (this._indices) {\n\t\t\tthis._indices.dispose();\n\t\t\tthis._indices = null;\n\t\t}\n\t}\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param attributesView\n\t */\n\tpublic invalidateVertices(attributesView:AttributesView)\n\t{\n\t\tif (!attributesView)\n\t\t\treturn;\n\n\t\tvar bufferId:number = attributesView.buffer.id;\n\n\t\tthis._verticesDirty[bufferId] = true;\n\t}\n\t\n\t/**\n\t *\n\t */\n\tpublic disposeVertices(attributesView:AttributesView)\n\t{\n\t\tif (!attributesView)\n\t\t\treturn;\n\n\t\tvar bufferId:number = attributesView.buffer.id;\n\n\t\tthis._vertices[bufferId].dispose();\n\t\tthis._vertices[bufferId] = null;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this._subGeometry);\n\n\t\tthis.disposeIndices();\n\n\t\tif (this._overflow) {\n\t\t\tthis._overflow.dispose();\n\t\t\tthis._overflow = null;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidate()\n\t{\n\t\tthis.invalid = true;\n\t}\n\n\tpublic _iGetFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement = null):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic _iRender(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (this._indicesDirty)\n\t\t\tthis._updateIndices();\n\n\t\tthis._render(shader, stage);\n\n\t\tif (this._overflow)\n\t\t\tthis._overflow._iRender(shader, stage);\n\t}\n\n\tpublic _render(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (this._indices)\n\t\t\tthis._drawElements(0, this._numIndices, stage);\n\t\telse\n\t\t\tthis._drawArrays(0, this._numVertices, stage);\n\t}\n\n\tpublic _drawElements(firstIndex:number, numIndices:number, stage:Stage)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic _drawArrays(firstVertex:number, numVertices:number, stage:Stage)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @private\n\t */\n\tpublic _updateIndices(indexOffset:number = 0)\n\t{\n\t\tthis._indices = SubGeometryUtils.getSubIndices(this._subGeometry.indices, this._subGeometry.numVertices, this._indexMappings, indexOffset);\n\n\t\tthis._numIndices = this._indices.count*this._subGeometry.indices.dimensions;\n\n\t\tindexOffset += this._numIndices;\n\n\t\t//check if there is more to split\n\t\tif (indexOffset < this._subGeometry.indices.count*this._subGeometry.indices.dimensions) {\n\t\t\tif (!this._overflow)\n\t\t\t\tthis._overflow = this._pGetOverflowSubGeometry();\n\n\t\t\tthis._overflow._updateIndices(indexOffset);\n\t\t} else if (this._overflow) {\n\t\t\tthis._overflow.dispose();\n\t\t\tthis._overflow = null;\n\t\t}\n\n\t\tthis._indicesDirty = false;\n\t\t\n\t\t//invalidate vertices if index mappings exist\n\t\tif (this._indexMappings.length)\n\t\t\tfor (var key in this._verticesDirty)\n\t\t\t\tthis._verticesDirty[key] = true;\n\t}\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param attributesView\n\t * @private\n\t */\n\tprivate _updateVertices(attributesView:AttributesView)\n\t{\n\t\tthis._numVertices = attributesView.count;\n\n\t\tvar bufferId:number = attributesView.buffer.id;\n\n\t\tthis._vertices[bufferId] = SubGeometryUtils.getSubVertices(attributesView.buffer, this._indexMappings);\n\n\t\tthis._verticesDirty[bufferId] = false;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onIndicesUpdated(event:SubGeometryEvent)\n\t{\n\t\tthis.invalidateIndices();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onIndicesDisposed(event:SubGeometryEvent)\n\t{\n\t\tthis.disposeIndices();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onVerticesUpdated(event:SubGeometryEvent)\n\t{\n\t\tthis.invalidateVertices(event.attributesView);\n\t}\n\t\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onVerticesDisposed(event:SubGeometryEvent)\n\t{\n\t\tthis.disposeVertices(event.attributesView);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.TriangleSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowSubGeometry():SubGeometryVOBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = SubGeometryVOBase;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\n\nimport ISubGeometryVOClass\t\t\t= require(\"awayjs-renderergl/lib/vos/ISubGeometryVOClass\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\nimport TriangleSubGeometryVO\t\t= require(\"awayjs-renderergl/lib/vos/TriangleSubGeometryVO\");\nimport LineSubGeometryVO\t\t\t= require(\"awayjs-renderergl/lib/vos/LineSubGeometryVO\");\nimport CurveSubGeometryVO\t\t\t= require(\"awayjs-renderergl/lib/vos/CurveSubGeometryVO\");\n\n/**\n * @class away.pool.SubGeometryVOPool\n */\nclass SubGeometryVOPool\n{\n\tprivate static classPool:Object = new Object();\n\n\tpublic static _pool:SubGeometryVOPool;\n\n\tprivate _pool:Object = new Object();\n\n\t/**\n\t * //TODO\n\t *\n\t * @param subGeometryDataClass\n\t */\n\tconstructor()\n\t{\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ISubGeometry\n\t */\n\tpublic getItem(subGeometry:SubGeometryBase):SubGeometryVOBase\n\t{\n\t\treturn (this._pool[subGeometry.id] || (this._pool[subGeometry.id] = subGeometry._iAddSubGeometryVO(new (SubGeometryVOPool.getClass(subGeometry))(this, subGeometry))));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(subGeometry:SubGeometryBase)\n\t{\n\t\tsubGeometry._iRemoveSubGeometryVO(this._pool[subGeometry.id]);\n\n\t\tthis._pool[subGeometry.id] = null;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t * @returns RenderPool\n\t */\n\tpublic static getPool():SubGeometryVOPool\n\t{\n\t\treturn (SubGeometryVOPool._pool || (SubGeometryVOPool._pool = new SubGeometryVOPool()));\n\t}\n\n\t/**\n\t *\n\t * @param subMeshClass\n\t */\n\tpublic static registerClass(subGeometryVOClass:ISubGeometryVOClass)\n\t{\n\t\tSubGeometryVOPool.classPool[subGeometryVOClass.assetClass.assetType] = subGeometryVOClass;\n\t}\n\n\t/**\n\t *\n\t * @param subGeometry\n\t */\n\tpublic static getClass(subGeometry:SubGeometryBase):ISubGeometryVOClass\n\t{\n\t\treturn SubGeometryVOPool.classPool[subGeometry.assetType];\n\t}\n\n\tprivate static main = SubGeometryVOPool.addDefaults();\n\n\tprivate static addDefaults()\n\t{\n\t\tSubGeometryVOPool.registerClass(CurveSubGeometryVO);\n\t\tSubGeometryVOPool.registerClass(LineSubGeometryVO);\n\t\tSubGeometryVOPool.registerClass(TriangleSubGeometryVO);\n\t}\n}\n\nexport = SubGeometryVOPool;",
    "import AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ITextureVO\t\t\t\t\t= require(\"awayjs-display/lib/pool/ITextureVO\");\nimport TextureBase\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport TextureVOPool\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOPool\");\n\n/**\n *\n * @class away.pool.TextureVOBaseBase\n */\nclass TextureVOBase implements ITextureVO\n{\n\tprivate _pool:TextureVOPool;\n\tprivate _texture:TextureBase;\n\n\tpublic _stage:Stage;\n\n\tpublic invalid:boolean;\n\n\tconstructor(pool:TextureVOPool, texture:TextureBase, stage:Stage)\n\t{\n\t\tthis._pool = pool;\n\t\tthis._texture = texture;\n\t\tthis._stage = stage;\n\t}\n\n\tpublic _iInitRegisters(shader:ShaderBase, regCache:ShaderRegisterCache)\n\t{\n\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this._texture);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidate()\n\t{\n\t\tthis.invalid = true;\n\t}\n\n\tpublic _iGetFragmentCode(shader:ShaderBase, targetReg:ShaderRegisterElement, regCache:ShaderRegisterCache, inputReg:ShaderRegisterElement = null):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic activate(shader:ShaderBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = TextureVOBase;",
    "import Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport TextureBase\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport ITextureVOClass\t\t\t= require(\"awayjs-renderergl/lib/vos/ITextureVOClass\");\nimport TextureVOBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/vos/TextureVOBase\");\nimport Single2DTextureVO\t\t= require(\"awayjs-renderergl/lib/vos/Single2DTextureVO\");\nimport SingleCubeTextureVO\t\t= require(\"awayjs-renderergl/lib/vos/SingleCubeTextureVO\");\n\n/**\n * @class away.pool.TextureVOPool\n */\nclass TextureVOPool\n{\n\tprivate static classPool:Object = new Object();\n\n\tpublic _stage:Stage;\n\tprivate _pool:Object = new Object();\n\n\t/**\n\t * //TODO\n\t *\n\t * @param textureDataClass\n\t */\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ITexture\n\t */\n\tpublic getItem(texture:TextureBase):TextureVOBase\n\t{\n\t\treturn (this._pool[texture.id] || (this._pool[texture.id] = texture._iAddTextureVO(new (TextureVOPool.getClass(texture))(this, texture, this._stage))));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(texture:TextureBase)\n\t{\n\t\ttexture._iRemoveTextureVO(this._pool[texture.id]);\n\n\t\tthis._pool[texture.id] = null;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var id in this._pool)\n\t\t\tthis._pool[id].dispose();\n\t}\n\n\t/**\n\t *\n\t * @param subMeshClass\n\t */\n\tpublic static registerClass(textureVOClass:ITextureVOClass)\n\t{\n\t\tTextureVOPool.classPool[textureVOClass.assetClass.assetType] = textureVOClass;\n\t}\n\n\t/**\n\t *\n\t * @param subGeometry\n\t */\n\tpublic static getClass(texture:TextureBase):ITextureVOClass\n\t{\n\t\treturn TextureVOPool.classPool[texture.assetType];\n\t}\n\n\tprivate static main = TextureVOPool.addDefaults();\n\n\tprivate static addDefaults()\n\t{\n\t\tTextureVOPool.registerClass(Single2DTextureVO);\n\t\tTextureVOPool.registerClass(SingleCubeTextureVO);\n\t}\n}\n\nexport = TextureVOPool;",
    "import IAssetClass\t\t\t\t\t= require(\"awayjs-core/lib/library/IAssetClass\");\n\nimport ContextGLDrawMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLDrawMode\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\n\nimport ShaderBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterCache\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/shaders/ShaderRegisterElement\");\nimport SubGeometryVOPool\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOPool\");\nimport SubGeometryVOBase\t\t\t= require(\"awayjs-renderergl/lib/vos/SubGeometryVOBase\");\n\n/**\n *\n * @class away.pool.TriangleSubGeometryVO\n */\nclass TriangleSubGeometryVO extends SubGeometryVOBase\n{\n\t/**\n\t *\n\t */\n\tpublic static assetClass:IAssetClass = TriangleSubGeometry;\n\n\tprivate _triangleSubGeometry:TriangleSubGeometry;\n\n\tconstructor(pool:SubGeometryVOPool, triangleSubGeometry:TriangleSubGeometry)\n\t{\n\t\tsuper(pool, triangleSubGeometry);\n\n\t\tthis._triangleSubGeometry = triangleSubGeometry;\n\n\t\tthis.invalidateVertices(this._triangleSubGeometry.positions);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.normals);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.tangents);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.uvs);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.secondaryUVs);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.jointIndices);\n\t\tthis.invalidateVertices(this._triangleSubGeometry.jointWeights);\n\t}\n\n\tpublic _render(shader:ShaderBase, stage:Stage)\n\t{\n\t\tif (shader.uvBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.uvBufferIndex, this._triangleSubGeometry.uvs, stage);\n\n\t\tif (shader.secondaryUVBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.secondaryUVBufferIndex, this._triangleSubGeometry.secondaryUVs, stage);\n\n\t\tif (shader.normalBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.normalBufferIndex, this._triangleSubGeometry.normals, stage);\n\n\t\tif (shader.tangentBufferIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.tangentBufferIndex, this._triangleSubGeometry.tangents, stage);\n\n\t\tif (shader.jointIndexIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.jointIndexIndex, this._triangleSubGeometry.jointIndices, stage);\n\n\t\tif (shader.jointWeightIndex >= 0)\n\t\t\tthis.activateVertexBufferVO(shader.jointIndexIndex, this._triangleSubGeometry.jointWeights, stage);\n\n\t\tthis.activateVertexBufferVO(0, this._triangleSubGeometry.positions, stage);\n\n\n\t\tsuper._render(shader, stage);\n\t}\n\n\tpublic _drawElements(firstIndex:number, numIndices:number, stage:Stage)\n\t{\n\t\tthis.getIndexBufferVO(stage).draw(ContextGLDrawMode.TRIANGLES, 0, numIndices);\n\t}\n\n\tpublic _drawArrays(firstVertex:number, numVertices:number, stage:Stage)\n\t{\n\t\tstage.context.drawVertices(ContextGLDrawMode.TRIANGLES, firstVertex, numVertices);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param renderableOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.TriangleSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowSubGeometry():SubGeometryVOBase\n\t{\n\t\treturn new TriangleSubGeometryVO(this._pool, this._triangleSubGeometry);\n\t}\n}\n\nexport = TriangleSubGeometryVO;"
  ],
  "sourceRoot": ""
}